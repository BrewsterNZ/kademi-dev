<html xmlns="http://www.w3.org/1999/xhtml">    #parse("/theme/masterTemplate.html")    <head>        #@themeHeader( "Sales Data" )        <link rel="stylesheet" href="/static/datepicker/1.0.0/datepicker.css" />        <link rel="stylesheet" type="text/css" href="/static/bootstrap-msg/0.3/bootstrap-msg.min.css" />        <script bottom="true" src="/static/datepicker/1.0.0/bootstrap-datepicker.js">//</script>        <script src="/static/bootstrap-msg/0.3/bootstrap-msg.min.js" type="text/javascript">//</script>        <script type="text/javascript" src='/static/reload-fragment/1.0.0/jquery.reload-fragment.js'>//</script>        #end    </head>    <body class="">        #@themeBody()        <div class="container">            <h1>Sales data</h1>            #if( $page.mySeries.isEmpty() )            <p class="lead-text">There are no data series assigned to you at the moment.</p>            #else            #foreach($series in $page.mySeries)            <div class="panel panel-default" id="series-container">                <div class="panel-heading">                    <h4 class="panel-title">$series.title</h4>                </div>                <div class="panel-body">                    <form action="$page.href" method="post" class="sales-data-form">                        <button type="submit" class="btn btn-success btn-sm pull-right">Save data</button>                        <p>$!series.notes</p>                        <table class="table table-striped" id="table-${series.name}">                            <thead>                                <tr>                                    <th colspan="2">Sales period</th>                                    <th>Amount</th>                                    <th>Units</th>                                    <th colspan="">Entered by</th>                                </tr>                            </thead>                            <tbody>                                <tr>                                    <td>                                        <input type="hidden" name="recordId0" value="" />                                        <input type="hidden" name="series0" value="$series.name" />                                        <div class="form-group">                                            <input type="text" name="periodFrom0" class="form-control date-picker" data-format="DD/MM/YYYY" value="" />                                        </div>                                    </td>                                    <td>                                        <div class="form-group">                                            <input type="text" name="periodTo0" class="form-control date-picker" data-format="DD/MM/YYYY" value="" />                                        </div>                                    </td>                                    <td>                                        <div class="form-group">                                            <input type="text" name="amount0" class="form-control" value="" />                                        </div>                                    </td>                                    <td>$series.units</td>                                    <td></td>                                </tr>                                #foreach($record in $series.records)                                <tr>                                    <td>                                        <input type="hidden" name="recordId${foreach.count}" value="$record.id" />                                        <input type="hidden" name="series${foreach.count}" value="$series.name" />                                        <div class="form-group">                                            <input type="text" name="periodFrom${foreach.count}" placeholder="Start date" data-format="DD/MM/YYYY" value="$formatter.formatDate( $record.periodFrom )" class="form-control date-picker" />                                        </div>                                    </td>                                    <td>                                        <div class="form-group">                                            <input type="text" name="periodTo${foreach.count}" value="$formatter.formatDate( $record.periodTo )" data-format="DD/MM/YYYY" class="form-control date-picker" />                                        </div>                                    </td>                                    <td>                                        <div class="form-group">                                            <input type="text" name="amount${foreach.count}" value="$record.amount" class="form-control" />                                        </div>                                    </td>                                    <td>$series.units</td>                                    <td>                                        $record.enteredBy.name                                        <abbr title="$formatter.formatDateISO8601($record.enteredDate)" class="timeago">$!record.enteredDate</abbr>                                    </td>                                </tr>                                #end                            </tbody>                        </table>                    </form>                </div>            </div>            #end            #end        </div>        <script type="text/javascript">            $(function () {                $(".timeago").timeago();                $("form.sales-data-form").forms({                    callback: function (resp, form) {                        flog("callback", form);                        form.find("table").reloadFragment({                            whenComplete: function () {                                form.find(".timeago").timeago();                            }                        });                        Msg.info("Saved");                    },                    validate: function (form) {                        flog("validate", form);                        // Check that any row with non-empty values has all non-empty values                        form.find("tbody tr").each(function (i, n) {                            var row = $(n);                            var rowInputs = row.find("input[type=text]");                            var nonEmpty = rowInputs.filter(function () {                                return $.trim($(this).val()).length > 0                            });                            if (nonEmpty.length > 0) {                                rowInputs.addClass("required");                            } else {                                rowInputs.removeClass("required");                            }                        });                        return true;                    }                });                $('.date-picker').datepicker({                    autoclose: true,                    format: 'dd/mm/yyyy',                });                $(document.body).on('click', '[data-role="date-picker-trigger"]', function (e) {                    e.preventDefault();                    var trigger = $(this);                    var datePickerId = trigger.attr('href');                    var datePicker = $(datePickerId);                    datePicker.datepicker('show');                });            });        </script>        #end    </body></html>