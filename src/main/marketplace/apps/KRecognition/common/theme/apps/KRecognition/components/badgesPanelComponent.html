#set( $recognitionService = $applications.userApp.recognitionService )
#set( $badges = $recognitionService.getAwardedBadges($topic) )

#if (!$badgesPerRows)
    #set ($badgesPerRows = 4)
#end
#if ($mostRecentBadge == "true")
    #set ($badgesPerRows = 1)
#end
#set ($badgesPerRows = $formatter.toInteger( $badgesPerRows ))

#if ($badgesPerRows == 1)
    #set ($badgeClass = "col-sm-12")
#elseif ($badgesPerRows == 2)
    #set ($badgeClass = "col-sm-6")
#elseif ($badgesPerRows == 3)
    #set ($badgeClass = "col-sm-4")
#elseif ($badgesPerRows == 4)
    #set ($badgeClass = "col-sm-3")
#elseif ($badgesPerRows == 6)
    #set ($badgeClass = "col-sm-2")
#elseif ($badgesPerRows == 12)
    #set ($badgeClass = "col-sm-1")
#end

#if( !$badges or $badges.empty)
    #if (!$page)
        NO BADGES
    #end
#else
    #set ($badges = $formatter.sortByProperty($badges, "createdDate"))
    #set ($badges = $formatter.sortReverse($badges))
    <div class="kbadges-list row row-sm">
        #foreach($b in $badges)
            <div class="$badgeClass kbadge">
                #if ($b.recognition.imageHash)
                    <img src="/_hashes/files/$b.recognition.imageHash" class="img-responsive kbadge-photo" alt="$b.recognition.title" />
                #else
                    <img src="/static/images/photo_holder_squared.png" class="img-responsive kbadge-photo" alt="$b.recognition.title" />
                #end
                #if ($showBadgeTitle == true)
                    <div class="kbadge-title">$b.recognition.title</div>
                #end
            </div>
        
            #if ($mostRecentBadge == "true")
                #break
            #end
        #end
    </div>
#end