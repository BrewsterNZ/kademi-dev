#if (!$rowHeight)
#set ($rowHeight = 25)
#end
#if (!$numUsers)
#set ($numUsers = 5)
#end

#set( $kpiFolder = $rootFolder.find("/sales").child($salesDataSeries).find($kpi))
#set ($startDate = $formatter.yearStart)
#set ($endDate = $formatter.yearEnd())

#set( $lb = $kpiFolder.getLeaderboard($startDate, $endDate))
#if( $lb )

<table cellpadding="0" cellspacing="0" width="100%" class="table table-striped table-hover">
    <thead>
        <tr>
            <th>Rank</th>
            <th>Amount</th>
            <th>Raw value</th>
            <th>Baseline</th>
            <th>Participant</th>
        </tr>
    </thead>
    <tbody id="leaderboardBody">
        #foreach($item in $lb.highestResults )
        #set( $plusOne = $item.rank + 1 )
        <tr>
            <td>$plusOne</td>
            <td>
                #if( $item.amount )
                $formatter.formatCurrency($item.amount)
                #else
                No value
                #end
            </td>
            <td>$!formatter.formatCurrency($item.rawAmount)</td>
            <td>$!formatter.formatCurrency($item.baseline)</td>
            <td>
                <!-- either a profilebean or orgdata -->
                #if( $item.profile) <!-- is individual -->
                $item.profile.name $item.profile.class($item.profile.userName)
                #else
                $item.org.title
                #end
            </td>
            <td>
                #if( $item.profile)
                #foreach($orgAndGroup in $item.profile.primaryMemberships().groupByOrg.entrySet() )
                <span class="label label-success">
                    <b>$orgAndGroup.value.first.groupName</b>
                    in
                    $orgAndGroup.key.title
                </span>
                #end
                #end
            </td>
        </tr>
        #end
    </tbody>
</table>

#else
<table border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="$!{bgcolor}">
    <tr>
        <td colspan="2">
            No KPI selected
        </td>
    </tr>
</table>
#end
