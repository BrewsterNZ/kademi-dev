#set ($baseStyles = "font-family: $!{fontFamily}; font-size: $!{fontSize}px; line-height: $!{lineHeight}px; color: $!{textColor};")
#set ($linkStyles = "font-family: $!{fontFamily}; font-size: $!{fontSize}px; line-height: $!{lineHeight}px; color: $!{linkColor}; text-decoration: none;")

#if( $passwordreset )
#else
    #set( $passwordreset = $applications.email.createPasswordReset($rootFolder, $profile) )
#end

<table cellpadding="0" cellspacing="0" border="0" width="100%" bgcolor="$!bgColor" style="background-color: $!bgColor;">
    <tbody>
        <tr>
            <td class="wrapper" style="padding-top: $!{paddingTop}px; padding-bottom: $!{paddingBottom}px; padding-left: $!{paddingLeft}px; padding-right: $!{paddingRight}px;">
                <table #if($textAlign =='full') width="100%" align="center" #else align="$!{textAlign}" #end border="0" cellpadding="0" cellspacing="0" class="button-wrapper" bgcolor="$!color" style="border-radius: $!{borderRadius}px; background-color: $!color;">
                    <tbody>
                        <tr>
                            <td #if($textAlign =='full') align="center" #else align="$!{textAlign}" #end valign="middle" class="button-inner" style="padding-top: $!{paddingInnerTop}px; padding-bottom: $!{paddingInnerBottom}px; padding-left: $!{paddingInnerLeft}px; padding-right: $!{paddingInnerRight}px;">
                                #set ($buttonFontSizeStr = "")
                                #if (!$formatter.isNull($buttonFontSize))
                                    #set ($buttonFontSizeStr = "font-size: $!{buttonFontSize}px;")
                                #end

                                #set ($buttonFontFamilyStr = "")
                                #if (!$formatter.isNull($buttonFontFamily))
                                    #set ($buttonFontFamilyStr = "font-family: $!{buttonFontFamily};")
                                #end

                                #set ($fontWeightStr = "")
                                #if (!$formatter.isNull($fontWeight))
                                    #set ($fontWeightStr = "font-weight: $!{fontWeight};")
                                #end

                                #set ($fontStyleStr = "")
                                #if (!$formatter.isNull($fontStyle))
                                    #set ($fontStyleStr = "font-style: $!{fontStyle};")
                                #end

                                #set ($buttonTextColorStr = "")
                                #if (!$formatter.isNull($buttonTextColor))
                                    #set ($buttonTextColorStr = "color: $!{buttonTextColor};")
                                #end
                                <a title="$message" href="http://${rootFolder.domainName}${formatter.portString}/do-reset/?token=$!{passwordreset.token}" target="_blank" style="$!buttonFontSizeStr $!buttonFontWeightStr #if($textAlign == 'full') text-align: center; #else text-align: $!{textAlign}; #end text-decoration: none; $!buttonTextColorStr $!buttonFontFamilyStr $!fontStyleStr $!fontWeightStr">$message</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </td>
        </tr>
    </tbody>
</table>