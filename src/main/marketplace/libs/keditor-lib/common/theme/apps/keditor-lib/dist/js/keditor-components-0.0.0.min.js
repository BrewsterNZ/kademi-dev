/**!
 * KEditor - Kademi content editor
 * @copyright: Kademi (http://kademi.co)
 * @author: Kademi (http://kademi.co)
 * @version: 0.0.0
 * @dependencies: $, $.fn.draggable, $.fn.droppable, $.fn.sortable, Bootstrap (optional), FontAwesome (optional)
 */
!function(t){var e=t.keditor,n=e.log;e.components.accordion={settingEnabled:!0,settingTitle:"Accordion Settings",init:function(e,i,o,a){var r=a.options,d=a.generateId("accordion"),s=o.children(".keditor-component-content");s.find(".accordionWrap .panel-group").attr("id",d),s.find(".accordionWrap a[data-toggle]").attr("data-parent","#"+d);var c=s.find(".panel");c.each(function(e,n){var i=t(n),o=a.generateId("heading"+e),r=a.generateId("collapse"+e);if(i.find(".panel-heading").attr("id",o),i.find(".panel-collapse").attr("aria-labelledby",o).attr("id",r),i.find("a[data-toggle]").attr("href","#"+r).attr("aria-controls","#"+r),!i.find("a[data-toggle]").find(".accHeadingText").length){var d=t('<div class="accHeadingText" style="display: inline-block; width: 90%"></div>'),s=t('<div style="display: inline-block; width: 5%; float: right; text-align: right"><i class="fa fa-angle-double-down panelIconCollapsed"></i><i class="fa panelIconExpanded fa-angle-double-up"></i></div>'),c=i.find("a[data-toggle]").text().trim();d.text(c),i.find("a[data-toggle]").html("").append(d).append(s)}}),s.find(".accordionWrap .panel-collapse").collapse("show"),s.find(".panel-footer, .btnAddAccordionItem").removeClass("hide"),s.find(".panel-title a .accHeadingText").prop("contenteditable",!0),s.find(".panel-collapse .panel-body").prop("contenteditable",!0),s.find(".panel-title a .accHeadingText, .panel-collapse .panel-body").on("input",function(t){"function"==typeof r.onComponentChanged&&r.onComponentChanged.call(e,t,o),"function"==typeof r.onContainerChanged&&r.onContainerChanged.call(e,t,i),"function"==typeof r.onContentChanged});var l=s.find(".panel-title a .accHeadingText, .panel-collapse .panel-body").ckeditor(r.ckeditorOptions).editor;l.on("instanceReady",function(){n("CKEditor is ready",o),"function"==typeof r.onComponentReady&&r.onComponentReady.call(e,o,l)}),t(document).off("click",".btnDeleteAccordionItem").on("click",".btnDeleteAccordionItem",function(e){if(e.preventDefault(),confirm("Are you sure you want to delete this item?")){var n=s.find(".panel").length;n>1?t(this).parents(".panel").remove():Msg.error("You cant delete the last item")}}),t(document).off("click",".btnAddAccordionItem").on("click",".btnAddAccordionItem",function(t){t.preventDefault();var i=s.find(".panel").first().clone(),d=a.generateId("heading"),c=a.generateId("collapse");i.find(".panel-heading").attr("id",d),i.find(".panel-collapse").attr("aria-labelledby",d).attr("id",c),i.find("a[data-toggle]").attr("href","#"+c),s.find(".accordionWrap .panel-group").append(i);var l=i.find(".panel-title a .accHeadingText, .panel-collapse .panel-body").ckeditor(r.ckeditorOptions).editor;l.on("instanceReady",function(){n("CKEditor is ready",o),"function"==typeof r.onComponentReady&&r.onComponentReady.call(e,o,l)})})},getContent:function(e,n){var i=e.children(".keditor-component-content");return i.find(".panel-collapse .panel-body").each(function(){var e=t(this).html();t(this).replaceWith('<div class="panel-body">'+e+"</div>")}),"true"==e.attr("data-initial-collapsed")&&i.find(".panel").each(function(){var e=t(this).find(".panel-heading a"),n=t(this).find(".panel-collapse");n.addClass("collapse").attr("aria-expanded","false").removeClass("in"),e.addClass("collapsed").attr("aria-expanded","false")}),i.find(".panel-footer, .btnAddAccordionItem").addClass("hide"),i.find("[contenteditable]").removeAttr("contenteditable"),i.find(".accHeadingText").each(function(){t(this).css("outline","none").text(t(this).text())}),i.html()},destroy:function(t,e){n('destroy "text" component',t);var i=t.find(".keditor-component-content").attr("id"),o=CKEDITOR.instances[i];o&&o.destroy()},initSettingForm:function(e,i){return n('init "accordion" settings',e),t.ajax({url:"/theme/apps/keditor-lib/componentAccordionSettings.html",type:"get",dataType:"HTML",success:function(n){e.html(n),e.find(".collapsedAll").on("click",function(){var t=i.getSettingComponent();t.attr("data-initial-collapsed",this.checked)}),e.find(".panelStyle").on("change",function(t){var e=i.getSettingComponent(),n=e.attr("data-panel-style")||"panel-default";e.attr("data-panel-style",this.value),e.find(".panel").removeClass(n).addClass(this.value)}),t.getStyleOnce("/static/bootstrap-iconpicker/1.7.0/css/bootstrap-iconpicker.min.css"),t.getScriptOnce("/static/bootstrap-iconpicker/1.7.0/js/iconset/iconset-fontawesome-4.2.0.min.js",function(){t.getScriptOnce("/static/bootstrap-iconpicker/1.7.0/js/bootstrap-iconpicker.min.js",function(){e.find(".btn-collapsed-icon, .btn-expanded-icon").iconpicker({iconset:"fontawesome",cols:10,rows:4,placement:"left"}),e.find(".btn-collapsed-icon").on("change",function(t){var e=i.getSettingComponent();e.attr("data-collapsed-icon",t.icon),e.find(".panelIconCollapsed").each(function(){this.className="panelIconCollapsed fa "+t.icon})}),e.find(".btn-expanded-icon").on("change",function(t){var e=i.getSettingComponent();e.attr("data-expanded-icon",t.icon),e.find(".panelIconExpanded").each(function(){this.className="panelIconExpanded fa "+t.icon})})})})}})},showSettingForm:function(e,i,o){n('showSettingForm "Accordion" component');var a=o.getDataAttributes(i,["data-type"],!1);e.find(".collapsedAll").prop("checked","true"==i.attr("data-initial-collapsed")),e.find(".panelStyle").val(i.attr("data-panel-style")),t.getScriptOnce("/static/bootstrap-iconpicker/1.7.0/js/iconset/iconset-fontawesome-4.2.0.min.js",function(){t.getScriptOnce("/static/bootstrap-iconpicker/1.7.0/js/bootstrap-iconpicker.min.js",function(){var t=a["data-collapsed-icon"]||"fa-caret-up";e.find(".btn-collapsed-icon").find("i").attr("class","fa "+t).end().find("input").val(t);var n=a["data-expanded-icon"]||"fa-caret-down";e.find(".btn-expanded-icon").find("i").attr("class","fa "+n).end().find("input").val(n)})})}}}(jQuery),function(t){var e=t.keditor,n=e.log;e.components.audio={init:function(e,i,o,a){n('init "audio" component',o),this.component=o;var r=o.find("img[data-src]"),d="";r.attr("id")?d=r.attr("id"):(d=a.generateId("component-audio"),r.attr("id",d)),r.parent().hasClass("audio-wrapper")||r.wrap('<div class="audio-wrapper"></div>'),this.src=r.attr("data-src"),this.width=r.attr("data-width"),this.autostart="true"===r.attr("data-autostart");var s=this;t.getScriptOnce("/static/jwplayer/6.10/jwplayer.js",function(){jwplayer.key="cXefLoB9RQlBo/XvVncatU90OaeJMXMOY/lamKrzOi0=",s.buildJWAudioPlayerPreview(d)})},getContent:function(t,e){n('getContent "audio" component',t);var i=t.find("img[data-src]"),o=i.attr("id"),a='<img data-componentId="'+o+'" src="/theme/apps/content/preview/audio.png" data-autostart="'+this.autostart+'" data-width="'+this.width+'" data-src="'+this.src+'" data-kaudio="'+this.src+'" />';return a},settingEnabled:!0,settingTitle:"Audio settings",initSettingForm:function(e,i){return n('init "audio" settings',e),t.ajax({url:"/theme/apps/keditor-lib/componentAudioSettings.html",type:"get",dataType:"HTML",success:function(t){e.html(t)}})},showSettingForm:function(t,e,i){n('showSettingForm "audio" component',t,e);var o=this,a=t.find(".btn-audioFileInput");a.mselect({contentTypes:["audio"],bs3Modal:!0,pagePath:i.options.pagePath,basePath:i.options.basePath,onSelectFile:function(t){o.src=t,o.refreshAudioPlayerPreview()}});var r=e.find("img[data-src]"),d=r.attr("id"),s=t.find("#audio-autoplay");this.autostart&&s.prop("checked",!0),s.on("click",function(t){o.autostart=this.checked,o.buildJWAudioPlayerPreview(d)});var c=t.find("#audio-width");c.val(this.width),c.on("change",function(){o.width=this.value,o.resizeAudioPlayerPreview()})},buildJWAudioPlayerPreview:function(t){var e=this.width,n=this.src,i=this.autostart,o=jwplayer(t);o.setup({file:n,width:e,height:30,autostart:i,flashplayer:"/static/jwplayer/6.10/jwplayer.flash.swf",html5player:"/static/jwplayer/6.10/jwplayer.html5.js",primary:"flash"}),o.onReady(function(){log("jwplayer preview init done")})},refreshAudioPlayerPreview:function(){var t=this,e=jwplayer(t.componentId),n=t.src;e.load([{file:n}]),e.play()},resizeAudioPlayerPreview:function(){var t=this,e=jwplayer(t.componentId),n=t.width;e.resize(n,30)}}}(jQuery),function(t){var e=t.keditor,n=e.log;e.components.carousel={init:function(e,i,o,a){n('init "carousel" component',o);var r=o.children(".keditor-component-content"),d=r.find(".carousel");if(0===d.find(".carousel-img").length&&0===d.find(".carousel-content").length){var s=this,c=[];d.addClass("carousel-fixed-height"),d.find(".carousel-inner .item").each(function(){var e=t(this);c.push({src:e.find("img").attr("src"),hash:e.attr("data-hash")})}),d.attr("data-height",300).css("height",300),d.find(".carousel-inner").html(""),d.find(".carousel-indicators").html(""),t.each(c,function(t,e){s.addItemToCarousel(o,{src:e.src,hash:e.hash})})}var l=a.generateId("component-carousel");d.attr("id",l),d.find(".carousel-indicators li").attr("data-target","#"+l),d.find(".carousel-control").attr("href","#"+l)},getContent:function(t,e){var n=t.children(".keditor-component-content");return n.find(".carousel-inner").children().removeClass("active").eq(0).addClass("active"),n.html()},settingEnabled:!0,settingTitle:"Carousel settings",editingItemId:"",initSettingForm:function(e,i){n('init "carousel" settings',e);var o=this;return t.ajax({url:"/theme/apps/keditor-lib/componentCarouselSettings.html",type:"get",dataType:"HTML",success:function(a){e.html(a),t.getStyleOnce("/static/bootstrap-iconpicker/1.7.0/css/bootstrap-iconpicker.min.css"),t.getScriptOnce("/static/bootstrap-iconpicker/1.7.0/js/iconset/iconset-fontawesome-4.2.0.min.js",function(){t.getScriptOnce("/static/bootstrap-iconpicker/1.7.0/js/bootstrap-iconpicker.min.js",function(){e.find(".btn-prev-icon, .btn-next-icon").iconpicker({iconset:"fontawesome",cols:10,rows:4,placement:"left"}),e.find(".btn-prev-icon").on("change",function(t){var e=i.getSettingComponent().find(".carousel");e.find(".glyphicon-chevron-left").attr("class","fa glyphicon-chevron-left "+t.icon)}),e.find(".btn-next-icon").on("change",function(t){var e=i.getSettingComponent().find(".carousel");e.find(".glyphicon-chevron-right").attr("class","fa glyphicon-chevron-right "+t.icon)})})});var r=e.find(".carouselAddImage"),d=e.find(".carouselItemsWrap");r.mselect({contentTypes:["image"],bs3Modal:!0,pagePath:i.options.pagePath,basePath:i.options.basePath,onSelectFile:function(t,a,r,d){n("Keditor carousel selected a file",t,d),o.addItemToList(e,{src:t,hash:d,caption:""}),o.refreshCarousel(i.getSettingComponent(),e),o.editingItemId=""}}),d.sortable({handle:".btn-sort-item",items:"> .carouselItem",axis:"y",tolerance:"pointer",sort:function(){t(this).removeClass("ui-state-default")},update:function(){o.refreshCarousel(i.getSettingComponent(),e)}});var s=o.initModalContent(e,i),c=t("#modal-carousel-content"),l=o.initModalCaption(e,i),p=t("#modal-carousel-caption");e.find(".carouselAddImage").on("click",function(t){t.preventDefault()}),e.find(".carouselAddContent").on("click",function(t){t.preventDefault(),c.modal("show")}),e.on("click",".carouselItem a.btn-remove-item",function(n){if(n.preventDefault(),confirm("Are you sure that you want to delete this image?")){var a=t(this),r=a.closest(".btn-group").siblings("[data-hash]").attr("data-hash"),d=i.getSettingComponent().find(".carousel");d.find("[data-hash="+r+"]").remove(),a.closest(".carouselItem").remove(),o.refreshCarousel(i.getSettingComponent(),e)}}),e.on("click",".carouselItem a.btn-edit-item",function(n){n.preventDefault();var i=t(this).closest(".carouselItem");o.editingItemId=i.attr("id");var a=i.find(".txt-carousel-content");a.length>0?(s.setData(a.val()||""),e.find(".carouselAddContent").trigger("click")):e.find(".carouselAddImage").trigger("click")}),e.on("click",".carouselItem a.btn-edit-caption-item",function(e){e.preventDefault();var n=t(this).closest(".carouselItem");o.editingItemId=n.attr("id");var i=n.find(".txt-carousel-caption");l.setData(i.val()||""),p.modal("show")}),e.find(".carouselHeight").on("change",function(t){var e=this.value;(isNaN(e)||+e<200)&&(e=200,this.value=200);var n=i.getSettingComponent().find(".carousel");n.attr("data-height",e),n.css("height",e)}),e.find(".carouselPause").on("change",function(t){t.preventDefault();var e=i.getSettingComponent().find(".carousel");e.attr("data-pause",this.value)}),e.find(".carouselInterval").on("change",function(t){t.preventDefault();var e=i.getSettingComponent().find(".carousel");e.attr("data-interval",this.value)}),e.find(".carouselWrap").on("click",function(t){var e=i.getSettingComponent().find(".carousel");this.checked?e.attr("data-wrap","true"):e.attr("data-wrap","false")}),e.find(".select-image-size").on("change",function(){var t=i.getSettingComponent().find(".carousel");t.attr("data-image-size",this.value),t.find(".carousel-img").css("background-size","centered"===this.value?"unset":"")})}})},initModalContent:function(e,i){var o=this,a=t('<div class="modal fade" tabindex="-1" id="modal-carousel-content">    <div class="modal-dialog modal-lg">        <div class="modal-content">            <div class="modal-header">                <button type="button" class="close" data-dismiss="modal">&times;</button>                <h4 class="modal-title">Edit content</h4>            </div>            <div class="modal-body">                <textarea id="modal-carousel-content-body" class="form-control" rows="12"></textarea>            </div>            <div class="modal-footer">                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>                <button type="button" class="btn btn-primary btn-carousel-save-content">Save</button>            </div>        </div>    </div></div>').appendTo(document.body),r=t.extend({},i.options.ckeditorOptions);r.removePlugins=r.removePlugins.replace(",autogrow","")+",sourcedialog",r.extraPlugins=r.extraPlugins+",autogrow";var d=t("#modal-carousel-content-body").ckeditor(r).editor;return a.on("hidden.bs.modal",function(){d.setData(""),o.editingItemId=""}),a.find(".btn-carousel-save-content").on("click",function(t){t.preventDefault(),n("Keditor carousel add content");var r=d.getData()||"";o.addItemToList(e,{content:r}),o.refreshCarousel(i.getSettingComponent(),e),a.modal("hide")}),d},initModalCaption:function(e,i){var o=this,a=t('<div class="modal fade" tabindex="-1" id="modal-carousel-caption">    <div class="modal-dialog modal-lg">        <div class="modal-content">            <div class="modal-header">                <button type="button" class="close" data-dismiss="modal">&times;</button>                <h4 class="modal-title">Edit caption</h4>            </div>            <div class="modal-body">                <textarea id="modal-carousel-caption-body" class="form-control" rows="12"></textarea>            </div>            <div class="modal-footer">                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>                <button type="button" class="btn btn-primary btn-carousel-save-caption">Save</button>            </div>        </div>    </div></div>').appendTo(document.body),r=t.extend({},i.options.ckeditorOptions);r.removePlugins=r.removePlugins.replace(",autogrow","")+",sourcedialog",r.extraPlugins=r.extraPlugins+",autogrow",r.toolbarGroups=toolbarSets.Lite;var d=t("#modal-carousel-caption-body").ckeditor(r).editor;return a.on("hidden.bs.modal",function(){d.setData(""),o.editingItemId=""}),a.find(".btn-carousel-save-caption").on("click",function(t){t.preventDefault(),n("Keditor carousel add content");var r=d.getData()||"",s=e.find("#"+o.editingItemId).find(".img-responsive");o.addItemToList(e,{src:s.attr("src"),hash:s.attr("data-hash"),caption:r}),o.refreshCarousel(i.getSettingComponent(),e),a.modal("hide")}),d},showSettingForm:function(e,n,i){var o=this;o.editingItemId="",e.find(".carouselItemsWrap").html(""),n.find(".carousel-inner > .item").each(function(){var n=t(this),i=n.find(".carousel-img"),a=n.find(".carousel-content");if(a.length>0)o.addItemToList(e,{content:a.html()});else{var r=i.css("background-image");r=r.slice(4,-1).replace(/['"]/g,"");var d=t(n).attr("data-hash"),s=n.find(".carousel-caption");o.addItemToList(e,{src:r,hash:d,caption:s.html()||""})}});var a=n.find(".carousel"),r=a.attr("data-wrap"),d=a.attr("data-pause"),s=a.attr("data-interval"),c=a.attr("data-height");e.find(".carouselPause").val(d),e.find(".carouselInterval").val(s),e.find(".carouselWrap").prop("checked","true"===r),e.find(".carouselHeight").val(c),e.find(".select-image-size").val(a.attr("data-image-size")||"stretched"),t.getScriptOnce("/static/bootstrap-iconpicker/1.7.0/js/iconset/iconset-fontawesome-4.2.0.min.js",function(){t.getScriptOnce("/static/bootstrap-iconpicker/1.7.0/js/bootstrap-iconpicker.min.js",function(){var t=a.find(".glyphicon-chevron-left").attr("class")||"";t=t.replace("glyphicon-chevron-left","").replace("fa","").trim(),e.find(".btn-prev-icon").find("i").attr("class","fa "+t).end().find("input").val(t);var n=a.find(".glyphicon-chevron-right").attr("class")||"";n=n.replace("glyphicon-chevron-right","").replace("fa","").trim(),e.find(".btn-next-icon").find("i").attr("class","fa "+n).end().find("input").val(n)})})},addItemToCarousel:function(t,e){n("addItemToCarousel",t,e);var i=t.find(".carousel"),o=i.find(".carousel-inner"),a=i.attr("id"),r=o.children().length,d=0===r?"active":"",s="background-image: url('"+e.src+"')",c="centered"===i.attr("data-image-size")?";background-size: unset":"";i.find(".carousel-indicators").append('<li data-target="#'+a+'" data-slide-to="'+r+'" class="'+d+'"></li>');var l="";e.content?(l+='<div class="item '+d+'">',l+='   <div class="carousel-content clearfix">'+e.content+"</div>",l+='   <div class="carousel-caption"></div>',l+="</div>"):(l+='<div data-hash="'+e.hash+'" class="item '+d+'">',l+='   <div class="carousel-img" style="'+s+c+'"></div>',l+='   <div class="carousel-caption">'+e.caption+"</div>",l+="</div>"),o.append(l)},addItemToList:function(t,e){n("addItemToList",t,e);var i="",o="";e.content?(o+='<img class="img-responsive" src="/keditor/componentCarouselContent.png" />',o+='<textarea style="display: none" class="txt-carousel-content">'+e.content+"</textarea>"):(o+='<img class="img-responsive" src="'+e.src+'" data-hash="'+e.hash+'" />',o+='<textarea style="display: none" class="txt-carousel-caption">'+e.caption+"</textarea>",i='<a title="Edit caption" class="btn btn-success btn-edit-caption-item" href="#"><i class="fa fa-file"></i></a>'),o+='   <div class="btn-group btn-group-xs">',o+='       <a title="Reorder item" class="btn btn-info btn-sort-item" href="#"><i class="fa fa-sort"></i></a>',o+='       <a title="Edit item" class="btn btn-primary btn-edit-item" href="#"><i class="fa fa-edit"></i></a>'+i,o+='       <a title="Delete item" class="btn btn-danger btn-remove-item" href="#"><i class="fa fa-trash"></i></a>',o+="   </div>",this.editingItemId?(t.find("#"+this.editingItemId).html(o),this.editingItemId=""):t.find(".carouselItemsWrap").append('<div class="carouselItem" id="carouselItem-'+(new Date).getTime()+'">'+o+"</div>")},refreshCarousel:function(e,n){var i=this,o=e.find(".carousel");o.find(".carousel-inner").html(""),o.find(".carousel-indicators").html(""),n.find(".carouselItemsWrap").find(".carouselItem").each(function(){var n=t(this),o=n.find(".txt-carousel-content"),a=n.find(".txt-carousel-caption"),r=n.find("img");0===o.length?i.addItemToCarousel(e,{src:r.attr("src"),hash:r.attr("data-hash"),caption:a.val()}):i.addItemToCarousel(e,{content:o.val()})})}}}(jQuery),function(t){var e=t.keditor,n=e.log;e.components.form={initFormBuilder:function(e){var n=this;t.getScriptOnce("/static/formBuilder/2.5.3/form-builder.min.js",function(){t.getScriptOnce("/static/formBuilder/2.5.3/form-render.min.js",function(){var t=e.find(".form-builder-area"),i=e.find(".form-data"),o=e.find(".form-content");e.find(".keditor-component-content").prepend('<p class="form-builder-tools" style="text-align: right;">    <a href="#" class="btn btn-primary btn-preview-form">Preview form</a>     <a href="#" class="btn btn-info btn-edit-form disabled">Edit form</a></p>');var a=e.find(".btn-edit-form"),r=e.find(".btn-preview-form");t.formBuilder({disableInjectedStyle:!0,showActionButtons:!1,dataType:"json",formData:i.html(),disableFields:["autocomplete","paragraph","header"],disabledAttrs:["access"],typeUserDisabledAttrs:{"checkbox-group":["toggle","inline"]}}),a.on("click",function(e){e.preventDefault(),a.hasClass("disabled")||(t.show(),o.hide(),a.addClass("disabled"),r.removeClass("disabled"))}),r.on("click",function(i){i.preventDefault(),r.hasClass("disabled")||(n.renderForm(e),t.hide(),o.show(),a.removeClass("disabled"),r.addClass("disabled"))})})})},renderForm:function(e,n){var i=e.find(".form-content");if(!n){var o=e.find(".form-builder-area");n=o.data("formBuilder")}i.formRender({dataType:"json",formData:n.actions.getData("json")}),i.hasClass("form-horizontal")&&i.children("div").each(function(){var e=t(this),n=i.attr("data-grid")||"4-8";if(n=n.split("-"),e.attr("class"))if(e.hasClass("fb-button"))e.find("button").wrap('<div class="col-sm-'+n[1]+" col-sm-offset-"+n[0]+'"></div>');else{var o=e.children("label"),a=e.children("input, select, textarea"),r=e.children("div");o.addClass("control-label col-sm-"+n[0]),r.length>0?r.addClass("col-sm-"+n[1]):a.addClass("form-control").wrap('<div class="col-sm-'+n[1]+'"></div>')}})},init:function(e,i,o,a){n('init "form" component',o);var r=o.find(".keditor-component-content"),d=o.find(".form-builder-area"),s=o.find(".form-content"),c=o.find(".form-data");0===c.length&&r.append('<div class="form-data" style="display: none !important;"></div>'),0===s.length?r.append('<form class="form-content" style="display: none !important;"></form>'):s.hide(),0===d.length&&(d=t('<div class="form-builder-area clearfix"></div>'),r.append(d)),this.initFormBuilder(o)},getContent:function(e,i){n('getContent "form" component',e);var o=this,a=e.find(".keditor-component-content"),r=e.find(".form-data"),d=t("#"+e.attr("id")).find(".form-builder-area"),s=d.data("formBuilder");return o.renderForm(e,s),r.html(s.actions.getData("json")),e.find(".form-builder-area, .form-builder-tools").remove(),e.find(".form-content").show(),a.html()},settingEnabled:!0,settingTitle:"Form Settings",initSettingForm:function(e,i){n('initSettingForm "form" component');var o=this;return t.ajax({url:"/theme/apps/keditor-lib/componentFormSettings.html",type:"get",dataType:"HTML",success:function(t){e.html(t),e.find(".txt-form-action").on("change",function(){var t=i.getSettingComponent(),e=t.find(".form-content");e.attr("action",this.value)}),e.find(".select-method").on("change",function(){var t=i.getSettingComponent(),e=t.find(".form-content");e.attr("action",this.value)}),e.find(".select-enctype").on("change",function(){var t=i.getSettingComponent(),e=t.find(".form-content");e.attr("enctype",this.value)}),e.find(".select-layout").on("change",function(){var t=i.getSettingComponent(),n=t.find(".form-content");n.removeClass("form-inline form-horizontal"),this.value&&n.addClass(this.value),o.renderForm(t),e.find(".select-grid-wrapper").css("display","form-horizontal"===this.value?"block":"none")}),e.find(".select-grid").on("change",function(){var t=i.getSettingComponent(),e=t.find(".form-content");e.attr("data-grid",this.value),o.renderForm(t)})}})},showSettingForm:function(t,e,i){n('showSettingForm "form" component',e);var o=e.find(".form-content"),a="";o.hasClass("form-inline")?a="form-inline":o.hasClass("form-horizontal")&&(a="form-horizontal"),t.find(".txt-form-action").val(o.attr("action")||""),t.find(".select-method").val(o.attr("method")||"get"),t.find(".select-enctype").val(o.attr("enctype")),t.find(".select-layout").val(a),t.find(".select-grid-wrapper").css("display","form-horizontal"===a?"block":"none"),t.find(".select-grid").val(o.attr("data-grid")||"4-8")}}}(jQuery),function(t,e){var n=t.keditor,i=n.log;n.components.googlemap={init:function(t,e,n,o){i('init "googlemap" component',n),this.callWhenGoogleMapReady(function(){initKGoogleMap(n)})},getContent:function(t,e){i('getContent "googlemap" component',t);var n=t.children(".keditor-component-content");return n.find(".googlemap-cover").remove(),t.find(".kgooglemap").html(""),n.html()},settingEnabled:!0,settingTitle:"Google Map Settings",initSettingForm:function(e,n){i('init "googlemap" settings',e);var o=this;return t.ajax({url:"/theme/apps/keditor-lib/componentGoogleMapSettings.html",type:"get",dataType:"HTML",success:function(i){e.html(i),o.callWhenGoogleMapReady(function(){var t=n.getSettingComponent();o.initAutocomplete(t,e)});var a=e.find(".map-type");e.find(".mapType").on("click",function(){a.hide().filter("."+this.value).show();var t=n.getSettingComponent(),i=t.find("iframe"),r=t.find(".kgooglemap");t.attr("data-maptype",this.value),i["manually"===this.value?"hide":"show"](),r["manually"===this.value?"show":"hide"](),"manually"===this.value&&o.makeGoogleMapFresh(e,t)}),e.find("[name=mapEmbedCode]").on("change",function(){var e=t(this.value),i=e.attr("src");e.length>0&&i&&i.length>0?n.getSettingComponent().find(".embed-responsive-item").attr("src",i):alert("Your Google Map embed code is invalid!")}),e.find("[name=mapRatio]").on("click",function(){var t=n.getSettingComponent();t.find(".embed-responsive").removeClass("embed-responsive-4by3 embed-responsive-16by9").addClass("embed-responsive-"+this.value)})}})},callWhenGoogleMapReady:function(n){var i=this,o="AIzaSyBUcuZxwpBXCPztG7ot-rITXJbycPuS7gs",a="https://maps.googleapis.com/maps/api/js?key="+o+"&libraries=places";e.google&&e.google.maps&&google.maps.places?n.call(i):t.getScriptOnce(a,function(){n.call(i)})},makeGoogleMapFresh:function(t,e){var n=t.find("[name=mapAddress]")[0];setTimeout(function(){google.maps.event.trigger(n,"focus"),google.maps.event.trigger(n,"keydown",{keyCode:13})},1e3);var i=e.find(".kgooglemap").data("map");setTimeout(function(){google.maps.event.trigger(i,"resize")},100)},showSettingForm:function(t,e,n){var i=this;i.callWhenGoogleMapReady(function(){var n=e.attr("data-maptype")||"embed",o=e.attr("data-place"),a=e.find(".embed-responsive").hasClass("embed-responsive-16by9")?"16by9":"4by3";t.find(".mapRatio[value="+a+"]").prop("checked",!0),t.find(".mapType[value="+n+"]").prop("checked",!0);var r=e.find("iframe").attr("src"),d='<iframe class="embed-responsive-item" src="'+r+'"></iframe>';o||(o="Hanoi, Vietnam"),t.find("[name=mapAddress]").val(o),t.find("[name=mapEmbedCode]").val(d),t.find(".map-type").hide().filter("."+n).show(),e.find(".kgooglemap").data("map")?"manually"===n&&i.makeGoogleMapFresh(t,e):(i.initAutocomplete(e,t),"manually"===n&&i.makeGoogleMapFresh(t,e))})},initAutocomplete:function(t,e){if(t.find(".kgooglemap").data("map"))this.makeGoogleMapFresh(e,t);else{var n=t.find(".kgooglemap")[0],i=new google.maps.Map(n,{zoom:13,mapTypeId:"roadmap"}),o=e.find("[name=mapAddress]")[0],a=new google.maps.places.SearchBox(o);i.addListener("bounds_changed",function(){a.setBounds(i.getBounds())});var r=[];a.addListener("places_changed",function(){var e=a.getPlaces();if(0!=e.length){r.forEach(function(t){t.setMap(null)}),r=[];var n=new google.maps.LatLngBounds;e.forEach(function(t){if(!t.geometry)return void console.log("Returned place contains no geometry");var e={url:t.icon,size:new google.maps.Size(71,71),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(25,25)};r.push(new google.maps.Marker({map:i,icon:e,title:t.name,position:t.geometry.location})),t.geometry.viewport?n.union(t.geometry.viewport):n.extend(t.geometry.location)}),i.fitBounds(n),t.attr("data-place",o.value)}}),t.find(".kgooglemap").data("map",i)}}}}(jQuery,window),function(t){var e=t.keditor,n=t.contentEditor,i=e.log;e.components.jumbotron={settingEnabled:!0,settingTitle:"Jumbotron Settings",init:function(t,e,n,o){var a=o.options,r=n.children(".keditor-component-content");r.prop("contenteditable",!0),r.on("input",function(i){"function"==typeof a.onComponentChanged&&a.onComponentChanged.call(t,i,n),"function"==typeof a.onContainerChanged&&a.onContainerChanged.call(t,i,e),"function"==typeof a.onContentChanged&&a.onContentChanged.call(t,i)});var d=r.ckeditor(a.ckeditorOptions).editor;d.on("instanceReady",function(){i("CKEditor is ready",n),"function"==typeof a.onComponentReady&&a.onComponentReady.call(t,n,d)})},getContent:function(t,e){i('getContent "jumbotron" component',t);var n=t.find(".keditor-component-content"),o=n.attr("id"),a=CKEDITOR.instances[o];return a?a.getData():n.html()},initSettingForm:function(e,o){return i('init "jumbotron" settings',e),t.ajax({url:"/theme/apps/keditor-lib/componentJumbotronSettings.html",type:"get",dataType:"HTML",success:function(i){e.html(i),e.find(".chk-inverse").on("click",function(){var t=o.getSettingComponent();t.find(".jumbotron")[this.checked?"addClass":"removeClass"]("jumbotron-inverse")});var a=e.find(".button-color-picker");n.initSimpleColorPicker(a,function(t){var e=o.getSettingComponent();e.find(".jumbotron").css("background-color",t),e.attr("data-bgcolor",t)});var r=e.find(".paddingSettings");r.on("change",function(){var e=this.value||"",n=o.getSettingComponent(),i=t(this).attr("name");""===e.trim()?n.find(".jumbotron").css(i,""):(isNaN(e)&&(e=0,this.value=e),n.find(".jumbotron").css(i,e+"px"))});var d=e.find(".marginSettings");d.on("change",function(){var e=this.value||"",n=o.getSettingComponent(),i=t(this).attr("name");""===e.trim()?n.find(".jumbotron").css(i,""):(isNaN(e)&&(e=0,this.value=e),n.find(".jumbotron").css(i,e+"px"))})}})},showSettingForm:function(e,n,o){i('showSettingForm "jumbotron" component',n),e.find("[name=button-color]").val(n.attr("data-bgcolor")).trigger("update"),e.find(".paddingSettings").each(function(){t(this).val(n.find(".jumbotron").css(t(this).attr("name")).replace("px",""))}),e.find(".marginSettings").each(function(){t(this).val(n.find(".jumbotron").css(t(this).attr("name")).replace("px",""))}),e.find("[name=showButton][value=false]").prop("checked",n.find("a").hasClass("hide")),e.find(".chk-inverse").prop("checked",n.find(".jumbotron").hasClass("jumbotron-inverse"))},destroy:function(t,e){i('destroy "text" component',t);var n=t.find(".keditor-component-content").attr("id"),o=CKEDITOR.instances[n];o&&o.destroy()}}}(jQuery),function(t){var e=t.keditor,n=e.log;e.components.ksvgmap={init:function(e,i,o,a){var r=o.find("script");r.length&&r.remove(),o.attr("data-height")&&o.find(".ksvgmap").css("height",+o.attr("data-height")),t.getScriptOnce("/static/jquery-jvectormap/jquery-jvectormap-2.0.3.min.js",function(){t.getScriptOnce("/static/jquery-jvectormap/jquery-jvectormap-au-mill.js",function(){o.find(".ksvgmap").vectorMap({map:"au_mill",backgroundColor:"#fff",zoomButtons:!1,focusOn:{x:.5,y:.5,scale:1},regionStyle:{initial:{fill:"#efefef"},hover:{fill:"#00aa90"}},onRegionTipShow:function(t,e,n){o.attr("data-"+n)&&e.html(e.html()+" - "+o.attr("data-"+n))}});var t=setInterval(function(){try{var e=o.find(".ksvgmap").vectorMap("get","mapObject");e.updateSize(),clearInterval(t)}catch(i){n("trying to get jvectormap object")}},50)})})},getContent:function(e,i){n('getContent "svgmap" component',e);var o=e.children(".keditor-component-content"),a='<script>$(function(){$(document.body).hasClass("content-editor-page")||$.getScriptOnce("/static/jquery-jvectormap/jquery-jvectormap-2.0.3.min.js",function(){$.getScriptOnce("/static/jquery-jvectormap/jquery-jvectormap-au-mill.js",function(){$(".ksvgmap").each(function(){var a=$(this).parents("[data-type=component-ksvgmap]");a.hasClass("ksvgInit")||(a.addClass("ksvgInit"),$(this).vectorMap({map:"au_mill",backgroundColor:"#fff",zoomButtons:!1,scale:5,regionStyle:{initial:{fill:"#efefef"},hover:{fill:"#00aa90"}},onRegionTipShow:function(b,c,d){a.attr("data-"+d)&&c.html("<span class=\'vectormap-tip-region-name\'>"+c.html()+"</span><span class=\'vectormap-tip-separator\'> - </span><span class=\'vectormap-tip-region-data\'>"+a.attr("data-"+d)+"</span>")}}))})})})});</script>',r='<link rel="stylesheet" href="/static/jquery-jvectormap/jquery-jvectormap-2.0.3.css">';e.find(".jvectormap-container").remove();
var d=t(document.body).find('[data-type="component-ksvgmap"]:not(.keditor-snippet)');return d.length>0&&t(d[d.length-1]).attr("id")===e.attr("id")&&(t(r).insertBefore(e.find(".ksvgmap")),t(a).insertAfter(e.find(".ksvgmap"))),o.html()},settingEnabled:!0,settingTitle:"SVGMap Settings",initSettingForm:function(e,i){return n('init "svgmap" settings',e),t.ajax({url:"/theme/apps/keditor-lib/componentKsvgMapSettings.html",type:"get",dataType:"HTML",success:function(t){e.html(t);var n=i.getSettingComponent();e.find(".state").on("change",function(t){var i=n.attr("data-"+this.value);e.find(".stateMessage").val(i)}),e.find(".stateMessage").on("change",function(t){var i=e.find(".state").val();n.attr("data-"+i,this.value)}),e.find(".height").on("change",function(t){n.attr("data-height",this.value),n.find(".ksvgmap").css("height",this.value);var e=n.find(".ksvgmap").vectorMap("get","mapObject");e.updateSize()})}})},showSettingForm:function(t,e,n){var i=e.attr("data-height"),o=t.find(".state").val();t.find(".height").val(i),t.find(".stateMessage").val(e.attr("data-"+o))}}}(jQuery),function(t){var e=t.keditor,n=t.contentEditor,i=e.log;e.components.media={init:function(t,e,n,o){i('init "media" component',n);var a=o.options,r=n.children(".keditor-component-content"),d=r.find(".media-body");d.addClass("clearfix");var s=r.find(".media-left"),c=r.find(".media-left-inner");0===c.length&&s.html('<div class="media-left-inner">'+s.html()+"</div>"),d.attr("id")||d.attr("id",o.generateId("component-text-content-inner")),d.prop("contenteditable",!0),d.on("input",function(i){"function"==typeof a.onComponentChanged&&a.onComponentChanged.call(t,i,n),"function"==typeof a.onContainerChanged&&a.onContainerChanged.call(t,i,e),"function"==typeof a.onContentChanged&&a.onContentChanged.call(t,i)});var l=d.ckeditor(a.ckeditorOptions).editor;l.on("instanceReady",function(){i("CKEditor is ready",n),"function"==typeof a.onComponentReady&&a.onComponentReady.call(t,n,l)})},getContent:function(t,e){i('getContent "media" component',t);var n=t.find(".keditor-component-content"),o=n.find(".media-body"),a=o.attr("id"),r=CKEDITOR.instances[a];return r&&o.replaceWith('<div class="media-body clearfix">'+r.getData()+"</div>"),n.html()},destroy:function(t,e){i('destroy "text" component',t);var n=t.find(".media-body").attr("id"),o=CKEDITOR.instances[n];o&&o.destroy()},settingEnabled:!0,settingTitle:"Media Settings",initSettingForm:function(e,o){return i('initSettingForm "media" component'),t.ajax({url:"/theme/apps/keditor-lib/componentMediaSettings.html",type:"get",dataType:"HTML",success:function(t){e.html(t);var i=e.find(".photo-link");i.on("change",function(){var t=this.value.trim();o.getSettingComponent().find("a").attr("href",t)});var a=e.find(".photo-target");a.on("change",function(){o.getSettingComponent().find("a").attr("target",this.value)});var r=e.find(".photo-linkable");r.on("click",function(){var t=o.getSettingComponent().find("img.media-object");r.is(":checked")?(i.prop("disabled",!1),a.prop("disabled",!1),t.wrap('<a href=""></a>')):(i.prop("disabled",!0),a.prop("disabled",!0),t.unwrap("a"))}),e.find(".photo-v-align").on("change",function(){var t=o.getSettingComponent().find(".media-left");t.css("vertical-align",this.value)}),e.find(".photo-responsive").on("click",function(){o.getSettingComponent().find("img")[this.checked?"addClass":"removeClass"]("img-responsive")}),e.find(".photo-style").on("change",function(){var t=o.getSettingComponent().find("img.media-object"),e=this.value;t.removeClass("img-rounded img-circle img-thumbnail"),e&&t.addClass(e)}),e.find(".photo-width").on("change",function(){var t=o.getSettingComponent().find("img.media-object");t.attr("width",this.value)}),n.initMselectImage(e.find(".photo-edit"),o,function(t,e,n,i){var a=o.getSettingComponent().find("img.media-object");a.attr("src","/_hashes/files/"+i)}),e.find(".left-width").on("change",function(){var t=o.getSettingComponent().find(".media-left-inner");t.css("width",this.value)})}})},showSettingForm:function(t,e,n){i('showSettingForm "media" component',e);var o=t.find(".photo-v-align"),a=t.find(".photo-responsive"),r=t.find(".photo-width"),d=t.find(".photo-style"),s=t.find(".photo-link"),c=t.find(".photo-target"),l=t.find(".photo-linkable"),p=e.find("img.media-object"),m=e.find(".media-left"),f=e.find(".media-left-inner");t.find(".left-width").val((f.get(0).style.width||"").replace("px",""));var g=p.parent("a");g.length>0?(l.prop("checked",!0),s.prop("disabled",!1).val(g.attr("href")),c.prop("disabled",!1).val(g.attr("target"))):(l.prop("checked",!1),s.prop("disabled",!0).val(""),c.prop("disabled",!0).val(""));var h=m.css("vertical-align")||"top";p.hasClass("img-rounded")?d.val("img-rounded"):p.hasClass("img-circle")?d.val("img-circle"):p.hasClass("img-thumbnail")?d.val("img-thumbnail"):d.val(""),o.val(h),a.prop("checked",p.hasClass("img-responsive")),r.val(p.attr("width"))}}}(jQuery),function(t){var e=t.keditor,n=e.log;e.components.photo={init:function(t,e,i,o){n('init "photo" component',i);var a=i.children(".keditor-component-content"),r=a.find("img");r.css("display","inline-block"),r.css("vertical-align")||r.css("vertical-align","middle"),r.attr({width:r.width(),height:r.height()}).css({width:"",height:""});var d=o.options;"function"==typeof d.onComponentReady&&d.onComponentReady.call(t,i)},settingEnabled:!0,settingTitle:"Photo Settings",initSettingForm:function(e,i){n('init "photo" settings',e,i);var o=this;return t.ajax({url:"/theme/apps/keditor-lib/componentPhotoSettings.html",type:"get",dataType:"HTML",success:function(n){e.html(n);var a=e.find("#photo-link");a.on("change",function(){var t=this.value.trim();i.getSettingComponent().find("a").attr("href",t)});var r=e.find("#photo-target");r.on("change",function(){i.getSettingComponent().find("a").attr("target",this.value)});var d=e.find("#photo-linkable");d.on("click",function(){var t=i.getSettingComponent().find("img");d.is(":checked")?(a.prop("disabled",!1),r.prop("disabled",!1),t.wrap('<a href=""></a>')):(a.prop("disabled",!0),r.prop("disabled",!0),t.unwrap("a"))});var s=e.find("#photo-align");s.on("change",function(){var t=i.getSettingComponent().find(".photo-panel");t.css("text-align",this.value)});var c=e.find("#v-align");c.on("change",function(){var t=i.getSettingComponent().find(".photo-panel").find("img");t.css("vertical-align",this.value)});var l=e.find("#photo-responsive");l.on("click",function(){i.getSettingComponent().find("img")[this.checked?"addClass":"removeClass"]("img-responsive")});var p=e.find("#photo-style");p.on("change",function(){var t=i.getSettingComponent().find("img"),e=this.value;t.removeClass("img-rounded img-circle img-thumbnail"),e&&t.addClass(e)});var m=e.find("#photo-width"),f=e.find("#photo-height");m.on("change",function(){var t=i.getSettingComponent().find("img"),e=+this.value,n=Math.round(e/o.ratio);e<=0&&(e=o.width,n=o.height,this.value=e),t.attr({width:e,height:n}),f.val(n)}),f.on("change",function(){var t=i.getSettingComponent().find("img"),e=+this.value,n=Math.round(e*o.ratio);e<=0&&(n=o.width,e=o.height,this.value=e),t.attr({height:e,width:n}),m.val(n)});var g=e.find("#photo-edit");g.mselect({contentTypes:["image"],bs3Modal:!0,pagePath:i.options.pagePath,basePath:i.options.basePath,onSelectFile:function(e,n,a,r){var d=i.getSettingComponent().find("img"),s="/_hashes/files/"+r;t("<img />").attr("src",s).load(function(){d.attr({width:this.width,height:this.height,src:s}),o.ratio=this.width/this.height,o.width=this.width,o.height=this.height,m.val(this.width),f.val(this.height)})}})}})},showSettingForm:function(e,i,o){n('showSettingForm "photo" component',i);var a=this,r=e.find("#photo-align"),d=e.find("#v-align"),s=e.find("#photo-responsive"),c=e.find("#photo-width"),l=e.find("#photo-height"),p=e.find("#photo-style"),m=e.find("#photo-link"),f=e.find("#photo-target"),g=e.find("#photo-linkable"),h=i.find(".photo-panel"),u=h.find("img"),v=u.parent("a");v.length>0?(g.prop("checked",!0),m.prop("disabled",!1).val(v.attr("href")),f.prop("disabled",!1).val(v.attr("target"))):(g.prop("checked",!1),m.prop("disabled",!0).val(""),f.prop("disabled",!0).val(""));var b=h.css("text-align");"right"===b&&"center"===b||(b="left");var y=u.css("vertical-align");u.hasClass("img-rounded")?p.val("img-rounded"):u.hasClass("img-circle")?p.val("img-circle"):u.hasClass("img-thumbnail")?p.val("img-thumbnail"):p.val(""),r.val(b),d.val(y),s.prop("checked",u.hasClass("img-responsive")),c.val(u.width()),l.val(u.height()),t("<img />").attr("src",u.attr("src")).load(function(){a.ratio=this.width/this.height,a.width=this.width,a.height=this.height})}}}(jQuery),function(t){var e=t.keditor,n=t.contentEditor,i=e.log;CKEDITOR.disableAutoInline=!0,CKEDITOR.dtd.$removeEmpty.i=!1,e.components.text={init:function(e,n,o,a){i('init "text" component',o);var r=a.options,d=o.find(".keditor-component-content"),s=d.find(".keditor-component-text-content-inner");if(0===s.length){var c=d.html();s=t('<div class="keditor-component-text-content-inner clearfix"></div>'),d.html(s),s.html(c),s.wrap('<div class="keditor-component-text-content"></div>')}s.attr("id")||s.attr("id",a.generateId("component-text-content-inner")),s.prop("contenteditable",!0),s.on("input",function(t){"function"==typeof r.onComponentChanged&&r.onComponentChanged.call(e,t,o),"function"==typeof r.onContainerChanged&&r.onContainerChanged.call(e,t,n),"function"==typeof r.onContentChanged&&r.onContentChanged.call(e,t)});var l=s.ckeditor(r.ckeditorOptions).editor;l.on("instanceReady",function(){i("CKEditor is ready",o),"function"==typeof r.onComponentReady&&r.onComponentReady.call(e,o,l)})},getContent:function(t,e){i('getContent "text" component',t);var n=t.find(".keditor-component-content"),o=n.find(".keditor-component-text-content"),a=o.children().attr("id"),r=CKEDITOR.instances[a];return r&&o.html('<div class="keditor-component-text-content-inner clearfix">'+r.getData()+"</div>"),n.html()},destroy:function(t,e){i('destroy "text" component',t);var n=t.find(".keditor-component-content").attr("id"),o=CKEDITOR.instances[n];o&&o.destroy()},settingEnabled:!0,settingTitle:"Text Settings",initSettingForm:function(e,o){return i('initSettingForm "text" component'),t.ajax({url:"/theme/apps/keditor-lib/componentTextSettings.html",type:"get",dataType:"HTML",success:function(i){e.html(i),e.find(".background-image-edit").mselect({contentTypes:["image"],bs3Modal:!0,pagePath:o.options.pagePath,basePath:o.options.basePath,onSelectFile:function(t,n,i,a){var r=o.getSettingComponent().find(".keditor-component-text-content"),d="http://"+window.location.host+"/_hashes/files/"+a;r.css("background-image",'url("'+d+'")'),e.find(".background-image-previewer").attr("src",d)}}),e.find(".background-image-delete").on("click",function(t){t.preventDefault();var n=o.getSettingComponent().find(".keditor-component-text-content");n.css("background-image",""),e.find(".background-image-previewer").attr("src","/static/images/photo_holder.png")});var a=e.find(".txt-bg-color");n.initSimpleColorPicker(a,function(t){target.css("background-color",t)}),e.find(".select-bg-repeat").on("change",function(){var t=o.getSettingComponent().find(".keditor-component-text-content");t.css("background-repeat",this.value)}),e.find(".select-bg-size").on("change",function(){var t=o.getSettingComponent().find(".keditor-component-text-content");t.css("background-size",this.value)}),e.find(".select-bg-position").on("change",function(){var t=o.getSettingComponent().find(".keditor-component-text-content");t.css("background-position",this.value)}),e.find(".txt-padding").each(function(){var e=t(this),n=e.attr("data-style-name");e.on("change",function(){var t=this.value||"",e=o.getSettingComponent().find(".keditor-component-text-content").get(0);""===t.trim()?e.style[n]="":(isNaN(t)&&(t=0,this.value=t),e.style[n]=t+"px")})}),e.find(".txt-margin").each(function(){var e=t(this),n=e.attr("data-style-name");e.on("change",function(){var t=this.value||"",e=o.getSettingComponent().find(".keditor-component-text-content").get(0);""===t.trim()?e.style[n]="":(isNaN(t)&&(t=0,this.value=t),e.style[n]=t+"px")})}),e.find(".txt-height").on("change",function(){var t=this.value||"";isNaN(t)&&(t="");var e=o.getSettingComponent().find(".keditor-component-text-content");e.css("height",t)}),e.find(".txt-min-height").on("change",function(){var t=this.value||"";isNaN(t)&&(t="");var e=o.getSettingComponent().find(".keditor-component-text-content");e.css("min-height",t+"px")}),e.find(".txt-max-height").on("change",function(){var t=this.value||"";isNaN(t)&&(t="");var e=o.getSettingComponent().find(".keditor-component-text-content");e.css("max-height",t+"px")}),e.find(".txt-width").on("change",function(){var t=this.value||"";isNaN(t)&&(t="");var e=o.getSettingComponent().find(".keditor-component-text-content");e.css("width",t)}),e.find(".txt-min-width").on("change",function(){var t=this.value||"";isNaN(t)&&(t="");var e=o.getSettingComponent().find(".keditor-component-text-content");e.css("min-width",t+"px")}),e.find(".txt-max-width").on("change",function(){var t=this.value||"";isNaN(t)&&(t="");var e=o.getSettingComponent().find(".keditor-component-text-content");e.css("max-width",t+"px")})}})},showSettingForm:function(e,n,o){i('showSettingForm "text" component',n);var a=n.find(".keditor-component-text-content").get(0),r=a.style.backgroundImage;r=(r||"").replace(/^url\(['"]+(.+)['"]+\)$/,"$1"),e.find(".background-image-previewer").attr("src","none"!==r&&""!==r?r:"/static/images/photo_holder.png"),e.find(".select-bg-repeat").val(a.style.backgroundRepeat||"repeat"),e.find(".select-bg-position").val(a.style.backgroundPosition||"0% 0%"),e.find(".select-bg-size").val(a.style.backgroundSize||"auto"),e.find(".txt-bg-color").val(a.style.backgroundColor||"").trigger("update"),e.find(".txt-padding").each(function(){var e=t(this),n=e.attr("data-style-name");e.val((a.style[n]||"").replace("px",""))}),e.find(".txt-margin").each(function(){var e=t(this),n=e.attr("data-style-name");e.val((a.style[n]||"").replace("px",""))}),e.find(".txt-height").val((a.style.height||"").replace("px","")),e.find(".txt-min-height").val((a.style.minHeight||"").replace("px","")),e.find(".txt-max-height").val((a.style.maxHeight||"").replace("px","")),e.find(".txt-width").val((a.style.width||"").replace("px","")),e.find(".txt-min-with").val((a.style.minWidth||"").replace("px","")),e.find(".txt-max-with").val((a.style.maxWidth||"").replace("px",""))}}}(jQuery),function(t){var e=t.keditor,n=t.contentEditor,i=e.log;e.components.thumbnail={init:function(t,e,n,o){i('init "thumbnail" component',n);var a=o.options,r=n.children(".keditor-component-content"),d=r.find(".caption");d.addClass("clearfix");var s=d.find(".caption-inner");0===s.length&&(d.html('<div class="caption-inner">'+d.html()+"</div>"),s=d.find(".caption-inner")),s.attr("id")||s.attr("id",o.generateId("component-text-content-inner")),s.prop("contenteditable",!0),s.on("input",function(i){"function"==typeof a.onComponentChanged&&a.onComponentChanged.call(t,i,n),"function"==typeof a.onContainerChanged&&a.onContainerChanged.call(t,i,e),"function"==typeof a.onContentChanged&&a.onContentChanged.call(t,i)});var c=s.ckeditor(a.ckeditorOptions).editor;c.on("instanceReady",function(){i("CKEditor is ready",n),"function"==typeof a.onComponentReady&&a.onComponentReady.call(t,n,c)})},getContent:function(t,e){i('getContent "thumbnail" component',t);var n=t.find(".keditor-component-content"),o=n.find(".caption"),a=o.find(".caption-inner"),r=a.attr("id"),d=CKEDITOR.instances[r];return d&&o.html(d.getData()),n.html()},destroy:function(t,e){i('destroy "text" component',t);var n=t.find(".caption-inner").attr("id"),o=CKEDITOR.instances[n];o&&o.destroy()},settingEnabled:!0,settingTitle:"Thumbnail Settings",initSettingForm:function(e,o){return i('initSettingForm "thumbnail" component'),t.ajax({url:"/theme/apps/keditor-lib/componentThumbnailSettings.html",type:"get",dataType:"HTML",success:function(t){e.html(t),n.initMselectImage(e.find(".photo-edit"),o,function(t,e,n,i){var a=o.getSettingComponent().find(".thumbnail img");a.attr("src","/_hashes/files/"+i)})}})},showSettingForm:function(t,e,n){i('showSettingForm "thumbnail" component',e)}}}(jQuery),function(t){var e=t.keditor,n=e.log;e.components.video={init:function(e,i,o,a){n('init "video" component',o);var r=this,d=o.find("img[data-video-src]");d.attr("id",a.generateId("component-video"));var s=d.parent();s.hasClass("video-wrapper")||(d.wrap('<div class="video-wrapper"></div>'),s=d.parent()),s.attr("data-id",d.attr("id")),s.attr("data-autostart",d.attr("data-autostart")),s.attr("data-aspectratio",d.attr("data-aspectratio")),s.attr("data-video-src",d.attr("data-video-src")),s.attr("data-repeat",d.attr("data-repeat")),s.attr("data-controls",d.attr("data-controls")),t.getScriptOnce("/static/jwplayer/6.10/jwplayer.js",function(){jwplayer.key="cXefLoB9RQlBo/XvVncatU90OaeJMXMOY/lamKrzOi0=",r.buildJWVideoPlayerPreview(o)})},getContent:function(t){n('getContent "video" component, component');var e=t.find(".video-wrapper"),i='<img class="video-jw" ';return i+='       id="'+this.componentId+'" ',i+='       src="'+e.attr("data-video-src")+'/alt-640-360.png" ',i+='       data-autostart="'+e.attr("data-autostart")+'" ',i+='       data-aspectratio="'+e.attr("data-aspectratio")+'" ',i+='       data-video-src="'+e.attr("data-video-src")+'" ',i+='       data-repeat="'+e.attr("data-repeat")+'" ',i+='       data-controls="'+e.attr("data-controls")+'" />',e.html(i),t.find(".keditor-component-content").html()},settingEnabled:!0,settingTitle:"Video Settings",initSettingForm:function(e,i){n('init "video" settings',e);var o=this;return t.ajax({url:"/theme/apps/keditor-lib/componentVideoSettings.html",type:"get",dataType:"HTML",success:function(n){e.html(n);var a=e.find(".select-border-style");a.on("change",function(){o.borderStyle=this.value,i.getSettingComponent().find(".video-wrapper").css("border-style",this.value)});var r=e.find(".border-width");r.on("change",function(){var t=this.value;(isNaN(t)||t<0)&&(t=1,this.value=t),o.borderWidth=t,i.getSettingComponent().find(".video-wrapper").css("border-width",t)});var d=e.find(".borderColor");t.contentEditor.initColorPicker(d,function(t){o.borderColor=t,i.getSettingComponent().find(".video-wrapper").css("border-color",t)}),e.find(".chk-border").on("click",function(){a.prop("disabled",!this.checked),r.prop("disabled",!this.checked),d.prop("disabled",!this.checked),this.checked||(i.getSettingComponent().find(".video-wrapper").css("border",""),a.val(""),r.val(""),d.val(""))});var s=e.find(".btn-videoFileInput");s.mselect({contentTypes:["video"],bs3Modal:!0,pagePath:i.options.pagePath,basePath:i.options.basePath,onSelectFile:function(t){i.getSettingComponent().find(".video-wrapper").attr("data-video-src",t),o.refreshVideoPlayerPreview(i)}});var c=e.find("#video-autoplay");c.on("click",function(){i.getSettingComponent().find(".video-wrapper").attr("data-autostart",this.checked),o.buildJWVideoPlayerPreview(i)});var l=e.find("#video-loop");l.on("click",function(){i.getSettingComponent().find(".video-wrapper").attr("data-repeat",this.checked),o.buildJWVideoPlayerPreview(i)});var p=e.find(".video-ratio");p.on("click",function(t){this.checked&&(i.getSettingComponent().find(".video-wrapper").attr("data-aspectratio",this.value),o.buildJWVideoPlayerPreview(i))});var m=e.find("#video-showcontrols");m.on("click",function(t){i.getSettingComponent().find(".video-wrapper").attr("data-controls",this.checked),o.buildJWVideoPlayerPreview(i)})}})},showSettingForm:function(t,e,i){n('showSettingForm "video" component',t,e);var o=e.find(".video-wrapper"),a=o.css("border-width")||"",r="0px"!==a,d=t.find(".chk-border"),s=t.find(".border-width"),c=t.find(".color-picker"),l=t.find(".select-border-style");d.prop("checked",r),l.prop("disabled",!r).val(o.css("border-style")),s.prop("disabled",!r).val(r?a.replace("px",""):""),c.colorpicker(r?"enable":"disable").colorpicker("setValue",r?o.css("border-color"):""),t.find("#video-autoplay").prop("checked","true"===o.attr("data-autostart")),t.find("#video-loop").prop("checked","true"===o.attr("data-repeat")),t.find(".video-ratio").filter('[value="'+o.attr("data-aspectratio")+'"]').prop("checked",!0),t.find("#video-showcontrols").prop("checked","true"===o.attr("data-controls"))},buildJWVideoPlayerPreview:function(t){t.jquery||(t=t.getSettingComponent());var e=t.find(".video-wrapper"),i=e.attr("data-video-src"),o=e.attr("data-autostart"),a=e.attr("data-repeat"),r=e.attr("data-aspectratio"),d=e.attr("data-controls"),s=jwplayer(e.attr("data-id")),c=i+"/alt-640-360.png";n("buildJWPlayer",i,"aspectratio=",r),s.setup({autostart:o,repeat:a,controls:d,aspectratio:r,flashplayer:"/static/jwplayer/6.10/jwplayer.flash.swf",html5player:"/static/jwplayer/6.10/jwplayer.html5.js",width:"100%",androidhls:!0,playlist:[{image:c,sources:[{file:i},{file:i+"/../alt-640-360.webm"},{file:i+"/../alt-640-360.m4v"}]}],primary:"flash"}),s.onReady(function(){n("jwplayer preview init done")})},refreshVideoPlayerPreview:function(t){var e=t.getSettingComponent().find(".video-wrapper"),n=jwplayer(e.attr("data-id")),i=e.attr("data-video-src");n.load([{file:i}]),n.play()}}}(jQuery),function(t){var e=t.keditor,n=e.log;e.components.vimeo={getContent:function(t,e){n('getContent "vimeo" component',t);var i=t.children(".keditor-component-content");return i.find(".vimeo-cover").remove(),i.html()},settingEnabled:!0,settingTitle:"Vimeo Settings",initSettingForm:function(e,i){return n('init "vimeo" settings',e),t.ajax({url:"/theme/apps/keditor-lib/componentVimeoSettings.html",type:"get",dataType:"HTML",success:function(t){e.html(t);var o=e.find(".btn-vimeo-edit");o.on("click",function(t){t.preventDefault();var e=prompt("Please enter Vimeo URL in here:"),n=/https?:\/\/(?:www\.|player\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|album\/(\d+)\/video\/|video\/|)(\d+)(?:$|\/|\?)/,o=e.match(n);o&&o[1]?i.getSettingComponent().find(".embed-responsive-item").attr("src","https://player.vimeo.com/video/"+o[1]+"?byline=0&portrait=0&badge=0"):alert("Your Vimeo URL is invalid!")});var a=e.find(".btn-vimeo-169");a.on("click",function(t){t.preventDefault(),i.getSettingComponent().find(".embed-responsive").removeClass("embed-responsive-4by3").addClass("embed-responsive-16by9")});var r=e.find(".btn-vimeo-43");r.on("click",function(t){t.preventDefault(),i.getSettingComponent().find(".embed-responsive").removeClass("embed-responsive-16by9").addClass("embed-responsive-4by3")});var d=e.find("#vimeo-autoplay");d.on("click",function(){var t=i.getSettingComponent().find(".embed-responsive-item"),e=t.attr("src"),o=e.replace(/(\?.+)+/,"")+"?byline=0&portrait=0&badge=0&autoplay="+(d.is(":checked")?1:0);n("Current url: "+e,"New url: "+o),t.attr("src",o)})}})},showSettingForm:function(t,e,i){n('showSettingForm "vimeo" component',e);var o=e.find(".embed-responsive-item"),a=t.find("#vimeo-autoplay"),r=o.attr("src");a.prop("checked",r.indexOf("autoplay=1")!==-1)}}}(jQuery),function(t){var e=t.keditor,n=e.log;e.components.youtube={getContent:function(t,e){n('getContent "youtube" component',t);var i=t.children(".keditor-component-content");return i.find(".youtube-cover").remove(),i.html()},settingEnabled:!0,settingTitle:"Youtube Settings",initSettingForm:function(e,i){return n('init "youtube" settings',e),t.ajax({url:"/theme/apps/keditor-lib/componentYoutubeSettings.html",type:"get",dataType:"HTML",success:function(t){e.html(t);var o=e.find(".btn-youtube-edit");o.on("click",function(t){t.preventDefault();var e=prompt("Please enter Youtube URL in here:"),n=/^(?:http(?:s)?:\/\/)?(?:www\.)?(?:m\.)?(?:youtu\.be\/|youtube\.com\/(?:(?:watch)?\?(?:.*&)?v(?:i)?=|(?:embed|v|vi|user)\/))([^\?&\"'>]+)/,o=e.match(n);o&&o[1]?i.getSettingComponent().find(".embed-responsive-item").attr("src","https://www.youtube.com/embed/"+o[1]):alert("Your Youtube URL is invalid!")});var a=e.find(".btn-youtube-169");a.on("click",function(t){t.preventDefault(),i.getSettingComponent().find(".embed-responsive").removeClass("embed-responsive-4by3").addClass("embed-responsive-16by9")});var r=e.find(".btn-youtube-43");r.on("click",function(t){t.preventDefault(),i.getSettingComponent().find(".embed-responsive").removeClass("embed-responsive-16by9").addClass("embed-responsive-4by3")});var d=e.find("#youtube-autoplay");d.on("click",function(){var t=i.getSettingComponent().find(".embed-responsive-item"),e=t.attr("src"),o=e.replace(/(\?.+)+/,"")+"?autoplay="+(d.is(":checked")?1:0);n("Current url: "+e,"New url: "+o),t.attr("src",o)})}})},showSettingForm:function(t,e,i){n('showSettingForm "youtube" component',e);var o=e.find(".embed-responsive-item"),a=t.find("#youtube-autoplay"),r=o.attr("src");a.prop("checked",r.indexOf("autoplay=1")!==-1)}}}(jQuery);
//# sourceMappingURL=keditor-components-0.0.0.min.js.map
