{"version":3,"sources":["keditor-components-0.0.0.js"],"names":["$","KEditor","keditor","flog","log","components","settingEnabled","settingTitle","init","contentArea","container","component","options","id","generateId","componentContent","children","find","attr","panels","each","index","item","p","itemId","panelCollapseId","length","headingText","headingIcon","text","trim","html","append","collapse","removeClass","prop","on","e","onComponentChanged","call","onContainerChanged","onContentChanged","editor","ckeditor","ckeditorOptions","onComponentReady","document","off","preventDefault","confirm","panelsCount","this","parents","remove","Msg","error","clone","first","getContent","h","replaceWith","panelTitle","panelCollapse","addClass","removeAttr","css","destroy","CKEDITOR","instances","initSettingForm","form","ajax","url","type","dataType","success","resp","comp","getSettingComponent","checked","old","value","getStyleOnce","getScriptOnce","iconpicker","iconset","cols","rows","placement","icon","className","showSettingForm","dataAttributes","getDataAttributes","val","iconCollapsed","end","iconExpanded","jQuery","img","componentId","parent","hasClass","wrap","src","width","autostart","instance","jwplayer","key","buildJWAudioPlayerPreview","btnAudioFileInput","mselect","contentTypes","bs3Modal","pagePath","basePath","onSelectFile","refreshAudioPlayerPreview","autoplayToggle","audioWidth","resizeAudioPlayerPreview","playerInstance","setup","file","height","flashplayer","html5player","primary","onReady","load","play","resize","carousel","self","images","push","hash","i","image","addItemToCarousel","eq","editingItemId","carouselAddImage","carouselItemsWrap","initMSelectImage","relUrl","addItemToList","caption","refreshCarousel","sortable","handle","items","axis","tolerance","sort","update","editorContent","initModalContent","modalContent","editorCaption","initModalCaption","modalCaption","modal","btn","closest","siblings","carouselItem","txtCarouselContent","setData","trigger","txtCarouselCaption","isNaN","appendTo","body","contentOptions","extend","removePlugins","replace","extraPlugins","carouselContent","getData","content","captionOptions","toolbarGroups","toolbarSets","carouselCaption","carouselImg","slice","isWrap","pause","interval","iconPrev","iconNext","data","carouselInner","cls","backgroundUrl","backgroundSize","itemStr","editCaption","Date","getTime","txtContent","txtCaption","initFormBuilder","formBuilderArea","formData","formContent","prepend","btnEditForm","btnPreviewForm","formBuilder","disableInjectedStyle","showActionButtons","disableFields","disabledAttrs","typeUserDisabledAttrs","checkbox-group","show","hide","renderForm","formRender","actions","div","dataGrid","split","label","input","subDiv","layout","window","callWhenGoogleMapReady","initKGoogleMap","initAutocomplete","mapTypes","filter","iframe","kgooglemap","makeGoogleMapFresh","alert","callback","apiKey","google","maps","places","setTimeout","event","keyCode","map","maptype","place","ratio","mapDiv","Map","zoom","mapTypeId","searchBox","SearchBox","addListener","setBounds","getBounds","markers","getPlaces","forEach","marker","setMap","bounds","LatLngBounds","geometry","console","size","Size","origin","Point","anchor","scaledSize","Marker","title","name","position","location","viewport","union","fitBounds","contentEditor","buttonColorPicker","initSimpleColorPicker","color","paddingSettings","paddingValue","paddingProp","marginSettings","script","vectorMap","backgroundColor","zoomButtons","focusOn","x","y","scale","regionStyle","initial","fill","hover","onRegionTipShow","el","code","setInterval","updateSize","clearInterval","arr","insertBefore","insertAfter","currentState","defaultState","mediaBody","mediaLeft","mediaLeftInner","txtLink","link","cbbTarget","chkLinkable","is","unwrap","relativeUrl","fileType","inputVAlign","inputResponsive","inputWidth","cbbStyle","get","style","a","valign","imgWidth","imgHeight","inputAlign","panel","inputHeight","newWidth","newHeight","Math","round","txtAltText","align","disableAutoInline","dtd","$removeEmpty","ckeditorPlace","contentHtml","componentTextContent","target","imageUrl","host","colorPicker","initColorPicker","textColorPicker","txt","styleName","marginValue","minHeight","maxHeight","minWidth","maxWidth","backgroundImage","backgroundRepeat","backgroundPosition","colorpicker","captionInner","wrapper","buildJWVideoPlayerPreview","selectPicker","borderStyle","txtBorderWidth","borderWidth","borderColor","btnVideoFileInput","refreshVideoPlayerPreview","loopToggle","showcontrolsToggle","isBorderEnabled","chkBorder","jquery","repeat","aspectratio","controls","posterHref","androidhls","playlist","sources","btnEdit","inputData","prompt","vimeoRegex","match","btn169","btn43","chkAutoplay","embedItem","currentUrl","newUrl","indexOf","youtubeRegex"],"mappings":"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","file":"keditor-components-0.0.0.min.js","sourcesContent":["(function ($) {\r\n    var KEditor = $.keditor;\r\n    var flog = KEditor.log;\r\n\r\n    KEditor.components['accordion'] = {\r\n        settingEnabled: true,\r\n        settingTitle: 'Accordion Settings',\r\n\r\n        init: function (contentArea, container, component, keditor) {\r\n            var options = keditor.options;\r\n            var id = keditor.generateId('accordion');\r\n            var componentContent = component.children('.keditor-component-content');\r\n            componentContent.find('.accordionWrap .panel-group').attr('id', id);\r\n            componentContent.find('.accordionWrap a[data-toggle]').attr('data-parent', '#' + id);\r\n\r\n\r\n            var panels = componentContent.find('.panel');\r\n            panels.each(function (index, item) {\r\n                var p = $(item);\r\n                var itemId = keditor.generateId('heading' + index);\r\n                var panelCollapseId = keditor.generateId('collapse' + index);\r\n                p.find('.panel-heading').attr('id', itemId);\r\n                p.find('.panel-collapse').attr('aria-labelledby', itemId).attr('id', panelCollapseId);\r\n                p.find('a[data-toggle]').attr('href', '#' + panelCollapseId).attr('aria-controls', '#' + panelCollapseId);\r\n\r\n                // backward compatibility\r\n                if (!p.find('a[data-toggle]').find('.accHeadingText').length){\r\n                    var headingText = $('<div class=\"accHeadingText\" style=\"display: inline-block; width: 90%\"></div>');\r\n                    var headingIcon = $('<div style=\"display: inline-block; width: 5%; float: right; text-align: right\"><i class=\"fa fa-angle-double-down panelIconCollapsed\"></i><i class=\"fa panelIconExpanded fa-angle-double-up\"></i></div>')\r\n                    var text = p.find('a[data-toggle]').text().trim();\r\n                    headingText.text(text);\r\n                    p.find('a[data-toggle]').html('').append(headingText).append(headingIcon);\r\n                }\r\n            });\r\n\r\n            componentContent.find('.accordionWrap .panel-collapse').collapse('show');\r\n            componentContent.find('.panel-footer, .btnAddAccordionItem').removeClass('hide');\r\n            componentContent.find('.panel-title a .accHeadingText').prop('contenteditable', true);\r\n            componentContent.find('.panel-collapse .panel-body').prop('contenteditable', true);\r\n\r\n            componentContent.find('.panel-title a .accHeadingText, .panel-collapse .panel-body').on('input', function (e) {\r\n                if (typeof options.onComponentChanged === 'function') {\r\n                    options.onComponentChanged.call(keditor, e, component, contentArea);\r\n                }\r\n                \r\n                if (typeof options.onContainerChanged === 'function') {\r\n                    options.onContainerChanged.call(keditor, e, container, contentArea);\r\n                }\r\n                \r\n                if (typeof options.onContentChanged === 'function') {\r\n                    options.onContentChanged.call(keditor, e, contentArea);\r\n                }\r\n            });\r\n\r\n            var editor = componentContent.find('.panel-title a .accHeadingText, .panel-collapse .panel-body').ckeditor(options.ckeditorOptions).editor;\r\n            editor.on('instanceReady', function () {\r\n                flog('CKEditor is ready', component);\r\n\r\n                if (typeof options.onComponentReady === 'function') {\r\n                    options.onComponentReady.call(contentArea, component, editor);\r\n                }\r\n            });\r\n\r\n            $(document).off('click', '.btnDeleteAccordionItem').on('click', '.btnDeleteAccordionItem', function (e) {\r\n                e.preventDefault();\r\n\r\n                if (confirm('Are you sure you want to delete this item?')) {\r\n                    var panelsCount = componentContent.find('.panel').length;\r\n                    if (panelsCount > 1) {\r\n                        $(this).parents('.panel').remove();\r\n                    } else {\r\n                        Msg.error('You cant delete the last item');\r\n                    }\r\n                }\r\n            });\r\n\r\n            $(document).off('click', '.btnAddAccordionItem').on('click', '.btnAddAccordionItem', function (e) {\r\n                e.preventDefault();\r\n                var clone = componentContent.find('.panel').first().clone();\r\n                var itemId = keditor.generateId('heading');\r\n                var panelCollapseId = keditor.generateId('collapse');\r\n                clone.find('.panel-heading').attr('id', itemId);\r\n                clone.find('.panel-collapse').attr('aria-labelledby', itemId).attr('id', panelCollapseId);\r\n                clone.find('a[data-toggle]').attr('href', '#' + panelCollapseId);\r\n                componentContent.find('.accordionWrap .panel-group').append(clone);\r\n                var editor = clone.find('.panel-title a .accHeadingText, .panel-collapse .panel-body').ckeditor(options.ckeditorOptions).editor;\r\n                editor.on('instanceReady', function () {\r\n                    flog('CKEditor is ready', component);\r\n\r\n                    if (typeof options.onComponentReady === 'function') {\r\n                        options.onComponentReady.call(contentArea, component, editor);\r\n                    }\r\n                });\r\n            });\r\n        },\r\n\r\n        getContent: function (component, keditor) {\r\n            var componentContent = component.children('.keditor-component-content');\r\n            componentContent.find('.panel-collapse .panel-body').each(function () {\r\n                var h = $(this).html();\r\n                $(this).replaceWith('<div class=\"panel-body\">' + h + '</div>');\r\n            });\r\n            if (component.attr('data-initial-collapsed') == 'true'){\r\n                componentContent.find('.panel').each(function () {\r\n                    var panelTitle = $(this).find('.panel-heading a');\r\n                    var panelCollapse = $(this).find('.panel-collapse');\r\n                    panelCollapse.addClass('collapse').attr('aria-expanded', 'false').removeClass('in');\r\n                    panelTitle.addClass('collapsed').attr('aria-expanded', 'false');\r\n                });\r\n            }\r\n            componentContent.find('.panel-footer, .btnAddAccordionItem').addClass('hide');\r\n            componentContent.find('[contenteditable]').removeAttr('contenteditable');\r\n            componentContent.find('.accHeadingText').each(function () {\r\n               $(this).css('outline', 'none').text($(this).text());\r\n            });\r\n            return componentContent.html();\r\n        },\r\n\r\n        destroy: function (component, keditor) {\r\n            flog('destroy \"text\" component', component);\r\n\r\n            var id = component.find('.keditor-component-content').attr('id');\r\n            var editor = CKEDITOR.instances[id];\r\n            if (editor) {\r\n                editor.destroy();\r\n            }\r\n        },\r\n        initSettingForm: function (form, keditor) {\r\n            flog('init \"accordion\" settings', form);\r\n\r\n            return $.ajax({\r\n                url: '/theme/apps/keditor-lib/componentAccordionSettings.html',\r\n                type: 'get',\r\n                dataType: 'HTML',\r\n                success: function (resp) {\r\n                    form.html(resp);\r\n\r\n                    form.find('.collapsedAll').on('click', function () {\r\n                        var comp = keditor.getSettingComponent();\r\n                        comp.attr('data-initial-collapsed', this.checked);\r\n                    });\r\n\r\n                    form.find('.panelStyle').on('change', function (e) {\r\n                        var comp = keditor.getSettingComponent();\r\n                        var old = comp.attr('data-panel-style') || 'panel-default';\r\n                        comp.attr('data-panel-style', this.value);\r\n                        comp.find('.panel').removeClass(old).addClass(this.value);\r\n                    });\r\n                    \r\n                    $.getStyleOnce('/static/bootstrap-iconpicker/1.7.0/css/bootstrap-iconpicker.min.css');\r\n                    $.getScriptOnce('/static/bootstrap-iconpicker/1.7.0/js/iconset/iconset-fontawesome-4.2.0.min.js', function () {\r\n                        $.getScriptOnce('/static/bootstrap-iconpicker/1.7.0/js/bootstrap-iconpicker.min.js', function () {\r\n                            form.find('.btn-collapsed-icon, .btn-expanded-icon').iconpicker({\r\n                                iconset: 'fontawesome',\r\n                                cols: 10,\r\n                                rows: 4,\r\n                                placement: 'left'\r\n                            });\r\n                            \r\n                            form.find('.btn-collapsed-icon').on('change', function (e) {\r\n                                var component = keditor.getSettingComponent();\r\n                                component.attr('data-collapsed-icon', e.icon);\r\n                                component.find('.panelIconCollapsed').each(function () {\r\n                                    this.className = \"panelIconCollapsed fa \"+ e.icon;\r\n                                })\r\n                            });\r\n                            \r\n                            form.find('.btn-expanded-icon').on('change', function (e) {\r\n                                var component = keditor.getSettingComponent();\r\n                                component.attr('data-expanded-icon', e.icon);\r\n                                component.find('.panelIconExpanded').each(function () {\r\n                                    this.className = \"panelIconExpanded fa \"+ e.icon;\r\n                                })\r\n                            });\r\n                        });\r\n                    });\r\n                            \r\n                }\r\n            });\r\n        },\r\n\r\n        showSettingForm: function (form, component, keditor) {\r\n            flog('showSettingForm \"Accordion\" component');\r\n            var dataAttributes = keditor.getDataAttributes(component, ['data-type'], false);\r\n            \r\n            form.find('.collapsedAll').prop('checked', component.attr('data-initial-collapsed') == 'true');\r\n            form.find('.panelStyle').val(component.attr('data-panel-style'));\r\n            \r\n            $.getScriptOnce('/static/bootstrap-iconpicker/1.7.0/js/iconset/iconset-fontawesome-4.2.0.min.js', function () {\r\n                $.getScriptOnce('/static/bootstrap-iconpicker/1.7.0/js/bootstrap-iconpicker.min.js', function () {\r\n                    var iconCollapsed = dataAttributes['data-collapsed-icon'] || 'fa-caret-up';\r\n                    form.find('.btn-collapsed-icon').find('i').attr('class', 'fa ' + iconCollapsed).end().find('input').val(iconCollapsed);\r\n                    var iconExpanded = dataAttributes['data-expanded-icon'] || 'fa-caret-down';\r\n                    form.find('.btn-expanded-icon').find('i').attr('class', 'fa ' + iconExpanded).end().find('input').val(iconExpanded);\r\n                });\r\n            });\r\n        }\r\n    };\r\n})(jQuery);\r\n\r\n\r\n(function ($) {\n    var KEditor = $.keditor;\n    var flog = KEditor.log;\n    \n    KEditor.components['audio'] = {\n        init: function (contentArea, container, component, keditor) {\n            flog('init \"audio\" component', component);\n            \n            this.component = component;\n            var img = component.find('img[data-src]');\n            var componentId = '';\n            if (!img.attr('id')) {\n                componentId = keditor.generateId('component-audio');\n                img.attr('id', componentId);\n            } else {\n                componentId = img.attr('id');\n            }\n            if (!img.parent().hasClass('audio-wrapper')) {\n                img.wrap('<div class=\"audio-wrapper\"></div>');\n            }\n            this.src = img.attr('data-src');\n            this.width = img.attr('data-width');\n            this.autostart = img.attr('data-autostart') === 'true';\n            var instance = this;\n            $.getScriptOnce('/static/jwplayer/6.10/jwplayer.js', function () {\n                jwplayer.key = 'cXefLoB9RQlBo/XvVncatU90OaeJMXMOY/lamKrzOi0=';\n                instance.buildJWAudioPlayerPreview(componentId);\n            });\n            \n        },\n        \n        getContent: function (component, keditor) {\n            flog('getContent \"audio\" component', component);\n            \n            var img = component.find('img[data-src]');\n            var componentId = img.attr('id');\n            \n            var html = '<img data-componentId=\"' + componentId + '\" src=\"/theme/apps/content/preview/audio.png\" data-autostart=\"' + this.autostart + '\" data-width=\"' + this.width + '\" data-src=\"' + this.src + '\" data-kaudio=\"' + this.src + '\" />';\n            return html;\n        },\n        \n        settingEnabled: true,\n        \n        settingTitle: 'Audio settings',\n        \n        initSettingForm: function (form, keditor) {\n            flog('init \"audio\" settings', form);\n            \n            return $.ajax({\n                url: '/theme/apps/keditor-lib/componentAudioSettings.html',\n                type: 'get',\n                dataType: 'HTML',\n                success: function (resp) {\n                    form.html(resp);\n                }\n            });\n        },\n        \n        showSettingForm: function (form, component, keditor) {\n            flog('showSettingForm \"audio\" component', form, component);\n            \n            var instance = this;\n            var btnAudioFileInput = form.find('.btn-audioFileInput');\n            btnAudioFileInput.mselect({\n                contentTypes: ['audio'],\n                bs3Modal: true,\n                pagePath: keditor.options.pagePath,\n                basePath: keditor.options.basePath,\n                onSelectFile: function (url) {\n                    instance.src = url;\n                    instance.refreshAudioPlayerPreview();\n                }\n            });\n            \n            var img = component.find('img[data-src]');\n            var componentId = img.attr('id');\n            \n            var autoplayToggle = form.find('#audio-autoplay');\n            if (this.autostart) {\n                autoplayToggle.prop('checked', true);\n            }\n            autoplayToggle.on('click', function (e) {\n                instance.autostart = this.checked;\n                instance.buildJWAudioPlayerPreview(componentId);\n            });\n            \n            var audioWidth = form.find('#audio-width');\n            audioWidth.val(this.width);\n            audioWidth.on('change', function () {\n                instance.width = this.value;\n                instance.resizeAudioPlayerPreview();\n            });\n        },\n        \n        buildJWAudioPlayerPreview: function (componentId) {\n            var width = this.width;\n            var src = this.src;\n            var autostart = this.autostart;\n            var playerInstance = jwplayer(componentId);\n            playerInstance.setup({\n                file: src,\n                width: width,\n                height: 30,\n                autostart: autostart,\n                flashplayer: \"/static/jwplayer/6.10/jwplayer.flash.swf\",\n                html5player: \"/static/jwplayer/6.10/jwplayer.html5.js\",\n                primary: \"flash\"\n            });\n            playerInstance.onReady(function () {\n                log('jwplayer preview init done');\n            });\n        },\n        \n        refreshAudioPlayerPreview: function () {\n            var instance = this;\n            var playerInstance = jwplayer(instance.componentId);\n            var src = instance.src;\n            playerInstance.load([{\n                file: src\n            }]);\n            playerInstance.play();\n        },\n        \n        resizeAudioPlayerPreview: function () {\n            var instance = this;\n            var playerInstance = jwplayer(instance.componentId);\n            var width = instance.width;\n            \n            playerInstance.resize(width, 30);\n        }\n    };\n    \n})(jQuery);\n\r\n(function ($) {\r\n    var KEditor = $.keditor;\r\n    var flog = KEditor.log;\r\n    \r\n    KEditor.components['carousel'] = {\r\n        init: function (contentArea, container, component, keditor) {\r\n            flog('init \"carousel\" component', component);\r\n            var componentContent = component.children('.keditor-component-content');\r\n            var carousel = componentContent.find('.carousel');\r\n            \r\n            if (carousel.find('.carousel-img').length === 0 && carousel.find('.carousel-content').length === 0) {\r\n                var self = this;\r\n                var images = [];\r\n                \r\n                carousel.addClass('carousel-fixed-height');\r\n                carousel.find('.carousel-inner .item').each(function () {\r\n                    var item = $(this);\r\n                    \r\n                    images.push({\r\n                        src: item.find('img').attr('src'),\r\n                        hash: item.attr('data-hash')\r\n                    });\r\n                });\r\n                \r\n                carousel.attr('data-height', 300).css('height', 300);\r\n                carousel.find('.carousel-inner').html('');\r\n                carousel.find('.carousel-indicators').html('');\r\n                \r\n                $.each(images, function (i, image) {\r\n                    self.addItemToCarousel(component, {\r\n                        src: image.src,\r\n                        hash: image.hash\r\n                    });\r\n                });\r\n            }\r\n            \r\n            var id = keditor.generateId('component-carousel');\r\n            carousel.attr('id', id);\r\n            carousel.find('.carousel-indicators li').attr('data-target', '#' + id);\r\n            carousel.find('.carousel-control').attr('href', '#' + id);\r\n        },\r\n        getContent: function (component, keditor) {\r\n            var componentContent = component.children('.keditor-component-content');\r\n            componentContent.find('.carousel-inner').children().removeClass('active').eq(0).addClass('active');\r\n            \r\n            return componentContent.html();\r\n        },\r\n        settingEnabled: true,\r\n        \r\n        settingTitle: 'Carousel settings',\r\n        \r\n        editingItemId: '',\r\n        \r\n        initSettingForm: function (form, keditor) {\r\n            flog('init \"carousel\" settings', form);\r\n            \r\n            var self = this;\r\n            return $.ajax({\r\n                url: '/theme/apps/keditor-lib/componentCarouselSettings.html',\r\n                type: 'get',\r\n                dataType: 'HTML',\r\n                success: function (resp) {\r\n                    form.html(resp);\r\n                    \r\n                    $.getStyleOnce('/static/bootstrap-iconpicker/1.7.0/css/bootstrap-iconpicker.min.css');\r\n                    $.getScriptOnce('/static/bootstrap-iconpicker/1.7.0/js/iconset/iconset-fontawesome-4.2.0.min.js', function () {\r\n                        $.getScriptOnce('/static/bootstrap-iconpicker/1.7.0/js/bootstrap-iconpicker.min.js', function () {\r\n                            form.find('.btn-prev-icon, .btn-next-icon').iconpicker({\r\n                                iconset: 'fontawesome',\r\n                                cols: 10,\r\n                                rows: 4,\r\n                                placement: 'left'\r\n                            });\r\n                            \r\n                            form.find('.btn-prev-icon').on('change', function (e) {\r\n                                var carousel = keditor.getSettingComponent().find('.carousel');\r\n                                carousel.find('.glyphicon-chevron-left').attr('class', 'fa glyphicon-chevron-left ' + e.icon);\r\n                            });\r\n                            \r\n                            form.find('.btn-next-icon').on('change', function (e) {\r\n                                var carousel = keditor.getSettingComponent().find('.carousel');\r\n                                carousel.find('.glyphicon-chevron-right').attr('class', 'fa glyphicon-chevron-right ' + e.icon);\r\n                            });\r\n                        });\r\n                    });\r\n                    \r\n                    var carouselAddImage = form.find('.carouselAddImage');\r\n                    var carouselItemsWrap = form.find('.carouselItemsWrap');\r\n                    \r\n                    initMSelectImage(carouselAddImage, keditor, function (url, relUrl, type, hash) {\r\n                        flog('Keditor carousel selected a file', url, hash);\r\n                        self.addItemToList(form, {\r\n                            src: url,\r\n                            hash: hash,\r\n                            caption: ''\r\n                        });\r\n                        \r\n                        self.refreshCarousel(keditor.getSettingComponent(), form);\r\n                        self.editingItemId = '';\r\n                    });\r\n                    \r\n                    carouselItemsWrap.sortable({\r\n                        handle: '.btn-sort-item',\r\n                        items: '> .carouselItem',\r\n                        axis: 'y',\r\n                        tolerance: 'pointer',\r\n                        sort: function () {\r\n                            $(this).removeClass('ui-state-default');\r\n                        },\r\n                        update: function () {\r\n                            self.refreshCarousel(keditor.getSettingComponent(), form);\r\n                        }\r\n                    });\r\n                    \r\n                    // Content modal\r\n                    var editorContent = self.initModalContent(form, keditor)\r\n                    var modalContent = $('#modal-carousel-content');\r\n                    \r\n                    // Caption modal\r\n                    var editorCaption = self.initModalCaption(form, keditor)\r\n                    var modalCaption = $('#modal-carousel-caption');\r\n                    \r\n                    form.find('.carouselAddImage').on('click', function (e) {\r\n                        e.preventDefault();\r\n                    });\r\n                    \r\n                    form.find('.carouselAddContent').on('click', function (e) {\r\n                        e.preventDefault();\r\n                        modalContent.modal('show');\r\n                    });\r\n                    \r\n                    form.on('click', '.carouselItem a.btn-remove-item', function (e) {\r\n                        e.preventDefault();\r\n                        \r\n                        if (confirm('Are you sure that you want to delete this image?')) {\r\n                            var btn = $(this);\r\n                            var hash = btn.closest('.btn-group').siblings('[data-hash]').attr('data-hash');\r\n                            \r\n                            var carousel = keditor.getSettingComponent().find('.carousel');\r\n                            carousel.find('[data-hash=' + hash + ']').remove();\r\n                            btn.closest('.carouselItem').remove();\r\n                            \r\n                            self.refreshCarousel(keditor.getSettingComponent(), form);\r\n                        }\r\n                    });\r\n                    \r\n                    form.on('click', '.carouselItem a.btn-edit-item', function (e) {\r\n                        e.preventDefault();\r\n                        \r\n                        var carouselItem = $(this).closest('.carouselItem');\r\n                        self.editingItemId = carouselItem.attr('id');\r\n                        var txtCarouselContent = carouselItem.find('.txt-carousel-content');\r\n                        \r\n                        if (txtCarouselContent.length > 0) {\r\n                            editorContent.setData(txtCarouselContent.val() || '');\r\n                            form.find('.carouselAddContent').trigger('click');\r\n                        } else {\r\n                            form.find('.carouselAddImage').trigger('click');\r\n                        }\r\n                    });\r\n                    \r\n                    \r\n                    form.on('click', '.carouselItem a.btn-edit-caption-item', function (e) {\r\n                        e.preventDefault();\r\n                        \r\n                        var carouselItem = $(this).closest('.carouselItem');\r\n                        self.editingItemId = carouselItem.attr('id');\r\n                        var txtCarouselCaption = carouselItem.find('.txt-carousel-caption');\r\n                        \r\n                        editorCaption.setData(txtCarouselCaption.val() || '');\r\n                        modalCaption.modal('show');\r\n                    });\r\n                    \r\n                    form.find('.carouselHeight').on('change', function (e) {\r\n                        var value = this.value;\r\n                        \r\n                        if (isNaN(value) || +value < 200) {\r\n                            value = 200;\r\n                            this.value = 200;\r\n                        }\r\n                        \r\n                        var carousel = keditor.getSettingComponent().find('.carousel');\r\n                        carousel.attr('data-height', value);\r\n                        carousel.css('height', value);\r\n                    });\r\n                    \r\n                    form.find('.carouselPause').on('change', function (e) {\r\n                        e.preventDefault();\r\n                        var comp = keditor.getSettingComponent().find('.carousel');\r\n                        comp.attr('data-pause', this.value);\r\n                    });\r\n                    \r\n                    form.find('.carouselInterval').on('change', function (e) {\r\n                        e.preventDefault();\r\n                        var comp = keditor.getSettingComponent().find('.carousel');\r\n                        comp.attr('data-interval', this.value);\r\n                    });\r\n                    \r\n                    form.find('.carouselWrap').on('click', function (e) {\r\n                        var comp = keditor.getSettingComponent().find('.carousel');\r\n                        if (this.checked) {\r\n                            comp.attr('data-wrap', 'true');\r\n                        } else {\r\n                            comp.attr('data-wrap', 'false');\r\n                        }\r\n                    });\r\n                    \r\n                    form.find('.select-image-size').on('change', function () {\r\n                        var carousel = keditor.getSettingComponent().find('.carousel');\r\n                        \r\n                        carousel.attr('data-image-size', this.value);\r\n                        \r\n                        carousel.find('.carousel-img').css('background-size', this.value === 'centered' ? 'unset' : '');\r\n                    });\r\n                }\r\n            });\r\n        },\r\n        \r\n        initModalContent: function (form, keditor) {\r\n            var self = this;\r\n            \r\n            var modalContent = $(\r\n                '<div class=\"modal fade\" tabindex=\"-1\" id=\"modal-carousel-content\">' +\r\n                '    <div class=\"modal-dialog modal-lg\">' +\r\n                '        <div class=\"modal-content\">' +\r\n                '            <div class=\"modal-header\">' +\r\n                '                <button type=\"button\" class=\"close\" data-dismiss=\"modal\">&times;</button>' +\r\n                '                <h4 class=\"modal-title\">Edit content</h4>' +\r\n                '            </div>' +\r\n                '            <div class=\"modal-body\">' +\r\n                '                <textarea id=\"modal-carousel-content-body\" class=\"form-control\" rows=\"12\"></textarea>' +\r\n                '            </div>' +\r\n                '            <div class=\"modal-footer\">' +\r\n                '                <button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\">Close</button>' +\r\n                '                <button type=\"button\" class=\"btn btn-primary btn-carousel-save-content\">Save</button>' +\r\n                '            </div>' +\r\n                '        </div>' +\r\n                '    </div>' +\r\n                '</div>'\r\n            ).appendTo(document.body);\r\n            \r\n            var contentOptions = $.extend({}, keditor.options.ckeditorOptions);\r\n            contentOptions.removePlugins = contentOptions.removePlugins.replace(',autogrow', '') + ',sourcedialog';\r\n            contentOptions.extraPlugins = contentOptions.extraPlugins + ',autogrow';\r\n            var editorContent = $('#modal-carousel-content-body').ckeditor(contentOptions).editor;\r\n            \r\n            modalContent.on('hidden.bs.modal', function () {\r\n                editorContent.setData('');\r\n                self.editingItemId = '';\r\n            });\r\n            \r\n            modalContent.find('.btn-carousel-save-content').on('click', function (e) {\r\n                e.preventDefault();\r\n                \r\n                flog('Keditor carousel add content');\r\n                \r\n                var carouselContent = editorContent.getData() || '';\r\n                self.addItemToList(form, {\r\n                    content: carouselContent\r\n                });\r\n                \r\n                self.refreshCarousel(keditor.getSettingComponent(), form);\r\n                modalContent.modal('hide');\r\n            });\r\n            \r\n            return editorContent;\r\n        },\r\n        \r\n        initModalCaption: function (form, keditor) {\r\n            var self = this;\r\n            \r\n            var modalCaption = $(\r\n                '<div class=\"modal fade\" tabindex=\"-1\" id=\"modal-carousel-caption\">' +\r\n                '    <div class=\"modal-dialog modal-lg\">' +\r\n                '        <div class=\"modal-content\">' +\r\n                '            <div class=\"modal-header\">' +\r\n                '                <button type=\"button\" class=\"close\" data-dismiss=\"modal\">&times;</button>' +\r\n                '                <h4 class=\"modal-title\">Edit caption</h4>' +\r\n                '            </div>' +\r\n                '            <div class=\"modal-body\">' +\r\n                '                <textarea id=\"modal-carousel-caption-body\" class=\"form-control\" rows=\"12\"></textarea>' +\r\n                '            </div>' +\r\n                '            <div class=\"modal-footer\">' +\r\n                '                <button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\">Close</button>' +\r\n                '                <button type=\"button\" class=\"btn btn-primary btn-carousel-save-caption\">Save</button>' +\r\n                '            </div>' +\r\n                '        </div>' +\r\n                '    </div>' +\r\n                '</div>'\r\n            ).appendTo(document.body);\r\n            \r\n            var captionOptions = $.extend({}, keditor.options.ckeditorOptions);\r\n            captionOptions.removePlugins = captionOptions.removePlugins.replace(',autogrow', '') + ',sourcedialog';\r\n            captionOptions.extraPlugins = captionOptions.extraPlugins + ',autogrow';\r\n            captionOptions.toolbarGroups = toolbarSets['Lite'];\r\n            var editorCaption = $('#modal-carousel-caption-body').ckeditor(captionOptions).editor;\r\n            \r\n            modalCaption.on('hidden.bs.modal', function () {\r\n                editorCaption.setData('');\r\n                self.editingItemId = '';\r\n            });\r\n            \r\n            modalCaption.find('.btn-carousel-save-caption').on('click', function (e) {\r\n                e.preventDefault();\r\n                \r\n                flog('Keditor carousel add content');\r\n                \r\n                var carouselCaption = editorCaption.getData() || '';\r\n                var item = form.find('#' + self.editingItemId).find('.img-responsive');\r\n                self.addItemToList(form, {\r\n                    src: item.attr('src'),\r\n                    hash: item.attr('data-hash'),\r\n                    caption: carouselCaption\r\n                });\r\n                \r\n                self.refreshCarousel(keditor.getSettingComponent(), form);\r\n                modalCaption.modal('hide');\r\n            });\r\n            \r\n            return editorCaption;\r\n        },\r\n        \r\n        showSettingForm: function (form, component, keditor) {\r\n            var self = this;\r\n            self.editingItemId = '';\r\n            form.find('.carouselItemsWrap').html('');\r\n            component.find('.carousel-inner > .item').each(function () {\r\n                var item = $(this);\r\n                var carouselImg = item.find('.carousel-img');\r\n                var carouselContent = item.find('.carousel-content');\r\n                \r\n                if (carouselContent.length > 0) {\r\n                    self.addItemToList(form, {\r\n                        content: carouselContent.html()\r\n                    });\r\n                } else {\r\n                    var url = carouselImg.css('background-image');\r\n                    url = url.slice(4, -1).replace(/['\"]/g, '');\r\n                    var hash = $(item).attr('data-hash');\r\n                    var caption = item.find('.carousel-caption');\r\n                    \r\n                    self.addItemToList(form, {\r\n                        src: url,\r\n                        hash: hash,\r\n                        caption: caption.html() || ''\r\n                    });\r\n                }\r\n            });\r\n            \r\n            var carousel = component.find('.carousel');\r\n            var isWrap = carousel.attr('data-wrap');\r\n            var pause = carousel.attr('data-pause');\r\n            var interval = carousel.attr('data-interval');\r\n            var height = carousel.attr('data-height');\r\n            \r\n            form.find('.carouselPause').val(pause);\r\n            form.find('.carouselInterval').val(interval);\r\n            form.find('.carouselWrap').prop('checked', isWrap === 'true');\r\n            form.find('.carouselHeight').val(height);\r\n            form.find('.select-image-size').val(carousel.attr('data-image-size') || 'stretched');\r\n            \r\n            $.getScriptOnce('/static/bootstrap-iconpicker/1.7.0/js/iconset/iconset-fontawesome-4.2.0.min.js', function () {\r\n                $.getScriptOnce('/static/bootstrap-iconpicker/1.7.0/js/bootstrap-iconpicker.min.js', function () {\r\n                    var iconPrev = carousel.find('.glyphicon-chevron-left').attr('class') || '';\r\n                    iconPrev = iconPrev.replace('glyphicon-chevron-left', '').replace('fa', '').trim();\r\n                    form.find('.btn-prev-icon').find('i').attr('class', 'fa ' + iconPrev).end().find('input').val(iconPrev);\r\n                    \r\n                    var iconNext = carousel.find('.glyphicon-chevron-right').attr('class') || '';\r\n                    iconNext = iconNext.replace('glyphicon-chevron-right', '').replace('fa', '').trim();\r\n                    form.find('.btn-next-icon').find('i').attr('class', 'fa ' + iconNext).end().find('input').val(iconNext);\r\n                });\r\n            });\r\n        },\r\n        \r\n        addItemToCarousel: function (component, data) {\r\n            flog('addItemToCarousel', component, data);\r\n            \r\n            var carousel = component.find('.carousel');\r\n            var carouselInner = carousel.find('.carousel-inner');\r\n            var id = carousel.attr('id');\r\n            var index = carouselInner.children().length;\r\n            var cls = index === 0 ? 'active' : '';\r\n            var backgroundUrl = \"background-image: url('\" + data.src + \"')\";\r\n            var backgroundSize = carousel.attr('data-image-size') === 'centered' ? ';background-size: unset' : '';\r\n            \r\n            carousel.find('.carousel-indicators').append(\r\n                '<li data-target=\"#' + id + '\" data-slide-to=\"' + index + '\" class=\"' + cls + '\"></li>'\r\n            );\r\n            \r\n            var itemStr = '';\r\n            if (data.content) {\r\n                itemStr += '<div class=\"item ' + cls + '\">';\r\n                itemStr += '   <div class=\"carousel-content clearfix\">' + data.content + '</div>';\r\n                itemStr += '   <div class=\"carousel-caption\"></div>';\r\n                itemStr += '</div>';\r\n            } else {\r\n                itemStr += '<div data-hash=\"' + data.hash + '\" class=\"item ' + cls + '\">';\r\n                itemStr += '   <div class=\"carousel-img\" style=\"' + backgroundUrl + backgroundSize + '\"></div>';\r\n                itemStr += '   <div class=\"carousel-caption\">' + data.caption + '</div>';\r\n                itemStr += '</div>';\r\n            }\r\n            \r\n            carouselInner.append(itemStr);\r\n        },\r\n        \r\n        addItemToList: function (form, data) {\r\n            flog('addItemToList', form, data);\r\n            \r\n            var editCaption = '';\r\n            \r\n            var itemStr = '';\r\n            if (data.content) {\r\n                itemStr += '<img class=\"img-responsive\" src=\"/keditor/componentCarouselContent.png\" />';\r\n                itemStr += '<textarea style=\"display: none\" class=\"txt-carousel-content\">' + data.content + '</textarea>';\r\n            } else {\r\n                itemStr += '<img class=\"img-responsive\" src=\"' + data.src + '\" data-hash=\"' + data.hash + '\" />';\r\n                itemStr += '<textarea style=\"display: none\" class=\"txt-carousel-caption\">' + data.caption + '</textarea>';\r\n                editCaption = '<a title=\"Edit caption\" class=\"btn btn-success btn-edit-caption-item\" href=\"#\"><i class=\"fa fa-file\"></i></a>';\r\n            }\r\n            \r\n            itemStr += '   <div class=\"btn-group btn-group-xs\">';\r\n            itemStr += '       <a title=\"Reorder item\" class=\"btn btn-info btn-sort-item\" href=\"#\"><i class=\"fa fa-sort\"></i></a>';\r\n            itemStr += '       <a title=\"Edit item\" class=\"btn btn-primary btn-edit-item\" href=\"#\"><i class=\"fa fa-edit\"></i></a>' + editCaption;\r\n            itemStr += '       <a title=\"Delete item\" class=\"btn btn-danger btn-remove-item\" href=\"#\"><i class=\"fa fa-trash\"></i></a>';\r\n            itemStr += '   </div>';\r\n            \r\n            if (this.editingItemId) {\r\n                form.find('#' + this.editingItemId).html(itemStr);\r\n                this.editingItemId = '';\r\n            } else {\r\n                form.find('.carouselItemsWrap').append(\r\n                    '<div class=\"carouselItem\" id=\"carouselItem-' + (new Date()).getTime() + '\">' + itemStr + '</div>'\r\n                );\r\n            }\r\n        },\r\n        \r\n        refreshCarousel: function (component, form) {\r\n            var self = this;\r\n            var carousel = component.find('.carousel');\r\n            carousel.find('.carousel-inner').html('');\r\n            carousel.find('.carousel-indicators').html('');\r\n            \r\n            form.find('.carouselItemsWrap').find('.carouselItem').each(function () {\r\n                var carouselItem = $(this);\r\n                var txtContent = carouselItem.find('.txt-carousel-content');\r\n                var txtCaption = carouselItem.find('.txt-carousel-caption');\r\n                var img = carouselItem.find('img');\r\n                \r\n                if (txtContent.length === 0) {\r\n                    self.addItemToCarousel(component, {\r\n                        src: img.attr('src'),\r\n                        hash: img.attr('data-hash'),\r\n                        caption: txtCaption.val()\r\n                    });\r\n                } else {\r\n                    self.addItemToCarousel(component, {\r\n                        content: txtContent.val()\r\n                    });\r\n                }\r\n            });\r\n        }\r\n    }\r\n    \r\n})(jQuery);\r\n(function ($) {\r\n    var KEditor = $.keditor;\r\n    var flog = KEditor.log;\r\n    \r\n    KEditor.components['form'] = {\r\n        initFormBuilder: function (component) {\r\n            var self = this;\r\n            \r\n            $.getScriptOnce('/static/formBuilder/2.5.3/form-builder.min.js', function () {\r\n                $.getScriptOnce('/static/formBuilder/2.5.3/form-render.min.js', function () {\r\n                    var formBuilderArea = component.find('.form-builder-area');\r\n                    var formData = component.find('.form-data');\r\n                    var formContent = component.find('.form-content');\r\n                    \r\n                    component.find('.keditor-component-content').prepend(\r\n                        '<p class=\"form-builder-tools\" style=\"text-align: right;\">' +\r\n                        '    <a href=\"#\" class=\"btn btn-primary btn-preview-form\">Preview form</a> ' +\r\n                        '    <a href=\"#\" class=\"btn btn-info btn-edit-form disabled\">Edit form</a>' +\r\n                        '</p>'\r\n                    );\r\n                    \r\n                    var btnEditForm = component.find('.btn-edit-form');\r\n                    var btnPreviewForm = component.find('.btn-preview-form');\r\n                    \r\n                    formBuilderArea.formBuilder({\r\n                        disableInjectedStyle: true,\r\n                        showActionButtons: false,\r\n                        dataType: 'json',\r\n                        formData: formData.html(),\r\n                        disableFields: [\r\n                            'autocomplete',\r\n                            'paragraph',\r\n                            'header'\r\n                        ],\r\n                        disabledAttrs: ['access'],\r\n                        \r\n                        typeUserDisabledAttrs: {\r\n                            'checkbox-group': [\r\n                                'toggle',\r\n                                'inline'\r\n                            ]\r\n                        }\r\n                    });\r\n                    \r\n                    btnEditForm.on('click', function (e) {\r\n                        e.preventDefault();\r\n                        \r\n                        if (!btnEditForm.hasClass('disabled')) {\r\n                            formBuilderArea.show();\r\n                            formContent.hide();\r\n                            btnEditForm.addClass('disabled');\r\n                            btnPreviewForm.removeClass('disabled');\r\n                        }\r\n                    });\r\n                    \r\n                    btnPreviewForm.on('click', function (e) {\r\n                        e.preventDefault();\r\n                        \r\n                        if (!btnPreviewForm.hasClass('disabled')) {\r\n                            self.renderForm(component);\r\n                            \r\n                            formBuilderArea.hide();\r\n                            formContent.show();\r\n                            btnEditForm.removeClass('disabled');\r\n                            btnPreviewForm.addClass('disabled');\r\n                        }\r\n                    });\r\n                })\r\n            });\r\n        },\r\n        \r\n        renderForm: function (component, formBuilder) {\r\n            var formContent = component.find('.form-content');\r\n            \r\n            if (!formBuilder) {\r\n                var formBuilderArea = component.find('.form-builder-area');\r\n                formBuilder = formBuilderArea.data('formBuilder');\r\n            }\r\n            \r\n            formContent.formRender({\r\n                dataType: 'json',\r\n                formData: formBuilder.actions.getData('json')\r\n            });\r\n            \r\n            if (formContent.hasClass('form-horizontal')) {\r\n                formContent.children('div').each(function () {\r\n                    var div = $(this);\r\n                    var dataGrid = formContent.attr('data-grid') || '4-8';\r\n                    dataGrid = dataGrid.split('-');\r\n                    \r\n                    if (div.attr('class')) {\r\n                        if (div.hasClass('fb-button')) {\r\n                            div.find('button').wrap('<div class=\"col-sm-' + dataGrid[1] + ' col-sm-offset-' + dataGrid[0] + '\"></div>');\r\n                        } else {\r\n                            var label = div.children('label');\r\n                            var input = div.children('input, select, textarea');\r\n                            var subDiv = div.children('div');\r\n                            \r\n                            label.addClass('control-label col-sm-' + dataGrid[0]);\r\n                            \r\n                            if (subDiv.length > 0) {\r\n                                subDiv.addClass('col-sm-' + dataGrid[1]);\r\n                            } else {\r\n                                input.addClass('form-control').wrap('<div class=\"col-sm-' + dataGrid[1] + '\"></div>');\r\n                            }\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        },\r\n        \r\n        init: function (contentArea, container, component, keditor) {\r\n            flog('init \"form\" component', component);\r\n            \r\n            var componentContent = component.find('.keditor-component-content');\r\n            var formBuilder = component.find('.form-builder-area');\r\n            var formContent = component.find('.form-content');\r\n            var formData = component.find('.form-data');\r\n            \r\n            if (formData.length === 0) {\r\n                componentContent.append('<div class=\"form-data\" style=\"display: none !important;\"></div>')\r\n            }\r\n            \r\n            if (formContent.length === 0) {\r\n                componentContent.append('<form class=\"form-content\" style=\"display: none !important;\"></form>')\r\n            } else {\r\n                formContent.hide()\r\n            }\r\n            \r\n            if (formBuilder.length === 0) {\r\n                formBuilder = $('<div class=\"form-builder-area clearfix\"></div>');\r\n                componentContent.append(formBuilder);\r\n            }\r\n            \r\n            this.initFormBuilder(component);\r\n        },\r\n        \r\n        getContent: function (component, keditor) {\r\n            flog('getContent \"form\" component', component);\r\n            \r\n            var self = this;\r\n            var componentContent = component.find('.keditor-component-content');\r\n            var formData = component.find('.form-data');\r\n            var formBuilderArea = $('#' + component.attr('id')).find('.form-builder-area');\r\n            var formBuilder = formBuilderArea.data('formBuilder');\r\n            \r\n            self.renderForm(component, formBuilder);\r\n            formData.html(formBuilder.actions.getData('json'));\r\n            component.find('.form-builder-area, .form-builder-tools').remove();\r\n            component.find('.form-content').show();\r\n            \r\n            return componentContent.html();\r\n        },\r\n        \r\n        settingEnabled: true,\r\n        \r\n        settingTitle: 'Form Settings',\r\n        \r\n        initSettingForm: function (form, keditor) {\r\n            flog('initSettingForm \"form\" component');\r\n            \r\n            var self = this;\r\n            \r\n            return $.ajax({\r\n                url: '/theme/apps/keditor-lib/componentFormSettings.html',\r\n                type: 'get',\r\n                dataType: 'HTML',\r\n                success: function (resp) {\r\n                    form.html(resp);\r\n                    \r\n                    form.find('.txt-form-action').on('change', function () {\r\n                        var component = keditor.getSettingComponent();\r\n                        var formContent = component.find('.form-content');\r\n                        \r\n                        formContent.attr('action', this.value);\r\n                    });\r\n                    \r\n                    form.find('.select-method').on('change', function () {\r\n                        var component = keditor.getSettingComponent();\r\n                        var formContent = component.find('.form-content');\r\n                        \r\n                        formContent.attr('action', this.value);\r\n                    });\r\n                    \r\n                    form.find('.select-enctype').on('change', function () {\r\n                        var component = keditor.getSettingComponent();\r\n                        var formContent = component.find('.form-content');\r\n                        \r\n                        formContent.attr('enctype', this.value);\r\n                    });\r\n                    \r\n                    form.find('.select-layout').on('change', function () {\r\n                        var component = keditor.getSettingComponent();\r\n                        var formContent = component.find('.form-content');\r\n                        \r\n                        formContent.removeClass('form-inline form-horizontal');\r\n                        if (this.value) {\r\n                            formContent.addClass(this.value);\r\n                        }\r\n                        self.renderForm(component);\r\n                        form.find('.select-grid-wrapper').css('display', this.value === 'form-horizontal' ? 'block' : 'none');\r\n                    });\r\n                    \r\n                    form.find('.select-grid').on('change', function () {\r\n                        var component = keditor.getSettingComponent();\r\n                        var formContent = component.find('.form-content');\r\n                        \r\n                        formContent.attr('data-grid', this.value);\r\n                        self.renderForm(component);\r\n                    });\r\n                }\r\n            });\r\n        },\r\n        \r\n        showSettingForm: function (form, component, keditor) {\r\n            flog('showSettingForm \"form\" component', component);\r\n            var formContent = component.find('.form-content');\r\n            \r\n            var layout = '';\r\n            if (formContent.hasClass('form-inline')) {\r\n                layout = 'form-inline';\r\n            } else if (formContent.hasClass('form-horizontal')) {\r\n                layout = 'form-horizontal';\r\n            }\r\n            \r\n            form.find('.txt-form-action').val(formContent.attr('action') || '');\r\n            form.find('.select-method').val(formContent.attr('method') || 'get');\r\n            form.find('.select-enctype').val(formContent.attr('enctype'));\r\n            form.find('.select-layout').val(layout);\r\n            form.find('.select-grid-wrapper').css('display', layout === 'form-horizontal' ? 'block' : 'none');\r\n            form.find('.select-grid').val(formContent.attr('data-grid') || '4-8');\r\n        }\r\n    };\r\n    \r\n})(jQuery);\r\n\r\n(function ($, window) {\n    var KEditor = $.keditor;\n    var flog = KEditor.log;\n    \n    KEditor.components['googlemap'] = {\n        init: function (contentArea, container, component, keditor) {\n            flog('init \"googlemap\" component', component);\n            \n            this.callWhenGoogleMapReady(function () {\n                initKGoogleMap(component);\n            });\n        },\n        \n        getContent: function (component, keditor) {\n            flog('getContent \"googlemap\" component', component);\n            \n            var componentContent = component.children('.keditor-component-content');\n            componentContent.find('.googlemap-cover').remove();\n            component.find('.kgooglemap').html('');\n            \n            return componentContent.html();\n        },\n        \n        settingEnabled: true,\n        \n        settingTitle: 'Google Map Settings',\n        \n        initSettingForm: function (form, keditor) {\n            flog('init \"googlemap\" settings', form);\n            var self = this;\n            \n            return $.ajax({\n                url: '/theme/apps/keditor-lib/componentGoogleMapSettings.html',\n                type: 'get',\n                dataType: 'HTML',\n                success: function (resp) {\n                    form.html(resp);\n                    \n                    self.callWhenGoogleMapReady(function () {\n                        var component = keditor.getSettingComponent();\n                        self.initAutocomplete(component, form);\n                    });\n                    \n                    var mapTypes = form.find('.map-type');\n                    form.find('.mapType').on('click', function () {\n                        mapTypes.hide().filter('.' + this.value).show();\n                        \n                        var component = keditor.getSettingComponent();\n                        var iframe = component.find('iframe');\n                        var kgooglemap = component.find('.kgooglemap');\n                        component.attr('data-maptype', this.value);\n                        \n                        iframe[this.value === 'manually' ? 'hide' : 'show']();\n                        kgooglemap[this.value === 'manually' ? 'show' : 'hide']();\n                        \n                        if (this.value === 'manually') {\n                            self.makeGoogleMapFresh(form, component);\n                        }\n                    });\n                    \n                    form.find('[name=mapEmbedCode]').on('change', function () {\n                        var iframe = $(this.value);\n                        var src = iframe.attr('src');\n                        if (iframe.length > 0 && src && src.length > 0) {\n                            keditor.getSettingComponent().find('.embed-responsive-item').attr('src', src);\n                        } else {\n                            alert('Your Google Map embed code is invalid!');\n                        }\n                    });\n                    \n                    form.find('[name=mapRatio]').on('click', function () {\n                        var component = keditor.getSettingComponent();\n                        \n                        component.find('.embed-responsive').removeClass('embed-responsive-4by3 embed-responsive-16by9').addClass('embed-responsive-' + this.value);\n                    });\n                }\n            });\n        },\n        \n        callWhenGoogleMapReady: function (callback) {\n            var self = this;\n            var apiKey = 'AIzaSyBUcuZxwpBXCPztG7ot-rITXJbycPuS7gs';\n            var url = 'https://maps.googleapis.com/maps/api/js?key=' + apiKey + '&libraries=places';\n            \n            if (window.google && window.google.maps && google.maps.places) {\n                callback.call(self);\n            } else {\n                $.getScriptOnce(url, function () {\n                    callback.call(self);\n                });\n            }\n        },\n        \n        makeGoogleMapFresh: function (form, component) {\n            var input = form.find('[name=mapAddress]')[0];\n            \n            setTimeout(function () {\n                google.maps.event.trigger(input, 'focus');\n                google.maps.event.trigger(input, 'keydown', {\n                    keyCode: 13\n                });\n            }, 1000);\n            \n            var map = component.find('.kgooglemap').data('map');\n            setTimeout(function () {\n                google.maps.event.trigger(map, \"resize\");\n            }, 100);\n        },\n        \n        showSettingForm: function (form, component, keditor) {\n            var self = this;\n            \n            self.callWhenGoogleMapReady(function () {\n                var maptype = component.attr('data-maptype') || 'embed';\n                var place = component.attr('data-place');\n                \n                var ratio = component.find('.embed-responsive').hasClass('embed-responsive-16by9') ? '16by9' : '4by3';\n                form.find('.mapRatio[value=' + ratio + ']').prop('checked', true);\n                form.find('.mapType[value=' + maptype + ']').prop('checked', true);\n                \n                var src = component.find('iframe').attr('src');\n                var iframe = '<iframe class=\"embed-responsive-item\" src=\"' + src + '\"></iframe>';\n                if (!place) {\n                    place = 'Hanoi, Vietnam';\n                }\n                form.find('[name=mapAddress]').val(place);\n                form.find('[name=mapEmbedCode]').val(iframe);\n                \n                form.find('.map-type').hide().filter('.' + maptype).show();\n                \n                if (!component.find('.kgooglemap').data('map')) {\n                    self.initAutocomplete(component, form);\n                    \n                    if (maptype === 'manually') {\n                        self.makeGoogleMapFresh(form, component);\n                    }\n                } else {\n                    if (maptype === 'manually') {\n                        self.makeGoogleMapFresh(form, component);\n                    }\n                }\n            });\n        },\n        \n        initAutocomplete: function (component, form) {\n            if (component.find('.kgooglemap').data('map')) {\n                this.makeGoogleMapFresh(form, component);\n            } else {\n                var mapDiv = component.find('.kgooglemap')[0];\n                var map = new google.maps.Map(mapDiv, {\n                    zoom: 13,\n                    mapTypeId: 'roadmap'\n                });\n                \n                // Create the search box and link it to the UI element.\n                var input = form.find('[name=mapAddress]')[0];\n                var searchBox = new google.maps.places.SearchBox(input);\n                \n                // Bias the SearchBox results towards current map's viewport.\n                map.addListener('bounds_changed', function () {\n                    searchBox.setBounds(map.getBounds());\n                });\n                \n                var markers = [];\n                searchBox.addListener('places_changed', function () {\n                    var places = searchBox.getPlaces();\n                    \n                    if (places.length == 0) {\n                        return;\n                    }\n                    \n                    // Clear out the old markers.\n                    markers.forEach(function (marker) {\n                        marker.setMap(null);\n                    });\n                    markers = [];\n                    \n                    // For each place, get the icon, name and location.\n                    var bounds = new google.maps.LatLngBounds();\n                    places.forEach(function (place) {\n                        if (!place.geometry) {\n                            console.log(\"Returned place contains no geometry\");\n                            return;\n                        }\n                        \n                        var icon = {\n                            url: place.icon,\n                            size: new google.maps.Size(71, 71),\n                            origin: new google.maps.Point(0, 0),\n                            anchor: new google.maps.Point(17, 34),\n                            scaledSize: new google.maps.Size(25, 25)\n                        };\n                        \n                        // Create a marker for each place.\n                        markers.push(new google.maps.Marker({\n                            map: map,\n                            icon: icon,\n                            title: place.name,\n                            position: place.geometry.location\n                        }));\n                        \n                        if (place.geometry.viewport) {\n                            // Only geocodes have viewport.\n                            bounds.union(place.geometry.viewport);\n                        } else {\n                            bounds.extend(place.geometry.location);\n                        }\n                    });\n                    map.fitBounds(bounds);\n                    component.attr('data-place', input.value);\n                });\n                \n                component.find('.kgooglemap').data('map', map);\n            }\n        }\n    };\n    \n})(jQuery, window);\n\r\n(function ($) {\n    var KEditor = $.keditor;\n    var contentEditor = $.contentEditor;\n    var flog = KEditor.log;\n    \n    KEditor.components['jumbotron'] = {\n        settingEnabled: true,\n        \n        settingTitle: 'Jumbotron Settings',\n        init: function (contentArea, container, component, keditor) {\n            var self = this;\n            var options = keditor.options;\n            \n            var componentContent = component.children('.keditor-component-content');\n            componentContent.prop('contenteditable', true);\n            \n            componentContent.on('input', function (e) {\n                if (typeof options.onComponentChanged === 'function') {\n                    options.onComponentChanged.call(keditor, e, component, contentArea);\n                }\n                \n                if (typeof options.onContainerChanged === 'function') {\n                    options.onContainerChanged.call(keditor, e, container, contentArea);\n                }\n                \n                if (typeof options.onContentChanged === 'function') {\n                    options.onContentChanged.call(keditor, e, contentArea);\n                }\n            });\n            \n            var editor = componentContent.ckeditor(options.ckeditorOptions).editor;\n            editor.on('instanceReady', function () {\n                flog('CKEditor is ready', component);\n                \n                if (typeof options.onComponentReady === 'function') {\n                    options.onComponentReady.call(contentArea, component, editor);\n                }\n            });\n        },\n        \n        getContent: function (component, keditor) {\n            flog('getContent \"jumbotron\" component', component);\n            \n            var componentContent = component.find('.keditor-component-content');\n            var id = componentContent.attr('id');\n            var editor = CKEDITOR.instances[id];\n            if (editor) {\n                return editor.getData();\n            } else {\n                return componentContent.html();\n            }\n        },\n        \n        initSettingForm: function (form, keditor) {\n            flog('init \"jumbotron\" settings', form);\n            \n            return $.ajax({\n                url: '/theme/apps/keditor-lib/componentJumbotronSettings.html',\n                type: 'get',\n                dataType: 'HTML',\n                success: function (resp) {\n                    form.html(resp);\n                    \n                    form.find('.chk-inverse').on('click', function () {\n                        var comp = keditor.getSettingComponent();\n                        comp.find('.jumbotron')[this.checked ? 'addClass' : 'removeClass']('jumbotron-inverse');\n                    });\n                    \n                    var buttonColorPicker = form.find('.button-color-picker');\n                    contentEditor.initSimpleColorPicker(buttonColorPicker, function (color) {\n                        var comp = keditor.getSettingComponent();\n                        comp.find('.jumbotron').css('background-color', color);\n                        comp.attr('data-bgcolor', color);\n                    });\n                    \n                    var paddingSettings = form.find('.paddingSettings');\n                    paddingSettings.on('change', function () {\n                        var paddingValue = this.value || '';\n                        var component = keditor.getSettingComponent();\n                        var paddingProp = $(this).attr('name');\n                        if (paddingValue.trim() === '') {\n                            component.find('.jumbotron').css(paddingProp, '');\n                        } else {\n                            if (isNaN(paddingValue)) {\n                                paddingValue = 0;\n                                this.value = paddingValue;\n                            }\n                            component.find('.jumbotron').css(paddingProp, paddingValue + 'px');\n                        }\n                    });\n                    \n                    var marginSettings = form.find('.marginSettings');\n                    marginSettings.on('change', function () {\n                        var paddingValue = this.value || '';\n                        var component = keditor.getSettingComponent();\n                        var paddingProp = $(this).attr('name');\n                        if (paddingValue.trim() === '') {\n                            component.find('.jumbotron').css(paddingProp, '');\n                        } else {\n                            if (isNaN(paddingValue)) {\n                                paddingValue = 0;\n                                this.value = paddingValue;\n                            }\n                            component.find('.jumbotron').css(paddingProp, paddingValue + 'px');\n                        }\n                    });\n                }\n            });\n        },\n        \n        showSettingForm: function (form, component, keditor) {\n            flog('showSettingForm \"jumbotron\" component', component);\n            form.find('[name=button-color]').val(component.attr('data-bgcolor')).trigger('update');\n            form.find('.paddingSettings').each(function () {\n                $(this).val(component.find('.jumbotron').css($(this).attr('name')).replace('px', ''));\n            });\n            form.find('.marginSettings').each(function () {\n                $(this).val(component.find('.jumbotron').css($(this).attr('name')).replace('px', ''));\n            });\n            form.find('[name=showButton][value=false]').prop('checked', component.find('a').hasClass('hide'));\n            form.find('.chk-inverse').prop('checked', component.find('.jumbotron').hasClass('jumbotron-inverse'));\n        },\n        \n        destroy: function (component, keditor) {\n            flog('destroy \"text\" component', component);\n            \n            var id = component.find('.keditor-component-content').attr('id');\n            var editor = CKEDITOR.instances[id];\n            if (editor) {\n                editor.destroy();\n            }\n        }\n    };\n    \n})(jQuery);\n\n\r\n(function ($) {\n    var KEditor = $.keditor;\n    var flog = KEditor.log;\n    \n    KEditor.components['ksvgmap'] = {\n        init: function (contentArea, container, component, keditor) {\n            var script = component.find('script');\n            if (script.length) {\n                script.remove();\n            }\n            if (component.attr('data-height')) {\n                component.find('.ksvgmap').css('height', +component.attr('data-height'));\n            }\n            $.getScriptOnce('/static/jquery-jvectormap/jquery-jvectormap-2.0.3.min.js', function () {\n                $.getScriptOnce('/static/jquery-jvectormap/jquery-jvectormap-au-mill.js', function () {\n                    component.find('.ksvgmap').vectorMap({\n                        map: 'au_mill',\n                        backgroundColor: '#fff',\n                        zoomButtons: false,\n                        focusOn: {\n                            x: 0.5,\n                            y: 0.5,\n                            scale: 1\n                        },\n                        regionStyle: {\n                            initial: {\n                                fill: '#efefef'\n                            },\n                            hover: {\n                                fill: \"#00aa90\"\n                            }\n                        },\n                        onRegionTipShow: function (e, el, code) {\n                            if (component.attr('data-' + code))\n                                el.html(el.html() + ' - ' + component.attr('data-' + code));\n                        }\n                    });\n                    var i = setInterval(function () {\n                        try {\n                            var map = component.find('.ksvgmap').vectorMap('get', 'mapObject');\n                            map.updateSize();\n                            clearInterval(i);\n                        } catch (e) {\n                            flog('trying to get jvectormap object');\n                        }\n                    }, 50);\n                });\n            });\n        },\n        getContent: function (component, keditor) {\n            flog('getContent \"svgmap\" component', component);\n            var componentContent = component.children('.keditor-component-content');\n            var script = '<script>$(function(){$(document.body).hasClass(\"content-editor-page\")||$.getScriptOnce(\"/static/jquery-jvectormap/jquery-jvectormap-2.0.3.min.js\",function(){$.getScriptOnce(\"/static/jquery-jvectormap/jquery-jvectormap-au-mill.js\",function(){$(\".ksvgmap\").each(function(){var a=$(this).parents(\"[data-type=component-ksvgmap]\");a.hasClass(\"ksvgInit\")||(a.addClass(\"ksvgInit\"),$(this).vectorMap({map:\"au_mill\",backgroundColor:\"#fff\",zoomButtons:!1,scale:5,regionStyle:{initial:{fill:\"#efefef\"},hover:{fill:\"#00aa90\"}},onRegionTipShow:function(b,c,d){a.attr(\"data-\"+d)&&c.html(\"<span class=\\'vectormap-tip-region-name\\'>\"+c.html()+\"</span><span class=\\'vectormap-tip-separator\\'> - </span><span class=\\'vectormap-tip-region-data\\'>\"+a.attr(\"data-\"+d)+\"</span>\")}}))})})})});</script>';\n            var css = '<link rel=\"stylesheet\" href=\"/static/jquery-jvectormap/jquery-jvectormap-2.0.3.css\">';\n            component.find('.jvectormap-container').remove();\n            var arr = $(document.body).find('[data-type=\"component-ksvgmap\"]:not(.keditor-snippet)');\n            if (arr.length > 0) {\n                if ($(arr[arr.length - 1]).attr('id') === component.attr('id')) {\n                    $(css).insertBefore(component.find('.ksvgmap'));\n                    $(script).insertAfter(component.find('.ksvgmap'));\n                }\n            }\n            \n            return componentContent.html();\n        },\n        \n        settingEnabled: true,\n        \n        settingTitle: 'SVGMap Settings',\n        \n        initSettingForm: function (form, keditor) {\n            flog('init \"svgmap\" settings', form);\n            \n            return $.ajax({\n                url: '/theme/apps/keditor-lib/componentKsvgMapSettings.html',\n                type: 'get',\n                dataType: 'HTML',\n                success: function (resp) {\n                    form.html(resp);\n                    \n                    var component = keditor.getSettingComponent();\n                    form.find('.state').on('change', function (e) {\n                        var val = component.attr('data-' + this.value);\n                        form.find('.stateMessage').val(val);\n                    });\n                    form.find('.stateMessage').on('change', function (e) {\n                        var currentState = form.find('.state').val();\n                        component.attr('data-' + currentState, this.value);\n                    });\n                    form.find('.height').on('change', function (e) {\n                        component.attr('data-height', this.value);\n                        component.find('.ksvgmap').css('height', this.value);\n                        var map = component.find('.ksvgmap').vectorMap('get', 'mapObject');\n                        map.updateSize();\n                    });\n                }\n            });\n        },\n        showSettingForm: function (form, component, keditor) {\n            var height = component.attr('data-height');\n            var defaultState = form.find('.state').val();\n            form.find('.height').val(height);\n            form.find('.stateMessage').val(component.attr('data-' + defaultState));\n        }\n    };\n})(jQuery);\n\r\n(function ($) {\r\n    var KEditor = $.keditor;\r\n    var flog = KEditor.log;\r\n    \r\n    KEditor.components['media'] = {\r\n        init: function (contentArea, container, component, keditor) {\r\n            flog('init \"media\" component', component);\r\n            \r\n            var options = keditor.options;\r\n            var componentContent = component.children('.keditor-component-content');\r\n            \r\n            var mediaBody = componentContent.find('.media-body');\r\n            mediaBody.addClass('clearfix');\r\n            \r\n            var mediaLeft = componentContent.find('.media-left');\r\n            var mediaLeftInner = componentContent.find('.media-left-inner');\r\n            if (mediaLeftInner.length === 0) {\r\n                mediaLeft.html('<div class=\"media-left-inner\">' + mediaLeft.html() + '</div>');\r\n            }\r\n            \r\n            if (!mediaBody.attr('id')) {\r\n                mediaBody.attr('id', keditor.generateId('component-text-content-inner'));\r\n            }\r\n            \r\n            mediaBody.prop('contenteditable', true);\r\n            mediaBody.on('input', function (e) {\r\n                if (typeof options.onComponentChanged === 'function') {\r\n                    options.onComponentChanged.call(keditor, e, component, contentArea);\r\n                }\r\n                \r\n                if (typeof options.onContainerChanged === 'function') {\r\n                    options.onContainerChanged.call(keditor, e, container, contentArea);\r\n                }\r\n                \r\n                if (typeof options.onContentChanged === 'function') {\r\n                    options.onContentChanged.call(keditor, e, contentArea);\r\n                }\r\n            });\r\n            \r\n            var editor = mediaBody.ckeditor(options.ckeditorOptions).editor;\r\n            editor.on('instanceReady', function () {\r\n                flog('CKEditor is ready', component);\r\n                \r\n                if (typeof options.onComponentReady === 'function') {\r\n                    options.onComponentReady.call(contentArea, component, editor);\r\n                }\r\n            });\r\n        },\r\n        \r\n        getContent: function (component, keditor) {\r\n            flog('getContent \"media\" component', component);\r\n            \r\n            var componentContent = component.find('.keditor-component-content');\r\n            var mediaBody = componentContent.find('.media-body');\r\n            \r\n            var id = mediaBody.attr('id');\r\n            var editor = CKEDITOR.instances[id];\r\n            if (editor) {\r\n                mediaBody.replaceWith('<div class=\"media-body clearfix\">' + editor.getData() + '</div>');\r\n            }\r\n            \r\n            return componentContent.html();\r\n        },\r\n        \r\n        destroy: function (component, keditor) {\r\n            flog('destroy \"text\" component', component);\r\n            \r\n            var id = component.find('.media-body').attr('id');\r\n            var editor = CKEDITOR.instances[id];\r\n            if (editor) {\r\n                editor.destroy();\r\n            }\r\n        },\r\n        \r\n        settingEnabled: true,\r\n        \r\n        settingTitle: 'Media Settings',\r\n        \r\n        initSettingForm: function (form, keditor) {\r\n            flog('initSettingForm \"media\" component');\r\n            \r\n            return $.ajax({\r\n                url: '/theme/apps/keditor-lib/componentMediaSettings.html',\r\n                type: 'get',\r\n                dataType: 'HTML',\r\n                success: function (resp) {\r\n                    form.html(resp);\r\n                    var txtLink = form.find('.photo-link');\r\n                    txtLink.on('change', function () {\r\n                        var link = this.value.trim();\r\n                        keditor.getSettingComponent().find('a').attr('href', link);\r\n                    });\r\n                    \r\n                    var cbbTarget = form.find('.photo-target');\r\n                    cbbTarget.on('change', function () {\r\n                        keditor.getSettingComponent().find('a').attr('target', this.value);\r\n                    });\r\n                    \r\n                    var chkLinkable = form.find('.photo-linkable');\r\n                    chkLinkable.on('click', function () {\r\n                        var img = keditor.getSettingComponent().find('img.media-object');\r\n                        \r\n                        if (chkLinkable.is(':checked')) {\r\n                            txtLink.prop('disabled', false);\r\n                            cbbTarget.prop('disabled', false);\r\n                            img.wrap('<a href=\"\"></a>');\r\n                        } else {\r\n                            txtLink.prop('disabled', true);\r\n                            cbbTarget.prop('disabled', true);\r\n                            img.unwrap('a');\r\n                        }\r\n                    });\r\n                    \r\n                    form.find('.photo-v-align').on('change', function () {\r\n                        var mediaLeft = keditor.getSettingComponent().find('.media-left');\r\n                        mediaLeft.css('vertical-align', this.value);\r\n                    });\r\n                    \r\n                    form.find('.photo-responsive').on('click', function () {\r\n                        keditor.getSettingComponent().find('img')[this.checked ? 'addClass' : 'removeClass']('img-responsive');\r\n                    });\r\n                    \r\n                    form.find('.photo-style').on('change', function () {\r\n                        var img = keditor.getSettingComponent().find('img.media-object');\r\n                        var val = this.value;\r\n                        \r\n                        img.removeClass('img-rounded img-circle img-thumbnail');\r\n                        if (val) {\r\n                            img.addClass(val);\r\n                        }\r\n                    });\r\n                    \r\n                    form.find('.photo-width').on('change', function () {\r\n                        var img = keditor.getSettingComponent().find('img.media-object');\r\n                        img.attr('width', this.value);\r\n                    });\r\n                    \r\n                    initMSelectImage(form.find('.photo-edit'), keditor, function (url, relativeUrl, fileType, hash) {\r\n                        var img = keditor.getSettingComponent().find('img.media-object');\r\n                        \r\n                        img.attr('src', '/_hashes/files/' + hash);\r\n                    });\r\n                    \r\n                    form.find('.left-width').on('change', function () {\r\n                        var mediaLeftInner = keditor.getSettingComponent().find('.media-left-inner');\r\n                        mediaLeftInner.css('width', this.value);\r\n                    });\r\n                }\r\n            });\r\n        },\r\n        \r\n        showSettingForm: function (form, component, keditor) {\r\n            flog('showSettingForm \"media\" component', component);\r\n            \r\n            var inputVAlign = form.find('.photo-v-align');\r\n            var inputResponsive = form.find('.photo-responsive');\r\n            var inputWidth = form.find('.photo-width');\r\n            var cbbStyle = form.find('.photo-style');\r\n            var txtLink = form.find('.photo-link');\r\n            var cbbTarget = form.find('.photo-target');\r\n            var chkLinkable = form.find('.photo-linkable');\r\n            \r\n            var img = component.find('img.media-object');\r\n            var mediaLeft = component.find('.media-left');\r\n            var mediaLeftInner = component.find('.media-left-inner');\r\n            \r\n            form.find('.left-width').val((mediaLeftInner.get(0).style.width || '').replace('px', ''));\r\n            \r\n            var a = img.parent('a');\r\n            if (a.length > 0) {\r\n                chkLinkable.prop('checked', true);\r\n                txtLink.prop('disabled', false).val(a.attr('href'));\r\n                cbbTarget.prop('disabled', false).val(a.attr('target'));\r\n            } else {\r\n                chkLinkable.prop('checked', false);\r\n                txtLink.prop('disabled', true).val('');\r\n                cbbTarget.prop('disabled', true).val('');\r\n            }\r\n            \r\n            var valign = mediaLeft.css('vertical-align') || 'top';\r\n            \r\n            if (img.hasClass('img-rounded')) {\r\n                cbbStyle.val('img-rounded');\r\n            } else if (img.hasClass('img-circle')) {\r\n                cbbStyle.val('img-circle');\r\n            } else if (img.hasClass('img-thumbnail')) {\r\n                cbbStyle.val('img-thumbnail');\r\n            } else {\r\n                cbbStyle.val('');\r\n            }\r\n            \r\n            inputVAlign.val(valign);\r\n            inputResponsive.prop('checked', img.hasClass('img-responsive'));\r\n            inputWidth.val(img.attr('width'));\r\n        }\r\n    };\r\n    \r\n})(jQuery);\r\n\r\n(function ($) {\n    var KEditor = $.keditor;\n    var flog = KEditor.log;\n    \n    KEditor.components['photo'] = {\n        init: function (contentArea, container, component, keditor) {\n            flog('init \"photo\" component', component);\n            \n            var componentContent = component.children('.keditor-component-content');\n            var img = componentContent.find('img');\n            \n            img.css('display', 'inline-block');\n            if (!img.css('vertical-align')) {\n                img.css('vertical-align', 'middle');\n            }\n            \n            img.on('load', function () {\n                var imgWidth = img.get(0).style.width;\n                var imgHeight = img.get(0).style.height;\n                \n                if (imgWidth && imgHeight) {\n                    img.attr({\n                        width: imgWidth,\n                        height: imgHeight\n                    }).css({\n                        width: '',\n                        height: ''\n                    });\n                }\n            });\n            \n            var options = keditor.options;\n            if (typeof options.onComponentReady === 'function') {\n                options.onComponentReady.call(contentArea, component);\n            }\n        },\n        \n        settingEnabled: true,\n        \n        settingTitle: 'Photo Settings',\n        \n        initSettingForm: function (form, keditor) {\n            flog('init \"photo\" settings', form, keditor);\n            \n            var self = this;\n            \n            return $.ajax({\n                url: '/theme/apps/keditor-lib/componentPhotoSettings.html',\n                type: 'get',\n                dataType: 'HTML',\n                success: function (resp) {\n                    form.html(resp);\n                    \n                    var txtLink = form.find('#photo-link');\n                    txtLink.on('change', function () {\n                        var link = this.value.trim();\n                        keditor.getSettingComponent().find('a').attr('href', link);\n                    });\n                    \n                    var cbbTarget = form.find('#photo-target');\n                    cbbTarget.on('change', function () {\n                        keditor.getSettingComponent().find('a').attr('target', this.value);\n                    });\n                    \n                    var chkLinkable = form.find('#photo-linkable');\n                    chkLinkable.on('click', function () {\n                        var img = keditor.getSettingComponent().find('img');\n                        \n                        if (chkLinkable.is(':checked')) {\n                            txtLink.prop('disabled', false);\n                            cbbTarget.prop('disabled', false);\n                            img.wrap('<a href=\"\"></a>');\n                        } else {\n                            txtLink.prop('disabled', true);\n                            cbbTarget.prop('disabled', true);\n                            img.unwrap('a');\n                        }\n                    });\n                    \n                    var inputAlign = form.find('#photo-align');\n                    inputAlign.on('change', function () {\n                        var panel = keditor.getSettingComponent().find('.photo-panel');\n                        panel.css('text-align', this.value);\n                    });\n                    \n                    var inputVAlign = form.find('#v-align');\n                    inputVAlign.on('change', function () {\n                        var panel = keditor.getSettingComponent().find('.photo-panel').find('img');\n                        panel.css('vertical-align', this.value);\n                    });\n                    \n                    var inputResponsive = form.find('#photo-responsive');\n                    inputResponsive.on('click', function () {\n                        keditor.getSettingComponent().find('img')[this.checked ? 'addClass' : 'removeClass']('img-responsive');\n                    });\n                    \n                    var cbbStyle = form.find('#photo-style');\n                    cbbStyle.on('change', function () {\n                        var img = keditor.getSettingComponent().find('img');\n                        var val = this.value;\n                        \n                        img.removeClass('img-rounded img-circle img-thumbnail');\n                        if (val) {\n                            img.addClass(val);\n                        }\n                    });\n                    \n                    var inputWidth = form.find('#photo-width');\n                    var inputHeight = form.find('#photo-height');\n                    inputWidth.on('change', function () {\n                        var img = keditor.getSettingComponent().find('img');\n                        var newWidth = +this.value;\n                        var newHeight = Math.round(newWidth / self.ratio);\n                        \n                        if (newWidth <= 0) {\n                            newWidth = self.width;\n                            newHeight = self.height;\n                            this.value = newWidth;\n                        }\n                        \n                        img.attr({\n                            'width': newWidth,\n                            'height': newHeight\n                        });\n                        inputHeight.val(newHeight);\n                    });\n                    inputHeight.on('change', function () {\n                        var img = keditor.getSettingComponent().find('img');\n                        var newHeight = +this.value;\n                        var newWidth = Math.round(newHeight * self.ratio);\n                        \n                        if (newHeight <= 0) {\n                            newWidth = self.width;\n                            newHeight = self.height;\n                            this.value = newHeight;\n                        }\n                        \n                        img.attr({\n                            'height': newHeight,\n                            'width': newWidth\n                        });\n                        inputWidth.val(newWidth);\n                    });\n                    \n                    form.find('#photo-alt-text').on('change', function () {\n                        var img = keditor.getSettingComponent().find('img');\n                        \n                        img.attr('alt', this.value);\n                    });\n                    \n                    initMSelectImage(form.find('#photo-edit'), keditor, function (url, relUrl, type, hash) {\n                        var img = keditor.getSettingComponent().find('img');\n                        var src = '/_hashes/files/' + hash;\n                        \n                        $('<img />').attr('src', src).load(function () {\n                            img.attr({\n                                width: this.width,\n                                height: this.height,\n                                src: src\n                            });\n                            self.ratio = this.width / this.height;\n                            self.width = this.width;\n                            self.height = this.height;\n                            inputWidth.val(this.width);\n                            inputHeight.val(this.height);\n                        });\n                    });\n                }\n            });\n        },\n        \n        showSettingForm: function (form, component, keditor) {\n            flog('showSettingForm \"photo\" component', component);\n            \n            var self = this;\n            var inputAlign = form.find('#photo-align');\n            var inputVAlign = form.find('#v-align');\n            var inputResponsive = form.find('#photo-responsive');\n            var inputWidth = form.find('#photo-width');\n            var inputHeight = form.find('#photo-height');\n            var cbbStyle = form.find('#photo-style');\n            var txtLink = form.find('#photo-link');\n            var cbbTarget = form.find('#photo-target');\n            var chkLinkable = form.find('#photo-linkable');\n            var txtAltText = form.find('#photo-alt-text');\n            \n            var panel = component.find('.photo-panel');\n            var img = panel.find('img');\n            \n            var a = img.parent('a');\n            if (a.length > 0) {\n                chkLinkable.prop('checked', true);\n                txtLink.prop('disabled', false).val(a.attr('href'));\n                cbbTarget.prop('disabled', false).val(a.attr('target'));\n            } else {\n                chkLinkable.prop('checked', false);\n                txtLink.prop('disabled', true).val('');\n                cbbTarget.prop('disabled', true).val('');\n            }\n            \n            var align = panel.css('text-align');\n            if (align !== 'right' || align !== 'center') {\n                align = 'left';\n            }\n            \n            var valign = img.css('vertical-align');\n            \n            if (img.hasClass('img-rounded')) {\n                cbbStyle.val('img-rounded');\n            } else if (img.hasClass('img-circle')) {\n                cbbStyle.val('img-circle');\n            } else if (img.hasClass('img-thumbnail')) {\n                cbbStyle.val('img-thumbnail');\n            } else {\n                cbbStyle.val('');\n            }\n            inputAlign.val(align);\n            inputVAlign.val(valign);\n            inputResponsive.prop('checked', img.hasClass('img-responsive'));\n            inputWidth.val(img.width());\n            inputHeight.val(img.height());\n            txtAltText.val(img.attr('alt') || '');\n            \n            $('<img />').attr('src', img.attr('src')).load(function () {\n                self.ratio = this.width / this.height;\n                self.width = this.width;\n                self.height = this.height;\n            });\n        }\n    };\n    \n})(jQuery);\n\r\n(function ($) {\r\n    var KEditor = $.keditor;\r\n    var contentEditor = $.contentEditor;\r\n    var flog = KEditor.log;\r\n    \r\n    CKEDITOR.disableAutoInline = true;\r\n    CKEDITOR.dtd.$removeEmpty['i'] = false;\r\n    \r\n    // Text component\r\n    // ---------------------------------------------------------------------\r\n    KEditor.components['text'] = {\r\n        init: function (contentArea, container, component, keditor) {\r\n            flog('init \"text\" component', component);\r\n            \r\n            var options = keditor.options;\r\n            \r\n            var componentContent = component.find('.keditor-component-content');\r\n            var ckeditorPlace = componentContent.find('.keditor-component-text-content-inner');\r\n            \r\n            if (ckeditorPlace.length === 0) {\r\n                var contentHtml = componentContent.html();\r\n                ckeditorPlace = $('<div class=\"keditor-component-text-content-inner clearfix\"></div>');\r\n                componentContent.html(ckeditorPlace);\r\n                ckeditorPlace.html(contentHtml);\r\n                ckeditorPlace.wrap('<div class=\"keditor-component-text-content\"></div>');\r\n            }\r\n            \r\n            if (!ckeditorPlace.attr('id')) {\r\n                ckeditorPlace.attr('id', keditor.generateId('component-text-content-inner'));\r\n            }\r\n            \r\n            ckeditorPlace.prop('contenteditable', true);\r\n            ckeditorPlace.on('input', function (e) {\r\n                if (typeof options.onComponentChanged === 'function') {\r\n                    options.onComponentChanged.call(keditor, e, component, contentArea);\r\n                }\r\n                \r\n                if (typeof options.onContainerChanged === 'function') {\r\n                    options.onContainerChanged.call(keditor, e, container, contentArea);\r\n                }\r\n                \r\n                if (typeof options.onContentChanged === 'function') {\r\n                    options.onContentChanged.call(keditor, e, contentArea);\r\n                }\r\n            });\r\n            \r\n            var editor = ckeditorPlace.ckeditor(options.ckeditorOptions).editor;\r\n            editor.on('instanceReady', function () {\r\n                flog('CKEditor is ready', component);\r\n                \r\n                if (typeof options.onComponentReady === 'function') {\r\n                    options.onComponentReady.call(contentArea, component, editor);\r\n                }\r\n            });\r\n        },\r\n        \r\n        getContent: function (component, keditor) {\r\n            flog('getContent \"text\" component', component);\r\n            \r\n            var componentContent = component.find('.keditor-component-content');\r\n            var componentTextContent = componentContent.find('.keditor-component-text-content');\r\n            \r\n            var id = componentTextContent.children().attr('id');\r\n            var editor = CKEDITOR.instances[id];\r\n            if (editor) {\r\n                componentTextContent.html('<div class=\"keditor-component-text-content-inner clearfix\">' + editor.getData() + '</div>');\r\n            }\r\n            \r\n            return componentContent.html();\r\n        },\r\n        \r\n        destroy: function (component, keditor) {\r\n            flog('destroy \"text\" component', component);\r\n            \r\n            var id = component.find('.keditor-component-content').attr('id');\r\n            var editor = CKEDITOR.instances[id];\r\n            if (editor) {\r\n                editor.destroy();\r\n            }\r\n        },\r\n        \r\n        settingEnabled: true,\r\n        \r\n        settingTitle: 'Text Settings',\r\n        \r\n        initSettingForm: function (form, keditor) {\r\n            flog('initSettingForm \"text\" component');\r\n            \r\n            return $.ajax({\r\n                url: '/theme/apps/keditor-lib/componentTextSettings.html',\r\n                type: 'get',\r\n                dataType: 'HTML',\r\n                success: function (resp) {\r\n                    form.html(resp);\r\n                    \r\n                    // =================================================================================\r\n                    // Backgrounds\r\n                    // =================================================================================\r\n                    initMSelectImage(form.find('.background-image-edit'), keditor, function (url, relUrl, type, hash) {\r\n                        var target = keditor.getSettingComponent().find('.keditor-component-text-content');\r\n                        var imageUrl = 'http://' + window.location.host + '/_hashes/files/' + hash;\r\n                        target.css('background-image', 'url(\"' + imageUrl + '\")');\r\n                        form.find('.background-image-previewer').attr('src', imageUrl);\r\n                    });\r\n                    form.find('.background-image-delete').on('click', function (e) {\r\n                        e.preventDefault();\r\n                        \r\n                        var target = keditor.getSettingComponent().find('.keditor-component-text-content');\r\n                        target.css('background-image', '');\r\n                        form.find('.background-image-previewer').attr('src', '/static/images/photo_holder.png');\r\n                    });\r\n                    \r\n                    var colorPicker = form.find('.txt-bg-color');\r\n                    contentEditor.initColorPicker(colorPicker, function (color) {\r\n                        var target = keditor.getSettingComponent().find('.keditor-component-text-content');\r\n                        target.css('background-color', color);\r\n                    });\r\n\r\n                    var textColorPicker = form.find('.txt-text-color');\r\n                    contentEditor.initColorPicker(textColorPicker, function (color) {\r\n                        var target = keditor.getSettingComponent().find('.keditor-component-text-content');\r\n                        target.css('color', color);\r\n                    });\r\n                    \r\n                    form.find('.select-bg-repeat').on('change', function () {\r\n                        var target = keditor.getSettingComponent().find('.keditor-component-text-content');\r\n                        \r\n                        target.css('background-repeat', this.value);\r\n                    });\r\n                    \r\n                    form.find('.select-bg-size').on('change', function () {\r\n                        var target = keditor.getSettingComponent().find('.keditor-component-text-content');\r\n                        \r\n                        target.css('background-size', this.value);\r\n                    });\r\n                    \r\n                    form.find('.select-bg-position').on('change', function () {\r\n                        var target = keditor.getSettingComponent().find('.keditor-component-text-content');\r\n                        \r\n                        target.css('background-position', this.value);\r\n                    });\r\n                    \r\n                    // =================================================================================\r\n                    // Padding\r\n                    // =================================================================================\r\n                    form.find('.txt-padding').each(function () {\r\n                        var txt = $(this);\r\n                        var styleName = txt.attr('data-style-name');\r\n                        \r\n                        txt.on('change', function () {\r\n                            var paddingValue = this.value || '';\r\n                            var target = keditor.getSettingComponent().find('.keditor-component-text-content').get(0);\r\n                            \r\n                            if (paddingValue.trim() === '') {\r\n                                target.style[styleName] = '';\r\n                            } else {\r\n                                if (isNaN(paddingValue)) {\r\n                                    paddingValue = 0;\r\n                                    this.value = paddingValue;\r\n                                }\r\n                                target.style[styleName] = paddingValue + 'px';\r\n                            }\r\n                        });\r\n                    });\r\n                    \r\n                    // =================================================================================\r\n                    // Margin\r\n                    // =================================================================================\r\n                    form.find('.txt-margin').each(function () {\r\n                        var txt = $(this);\r\n                        var styleName = txt.attr('data-style-name');\r\n                        \r\n                        txt.on('change', function () {\r\n                            var marginValue = this.value || '';\r\n                            var target = keditor.getSettingComponent().find('.keditor-component-text-content').get(0);\r\n                            \r\n                            if (marginValue.trim() === '') {\r\n                                target.style[styleName] = '';\r\n                            } else {\r\n                                if (isNaN(marginValue)) {\r\n                                    marginValue = 0;\r\n                                    this.value = marginValue;\r\n                                }\r\n                                target.style[styleName] = marginValue + 'px';\r\n                            }\r\n                        });\r\n                    });\r\n                    \r\n                    // =================================================================================\r\n                    // Width and Height\r\n                    // =================================================================================\r\n                    form.find('.txt-height').on('change', function () {\r\n                        var height = this.value || '';\r\n                        if (isNaN(height)) {\r\n                            height = '';\r\n                        }\r\n                        \r\n                        var target = keditor.getSettingComponent().find('.keditor-component-text-content');\r\n                        target.css('height', height);\r\n                    });\r\n                    \r\n                    form.find('.txt-min-height').on('change', function () {\r\n                        var minHeight = this.value || '';\r\n                        if (isNaN(minHeight)) {\r\n                            minHeight = '';\r\n                        }\r\n                        \r\n                        var target = keditor.getSettingComponent().find('.keditor-component-text-content');\r\n                        target.css('min-height', minHeight + 'px');\r\n                    });\r\n                    \r\n                    form.find('.txt-max-height').on('change', function () {\r\n                        var maxHeight = this.value || '';\r\n                        if (isNaN(maxHeight)) {\r\n                            maxHeight = '';\r\n                        }\r\n                        \r\n                        var target = keditor.getSettingComponent().find('.keditor-component-text-content');\r\n                        target.css('max-height', maxHeight + 'px');\r\n                    });\r\n                    \r\n                    form.find('.txt-width').on('change', function () {\r\n                        var width = this.value || '';\r\n                        if (isNaN(width)) {\r\n                            width = '';\r\n                        }\r\n                        \r\n                        var target = keditor.getSettingComponent().find('.keditor-component-text-content');\r\n                        target.css('width', width);\r\n                    });\r\n                    \r\n                    form.find('.txt-min-width').on('change', function () {\r\n                        var minWidth = this.value || '';\r\n                        if (isNaN(minWidth)) {\r\n                            minWidth = '';\r\n                        }\r\n                        \r\n                        var target = keditor.getSettingComponent().find('.keditor-component-text-content');\r\n                        target.css('min-width', minWidth + 'px');\r\n                    });\r\n                    \r\n                    form.find('.txt-max-width').on('change', function () {\r\n                        var maxWidth = this.value || '';\r\n                        if (isNaN(maxWidth)) {\r\n                            maxWidth = '';\r\n                        }\r\n                        \r\n                        var target = keditor.getSettingComponent().find('.keditor-component-text-content');\r\n                        target.css('max-width', maxWidth + 'px');\r\n                    });\r\n                }\r\n            });\r\n        },\r\n        \r\n        showSettingForm: function (form, component, keditor) {\r\n            flog('showSettingForm \"text\" component', component);\r\n            \r\n            var target = component.find('.keditor-component-text-content').get(0);\r\n            \r\n            var imageUrl = target.style.backgroundImage;\r\n            imageUrl = (imageUrl || '').replace(/^url\\(['\"]+(.+)['\"]+\\)$/, '$1');\r\n            form.find('.background-image-previewer').attr('src', imageUrl !== 'none' && imageUrl !== '' ? imageUrl : '/static/images/photo_holder.png');\r\n            \r\n            form.find('.select-bg-repeat').val(target.style.backgroundRepeat || 'repeat');\r\n            form.find('.select-bg-position').val(target.style.backgroundPosition || '0% 0%');\r\n            form.find('.select-bg-size').val(target.style.backgroundSize || 'auto');\r\n\r\n            if (target.style.backgroundColor){\r\n                form.find('.txt-bg-color').colorpicker('setValue', target.style.backgroundColor);\r\n            }\r\n            if (target.style.color){\r\n                form.find('.txt-text-color').colorpicker('setValue', target.style.color);\r\n            }\r\n\r\n            form.find('.txt-padding').each(function () {\r\n                var txt = $(this);\r\n                var styleName = txt.attr('data-style-name');\r\n                \r\n                txt.val((target.style[styleName] || '').replace('px', ''));\r\n            });\r\n            form.find('.txt-margin').each(function () {\r\n                var txt = $(this);\r\n                var styleName = txt.attr('data-style-name');\r\n                \r\n                txt.val((target.style[styleName] || '').replace('px', ''));\r\n            });\r\n            \r\n            form.find('.txt-height').val((target.style.height || '').replace('px', ''));\r\n            form.find('.txt-min-height').val((target.style.minHeight || '').replace('px', ''));\r\n            form.find('.txt-max-height').val((target.style.maxHeight || '').replace('px', ''));\r\n            form.find('.txt-width').val((target.style.width || '').replace('px', ''));\r\n            form.find('.txt-min-with').val((target.style.minWidth || '').replace('px', ''));\r\n            form.find('.txt-max-with').val((target.style.maxWidth || '').replace('px', ''));\r\n        }\r\n    };\r\n    \r\n})(jQuery);\r\n\r\n(function ($) {\r\n    var KEditor = $.keditor;\r\n    var flog = KEditor.log;\r\n    \r\n    KEditor.components['thumbnail'] = {\r\n        init: function (contentArea, container, component, keditor) {\r\n            flog('init \"thumbnail\" component', component);\r\n            \r\n            var options = keditor.options;\r\n            var componentContent = component.children('.keditor-component-content');\r\n            \r\n            var caption = componentContent.find('.caption');\r\n            caption.addClass('clearfix');\r\n            \r\n            var captionInner = caption.find('.caption-inner');\r\n            if (captionInner.length === 0) {\r\n                caption.html('<div class=\"caption-inner\">' + caption.html() + '</div>');\r\n                captionInner = caption.find('.caption-inner');\r\n            }\r\n            \r\n            if (!captionInner.attr('id')) {\r\n                captionInner.attr('id', keditor.generateId('component-text-content-inner'));\r\n            }\r\n            \r\n            captionInner.prop('contenteditable', true);\r\n            captionInner.on('input', function (e) {\r\n                if (typeof options.onComponentChanged === 'function') {\r\n                    options.onComponentChanged.call(keditor, e, component, contentArea);\r\n                }\r\n                \r\n                if (typeof options.onContainerChanged === 'function') {\r\n                    options.onContainerChanged.call(keditor, e, container, contentArea);\r\n                }\r\n                \r\n                if (typeof options.onContentChanged === 'function') {\r\n                    options.onContentChanged.call(keditor, e, contentArea);\r\n                }\r\n            });\r\n            \r\n            var editor = captionInner.ckeditor(options.ckeditorOptions).editor;\r\n            editor.on('instanceReady', function () {\r\n                flog('CKEditor is ready', component);\r\n                \r\n                if (typeof options.onComponentReady === 'function') {\r\n                    options.onComponentReady.call(contentArea, component, editor);\r\n                }\r\n            });\r\n        },\r\n        \r\n        getContent: function (component, keditor) {\r\n            flog('getContent \"thumbnail\" component', component);\r\n            \r\n            var componentContent = component.find('.keditor-component-content');\r\n            var caption = componentContent.find('.caption');\r\n            var captionInner = caption.find('.caption-inner');\r\n            \r\n            var id = captionInner.attr('id');\r\n            var editor = CKEDITOR.instances[id];\r\n            if (editor) {\r\n                caption.html(editor.getData());\r\n            }\r\n            \r\n            return componentContent.html();\r\n        },\r\n        \r\n        destroy: function (component, keditor) {\r\n            flog('destroy \"text\" component', component);\r\n            \r\n            var id = component.find('.caption-inner').attr('id');\r\n            var editor = CKEDITOR.instances[id];\r\n            if (editor) {\r\n                editor.destroy();\r\n            }\r\n        },\r\n        \r\n        settingEnabled: true,\r\n        \r\n        settingTitle: 'Thumbnail Settings',\r\n        \r\n        initSettingForm: function (form, keditor) {\r\n            flog('initSettingForm \"thumbnail\" component');\r\n            \r\n            return $.ajax({\r\n                url: '/theme/apps/keditor-lib/componentThumbnailSettings.html',\r\n                type: 'get',\r\n                dataType: 'HTML',\r\n                success: function (resp) {\r\n                    form.html(resp);\r\n                    \r\n                    initMSelectImage(form.find('.photo-edit'), keditor, function (url, relativeUrl, fileType, hash) {\r\n                        var img = keditor.getSettingComponent().find('.thumbnail img');\r\n                        \r\n                        img.attr('src', '/_hashes/files/' + hash);\r\n                    });\r\n                }\r\n            });\r\n        },\r\n        \r\n        showSettingForm: function (form, component, keditor) {\r\n            flog('showSettingForm \"thumbnail\" component', component);\r\n        }\r\n    };\r\n    \r\n})(jQuery);\r\n\r\n(function ($) {\r\n    var KEditor = $.keditor;\r\n    var flog = KEditor.log;\r\n    \r\n    KEditor.components['video'] = {\r\n        init: function (contentArea, container, component, keditor) {\r\n            flog('init \"video\" component', component);\r\n            \r\n            var self = this;\r\n            \r\n            var img = component.find('img[data-video-src]');\r\n            img.attr('id', keditor.generateId('component-video'));\r\n            \r\n            var wrapper = img.parent();\r\n            if (!wrapper.hasClass('video-wrapper')) {\r\n                img.wrap('<div class=\"video-wrapper\"></div>');\r\n                wrapper = img.parent();\r\n            }\r\n            \r\n            wrapper.attr('data-id', img.attr('id'));\r\n            wrapper.attr('data-autostart', img.attr('data-autostart'));\r\n            wrapper.attr('data-aspectratio', img.attr('data-aspectratio'));\r\n            wrapper.attr('data-video-src', img.attr('data-video-src'));\r\n            wrapper.attr('data-repeat', img.attr('data-repeat'));\r\n            wrapper.attr('data-controls', img.attr('data-controls'));\r\n            \r\n            $.getScriptOnce('/static/jwplayer/6.10/jwplayer.js', function () {\r\n                jwplayer.key = 'cXefLoB9RQlBo/XvVncatU90OaeJMXMOY/lamKrzOi0=';\r\n                self.buildJWVideoPlayerPreview(component);\r\n            });\r\n        },\r\n        \r\n        getContent: function (component) {\r\n            flog('getContent \"video\" component, component');\r\n            \r\n            var wrapper = component.find('.video-wrapper');\r\n            var html = '<img class=\"video-jw\" ';\r\n            html += '       id=\"' + this.componentId + '\" ';\r\n            html += '       src=\"' + wrapper.attr('data-video-src') + '/alt-640-360.png\" ';\r\n            html += '       data-autostart=\"' + wrapper.attr('data-autostart') + '\" ';\r\n            html += '       data-aspectratio=\"' + wrapper.attr('data-aspectratio') + '\" ';\r\n            html += '       data-video-src=\"' + wrapper.attr('data-video-src') + '\" ';\r\n            html += '       data-repeat=\"' + wrapper.attr('data-repeat') + '\" ';\r\n            html += '       data-controls=\"' + wrapper.attr('data-controls') + '\" />';\r\n            wrapper.html(html);\r\n            \r\n            return component.find('.keditor-component-content').html();\r\n        },\r\n        \r\n        settingEnabled: true,\r\n        \r\n        settingTitle: 'Video Settings',\r\n        \r\n        initSettingForm: function (form, keditor) {\r\n            flog('init \"video\" settings', form);\r\n            var self = this;\r\n            \r\n            return $.ajax({\r\n                url: '/theme/apps/keditor-lib/componentVideoSettings.html',\r\n                type: 'get',\r\n                dataType: 'HTML',\r\n                success: function (resp) {\r\n                    form.html(resp);\r\n                    \r\n                    var selectPicker = form.find('.select-border-style');\r\n                    selectPicker.on('change', function () {\r\n                        self.borderStyle = this.value;\r\n                        keditor.getSettingComponent().find('.video-wrapper').css('border-style', this.value);\r\n                    });\r\n                    \r\n                    var txtBorderWidth = form.find('.border-width');\r\n                    txtBorderWidth.on('change', function () {\r\n                        var width = this.value;\r\n                        if (isNaN(width) || width < 0) {\r\n                            width = 1;\r\n                            this.value = width;\r\n                        }\r\n                        \r\n                        self.borderWidth = width;\r\n                        keditor.getSettingComponent().find('.video-wrapper').css('border-width', width);\r\n                    });\r\n                    \r\n                    var colorPicker = form.find('.borderColor');\r\n                    $.contentEditor.initColorPicker(colorPicker, function (color) {\r\n                        self.borderColor = color;\r\n                        keditor.getSettingComponent().find('.video-wrapper').css('border-color', color);\r\n                    });\r\n                    \r\n                    form.find('.chk-border').on('click', function () {\r\n                        selectPicker.prop('disabled', !this.checked);\r\n                        txtBorderWidth.prop('disabled', !this.checked);\r\n                        colorPicker.prop('disabled', !this.checked);\r\n                        \r\n                        if (!this.checked) {\r\n                            keditor.getSettingComponent().find('.video-wrapper').css('border', '');\r\n                            selectPicker.val('');\r\n                            txtBorderWidth.val('');\r\n                            colorPicker.val('');\r\n                        }\r\n                    });\r\n                    \r\n                    var btnVideoFileInput = form.find('.btn-videoFileInput');\r\n                    btnVideoFileInput.mselect({\r\n                        contentTypes: ['video'],\r\n                        bs3Modal: true,\r\n                        pagePath: keditor.options.pagePath,\r\n                        basePath: keditor.options.basePath,\r\n                        onSelectFile: function (url) {\r\n                            keditor.getSettingComponent().find('.video-wrapper').attr('data-video-src', url);\r\n                            self.refreshVideoPlayerPreview(keditor);\r\n                        }\r\n                    });\r\n                    \r\n                    var autoplayToggle = form.find('#video-autoplay');\r\n                    autoplayToggle.on('click', function () {\r\n                        keditor.getSettingComponent().find('.video-wrapper').attr('data-autostart', this.checked);\r\n                        self.buildJWVideoPlayerPreview(keditor);\r\n                    });\r\n                    \r\n                    var loopToggle = form.find('#video-loop');\r\n                    loopToggle.on('click', function () {\r\n                        keditor.getSettingComponent().find('.video-wrapper').attr('data-repeat', this.checked);\r\n                        self.buildJWVideoPlayerPreview(keditor);\r\n                    });\r\n                    \r\n                    var ratio = form.find('.video-ratio');\r\n                    ratio.on('click', function (e) {\r\n                        if (this.checked) {\r\n                            keditor.getSettingComponent().find('.video-wrapper').attr('data-aspectratio', this.value);\r\n                            self.buildJWVideoPlayerPreview(keditor);\r\n                        }\r\n                    });\r\n                    \r\n                    var showcontrolsToggle = form.find('#video-showcontrols');\r\n                    showcontrolsToggle.on('click', function (e) {\r\n                        keditor.getSettingComponent().find('.video-wrapper').attr('data-controls', this.checked);\r\n                        self.buildJWVideoPlayerPreview(keditor);\r\n                    });\r\n                }\r\n            });\r\n        },\r\n        \r\n        showSettingForm: function (form, component, keditor) {\r\n            flog('showSettingForm \"video\" component', form, component);\r\n            \r\n            var wrapper = component.find('.video-wrapper');\r\n            var borderWidth = wrapper.css('border-width') || '';\r\n            var isBorderEnabled = borderWidth !== '0px';\r\n            \r\n            var chkBorder = form.find('.chk-border');\r\n            var txtBorderWidth = form.find('.border-width');\r\n            var colorPicker = form.find('.color-picker');\r\n            var selectPicker = form.find('.select-border-style');\r\n            \r\n            chkBorder.prop('checked', isBorderEnabled);\r\n            selectPicker.prop('disabled', !isBorderEnabled).val(wrapper.css('border-style'));\r\n            txtBorderWidth.prop('disabled', !isBorderEnabled).val(isBorderEnabled ? borderWidth.replace('px', '') : '');\r\n            colorPicker.colorpicker(isBorderEnabled ? 'enable' : 'disable').colorpicker('setValue', isBorderEnabled ? wrapper.css('border-color') : '');\r\n            \r\n            form.find('#video-autoplay').prop('checked', wrapper.attr('data-autostart') === 'true');\r\n            form.find('#video-loop').prop('checked', wrapper.attr('data-repeat') === 'true');\r\n            form.find('.video-ratio').filter('[value=\"' + wrapper.attr('data-aspectratio') + '\"]').prop('checked', true);\r\n            form.find('#video-showcontrols').prop('checked', wrapper.attr('data-controls') === 'true');\r\n        },\r\n        \r\n        buildJWVideoPlayerPreview: function (component) {\r\n            if (!component.jquery) {\r\n                component = component.getSettingComponent();\r\n            }\r\n            var wrapper = component.find('.video-wrapper');\r\n            var src = wrapper.attr('data-video-src');\r\n            var autostart = wrapper.attr('data-autostart');\r\n            var repeat = wrapper.attr('data-repeat');\r\n            var aspectratio = wrapper.attr('data-aspectratio');\r\n            var controls = wrapper.attr('data-controls');\r\n            var playerInstance = jwplayer(wrapper.attr('data-id'));\r\n            var posterHref = src + '/alt-640-360.png';\r\n            \r\n            flog(\"buildJWPlayer\", src, \"aspectratio=\", aspectratio);\r\n            playerInstance.setup({\r\n                autostart: autostart,\r\n                repeat: repeat,\r\n                controls: controls,\r\n                aspectratio: aspectratio,\r\n                flashplayer: \"/static/jwplayer/6.10/jwplayer.flash.swf\",\r\n                html5player: \"/static/jwplayer/6.10/jwplayer.html5.js\",\r\n                width: \"100%\",\r\n                androidhls: true, //enable hls on android 4.1+\r\n                playlist: [{\r\n                    image: posterHref,\r\n                    sources: [{\r\n                        file: src\r\n                    }\r\n                        , {\r\n                            file: src + \"/../alt-640-360.webm\"\r\n                        }, {\r\n                            file: src + \"/../alt-640-360.m4v\"\r\n                        }]\r\n                }]\r\n                , primary: \"flash\"\r\n            });\r\n            \r\n            playerInstance.onReady(function () {\r\n                flog('jwplayer preview init done');\r\n            });\r\n        },\r\n        \r\n        refreshVideoPlayerPreview: function (keditor) {\r\n            var wrapper = keditor.getSettingComponent().find('.video-wrapper');\r\n            var playerInstance = jwplayer(wrapper.attr('data-id'));\r\n            var src = wrapper.attr('data-video-src');\r\n            \r\n            playerInstance.load([{\r\n                file: src\r\n            }]);\r\n            playerInstance.play();\r\n        }\r\n    };\r\n})(jQuery);\r\n\r\n(function ($) {\n    var KEditor = $.keditor;\n    var flog = KEditor.log;\n    \n    KEditor.components['vimeo'] = {\n        getContent: function (component, keditor) {\n            flog('getContent \"vimeo\" component', component);\n            \n            var componentContent = component.children('.keditor-component-content');\n            componentContent.find('.vimeo-cover').remove();\n            \n            return componentContent.html();\n        },\n        \n        settingEnabled: true,\n        \n        settingTitle: 'Vimeo Settings',\n        \n        initSettingForm: function (form, keditor) {\n            flog('init \"vimeo\" settings', form);\n            \n            return $.ajax({\n                url: '/theme/apps/keditor-lib/componentVimeoSettings.html',\n                type: 'get',\n                dataType: 'HTML',\n                success: function (resp) {\n                    form.html(resp);\n                    \n                    var btnEdit = form.find('.btn-vimeo-edit');\n                    btnEdit.on('click', function (e) {\n                        e.preventDefault();\n                        \n                        var inputData = prompt('Please enter Vimeo URL in here:');\n                        var vimeoRegex = /https?:\\/\\/(?:www\\.|player\\.)?vimeo.com\\/(?:channels\\/(?:\\w+\\/)?|groups\\/([^\\/]*)\\/videos\\/|album\\/(\\d+)\\/video\\/|video\\/|)(\\d+)(?:$|\\/|\\?)/;\n                        var match = inputData.match(vimeoRegex);\n                        if (match && match[1]) {\n                            keditor.getSettingComponent().find('.embed-responsive-item').attr('src', 'https://player.vimeo.com/video/' + match[1] + '?byline=0&portrait=0&badge=0');\n                        } else {\n                            alert('Your Vimeo URL is invalid!');\n                        }\n                    });\n                    \n                    var btn169 = form.find('.btn-vimeo-169');\n                    btn169.on('click', function (e) {\n                        e.preventDefault();\n                        \n                        keditor.getSettingComponent().find('.embed-responsive').removeClass('embed-responsive-4by3').addClass('embed-responsive-16by9');\n                    });\n                    \n                    var btn43 = form.find('.btn-vimeo-43');\n                    btn43.on('click', function (e) {\n                        e.preventDefault();\n                        \n                        keditor.getSettingComponent().find('.embed-responsive').removeClass('embed-responsive-16by9').addClass('embed-responsive-4by3');\n                    });\n                    \n                    var chkAutoplay = form.find('#vimeo-autoplay');\n                    chkAutoplay.on('click', function () {\n                        var embedItem = keditor.getSettingComponent().find('.embed-responsive-item');\n                        var currentUrl = embedItem.attr('src');\n                        var newUrl = (currentUrl.replace(/(\\?.+)+/, '')) + '?byline=0&portrait=0&badge=0&autoplay=' + (chkAutoplay.is(':checked') ? 1 : 0);\n                        \n                        flog('Current url: ' + currentUrl, 'New url: ' + newUrl);\n                        embedItem.attr('src', newUrl);\n                    });\n                }\n            });\n        },\n        \n        showSettingForm: function (form, component, keditor) {\n            flog('showSettingForm \"vimeo\" component', component);\n            \n            var embedItem = component.find('.embed-responsive-item');\n            var chkAutoplay = form.find('#vimeo-autoplay');\n            var src = embedItem.attr('src');\n            \n            chkAutoplay.prop('checked', src.indexOf('autoplay=1') !== -1);\n        }\n    };\n    \n})(jQuery);\n\r\n(function ($) {\n    var KEditor = $.keditor;\n    var flog = KEditor.log;\n    \n    KEditor.components['youtube'] = {\n        init: function (contentArea, container, component, keditor) {\n            flog('init \"youtube\" component', component);\n            \n            component.find('iframe').attr('allowfullscreen', 'allowfullscreen');\n        },\n        \n        getContent: function (component, keditor) {\n            flog('getContent \"youtube\" component', component);\n            \n            var componentContent = component.children('.keditor-component-content');\n            componentContent.find('.youtube-cover').remove();\n            \n            return componentContent.html();\n        },\n        \n        settingEnabled: true,\n        \n        settingTitle: 'Youtube Settings',\n        \n        initSettingForm: function (form, keditor) {\n            flog('init \"youtube\" settings', form);\n            \n            return $.ajax({\n                url: '/theme/apps/keditor-lib/componentYoutubeSettings.html',\n                type: 'get',\n                dataType: 'HTML',\n                success: function (resp) {\n                    form.html(resp);\n                    \n                    var btnEdit = form.find('.btn-youtube-edit');\n                    btnEdit.on('click', function (e) {\n                        e.preventDefault();\n                        \n                        var inputData = prompt('Please enter Youtube URL in here:');\n                        var youtubeRegex = /^(?:http(?:s)?:\\/\\/)?(?:www\\.)?(?:m\\.)?(?:youtu\\.be\\/|youtube\\.com\\/(?:(?:watch)?\\?(?:.*&)?v(?:i)?=|(?:embed|v|vi|user)\\/))([^\\?&\\\"'>]+)/;\n                        var match = inputData.match(youtubeRegex);\n                        if (match && match[1]) {\n                            keditor.getSettingComponent().find('.embed-responsive-item').attr('src', 'https://www.youtube.com/embed/' + match[1]);\n                        } else {\n                            alert('Your Youtube URL is invalid!');\n                        }\n                    });\n                    \n                    var btn169 = form.find('.btn-youtube-169');\n                    btn169.on('click', function (e) {\n                        e.preventDefault();\n                        \n                        keditor.getSettingComponent().find('.embed-responsive').removeClass('embed-responsive-4by3').addClass('embed-responsive-16by9');\n                    });\n                    \n                    var btn43 = form.find('.btn-youtube-43');\n                    btn43.on('click', function (e) {\n                        e.preventDefault();\n                        \n                        keditor.getSettingComponent().find('.embed-responsive').removeClass('embed-responsive-16by9').addClass('embed-responsive-4by3');\n                    });\n                    \n                    var chkAutoplay = form.find('#youtube-autoplay');\n                    chkAutoplay.on('click', function () {\n                        var embedItem = keditor.getSettingComponent().find('.embed-responsive-item');\n                        var currentUrl = embedItem.attr('src');\n                        var newUrl = (currentUrl.replace(/(\\?.+)+/, '')) + '?autoplay=' + (chkAutoplay.is(':checked') ? 1 : 0);\n                        \n                        flog('Current url: ' + currentUrl, 'New url: ' + newUrl);\n                        embedItem.attr('src', newUrl);\n                    });\n                }\n            });\n        },\n        \n        showSettingForm: function (form, component, keditor) {\n            flog('showSettingForm \"youtube\" component', component);\n            \n            var embedItem = component.find('.embed-responsive-item');\n            var chkAutoplay = form.find('#youtube-autoplay');\n            var src = embedItem.attr('src');\n            \n            chkAutoplay.prop('checked', src.indexOf('autoplay=1') !== -1);\n        }\n    };\n    \n})(jQuery);\n"]}