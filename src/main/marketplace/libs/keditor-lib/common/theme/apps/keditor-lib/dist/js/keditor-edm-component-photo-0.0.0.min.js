/**!
 * KEditor - Kademi content editor
 * @copyright: Kademi (http://kademi.co)
 * @author: Kademi (http://kademi.co)
 * @version: 0.0.0
 * @dependencies: $, $.fn.draggable, $.fn.droppable, $.fn.sortable, Bootstrap (optional), FontAwesome (optional)
 */
!function(t){var n=t.keditor,o=t.edmEditor,i=n.log;n.components.photo={init:function(t,n,o,e){i('init "photo" component',o);var a=this,r=o.find("img");a.adjustWidthForImg(r,r.hasClass("full-width"));var d=e.options;"function"==typeof d.onComponentReady&&d.onComponentReady.call(t,o)},settingEnabled:!0,settingTitle:"Photo Settings",initSettingForm:function(n,e){i('init "photo" settings',n);var a=this;return t.ajax({url:"/theme/apps/keditor-lib/edmComponentPhotoSettings.html",type:"get",dataType:"HTML",success:function(t){n.html(t),n=n.find(".form-horizontal"),o.initDefaultComponentControls(n,e,{onPaddingChanged:function(t,n){if("padding-left"===t||"padding-right"===t){var o=e.getSettingComponent().find("img");a.adjustWidthForImg(o,o.hasClass("full-width"))}}});var i=n.find("#photo-link");i.on("change",function(){var t=this.value.trim(),n=new RegExp("^[a-zA-Z0-9_/%:/./-]+$"),o=i.next(),a=i.closest(".form-group");n.test(t)?(e.getSettingComponent().find("a").attr("href",t),o.hide(),a.removeClass("has-error")):(o.show(),a.addClass("has-error"))});var r=n.find("#photo-target");r.on("change",function(){e.getSettingComponent().find("a").attr("target",this.value)});var d=n.find("#photo-linkable");d.on("click",function(){var t=e.getSettingComponent().find("img");d.is(":checked")?(i.prop("disabled",!1),r.prop("disabled",!1),t.wrap('<a href="" style="text-decoration: none;"></a>'),t.css("border","0")):(i.prop("disabled",!0),r.prop("disabled",!0),t.unwrap("a"))});var s=n.find("#photo-edit");s.mselect({contentType:"image",bs3Modal:!0,pagePath:e.options.pagePath,basePath:e.options.basePath,onSelectFile:function(t,n,o,i){var r=e.getSettingComponent().find("img");r.attr("src","http://"+window.location.host+"/_hashes/files/"+i),a.adjustWidthForImg(r,!0)}});var h=n.find("#photo-alt");h.on("change",function(){e.getSettingComponent().find("img").attr("alt",this.value)});var l=n.find("#photo-fullwidth");l.on("click",function(){var t=e.getSettingComponent().find("img");t[this.checked?"addClass":"removeClass"]("full-width"),a.adjustWidthForImg(t,this.checked)});var p=n.find("#photo-align");p.on("change",function(){var t=e.getSettingComponent().find(".text-wrapper");t.attr("align",this.value)})}})},showSettingForm:function(t,n,e){i('showSettingForm "photo" component',n),o.showDefaultComponentControls(t,n,e);var a=n.find(".text-wrapper"),r=n.find("img"),d=t.find("#photo-alt");d.val(r.attr("alt")||"");var s=t.find("#photo-fullwidth");s.prop("checked",r.hasClass("full-width"));var h=t.find("#photo-link"),l=t.find("#photo-target"),p=t.find("#photo-linkable"),g=t.find("#photo-align");g.val(a.attr("align")||"left"),h.next().hide(),h.closest(".form-group").removeClass("has-error");var f=r.parent("a");f.length>0?(p.prop("checked",!0),h.prop("disabled",!1).val(f.attr("href")),l.prop("disabled",!1).val(f.attr("target"))):(p.prop("checked",!1),h.prop("disabled",!0).val(""),l.prop("disabled",!0).val(""))},adjustWidthForImg:function(n,o){i("adjustWidthForImg",n,o),n.css("display","none"),t("<img />").attr("src",n.attr("src")).load(function(){var t=this.width,i=this.height,e=t/i,a=n.parent();a.is("a")&&(a=a.parent());var r=a.width();n.attr({width:o?r:t,height:o?r/e:i}),n.css("display","block")})},onWithChanged:function(t,n,o){var i=this,e=t.find("img");i.adjustWidthForImg(e,e.hasClass("full-width"))}}}(jQuery);
//# sourceMappingURL=keditor-edm-component-photo-0.0.0.min.js.map
