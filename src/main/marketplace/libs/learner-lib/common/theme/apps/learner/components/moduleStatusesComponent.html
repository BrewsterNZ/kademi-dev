#if( !$height )
#set( $height = 300 )
#end

#if( !$tableTitle || $tableTitle=="" )
#set( $tableTitle = "Module Statuses Table" )
#end

#set ($queryTableId = "query-component-tbody-" + $formatter.randomGuid)
#set ($queryCompId = "query-component-" + $formatter.randomGuid)
#set ($resp = $applications.get("learner-lib").call("buildTableModuleStatuses", $programCode, $courseCode, $moduleCode, $complete))
<div class="panel panel-default panel-query-table" id="$queryCompId" style="height: $!{height}px; min-height: 0; overflow-y: auto" data-items-per-page="$itemsPerPage" data-queryname="$query" data-querytype="$queryType">
    <div class="panel-heading">
        <i class="fa fa-table"></i> $tableTitle
    </div>
    <div class="panel-body">
        <div class="table-responsive">
            <table class="table table-striped table-condensed">
                <thead>
                <tr>
                   <th>Title</th>
                   <th>Name</th>
                   <th>Start date</th>
                   <th>Status</th>
                </tr>
                </thead>
                <tbody id="$queryTableId">
                    #if ($resp.hits.totalHits < 1)
                    <tr>
                        <td colspan="99">No result</td>
                    </tr>
                    #end
                    #foreach($hit in $resp.hits.hits)
                        #set ($usr = $applications.userApp.findUserResourceById($hit.source.profile.toString()))
                        <tr>
                            <td>$hit.source.moduleTitle</td>
                            #if ($linkedProfile == "true")
                            <td><a href="/custs/${usr.name}">$!applications.userApp.findUserResourceById($hit.source.profile.toString()).extProfileBean.formattedName()</a></td>
                            #else
                            <td>$!usr.extProfileBean.formattedName()</td>
                            #end
                            <td>$!formatter.formatDate($formatter.parseDate($hit.source.createdDate))</td>
                            #if ($hit.source.complete)
                            <td><i class="fa fa-check-circle text-success"></i></td>
                            #else
                            <td>$hit.source.percentComplete%</td>
                            #end
                        </tr>
                    #end
                </tbody>
            </table>
        </div>
    </div>
    <div class="panel-footer">
        <ul class="pagination">
        </ul>
    </div>

</div>


