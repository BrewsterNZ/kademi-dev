<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns='http://www.w3.org/1999/xhtml'>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
        <meta name='templateName' value='/theme/apps/user/dashboard.html'/>
        <title>Dashboard</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
        <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans:400,400italic,600,600italic,700,700italic" type="text/css" />

        <script type="text/javascript">
            var pageInitFunctions = new Array();
        </script>

        <script src="/templates/themes/bootstrap320/js/common.js" >//</script>
        <script src="/static/js/jquery-1.8.1.min.js" >//</script>
        <script src="/static/js/jquery.pjax.js" type="text/javascript" >//</script>
        <script src="/templates/themes/bootstrap320/js/jqBootstrapValidation.js" >//</script>
        <script src="/templates/themes/bootstrap320/js/jqExtras.js" >//</script>
        <script src="/templates/themes/bootstrap320/js/theme.js" >//</script>
        <script src="/templates/themes/bootstrap320/js/bootstrap.min.js" >//</script>
        <script src="/static/js/jquery.cookie.js" type="text/javascript" >//</script>
        <script src="/static/jquery-ui/1.10.4/js/jquery-ui-1.10.4.custom.min.js" type="text/javascript" >//</script>
        <script src="/static/js/jquery.timeago.js" type="text/javascript" >//</script>
        <script src="/static/jquery.forms/1.0.1/jquery.forms-1.0.1.js" type="text/javascript" >//</script>
        <script src="/theme/js/jquery.user.js" type="text/javascript" >//</script>
        <script src="/static/jquery.comments/1.0.2/jquery.comments-1.0.2.js" type="text/javascript" >//</script>
        <!--
                <script type="text/javascript" src="/static/js/toolbars.js" >//</script>
                <script type="text/javascript" src="/static/ckeditor440/ckeditor.js" >//</script>
                <script type="text/javascript" src="/static/ckeditor440/adapters/jquery.js" >//</script>
        -->
        <script src="/static/js/jquery.placeholder.js" type="text/javascript" >//</script>
        <script src="/static/js/jquery.autogrow-textarea-1.0.0.js" type="text/javascript" >//</script>
        <script src="/theme/js/init-theme.js" type="text/javascript" >//</script>
        <script src="/static/bootstrap-msg/0.3/bootstrap-msg.min.js" type="text/javascript" >//</script>
        <script language="javascript" type="text/javascript" >jQuery(function ($) {
                //themeCssFiles.push("/templates/themes/fuse/theme.less");
                //initTheme();
            });</script>
        <!-- Le styles -->
        <script src="/theme/js/hhl.js" type="text/javascript" >//</script>
        <script src="/static/history/jquery.history.js" type="text/javascript" >//</script>
        <link rel="stylesheet" href="/static/bootstrap-msg/0.3/bootstrap-msg.min.css" type="text/css" />
        <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
        <!--[if lt IE 9]>
                  <script src="/js/html5shiv.js"></script>
                <![endif]-->
        <!--[if lt IE 8]>
                    <link href="/css/bootstrap-ie7.css" rel="stylesheet">
                <![endif]-->
        <link rel='stylesheet' type='text/css' media='all' href='/theme/--theme--less--bootstrap.less,--theme--theme-params.less,--theme--hhl.less,.compile.less?1293987934'/>
        <link rel='stylesheet' type='text/css' media='screen' href='/theme/--static--history--jquery.history.css,.compile.less?1293987934'/>


    </head>
    <body class=" dashboard ">
        <script src="/static/js/respond.src.js">//</script>  

        <div class="navbar navbar-fixed-top navbar-inverse" id="nav-top" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".navbar-main-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>                    
                    <a class="brand navbar-brand logo" href="/">
                        <img src="/theme/img/logo.png" />
                    </a>

                </div>


                <div class="navbar-collapse collapse navbar-main-collapse">
                    <div class="pull-right">

                        <ul class="nav nav-pills navbar-left">                       
                            <li class="active"><a class="nav-menuDashboard" href="/dashboard" shape="rect">Dashboard</a></li>
                            <li class=""><a class="nav-menuMyLearning" href="/myLearning" shape="rect">My Learning</a></li>
                            <li class=""><a class="nav-menuMyRewards" href="/rewards" shape="rect">My Rewards</a></li>
                            <li class=""><a class="nav-menuMyBlogs" href="/blogs/" shape="rect">Blogs</a></li>
                            <li class=""><a class="nav-menu-mycalendars" href="/Calendars" shape="rect">Calendars</a></li>
                        </ul>  

                        <ul class="nav nav-pills navbar-left">
                            <li class="dropdown">
                                <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                                    Brad
                                    <b class="caret"></b>
                                </a>
                                <ul class="dropdown-menu">
                                    <li>
                                        <a href="/profile">Profile</a>
                                    </li>                                    
                                    <li>
                                        <a href="#" class="logout">Logout</a>
                                    </li>
                                </ul>
                            </li>
                        </ul>          
                    </div>
                </div><!--/.nav-collapse -->                                          
            </div>
        </div>


        <div class="main-content" id="maincontentContainer">
            <div id="main-content-inner">
                <div class="">
                    <div class="">
                        <div class="col-md-8 dash-primary">
                            <!-- Start dashboardPrimary  -->
                            <div class="modules">    


                                <script src="/theme/apps/learner/moduleList.js" type="text/javascript">//</script>
                                <script type="text/javascript" src="/static/dotdotdot/1.6.16/jquery.dotdotdot.js" >//</script>

                                <script type="text/javascript">
                                    $(function () {
                                        scrollProgress();
                                        initDotDotDot();
                                    });
                                </script>

                                <hr/>

                                <p class='lead'>Recent articles</p>

                                <div class="row">    
                                    <div class="col-lg-4 col-md-6 col-sm-6 large">

                                        <div class='tile'>
                                            <div style="background-image: url('/blogs/new/microsoft-office-for-mac-release-date-rumours-and-images-new-office-for-mac-images-leak/Yosemite_ready_Office.jpg/alt-300-300.png')" class="tile-image">
                                                <a href="/blogs/new/microsoft-office-for-mac-release-date-rumours-and-images-new-office-for-mac-images-leak/" class="requiresUser"><span>View</span></a>
                                            </div>

                                            <div class="tile-content">
                                                <h3><a href="/blogs/new/microsoft-office-for-mac-release-date-rumours-and-images-new-office-for-mac-images-leak/" class="requiresUser">Microsoft Office for Mac release date, rumours and images: New Office for 
                                                        Mac images leak</a></h3>
                                                <p></p>
                                            </div>
                                        </div>
                                    </div>   
                                    <div class="col-lg-4 col-md-6 col-sm-6 large">

                                        <div class='tile'>
                                            <div style="background-image: url('/blogs/new/microsoft-plans-a-standalone-office-2016-for-end-of-2015/microsoft-office-100031290-large.png/alt-300-300.png')" class="tile-image">
                                                <a href="/blogs/new/microsoft-plans-a-standalone-office-2016-for-end-of-2015/" class="requiresUser"><span>View</span></a>
                                            </div>

                                            <div class="tile-content">
                                                <h3><a href="/blogs/new/microsoft-plans-a-standalone-office-2016-for-end-of-2015/" class="requiresUser">microsoft plans a standalone office 2016 for end of 2015</a></h3>
                                                <p></p>
                                            </div>
                                        </div>
                                    </div>   
                                    <div class="col-lg-4 col-md-6 col-sm-6 large">

                                        <div class='tile'>
                                            <div style="background-image: url('/blogs/new/watch-your-attachments-microsoft-office-bug-lets-hackers-take-over-computers/microsoft-office-hack-powerpoint.si.jpg/alt-300-300.png')" class="tile-image">
                                                <a href="/blogs/new/watch-your-attachments-microsoft-office-bug-lets-hackers-take-over-computers/" class="requiresUser"><span>View</span></a>
                                            </div>

                                            <div class="tile-content">
                                                <h3><a href="/blogs/new/watch-your-attachments-microsoft-office-bug-lets-hackers-take-over-computers/" class="requiresUser">Watch your attachments: Microsoft Office bug lets hackers take over 
                                                        computers</a></h3>
                                                <p></p>
                                            </div>
                                        </div>
                                    </div>   
                                </div> 


                                <!-- End dashboardPrimary  -->



                            </div>
                            <div class="col-md-4 dash-secondary">

                                <script type="text/javascript" src="/static/reload-fragment/1.0.0/jquery.reload-fragment.js" >//</script>

                                <div class="dashboard-upcoming-events" id="dashboard-upcoming-events">

                                    <div class="panel panel-default">
                                        <div class="panel-heading">
                                            <h3 class="panel-title">Upcoming events</h3>
                                        </div>
                                        <div class="panel-body">
                                            <div class="alert alert-info" role="alert">
                                                <a href="/Calendars/webinars/excel-webinar">Learn how to use Microsoft Excel with our experts online</a>; <abbr title="2014-11-26T00:00:00.000+13:00" class="timeago">Wed Nov 26 00:00:00 NZDT 2014</abbr>
                                            </div>
                                        </div>    
                                    </div>           
                                </div>
                                <script type="text/javascript">
                                    $(function () {
                                        jQuery.timeago.settings.strings.inPast = "time has elapsed";
                                        jQuery.timeago.settings.allowFuture = true;
                                        $("abbr.timeago").timeago();
                                        $(".dashboard-upcoming-events").on("click", ".invite-accept", function (e) {
                                            e.preventDefault();
                                            if (confirm("Are you sure you would like to accept this invitation?")) {
                                                rsvp("ACCEPTED", $(e.target).closest("a").attr("href"));
                                            }
                                        });
                                        $(".dashboard-upcoming-events").on("click", ".invite-decline", function (e) {
                                            e.preventDefault();
                                            if (confirm("Are you sure you would like to decline this invitation?")) {
                                                rsvp("DECLINED", $(e.target).closest("a").attr("href"));
                                            }
                                        });
                                        function rsvp(partStat, href) {
                                            flog("rsvp", partStat, href);
                                            $.ajax({
                                                type: 'POST',
                                                url: href,
                                                dataType: "json",
                                                data: {
                                                    rsvp: partStat
                                                },
                                                success: function (data) {
                                                    Msg.info("Invitation RSVP processed ok");
                                                    $("#dashboard-upcoming-events").reloadFragment({
                                                        whenComplete: function () {
                                                            $("abbr.timeago").timeago();
                                                        }
                                                    });
                                                },
                                                error: function (resp) {
                                                    Msg.error("An error occured processing the event");
                                                }
                                            });
                                        }
                                    });
                                </script>
                                <div class="panel panel-default">
                                    <div class="panel-heading">Community comments</div>
                                    <div class="panel-body stream-container">
                                        <div class="stream">
                                            <ul class="barList stream-items">
                                                <li>
                                                    <em>Loading comments..</em>
                                                </li>                                                                     
                                            </ul>            
                                        </div>
                                    </div>
                                </div>


                                <script type="text/javascript">
                                    pageInitFunctions.push(function () {
                                        initPosts("/");
                                    });

                                    function initPosts(basePath) {
                                        $.getJSON(basePath + "_postSearch?a", function (response) {
                                            log("got posts response", response);
                                            processPosts(response);
                                        });
                                    }

                                    function processPosts(comments) {
                                        $(".barList").html("");
                                        if (comments) {
                                            if (comments.length > 0) {
                                                comments.sort(dateOrd);
                                                var cookieAuth = "?miltonUserUrl=" + $.cookie("miltonUserUrl");
                                                cookieAuth += "&miltonUserUrlHash=" + $.cookie("miltonUserUrlHash");
                                                for (i = 0; i < comments.length; i++) {
                                                    var comment = comments[i];
                                                    var dt = new Date(comment.date);
                                                    var url = "http://" + comment.contentDomain + comment.contentHref + cookieAuth;
                                                    displayPost(comment.user, dt, comment.notes, comment.contentTitle, url); // pageTitle and pagePath are only present for aggregated results
                                                }
                                                jQuery(".barList abbr").timeago();
                                            } else {
                                                $(".barList").html("<li>No recent posts</li>");
                                            }
                                        }
                                    }

                                    function displayPost(user, date, comment, pageTitle, pagePath) {
                                        if (user == null) {
                                            log("missing user, ignore");
                                            return;
                                        }
                                        log("user", user);
                                        var li = $("<li>");
                                        var manageUserHref = "manageUsers/" + user.userId;
                                        if (user.photoHash) {
                                            li.append("<a class='profilePic' href='" + manageUserHref + "'><img src='/_hashes/files/" + user.photoHash + "' alt='' /></a>");
                                        } else {
                                            li.append("<a class='profilePic' href='" + manageUserHref + "'><img src='/templates/apps/user/profile.png' alt='' /></a>");
                                        }
                                        li.append(user.name + " posted in <a target='_blank' class='module' href='" + pagePath + "'><span>" + pageTitle + "</span></a>");
                                        var formattedDate = date.toISOString();
                                        var commentHtml = "<div class='post'>";
                                        commentHtml += "<p>" + comment + "</p>";
                                        commentHtml += "<em><abbr class='timeago' title='" + formattedDate + "'>" + formattedDate + "</abbr></em>";
                                        commentHtml += "</div>";
                                        li.append(commentHtml);

                                        li.append();
                                        $(".barList").append(li);
                                    }

                                </script>                </div>
                        </div>
                    </div>
                    <script type="text/javascript">
                        $(function () {
                            $('.dashboard-alert').bind('closed.bs.alert', function (e) {
                                href = $(this).closest("div").find("a.msg").attr("href");
                                if (href) {
                                    ackAlert(href);
                                }
                            })

                        });

                        function ackAlert(href) {
                            $.ajax({
                                type: 'POST',
                                url: href,
                                dataType: "json",
                                data: {
                                    ack: true
                                },
                                success: function (data) {
                                    flog("acked", data);
                                },
                                error: function (resp, textStatus, errorThrown) {
                                    alert("Error querying the list of organisations");
                                }
                            });
                        }
                    </script>
                </div>
            </div> <!-- /container -->


            <script type='text/javascript' src='/static/inline-edit/inline-edit.js'>// inserted by ContentApp</script>
            <link href='/static/inline-edit/inline-edit.css' rel='stylesheet' type='text/css' />
            <script type='text/javascript' src='/static/common/jquery.debounce-1.0.5.js'>// inserted by ContentApp</script>
            <!-- hard coded into ContentApp at the moment, sorry :( -->

            <script>
                $(function () {
                    // allow page templates to add a container around the whole content area
                    $("body.add-container").find("#maincontentContainer").addClass("container");
                });
            </script>


    </body>
</html>