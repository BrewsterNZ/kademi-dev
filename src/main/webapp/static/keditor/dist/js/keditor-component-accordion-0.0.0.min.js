/**!
 * KEditor - Kademi content editor
 * @copyright: Kademi (http://kademi.co)
 * @author: Kademi (http://kademi.co)
 * @version: 0.0.0
 * @dependencies: $, $.fn.draggable, $.fn.droppable, $.fn.sortable, Bootstrap (optional), FontAwesome (optional)
 */
!function(n){var t=n.keditor,e=t.log;t.components.accordion={settingEnabled:!0,settingTitle:"Accordion Settings",init:function(t,a,o,i){var d=i.options,c=i.generateId("accordion"),l=o.children(".keditor-component-content");l.find(".accordionWrap .panel-group").attr("id",c),l.find(".accordionWrap a[data-toggle]").attr("data-parent","#"+c);var r=l.find(".panel");r.each(function(t,e){var a=n(e),o=i.generateId("heading"+t),d=i.generateId("collapse"+t);a.find(".panel-heading").attr("id",o),a.find(".panel-collapse").attr("aria-labelledby",o).attr("id",d);var c=a.find("a[data-toggle]").html();a.find("a[data-toggle]").attr("href","#"+d).attr("aria-controls","#"+d),-1===c.indexOf("<div>")&&a.find("a[data-toggle]").html("<div>"+c+"</div>")}),l.find(".accordionWrap .panel-collapse").collapse("show"),l.find(".panel-footer, .btnAddAccordionItem").removeClass("hide"),l.find(".panel-title a div").prop("contenteditable",!0),l.find(".panel-collapse .panel-body").prop("contenteditable",!0),l.find(".panel-title a div, .panel-collapse .panel-body").on("input",function(n){"function"==typeof d.onComponentChanged&&d.onComponentChanged.call(t,n,o),"function"==typeof d.onContainerChanged&&d.onContainerChanged.call(t,n,a),"function"==typeof d.onContentChanged&&d.onContentChanged.call(t,n)});var p=l.find(".panel-title a div, .panel-collapse .panel-body").ckeditor(d.ckeditorOptions).editor;p.on("instanceReady",function(){e("CKEditor is ready",o),"function"==typeof d.onComponentReady&&d.onComponentReady.call(t,o,p)}),n(document).off("click",".btnDeleteAccordionItem").on("click",".btnDeleteAccordionItem",function(t){if(t.preventDefault(),confirm("Are you sure you want to delete this item?")){var e=l.find(".panel").length;e>1?n(this).parents(".panel").remove():Msg.error("You cant delete the last item")}}),n(document).off("click",".btnAddAccordionItem").on("click",".btnAddAccordionItem",function(n){n.preventDefault();var a=l.find(".panel").first().clone(),c=i.generateId("heading"),r=i.generateId("collapse");a.find(".panel-heading").attr("id",c),a.find(".panel-collapse").attr("aria-labelledby",c).attr("id",r),a.find("a[data-toggle]").attr("href","#"+r),l.find(".accordionWrap .panel-group").append(a);var p=a.find(".panel-title a div, .panel-collapse .panel-body").ckeditor(d.ckeditorOptions).editor;p.on("instanceReady",function(){e("CKEditor is ready",o),"function"==typeof d.onComponentReady&&d.onComponentReady.call(t,o,p)})})},getContent:function(t,e){var a=t.children(".keditor-component-content");return a.find(".panel-title a div").each(function(){var t=n(this).html();n(this).parent("a").html(t)}),a.find(".panel-collapse .panel-body").each(function(){var t=n(this).html();n(this).replaceWith('<div class="panel-body">'+t+"</div>")}),"true"==t.attr("data-initial-collapsed")&&a.find(".panel").each(function(){var t=n(this).find(".panel-heading a"),e=n(this).find(".panel-collapse");e.addClass("collapse").attr("aria-expanded","false").removeClass("in"),t.addClass("collapsed").attr("aria-expanded","false")}),a.find(".panel-footer, .btnAddAccordionItem").addClass("hide"),a.html()},destroy:function(n,t){e('destroy "text" component',n);var a=n.find(".keditor-component-content").attr("id"),o=CKEDITOR.instances[a];o&&o.destroy()},initSettingForm:function(t,a){return e('init "accordion" settings',t),n.ajax({url:"/static/keditor/componentAccordionSettings.html",type:"get",dataType:"HTML",success:function(e){t.html(e),t.find(".collapsedAll").on("click",function(){var n=a.getSettingComponent();n.attr("data-initial-collapsed",this.checked)}),t.find(".panelStyle").on("change",function(n){var t=a.getSettingComponent(),e=t.attr("data-panel-style")||"panel-default";t.attr("data-panel-style",this.value),t.find(".panel").removeClass(e).addClass(this.value)}),n.getStyleOnce("/static/bootstrap-iconpicker/1.7.0/css/bootstrap-iconpicker.min.css"),n.getScriptOnce("/static/bootstrap-iconpicker/1.7.0/js/iconset/iconset-fontawesome-4.2.0.min.js",function(){n.getScriptOnce("/static/bootstrap-iconpicker/1.7.0/js/bootstrap-iconpicker.min.js",function(){t.find(".btn-collapsed-icon, .btn-expanded-icon").iconpicker({iconset:"fontawesome",cols:10,rows:4,placement:"left"}),t.find(".btn-collapsed-icon").on("change",function(n){var t=a.getSettingComponent(),e=t.find("[data-dynamic-href]");t.attr("data-collapsed-icon",n.icon),a.initDynamicContent(e)}),t.find(".btn-expanded-icon").on("change",function(n){var t=a.getSettingComponent(),e=t.find("[data-dynamic-href]");t.attr("data-expanded-icon",n.icon),a.initDynamicContent(e)})})})}})},showSettingForm:function(t,a,o){e('showSettingForm "Accordion" component');var i=o.getDataAttributes(a,["data-type"],!1);t.find(".collapsedAll").prop("checked","true"==a.attr("data-initial-collapsed")),t.find(".panelStyle").val(a.attr("data-panel-style")),n.getScriptOnce("/static/bootstrap-iconpicker/1.7.0/js/iconset/iconset-fontawesome-4.2.0.min.js",function(){n.getScriptOnce("/static/bootstrap-iconpicker/1.7.0/js/bootstrap-iconpicker.min.js",function(){var n=i["data-collapsed-icon"]||"fa-caret-up";t.find(".btn-collapsed-icon").find("i").attr("class","fa "+n).end().find("input").val(n);var e=i["data-expanded-icon"]||"fa-caret-down";t.find(".btn-expanded-icon").find("i").attr("class","fa "+e).end().find("input").val(e)})})}}}(jQuery);
//# sourceMappingURL=keditor-component-accordion-0.0.0.min.js.map
