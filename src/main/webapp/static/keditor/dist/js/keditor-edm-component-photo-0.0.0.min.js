/**!
 * KEditor - Kademi content editor
 * @copyright: Kademi (http://kademi.co)
 * @author: Kademi (http://kademi.co)
 * @version: 0.0.0
 * @dependencies: $, $.fn.draggable, $.fn.droppable, $.fn.sortable, Bootstrap (optional), FontAwesome (optional)
 */
!function(t){var o=t.keditor,i=t.edmEditor,a=o.log;o.components.photo={init:function(t,o,i,e){a('init "photo" component',i);var n=this,l=i.find("img");n.adjustWidthForImg(l,l.hasClass("full-width"));var s=e.options;"function"==typeof s.onComponentReady&&s.onComponentReady.call(t,i)},settingEnabled:!0,settingTitle:"Photo Settings",initSettingForm:function(t,o){a('initSettingForm "photo" component');var e=this;t.append('<form class="form-horizontal">   <div class="form-group photo-edit-wrapper">       <div class="col-sm-12">           <button type="button" class="btn btn-block btn-primary" id="photo-edit">Change Photo</button>       </div>   </div>   <div class="form-group photo-alt-wrapper">       <label for="photo-alt" class="col-sm-12">Alt text</label>       <div class="col-sm-12">           <input type="text" id="photo-alt" class="form-control" />       </div>   </div>   <div class="form-group">       <label for="photo-fullwidth" class="col-sm-12">Full width</label>       <div class="col-sm-12">           <input type="checkbox" id="photo-fullwidth" />       </div>   </div>   <div class="form-group">       <label for="photo-width" class="col-sm-12">Linkable</label>       <div class="col-sm-12">           <input type="checkbox" id="photo-linkable" />       </div>   </div>   <div class="form-group">       <label for="photo-height" class="col-sm-12">Link</label>       <div class="col-sm-12">           <input type="text" id="photo-link" class="form-control" disabled="disabled" />           <span class="help-block" style="display: none;">Link is invalid</span>       </div>   </div>   <div class="form-group">       <label for="photo-height" class="col-sm-12">Open link in</label>       <div class="col-sm-12">           <select class="form-control" id="photo-target" disabled="disabled">               <option value="" selected="selected">Current tab/window</option>               <option value="_blank">New tab/window</option>           </select>       </div>   </div></form>');var n=t.find("#photo-link");n.on("change",function(){var t=this.value.trim(),i=new RegExp("^[a-zA-Z0-9_/%:/./-]+$"),a=n.next(),e=n.closest(".form-group");i.test(t)?(o.getSettingComponent().find("a").attr("href",t),a.hide(),e.removeClass("has-error")):(a.show(),e.addClass("has-error"))});var l=t.find("#photo-target");l.on("change",function(){o.getSettingComponent().find("a").attr("target",this.value)});var s=t.find("#photo-linkable");s.on("click",function(){var t=o.getSettingComponent().find("img");s.is(":checked")?(n.prop("disabled",!1),l.prop("disabled",!1),t.wrap('<a href="" style="text-decoration: none;"></a>'),t.css("border","0")):(n.prop("disabled",!0),l.prop("disabled",!0),t.unwrap("a"))});var d=t.find("#photo-edit");d.mselect({contentTypes:["image"],bs3Modal:!0,pagePath:o.options.pagePath,basePath:o.options.basePath,onSelectFile:function(t,i,a,n){var l=o.getSettingComponent().find("img");l.attr("src","http://"+window.location.host+"/_hashes/files/"+n),e.adjustWidthForImg(l,!0)}});var r=t.find("#photo-alt");r.on("change",function(){o.getSettingComponent().find("img").attr("alt",this.value)});var h=t.find("#photo-fullwidth");h.on("click",function(){var t=o.getSettingComponent().find("img");t[this.checked?"addClass":"removeClass"]("full-width"),e.adjustWidthForImg(t,this.checked)}),t=t.find("form"),i.initDefaultComponentControls(t,o,{onPaddingChanged:function(t,i){if("padding-left"===t||"padding-right"===t){var a=o.getSettingComponent().find("img");e.adjustWidthForImg(a,a.hasClass("full-width"))}}})},showSettingForm:function(t,o,e){a('showSettingForm "photo" component',o),i.showDefaultComponentControls(t,o,e);var n=o.find("img"),l=t.find("#photo-alt");l.val(n.attr("alt")||"");var s=t.find("#photo-fullwidth");s.prop("checked",n.hasClass("full-width"));var d=t.find("#photo-link"),r=t.find("#photo-target"),h=t.find("#photo-linkable");d.next().hide(),d.closest(".form-group").removeClass("has-error");var p=n.parent("a");p.length>0?(h.prop("checked",!0),d.prop("disabled",!1).val(p.attr("href")),r.prop("disabled",!1).val(p.attr("target"))):(h.prop("checked",!1),d.prop("disabled",!0).val(""),r.prop("disabled",!0).val(""))},setWidthForImg:function(t,o,i,a,e){t.css("display","none");var n=t.parent();n.is("a")&&(n=n.parent());var l=n.width();t.attr({width:e?l:o,height:e?l/a:i}),t.css("display","block")},adjustWidthForImg:function(o,i){a("adjustWidthForImg",o,i);var e=this,n=o.data("realWidth"),l=o.data("realHeight"),s=o.data("ratio");n&&l&&s?e.setWidthForImg(o,n,l,s,i):t("<img />").attr("src",o.attr("src")).load(function(){var t=this.width,a=this.height,n=t/a;o.data("realWidth",t),o.data("realHeight",a),o.data("ratio",n),e.setWidthForImg(o,t,a,n,i)})},onWithChanged:function(t,o,i){var a=this,e=t.find("img");a.adjustWidthForImg(e,e.hasClass("full-width"))}}}(jQuery);
//# sourceMappingURL=keditor-edm-component-photo-0.0.0.min.js.map
