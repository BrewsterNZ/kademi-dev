/**!
 * KEditor - Kademi content editor
 * @copyright: Kademi (http://kademi.co)
 * @author: Kademi (http://kademi.co)
 * @version: 0.0.0
 * @dependencies: $, $.fn.draggable, $.fn.droppable, $.fn.sortable, Bootstrap (optional), FontAwesome (optional)
 */
!function(t){var i=t.keditor,n=i.log;i.components.photo={init:function(t,i,e,o){n('init "photo" component',e);var a=e.children(".keditor-component-content"),h=a.find("img");h.css("display","inline-block"),h.css("vertical-align")||h.css("vertical-align","middle");var s=o.options;"function"==typeof s.onComponentReady&&s.onComponentReady.call(t,e)},settingEnabled:!0,settingTitle:"Photo Settings",initSettingForm:function(i,e){n('init "photo" settings',i,e);var o=this;e.options;return t.ajax({url:"/static/keditor/componentPhotoSettings.html",type:"get",dataType:"HTML",success:function(n){i.html(n);var a=i.find("#photo-link");a.on("change",function(){var t=this.value.trim(),i=/(https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9]\.[^\s]{2,})/,n=a.next(),o=a.closest(".form-group");i.test(t)?(e.getSettingComponent().find("a").attr("href",t),n.hide(),o.removeClass("has-error")):(n.show(),o.addClass("has-error"))});var h=i.find("#photo-target");h.on("change",function(){e.getSettingComponent().find("a").attr("target",this.value)});var s=i.find("#photo-linkable");s.on("click",function(){var t=e.getSettingComponent().find("img");s.is(":checked")?(a.prop("disabled",!1),h.prop("disabled",!1),t.wrap('<a href=""></a>')):(a.prop("disabled",!0),h.prop("disabled",!0),t.unwrap("a"))});var r=i.find("#photo-align");r.on("change",function(){var t=e.getSettingComponent().find(".photo-panel");t.css("text-align",this.value)});var d=i.find("#v-align");d.on("change",function(){var t=e.getSettingComponent().find(".photo-panel").find("img");t.css("vertical-align",this.value)});var l=i.find("#photo-responsive");l.on("click",function(){e.getSettingComponent().find("img")[this.checked?"addClass":"removeClass"]("img-responsive")});var g=i.find("#photo-style");g.on("change",function(){var t=e.getSettingComponent().find("img"),i=this.value;t.removeClass("img-rounded img-circle img-thumbnail"),i&&t.addClass(i)});var p=i.find("#photo-width"),c=i.find("#photo-height");p.on("change",function(){var t=e.getSettingComponent().find("img"),i=+this.value,n=Math.round(i/o.ratio);0>=i&&(i=o.width,n=o.height,this.value=i),t.css({width:i,height:n}),c.val(n)}),c.on("change",function(){var t=e.getSettingComponent().find("img"),i=+this.value,n=Math.round(i*o.ratio);0>=i&&(n=o.width,i=o.height,this.value=i),t.css({height:i,width:n}),p.val(n)});var v=i.find("#photo-edit");v.mselect({contentTypes:["image"],bs3Modal:!0,pagePath:e.options.pagePath,basePath:e.options.basePath,onSelectFile:function(i,n,a,h){var s=e.getSettingComponent().find("img"),r="/_hashes/files/"+h;t("<img />").attr("src",r).load(function(){s.attr("src",r).css({width:this.width,height:this.height}),o.ratio=this.width/this.height,o.width=this.width,o.height=this.height,p.val(this.width),c.val(this.height)})}})}})},showSettingForm:function(i,e,o){n('showSettingForm "photo" component',e);var a=this,h=i.find("#photo-align"),s=i.find("#v-align"),r=i.find("#photo-responsive"),d=i.find("#photo-width"),l=i.find("#photo-height"),g=i.find("#photo-style"),p=i.find("#photo-link"),c=i.find("#photo-target"),v=i.find("#photo-linkable");p.next().hide(),p.closest(".form-group").removeClass("has-error");var f=e.find(".photo-panel"),m=f.find("img"),u=m.parent("a");u.length>0?(v.prop("checked",!0),p.prop("disabled",!1).val(u.attr("href")),c.prop("disabled",!1).val(u.attr("target"))):(v.prop("checked",!1),p.prop("disabled",!0).val(""),c.prop("disabled",!0).val(""));var w=f.css("text-align");"right"===w&&"center"===w||(w="left");var C=m.css("vertical-align");m.hasClass("img-rounded")?g.val("img-rounded"):m.hasClass("img-circle")?g.val("img-circle"):m.hasClass("img-thumbnail")?g.val("img-thumbnail"):g.val(""),h.val(w),s.val(C),r.prop("checked",m.hasClass("img-responsive")),d.val(m.width()),l.val(m.height()),t("<img />").attr("src",m.attr("src")).load(function(){a.ratio=this.width/this.height,a.width=this.width,a.height=this.height})}}}(jQuery);
//# sourceMappingURL=keditor-component-photo-0.0.0.min.js.map
