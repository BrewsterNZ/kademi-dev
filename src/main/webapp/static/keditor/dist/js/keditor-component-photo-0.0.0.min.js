/**!
 * KEditor - Kademi content editor
 * @copyright: Kademi (http://kademi.co)
 * @author: Kademi (http://kademi.co)
 * @version: 0.0.0
 * @dependencies: $, $.fn.draggable, $.fn.droppable, $.fn.sortable, Bootstrap (optional), FontAwesome (optional)
 */
!function(t){var i=t.keditor,n=i.log;i.components.photo={init:function(t,i,e,o){n('init "photo" component',e);var a=e.children(".keditor-component-content"),h=a.find("img");h.css("display","inline-block"),h.css("vertical-align")||h.css("vertical-align","middle");var s=o.options;"function"==typeof s.onComponentReady&&s.onComponentReady.call(t,e)},settingEnabled:!0,settingTitle:"Photo Settings",initSettingForm:function(i,e){n('init "photo" settings',i,e);var o=this,a=e.options;return t.ajax({url:"/static/keditor/componentPhotoSettings.html",type:"get",dataType:"HTML",success:function(t){i.html(t);var n=i.find("#photo-link");n.on("change",function(){var t=this.value.trim(),i=new RegExp("^[a-zA-Z0-9_/%:/./-]+$"),o=n.next(),a=n.closest(".form-group");i.test(t)?(e.getSettingComponent().find("a").attr("href",t),o.hide(),a.removeClass("has-error")):(o.show(),a.addClass("has-error"))});var h=i.find("#photo-target");h.on("change",function(){e.getSettingComponent().find("a").attr("target",this.value)});var s=i.find("#photo-linkable");s.on("click",function(){var t=e.getSettingComponent().find("img");s.is(":checked")?(n.prop("disabled",!1),h.prop("disabled",!1),t.wrap('<a href=""></a>')):(n.prop("disabled",!0),h.prop("disabled",!0),t.unwrap("a"))});var r=i.find("#photo-edit");r.mselect({contentTypes:["image"],bs3Modal:!0,pagePath:a.pagePath,basePath:a.basePath,onSelectFile:function(t,n,h,s){var r=e.getSettingComponent().find("img");r.attr("src","/_hashes/files/"+s),o.showSettingForm(i,e.getSettingComponent(),a)}});var l=i.find("#photo-align");l.on("change",function(){var t=e.getSettingComponent().find(".photo-panel");t.css("text-align",this.value)});var d=i.find("#v-align");d.on("change",function(){var t=e.getSettingComponent().find(".photo-panel").find("img");t.css("vertical-align",this.value)});var g=i.find("#photo-responsive");g.on("click",function(){e.getSettingComponent().find("img")[this.checked?"addClass":"removeClass"]("img-responsive")});var p=i.find("#photo-style");p.on("change",function(){var t=e.getSettingComponent().find("img"),i=this.value;t.removeClass("img-rounded img-circle img-thumbnail"),i&&t.addClass(i)});var c=i.find("#photo-width"),v=i.find("#photo-height");c.on("change",function(){var t=e.getSettingComponent().find("img"),i=+this.value,n=Math.round(i/o.ratio);0>=i&&(i=o.width,n=o.height,this.value=i),t.css({width:i,height:n}),v.val(n)}),v.on("change",function(){var t=e.getSettingComponent().find("img"),i=+this.value,n=Math.round(i*o.ratio);0>=i&&(n=o.width,i=o.height,this.value=i),t.css({height:i,width:n}),c.val(n)})}})},showSettingForm:function(i,e,o){n('showSettingForm "photo" component',e);var a=this,h=i.find("#photo-align"),s=i.find("#v-align"),r=i.find("#photo-responsive"),l=i.find("#photo-width"),d=i.find("#photo-height"),g=i.find("#photo-style"),p=i.find("#photo-link"),c=i.find("#photo-target"),v=i.find("#photo-linkable");p.next().hide(),p.closest(".form-group").removeClass("has-error");var f=e.find(".photo-panel"),m=f.find("img"),u=m.parent("a");u.length>0?(v.prop("checked",!0),p.prop("disabled",!1).val(u.attr("href")),c.prop("disabled",!1).val(u.attr("target"))):(v.prop("checked",!1),p.prop("disabled",!0).val(""),c.prop("disabled",!0).val(""));var C=f.css("text-align");"right"===C&&"center"===C||(C="left");var b=m.css("vertical-align");m.hasClass("img-rounded")?g.val("img-rounded"):m.hasClass("img-circle")?g.val("img-circle"):m.hasClass("img-thumbnail")?g.val("img-thumbnail"):g.val(""),h.val(C),s.val(b),r.prop("checked",m.hasClass("img-responsive")),l.val(m.width()),d.val(m.height()),t("<img />").attr("src",m.attr("src")).load(function(){a.ratio=this.width/this.height,a.width=this.width,a.height=this.height})}}}(jQuery);
//# sourceMappingURL=keditor-component-photo-0.0.0.min.js.map
