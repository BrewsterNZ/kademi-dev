/**!
 * KEditor - Kademi content editor
 * @copyright: Kademi (http://kademi.co)
 * @author: Kademi (http://kademi.co)
 * @version: 0.0.0
 * @dependencies: $, $.fn.draggable, $.fn.droppable, $.fn.sortable, Bootstrap (optional), FontAwesome (optional)
 */
!function(o){var t=o.keditor,i=t.log;t.components.photo={init:function(o,t,e,n){i('init "photo" component',e);var l=e.children(".keditor-component-content"),a=l.find("img");a.css("display","inline-block"),a.css("vertical-align")||a.css("vertical-align","middle");var s=n.options;"function"==typeof s.onComponentReady&&s.onComponentReady.call(o,e)},settingEnabled:!0,settingTitle:"Photo Settings",initSettingForm:function(o,t){i('initSettingForm "photo" component');var e=this,n=t.options;o.append('<form class="form-horizontal">   <div class="form-group">       <div class="col-sm-12">           <button type="button" class="btn btn-block btn-primary" id="photo-edit">Change Photo</button>       </div>   </div>   <div class="form-group">       <label for="photo-align" class="col-sm-12">Align</label>       <div class="col-sm-12">           <select id="photo-align" class="form-control">               <option value="left">Left</option>               <option value="center">Center</option>               <option value="right">Right</option>           </select>       </div>   </div>   <div class="form-group">       <label for="vertical-alignment" class="col-sm-12">V Align</label>       <div class="col-sm-12">           <select class="form-control" id="v-align">               <option value="top">Top</option>               <option value="middle">Middle</option>               <option value="bottom">Bottom</option>           </select>       </div>   </div>   <div class="form-group">       <label for="photo-style" class="col-sm-12">Style</label>       <div class="col-sm-12">           <select id="photo-style" class="form-control">               <option value="">None</option>               <option value="img-rounded">Rounded</option>               <option value="img-circle">Circle</option>               <option value="img-thumbnail">Thumbnail</option>           </select>       </div>   </div>   <div class="form-group">       <label for="photo-responsive" class="col-sm-12">Responsive</label>       <div class="col-sm-12">           <input type="checkbox" id="photo-responsive" />       </div>   </div>   <div class="form-group">       <label for="photo-width" class="col-sm-12">Width</label>       <div class="col-sm-12">           <input type="number" id="photo-width" class="form-control" />       </div>   </div>   <div class="form-group">       <label for="photo-height" class="col-sm-12">Height</label>       <div class="col-sm-12">           <input type="number" id="photo-height" class="form-control" />       </div>   </div>   <div class="form-group">       <label for="photo-width" class="col-sm-12">Linkable</label>       <div class="col-sm-12">           <input type="checkbox" id="photo-linkable" />       </div>   </div>   <div class="form-group">       <label for="photo-height" class="col-sm-12">Link</label>       <div class="col-sm-12">           <input type="text" id="photo-link" class="form-control" disabled="disabled" />           <span class="help-block" style="display: none;">Link is invalid</span>       </div>   </div>   <div class="form-group">       <label for="photo-height" class="col-sm-12">Open link in</label>       <div class="col-sm-12">           <select class="form-control" id="photo-target" disabled="disabled">               <option value="" selected="selected">Current tab/window</option>               <option value="_blank">New tab/window</option>           </select>       </div>   </div></form>');var l=o.find("#photo-link");l.on("change",function(){var o=this.value.trim(),i=new RegExp("^[a-zA-Z0-9_/%:/./-]+$"),e=l.next(),n=l.closest(".form-group");i.test(o)?(t.getSettingComponent().find("a").attr("href",o),e.hide(),n.removeClass("has-error")):(e.show(),n.addClass("has-error"))});var a=o.find("#photo-target");a.on("change",function(){t.getSettingComponent().find("a").attr("target",this.value)});var s=o.find("#photo-linkable");s.on("click",function(){var o=t.getSettingComponent().find("img");s.is(":checked")?(l.prop("disabled",!1),a.prop("disabled",!1),o.wrap('<a href=""></a>')):(l.prop("disabled",!0),a.prop("disabled",!0),o.unwrap("a"))});var d=o.find("#photo-edit");d.mselect({contentTypes:["image"],bs3Modal:!0,pagePath:n.pagePath,basePath:n.basePath,onSelectFile:function(i,l,a,s){var d=t.getSettingComponent().find("img");d.attr("src","/_hashes/files/"+s),e.showSettingForm(o,t.getSettingComponent(),n)}});var r=o.find("#photo-align");r.on("change",function(){var o=t.getSettingComponent().find(".photo-panel");o.css("text-align",this.value)});var c=o.find("#v-align");c.on("change",function(){var o=t.getSettingComponent().find(".photo-panel").find("img");o.css("vertical-align",this.value)});var p=o.find("#photo-responsive");p.on("click",function(){t.getSettingComponent().find("img")[this.checked?"addClass":"removeClass"]("img-responsive")});var h=o.find("#photo-style");h.on("change",function(){var o=t.getSettingComponent().find("img"),i=this.value;o.removeClass("img-rounded img-circle img-thumbnail"),i&&o.addClass(i)});var v=o.find("#photo-width"),g=o.find("#photo-height");v.on("change",function(){var o=t.getSettingComponent().find("img"),i=+this.value,n=Math.round(i/e.ratio);i<=0&&(i=e.width,n=e.height,this.value=i),o.css({width:i,height:n}),g.val(n)}),g.on("change",function(){var o=t.getSettingComponent().find("img"),i=+this.value,n=Math.round(i*e.ratio);i<=0&&(n=e.width,i=e.height,this.value=i),o.css({height:i,width:n}),v.val(n)})},showSettingForm:function(t,e,n){i('showSettingForm "photo" component',e);var l=this,a=t.find("#photo-align"),s=t.find("#v-align"),d=t.find("#photo-responsive"),r=t.find("#photo-width"),c=t.find("#photo-height"),p=t.find("#photo-style"),h=t.find("#photo-link"),v=t.find("#photo-target"),g=t.find("#photo-linkable");h.next().hide(),h.closest(".form-group").removeClass("has-error");var m=e.find(".photo-panel"),f=m.find("img"),u=f.parent("a");u.length>0?(g.prop("checked",!0),h.prop("disabled",!1).val(u.attr("href")),v.prop("disabled",!1).val(u.attr("target"))):(g.prop("checked",!1),h.prop("disabled",!0).val(""),v.prop("disabled",!0).val(""));var b=m.css("text-align");"right"===b&&"center"===b||(b="left");var C=f.css("vertical-align");f.hasClass("img-rounded")?p.val("img-rounded"):f.hasClass("img-circle")?p.val("img-circle"):f.hasClass("img-thumbnail")?p.val("img-thumbnail"):p.val(""),a.val(b),s.val(C),d.prop("checked",f.hasClass("img-responsive")),r.val(f.width()),c.val(f.height()),o("<img />").attr("src",f.attr("src")).load(function(){l.ratio=this.width/this.height,l.width=this.width,l.height=this.height})}}}(jQuery);
//# sourceMappingURL=keditor-component-photo-0.0.0.min.js.map
