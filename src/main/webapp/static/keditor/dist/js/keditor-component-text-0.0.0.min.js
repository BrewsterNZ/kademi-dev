/**!
 * KEditor - Kademi content editor
 * @copyright: Kademi (http://kademi.co)
 * @author: Kademi (http://kademi.co)
 * @version: 0.0.0
 * @dependencies: $, $.fn.draggable, $.fn.droppable, $.fn.sortable, Bootstrap (optional), FontAwesome (optional)
 */
!function(t){var n=t.keditor,e=t.contentEditor,i=n.log;CKEDITOR.disableAutoInline=!0,CKEDITOR.dtd.$removeEmpty.i=!1,n.components.text={init:function(n,e,o,a){i('init "text" component',o);var c=a.options,r=o.find(".keditor-component-content"),d=r.find(".keditor-component-text-content-inner");if(0===d.length){var s=r.html();d=t('<div class="keditor-component-text-content-inner clearfix"></div>'),r.html(d),d.html(s),d.wrap('<div class="keditor-component-text-content"></div>')}d.attr("id")||d.attr("id",a.generateId("component-text-content-inner")),d.prop("contenteditable",!0),d.on("input",function(t){"function"==typeof c.onComponentChanged&&c.onComponentChanged.call(n,t,o),"function"==typeof c.onContainerChanged&&c.onContainerChanged.call(n,t,e),"function"==typeof c.onContentChanged&&c.onContentChanged.call(n,t)});var l=d.ckeditor(c.ckeditorOptions).editor;l.on("instanceReady",function(){i("CKEditor is ready",o),"function"==typeof c.onComponentReady&&c.onComponentReady.call(n,o,l)})},getContent:function(t,n){i('getContent "text" component',t);var e=t.find(".keditor-component-content"),o=e.find(".keditor-component-text-content"),a=o.children().attr("id"),c=CKEDITOR.instances[a];return c&&o.html('<div class="keditor-component-text-content-inner clearfix">'+c.getData()+"</div>"),e.html()},destroy:function(t,n){i('destroy "text" component',t);var e=t.find(".keditor-component-content").attr("id"),o=CKEDITOR.instances[e];o&&o.destroy()},settingEnabled:!0,settingTitle:"Text Settings",initSettingForm:function(n,o){return i('initSettingForm "text" component'),t.ajax({url:"/static/keditor/componentTextSettings.html",type:"get",dataType:"HTML",success:function(i){n.html(i);var a=window.location.pathname.replace("contenteditor","");o.options.basePath&&(a=o.options.basePath),n.find(".background-image-edit").mselect({contentTypes:["image"],bs3Modal:!0,pagePath:a,basePath:a,onSelectFile:function(t,e,i,a){var c=o.getSettingComponent().find(".keditor-component-text-content"),r="http://"+window.location.host+"/_hashes/files/"+a;c.css("background-image",'url("'+r+'")'),n.find(".background-image-previewer").attr("src",r)}}),n.find(".background-image-delete").on("click",function(t){t.preventDefault();var e=o.getSettingComponent().find(".keditor-component-text-content");e.css("background-image",""),n.find(".background-image-previewer").attr("src","/static/images/photo_holder.png")});var c=n.find(".txt-bg-color");e.initSimpleColorPicker(c,function(t){target.css("background-color",t)}),n.find(".select-bg-repeat").on("change",function(){var t=o.getSettingComponent().find(".keditor-component-text-content");t.css("background-repeat",this.value)}),n.find(".select-bg-size").on("change",function(){var t=o.getSettingComponent().find(".keditor-component-text-content");t.css("background-size",this.value)}),n.find(".select-bg-position").on("change",function(){var t=o.getSettingComponent().find(".keditor-component-text-content");t.css("background-position",this.value)}),n.find(".txt-padding").each(function(){var n=t(this),e=n.attr("data-style-name");n.on("change",function(){var t=this.value||"",n=o.getSettingComponent().find(".keditor-component-text-content").get(0);""===t.trim()?n.style[e]="":(isNaN(t)&&(t=0,this.value=t),n.style[e]=t+"px")})}),n.find(".txt-margin").each(function(){var n=t(this),e=n.attr("data-style-name");n.on("change",function(){var t=this.value||"",n=o.getSettingComponent().find(".keditor-component-text-content").get(0);""===t.trim()?n.style[e]="":(isNaN(t)&&(t=0,this.value=t),n.style[e]=t+"px")})}),n.find(".txt-height").on("change",function(){var t=this.value||"";isNaN(t)&&(t="");var n=o.getSettingComponent().find(".keditor-component-text-content");n.css("height",t)}),n.find(".txt-max-height").on("change",function(){var t=this.value||"";isNaN(t)&&(t="");var n=o.getSettingComponent().find(".keditor-component-text-content");n.css("max-height",t+"px")}),n.find(".txt-width").on("change",function(){var t=this.value||"";isNaN(t)&&(t="");var n=o.getSettingComponent().find(".keditor-component-text-content");n.css("width",t)}),n.find(".txt-max-width").on("change",function(){var t=this.value||"";isNaN(t)&&(t="");var n=o.getSettingComponent().find(".keditor-component-text-content");n.css("max-width",t+"px")});var r=function(n,e){var i=t(o.getSettingComponent().find(".keditor-component-text-content")),a="infinite",c="animated",r="data-animate-type",d=i.attr(r);i.removeClass(a).removeClass(c).removeClass(d),i.attr(r,""),n&&(i.addClass(n).addClass(c),i.attr(r,n)),e?i.addClass(a):i.removeClass(a)};n.find("select[name=rotating]").on("change",function(){var t=n.find("input[name=infinite]").is(":checked");r(this.value,t)}),n.find("input[name=infinite]").on("change",function(){var e=n.find("select[name=rotating]").val();r(e,t(this).is(":checked"))})}})},showSettingForm:function(n,e,o){i('showSettingForm "text" component',e);var a=e.find(".keditor-component-text-content").get(0),c=a.style.backgroundImage;c=(c||"").replace(/^url\(['"]+(.+)['"]+\)$/,"$1"),n.find(".background-image-previewer").attr("src","none"!==c&&""!==c?c:"/static/images/photo_holder.png"),n.find(".select-bg-repeat").val(a.style.backgroundRepeat||"repeat"),n.find(".select-bg-position").val(a.style.backgroundPosition||"0% 0%"),n.find(".select-bg-size").val(a.style.backgroundSize||"auto"),n.find(".txt-bg-color").val(a.style.backgroundColor||"").trigger("update"),n.find(".txt-padding").each(function(){var n=t(this),e=n.attr("data-style-name");n.val((a.style[e]||"").replace("px",""))}),n.find(".txt-margin").each(function(){var n=t(this),e=n.attr("data-style-name");n.val((a.style[e]||"").replace("px",""))}),n.find(".txt-height").val((a.style.height||"").replace("px","")),n.find(".txt-max-height").val((a.style.maxHeight||"").replace("px","")),n.find(".txt-width").val((a.style.width||"").replace("px","")),n.find(".txt-max-width").val((a.style.maxWidth||"").replace("px",""));var r=t(a),d=r.attr("data-animate-type");d||(d=""),n.find("select[name=rotating]").val(d),r.hasClass("infinite")?n.find("input[name=infinite]").prop("checked",!0):n.find("input[name=infinite]").prop("checked",!1)}}}(jQuery);
//# sourceMappingURL=keditor-component-text-0.0.0.min.js.map
