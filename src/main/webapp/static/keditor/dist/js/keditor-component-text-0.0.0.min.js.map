{"version":3,"sources":["keditor-component-text-0.0.0.js"],"names":["$","KEditor","keditor","contentEditor","flog","log","CKEDITOR","disableAutoInline","dtd","$removeEmpty","components","init","contentArea","container","component","options","componentContent","find","ckeditorPlace","length","contentHtml","html","wrap","attr","generateId","prop","on","e","onComponentChanged","call","onContainerChanged","onContentChanged","editor","ckeditor","ckeditorOptions","onComponentReady","getContent","componentTextContent","id","children","instances","getData","destroy","settingEnabled","settingTitle","initSettingForm","form","ajax","url","type","dataType","success","resp","basePath","window","location","pathname","replace","mselect","contentTypes","bs3Modal","pagePath","onSelectFile","relativeUrl","fileType","hash","target","getSettingComponent","imageUrl","host","css","preventDefault","colorPicker","initSimpleColorPicker","color","this","value","each","txt","styleName","paddingValue","get","trim","style","isNaN","marginValue","height","maxHeight","width","maxWidth","showSettingForm","backgroundImage","val","backgroundRepeat","backgroundPosition","backgroundSize","backgroundColor","trigger","jQuery"],"mappings":"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","file":"keditor-component-text-0.0.0.min.js","sourcesContent":["/**\n * KEditor Text Component\n * @copyright: Kademi (http://kademi.co)\n * @author: Kademi (http://kademi.co)\n * @version: @{version}\n * @dependencies: $, $.fn.draggable, $.fn.droppable, $.fn.sortable, Bootstrap, FontAwesome (optional)\n */\n(function ($) {\n    var KEditor = $.keditor;\n    var contentEditor = $.contentEditor;\n    var flog = KEditor.log;\n    \n    CKEDITOR.disableAutoInline = true;\n    CKEDITOR.dtd.$removeEmpty['i'] = false;\n    \n    // Text component\n    // ---------------------------------------------------------------------\n    KEditor.components['text'] = {\n        init: function (contentArea, container, component, keditor) {\n            flog('init \"text\" component', component);\n            \n            var options = keditor.options;\n            \n            var componentContent = component.find('.keditor-component-content');\n            var ckeditorPlace = componentContent.find('.keditor-component-text-content-inner');\n            \n            if (ckeditorPlace.length === 0) {\n                var contentHtml = componentContent.html();\n                ckeditorPlace = $('<div class=\"keditor-component-text-content-inner clearfix\"></div>');\n                componentContent.html(ckeditorPlace);\n                ckeditorPlace.html(contentHtml);\n                ckeditorPlace.wrap('<div class=\"keditor-component-text-content\"></div>');\n            }\n            \n            if (!ckeditorPlace.attr('id')) {\n                ckeditorPlace.attr('id', keditor.generateId('component-text-content-inner'));\n            }\n            \n            ckeditorPlace.prop('contenteditable', true);\n            ckeditorPlace.on('input', function (e) {\n                if (typeof options.onComponentChanged === 'function') {\n                    options.onComponentChanged.call(contentArea, e, component);\n                }\n                \n                if (typeof options.onContainerChanged === 'function') {\n                    options.onContainerChanged.call(contentArea, e, container);\n                }\n                \n                if (typeof options.onContentChanged === 'function') {\n                    options.onContentChanged.call(contentArea, e);\n                }\n            });\n            \n            var editor = ckeditorPlace.ckeditor(options.ckeditorOptions).editor;\n            editor.on('instanceReady', function () {\n                flog('CKEditor is ready', component);\n                \n                if (typeof options.onComponentReady === 'function') {\n                    options.onComponentReady.call(contentArea, component, editor);\n                }\n            });\n        },\n        \n        getContent: function (component, keditor) {\n            flog('getContent \"text\" component', component);\n            \n            var componentContent = component.find('.keditor-component-content');\n            var componentTextContent = componentContent.find('.keditor-component-text-content');\n            \n            var id = componentTextContent.children().attr('id');\n            var editor = CKEDITOR.instances[id];\n            if (editor) {\n                componentTextContent.html('<div class=\"keditor-component-text-content-inner clearfix\">' + editor.getData() + '</div>');\n            }\n            \n            return componentContent.html();\n        },\n        \n        destroy: function (component, keditor) {\n            flog('destroy \"text\" component', component);\n            \n            var id = component.find('.keditor-component-content').attr('id');\n            var editor = CKEDITOR.instances[id];\n            if (editor) {\n                editor.destroy();\n            }\n        },\n        \n        settingEnabled: true,\n        \n        settingTitle: 'Text Settings',\n        \n        initSettingForm: function (form, keditor) {\n            flog('initSettingForm \"text\" component');\n            \n            return $.ajax({\n                url: '/static/keditor/componentTextSettings.html',\n                type: 'get',\n                dataType: 'HTML',\n                success: function (resp) {\n                    form.html(resp);\n                    \n                    // =================================================================================\n                    // Backgrounds\n                    // =================================================================================\n                    var basePath = window.location.pathname.replace('contenteditor', '');\n                    if (keditor.options.basePath) {\n                        basePath = keditor.options.basePath;\n                    }\n                    form.find('.background-image-edit').mselect({\n                        contentTypes: ['image'],\n                        bs3Modal: true,\n                        pagePath: basePath,\n                        basePath: basePath,\n                        onSelectFile: function (url, relativeUrl, fileType, hash) {\n                            var target = keditor.getSettingComponent().find('.keditor-component-text-content');\n                            var imageUrl = 'http://' + window.location.host + '/_hashes/files/' + hash;\n                            target.css('background-image', 'url(\"' + imageUrl + '\")');\n                            form.find('.background-image-previewer').attr('src', imageUrl);\n                        }\n                    });\n                    form.find('.background-image-delete').on('click', function (e) {\n                        e.preventDefault();\n                        \n                        var target = keditor.getSettingComponent().find('.keditor-component-text-content');\n                        target.css('background-image', '');\n                        form.find('.background-image-previewer').attr('src', '/static/images/photo_holder.png');\n                    });\n                    \n                    var colorPicker = form.find('.txt-bg-color');\n                    contentEditor.initSimpleColorPicker(colorPicker, function (color) {\n                        target.css('background-color', color);\n                    });\n                    \n                    form.find('.select-bg-repeat').on('change', function () {\n                        var target = keditor.getSettingComponent().find('.keditor-component-text-content');\n                        \n                        target.css('background-repeat', this.value);\n                    });\n                    \n                    form.find('.select-bg-size').on('change', function () {\n                        var target = keditor.getSettingComponent().find('.keditor-component-text-content');\n                        \n                        target.css('background-size', this.value);\n                    });\n                    \n                    form.find('.select-bg-position').on('change', function () {\n                        var target = keditor.getSettingComponent().find('.keditor-component-text-content');\n                        \n                        target.css('background-position', this.value);\n                    });\n                    \n                    // =================================================================================\n                    // Padding\n                    // =================================================================================\n                    form.find('.txt-padding').each(function () {\n                        var txt = $(this);\n                        var styleName = txt.attr('data-style-name');\n                        \n                        txt.on('change', function () {\n                            var paddingValue = this.value || '';\n                            var target = keditor.getSettingComponent().find('.keditor-component-text-content').get(0);\n                            \n                            if (paddingValue.trim() === '') {\n                                target.style[styleName] = '';\n                            } else {\n                                if (isNaN(paddingValue)) {\n                                    paddingValue = 0;\n                                    this.value = paddingValue;\n                                }\n                                target.style[styleName] = paddingValue + 'px';\n                            }\n                        });\n                    });\n                    \n                    // =================================================================================\n                    // Margin\n                    // =================================================================================\n                    form.find('.txt-margin').each(function () {\n                        var txt = $(this);\n                        var styleName = txt.attr('data-style-name');\n                        \n                        txt.on('change', function () {\n                            var marginValue = this.value || '';\n                            var target = keditor.getSettingComponent().find('.keditor-component-text-content').get(0);\n                            \n                            if (marginValue.trim() === '') {\n                                target.style[styleName] = '';\n                            } else {\n                                if (isNaN(marginValue)) {\n                                    marginValue = 0;\n                                    this.value = marginValue;\n                                }\n                                target.style[styleName] = marginValue + 'px';\n                            }\n                        });\n                    });\n                    \n                    // =================================================================================\n                    // Width and Height\n                    // =================================================================================\n                    form.find('.txt-height').on('change', function () {\n                        var height = this.value || '';\n                        if (isNaN(height)) {\n                            height = '';\n                        }\n                        \n                        var target = keditor.getSettingComponent().find('.keditor-component-text-content');\n                        target.css('height', height);\n                    });\n                    \n                    form.find('.txt-max-height').on('change', function () {\n                        var maxHeight = this.value || '';\n                        if (isNaN(maxHeight)) {\n                            maxHeight = '';\n                        }\n                        \n                        var target = keditor.getSettingComponent().find('.keditor-component-text-content');\n                        target.css('max-height', maxHeight + 'px');\n                    });\n                    \n                    form.find('.txt-width').on('change', function () {\n                        var width = this.value || '';\n                        if (isNaN(width)) {\n                            width = '';\n                        }\n                        \n                        var target = keditor.getSettingComponent().find('.keditor-component-text-content');\n                        target.css('width', width);\n                    });\n                    \n                    form.find('.txt-max-width').on('change', function () {\n                        var maxWidth = this.value || '';\n                        if (isNaN(maxWidth)) {\n                            maxWidth = '';\n                        }\n                        \n                        var target = keditor.getSettingComponent().find('.keditor-component-text-content');\n                        target.css('max-width', maxWidth + 'px');\n                    });\n                }\n            });\n        },\n        \n        showSettingForm: function (form, component, keditor) {\n            flog('showSettingForm \"text\" component', component);\n            \n            var target = component.find('.keditor-component-text-content').get(0);\n            \n            var imageUrl = target.style.backgroundImage;\n            imageUrl = (imageUrl || '').replace(/^url\\(['\"]+(.+)['\"]+\\)$/, '$1');\n            form.find('.background-image-previewer').attr('src', imageUrl !== 'none' && imageUrl !== '' ? imageUrl : '/static/images/photo_holder.png');\n            \n            form.find('.select-bg-repeat').val(target.style.backgroundRepeat || 'repeat');\n            form.find('.select-bg-position').val(target.style.backgroundPosition || '0% 0%');\n            form.find('.select-bg-size').val(target.style.backgroundSize || 'auto');\n            \n            form.find('.txt-bg-color').val(target.style.backgroundColor || '').trigger('update')\n            \n            form.find('.txt-padding').each(function () {\n                var txt = $(this);\n                var styleName = txt.attr('data-style-name');\n                \n                txt.val((target.style[styleName] || '').replace('px', ''));\n            });\n            form.find('.txt-margin').each(function () {\n                var txt = $(this);\n                var styleName = txt.attr('data-style-name');\n                \n                txt.val((target.style[styleName] || '').replace('px', ''));\n            });\n            \n            form.find('.txt-height').val((target.style.height || '').replace('px', ''));\n            form.find('.txt-max-height').val((target.style.maxHeight || '').replace('px', ''));\n            form.find('.txt-width').val((target.style.width || '').replace('px', ''));\n            form.find('.txt-maxWith').val((target.style.maxWidth || '').replace('px', ''));\n        }\n    };\n    \n})(jQuery);\n"],"sourceRoot":"/source/"}