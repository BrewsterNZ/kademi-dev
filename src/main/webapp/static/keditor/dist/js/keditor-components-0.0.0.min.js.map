{"version":3,"sources":["keditor-components-0.0.0.js"],"names":["$","KEditor","keditor","flog","log","components","settingEnabled","settingTitle","init","contentArea","container","component","options","id","generateId","componentContent","children","find","attr","panels","each","index","item","p","itemId","panelCollapseId","title","html","indexOf","collapse","removeClass","prop","on","e","onComponentChanged","call","onContainerChanged","onContentChanged","editor","ckeditor","ckeditorOptions","onComponentReady","document","off","preventDefault","confirm","panelsCount","length","this","parents","remove","Msg","error","clone","first","append","getContent","h","parent","replaceWith","panelTitle","panelCollapse","addClass","destroy","CKEDITOR","instances","initSettingForm","form","ajax","url","type","dataType","success","resp","comp","getSettingComponent","checked","old","value","getStyleOnce","getScriptOnce","iconpicker","iconset","cols","rows","placement","dynamicElement","icon","initDynamicContent","showSettingForm","dataAttributes","getDataAttributes","val","iconCollapsed","end","iconExpanded","jQuery","img","componentId","hasClass","wrap","src","width","autostart","instance","jwplayer","key","buildJWAudioPlayerPreview","btnAudioFileInput","mselect","contentTypes","bs3Modal","pagePath","basePath","onSelectFile","refreshAudioPlayerPreview","autoplayToggle","audioWidth","resizeAudioPlayerPreview","playerInstance","setup","file","height","flashplayer","html5player","primary","onReady","load","play","resize","carousel","self","images","push","hash","css","i","image","addItemToCarousel","eq","editingItemId","carouselAddImage","carouselItemsWrap","relUrl","addItemToList","caption","refreshCarousel","sortable","handle","items","axis","tolerance","sort","update","editorContent","initModalContent","modalContent","editorCaption","initModalCaption","modalCaption","modal","btn","closest","siblings","carouselItem","txtCarouselContent","setData","trigger","txtCarouselCaption","isNaN","appendTo","body","contentOptions","extend","removePlugins","replace","extraPlugins","carouselContent","getData","content","captionOptions","toolbarGroups","toolbarSets","carouselCaption","carouselImg","slice","isWrap","pause","interval","iconPrev","trim","iconNext","data","carouselInner","cls","backgroundUrl","backgroundSize","itemStr","editCaption","Date","getTime","txtContent","txtCaption","initFormBuilder","formBuilderArea","formData","formContent","prepend","btnEditForm","btnPreviewForm","formBuilder","disableInjectedStyle","showActionButtons","disableFields","disabledAttrs","typeUserDisabledAttrs","checkbox-group","show","hide","renderForm","formRender","actions","div","dataGrid","split","label","input","subDiv","layout","window","callWhenGoogleMapReady","initKGoogleMap","initAutocomplete","mapTypes","filter","iframe","kgooglemap","makeGoogleMapFresh","alert","callback","apiKey","google","maps","places","setTimeout","event","keyCode","map","maptype","place","ratio","mapDiv","Map","zoom","mapTypeId","searchBox","SearchBox","addListener","setBounds","getBounds","markers","getPlaces","forEach","marker","setMap","bounds","LatLngBounds","geometry","console","size","Size","origin","Point","anchor","scaledSize","Marker","name","position","location","viewport","union","fitBounds","contentEditor","buttonColorPicker","initSimpleColorPicker","color","paddingSettings","paddingValue","paddingProp","marginSettings","script","vectorMap","backgroundColor","zoomButtons","focusOn","x","y","scale","regionStyle","initial","fill","hover","onRegionTipShow","el","code","setInterval","updateSize","clearInterval","arr","insertBefore","insertAfter","currentState","defaultState","txtLink","link","pattern","span","next","formGroup","test","cbbTarget","chkLinkable","is","unwrap","inputAlign","panel","inputVAlign","inputResponsive","cbbStyle","inputWidth","inputHeight","newWidth","newHeight","Math","round","photoEdit","relativeUrl","fileType","a","algin","valign","disableAutoInline","dtd","$removeEmpty","ckeditorPlace","contentHtml","componentTextContent","target","imageUrl","host","colorPicker","txt","styleName","get","style","marginValue","maxHeight","maxWidth","backgroundImage","backgroundRepeat","backgroundPosition","wrapper","buildJWVideoPlayerPreview","selectPicker","borderStyle","txtBorderWidth","borderWidth","previewer","colorpicker","format","align","colorSelectors","transparent","colorHex","toHex","borderColor","selectpicker","btnVideoFileInput","refreshVideoPlayerPreview","loopToggle","showcontrolsToggle","isBorderEnabled","chkBorder","jquery","repeat","aspectratio","controls","posterHref","androidhls","playlist","sources","btnEdit","inputData","prompt","vimeoRegex","match","btn169","btn43","chkAutoplay","embedItem","currentUrl","newUrl","youtubeRegex"],"mappings":"CAcA,SAAWA,GACP,GAAIC,GAAUD,EAAEE,QACZC,EAAOF,EAAQG,GAEnBH,GAAQI,WAAsB,WAC1BC,gBAAgB,EAChBC,aAAc,qBAEdC,KAAM,SAAUC,EAAaC,EAAWC,EAAWT,GAC/C,GAAIU,GAAUV,EAAQU,QAClBC,EAAKX,EAAQY,WAAW,aACxBC,EAAmBJ,EAAUK,SAAS,6BAC1CD,GAAiBE,KAAK,+BAA+BC,KAAK,KAAML,GAChEE,EAAiBE,KAAK,iCAAiCC,KAAK,cAAe,IAAML,EAGjF,IAAIM,GAASJ,EAAiBE,KAAK,SACnCE,GAAOC,KAAK,SAAUC,EAAOC,GACzB,GAAIC,GAAIvB,EAAEsB,GACNE,EAAStB,EAAQY,WAAW,UAAYO,GACxCI,EAAkBvB,EAAQY,WAAW,WAAaO,EACtDE,GAAEN,KAAK,kBAAkBC,KAAK,KAAMM,GACpCD,EAAEN,KAAK,mBAAmBC,KAAK,kBAAmBM,GAAQN,KAAK,KAAMO,EACrE,IAAIC,GAAQH,EAAEN,KAAK,kBAAkBU,MACrCJ,GAAEN,KAAK,kBAAkBC,KAAK,OAAQ,IAAMO,GAAiBP,KAAK,gBAAiB,IAAMO,GACrFC,EAAME,QAAQ,eACdL,EAAEN,KAAK,kBAAkBU,KAAK,QAAUD,EAAQ,YAIxDX,EAAiBE,KAAK,kCAAkCY,SAAS,QACjEd,EAAiBE,KAAK,uCAAuCa,YAAY,QACzEf,EAAiBE,KAAK,sBAAsBc,KAAK,mBAAmB,GACpEhB,EAAiBE,KAAK,+BAA+Bc,KAAK,mBAAmB,GAE7EhB,EAAiBE,KAAK,mDAAmDe,GAAG,QAAS,SAAUC,GACjD,kBAA/BrB,GAAQsB,oBACftB,EAAQsB,mBAAmBC,KAAK1B,EAAawB,EAAGtB,GAGV,kBAA/BC,GAAQwB,oBACfxB,EAAQwB,mBAAmBD,KAAK1B,EAAawB,EAAGvB,GAGZ,kBAA7BE,GAAQyB,kBACfzB,EAAQyB,iBAAiBF,KAAK1B,EAAawB,IAInD,IAAIK,GAASvB,EAAiBE,KAAK,mDAAmDsB,SAAS3B,EAAQ4B,iBAAiBF,MACxHA,GAAON,GAAG,gBAAiB,WACvB7B,EAAK,oBAAqBQ,GAEc,kBAA7BC,GAAQ6B,kBACf7B,EAAQ6B,iBAAiBN,KAAK1B,EAAaE,EAAW2B,KAI9DtC,EAAE0C,UAAUC,IAAI,QAAS,2BAA2BX,GAAG,QAAS,0BAA2B,SAAUC,GAGjG,GAFAA,EAAEW,iBAEEC,QAAQ,8CAA+C,CACvD,GAAIC,GAAc/B,EAAiBE,KAAK,UAAU8B,MAC9CD,GAAc,EACd9C,EAAEgD,MAAMC,QAAQ,UAAUC,SAE1BC,IAAIC,MAAM,oCAKtBpD,EAAE0C,UAAUC,IAAI,QAAS,wBAAwBX,GAAG,QAAS,uBAAwB,SAAUC,GAC3FA,EAAEW,gBACF,IAAIS,GAAQtC,EAAiBE,KAAK,UAAUqC,QAAQD,QAChD7B,EAAStB,EAAQY,WAAW,WAC5BW,EAAkBvB,EAAQY,WAAW,WACzCuC,GAAMpC,KAAK,kBAAkBC,KAAK,KAAMM,GACxC6B,EAAMpC,KAAK,mBAAmBC,KAAK,kBAAmBM,GAAQN,KAAK,KAAMO,GACzE4B,EAAMpC,KAAK,kBAAkBC,KAAK,OAAQ,IAAMO,GAChDV,EAAiBE,KAAK,+BAA+BsC,OAAOF,EAC5D,IAAIf,GAASe,EAAMpC,KAAK,mDAAmDsB,SAAS3B,EAAQ4B,iBAAiBF,MAC7GA,GAAON,GAAG,gBAAiB,WACvB7B,EAAK,oBAAqBQ,GAEc,kBAA7BC,GAAQ6B,kBACf7B,EAAQ6B,iBAAiBN,KAAK1B,EAAaE,EAAW2B,QAMtEkB,WAAY,SAAU7C,EAAWT,GAC7B,GAAIa,GAAmBJ,EAAUK,SAAS,6BAmB1C,OAlBAD,GAAiBE,KAAK,sBAAsBG,KAAK,WAC7C,GAAIqC,GAAIzD,EAAEgD,MAAMrB,MAChB3B,GAAEgD,MAAMU,OAAO,KAAK/B,KAAK8B,KAE7B1C,EAAiBE,KAAK,+BAA+BG,KAAK,WACtD,GAAIqC,GAAIzD,EAAEgD,MAAMrB,MAChB3B,GAAEgD,MAAMW,YAAY,2BAA6BF,EAAI,YAET,QAA5C9C,EAAUO,KAAK,2BACfH,EAAiBE,KAAK,UAAUG,KAAK,WACjC,GAAIwC,GAAa5D,EAAEgD,MAAM/B,KAAK,oBAC1B4C,EAAgB7D,EAAEgD,MAAM/B,KAAK,kBACjC4C,GAAcC,SAAS,YAAY5C,KAAK,gBAAiB,SAASY,YAAY,MAC9E8B,EAAWE,SAAS,aAAa5C,KAAK,gBAAiB,WAG/DH,EAAiBE,KAAK,uCAAuC6C,SAAS,QAE/D/C,EAAiBY,QAG5BoC,QAAS,SAAUpD,EAAWT,GAC1BC,EAAK,2BAA4BQ,EAEjC,IAAIE,GAAKF,EAAUM,KAAK,8BAA8BC,KAAK,MACvDoB,EAAS0B,SAASC,UAAUpD,EAC5ByB,IACAA,EAAOyB,WAGfG,gBAAiB,SAAUC,EAAMjE,GAG7B,MAFAC,GAAK,4BAA6BgE,GAE3BnE,EAAEoE,MACLC,IAAK,kDACLC,KAAM,MACNC,SAAU,OACVC,QAAS,SAAUC,GACfN,EAAKxC,KAAK8C,GAEVN,EAAKlD,KAAK,iBAAiBe,GAAG,QAAS,WACnC,GAAI0C,GAAOxE,EAAQyE,qBACnBD,GAAKxD,KAAK,yBAA0B8B,KAAK4B,WAG7CT,EAAKlD,KAAK,eAAee,GAAG,SAAU,SAAUC,GAC5C,GAAIyC,GAAOxE,EAAQyE,sBACfE,EAAMH,EAAKxD,KAAK,qBAAuB,eAC3CwD,GAAKxD,KAAK,mBAAoB8B,KAAK8B,OACnCJ,EAAKzD,KAAK,UAAUa,YAAY+C,GAAKf,SAASd,KAAK8B,SAGvD9E,EAAE+E,aAAa,uEACf/E,EAAEgF,cAAc,iFAAkF,WAC9FhF,EAAEgF,cAAc,oEAAqE,WACjFb,EAAKlD,KAAK,2CAA2CgE,YACjDC,QAAS,cACTC,KAAM,GACNC,KAAM,EACNC,UAAW,SAGflB,EAAKlD,KAAK,uBAAuBe,GAAG,SAAU,SAAUC,GACpD,GAAItB,GAAYT,EAAQyE,sBACpBW,EAAiB3E,EAAUM,KAAK,sBAEpCN,GAAUO,KAAK,sBAAuBe,EAAEsD,MACxCrF,EAAQsF,mBAAmBF,KAG/BnB,EAAKlD,KAAK,sBAAsBe,GAAG,SAAU,SAAUC,GACnD,GAAItB,GAAYT,EAAQyE,sBACpBW,EAAiB3E,EAAUM,KAAK,sBAEpCN,GAAUO,KAAK,qBAAsBe,EAAEsD,MACvCrF,EAAQsF,mBAAmBF,aASnDG,gBAAiB,SAAUtB,EAAMxD,EAAWT,GACxCC,EAAK,wCACL,IAAIuF,GAAiBxF,EAAQyF,kBAAkBhF,GAAY,cAAc,EAEzEwD,GAAKlD,KAAK,iBAAiBc,KAAK,UAAuD,QAA5CpB,EAAUO,KAAK,2BAC1DiD,EAAKlD,KAAK,eAAe2E,IAAIjF,EAAUO,KAAK,qBAE5ClB,EAAEgF,cAAc,iFAAkF,WAC9FhF,EAAEgF,cAAc,oEAAqE,WACjF,GAAIa,GAAgBH,EAAe,wBAA0B,aAC7DvB,GAAKlD,KAAK,uBAAuBA,KAAK,KAAKC,KAAK,QAAS,MAAQ2E,GAAeC,MAAM7E,KAAK,SAAS2E,IAAIC,EACxG,IAAIE,GAAeL,EAAe,uBAAyB,eAC3DvB,GAAKlD,KAAK,sBAAsBA,KAAK,KAAKC,KAAK,QAAS,MAAQ6E,GAAcD,MAAM7E,KAAK,SAAS2E,IAAIG,UAKvHC,QAUH,SAAWhG,GACP,GAAIC,GAAUD,EAAEE,QACZC,EAAOF,EAAQG,GAEnBH,GAAQI,WAAkB,OACtBG,KAAM,SAAUC,EAAaC,EAAWC,EAAWT,GAC/CC,EAAK,yBAA0BQ,GAE/BqC,KAAKrC,UAAYA,CACjB,IAAIsF,GAAMtF,EAAUM,KAAK,iBACrBiF,EAAc,EACbD,GAAI/E,KAAK,MAIVgF,EAAcD,EAAI/E,KAAK,OAHvBgF,EAAchG,EAAQY,WAAW,mBACjCmF,EAAI/E,KAAK,KAAMgF,IAIdD,EAAIvC,SAASyC,SAAS,kBACvBF,EAAIG,KAAK,qCAEbpD,KAAKqD,IAAMJ,EAAI/E,KAAK,YACpB8B,KAAKsD,MAAQL,EAAI/E,KAAK,cACtB8B,KAAKuD,UAA2C,SAA/BN,EAAI/E,KAAK,iBAC1B,IAAIsF,GAAWxD,IACfhD,GAAEgF,cAAc,oCAAqC,WACjDyB,SAASC,IAAM,+CACfF,EAASG,0BAA0BT,MAK3C1C,WAAY,SAAU7C,EAAWT,GAC7BC,EAAK,+BAAgCQ,EAErC,IAAIsF,GAAMtF,EAAUM,KAAK,iBACrBiF,EAAcD,EAAI/E,KAAK,MAEvBS,EAAO,0BAA4BuE,EAAc,iEAAmElD,KAAKuD,UAAY,iBAAmBvD,KAAKsD,MAAQ,eAAiBtD,KAAKqD,IAAM,kBAAoBrD,KAAKqD,IAAM,MACpO,OAAO1E,IAGXrB,gBAAgB,EAEhBC,aAAc,iBAEd2D,gBAAiB,SAAUC,EAAMjE,GAG7B,MAFAC,GAAK,wBAAyBgE,GAEvBnE,EAAEoE,MACLC,IAAK,8CACLC,KAAM,MACNC,SAAU,OACVC,QAAS,SAAUC,GACfN,EAAKxC,KAAK8C,OAKtBgB,gBAAiB,SAAUtB,EAAMxD,EAAWT,GACxCC,EAAK,oCAAqCgE,EAAMxD,EAEhD,IAAI6F,GAAWxD,KACX4D,EAAoBzC,EAAKlD,KAAK,sBAClC2F,GAAkBC,SACdC,cAAe,SACfC,UAAU,EACVC,SAAU9G,EAAQU,QAAQoG,SAC1BC,SAAU/G,EAAQU,QAAQqG,SAC1BC,aAAc,SAAU7C,GACpBmC,EAASH,IAAMhC,EACfmC,EAASW,8BAIjB,IAAIlB,GAAMtF,EAAUM,KAAK,iBACrBiF,EAAcD,EAAI/E,KAAK,MAEvBkG,EAAiBjD,EAAKlD,KAAK,kBAC3B+B,MAAKuD,WACLa,EAAerF,KAAK,WAAW,GAEnCqF,EAAepF,GAAG,QAAS,SAAUC,GACjCuE,EAASD,UAAYvD,KAAK4B,QAC1B4B,EAASG,0BAA0BT,IAGvC,IAAImB,GAAalD,EAAKlD,KAAK,eAC3BoG,GAAWzB,IAAI5C,KAAKsD,OACpBe,EAAWrF,GAAG,SAAU,WACpBwE,EAASF,MAAQtD,KAAK8B,MACtB0B,EAASc,8BAIjBX,0BAA2B,SAAUT,GACjC,GAAII,GAAQtD,KAAKsD,MACbD,EAAMrD,KAAKqD,IACXE,EAAYvD,KAAKuD,UACjBgB,EAAiBd,SAASP,EAC9BqB,GAAeC,OACXC,KAAMpB,EACNC,MAAOA,EACPoB,OAAQ,GACRnB,UAAWA,EACXoB,YAAa,2CACbC,YAAa,0CACbC,QAAS,UAEbN,EAAeO,QAAQ,WACnB1H,IAAI,iCAIZ+G,0BAA2B,WACvB,GAAIX,GAAWxD,KACXuE,EAAiBd,SAASD,EAASN,aACnCG,EAAMG,EAASH,GACnBkB,GAAeQ,OACXN,KAAMpB,KAEVkB,EAAeS,QAGnBV,yBAA0B,WACtB,GAAId,GAAWxD,KACXuE,EAAiBd,SAASD,EAASN,aACnCI,EAAQE,EAASF,KAErBiB,GAAeU,OAAO3B,EAAO,OAItCN,QASH,SAAWhG,GACP,GAAIC,GAAUD,EAAEE,QACZC,EAAOF,EAAQG,GAEnBH,GAAQI,WAAqB,UACzBG,KAAM,SAAUC,EAAaC,EAAWC,EAAWT,GAC/CC,EAAK,4BAA6BQ,EAClC,IAAII,GAAmBJ,EAAUK,SAAS,8BACtCkH,EAAWnH,EAAiBE,KAAK,YAErC,IAA8C,IAA1CiH,EAASjH,KAAK,iBAAiB8B,QAA8D,IAA9CmF,EAASjH,KAAK,qBAAqB8B,OAAc,CAChG,GAAIoF,GAAOnF,KACPoF,IAEJF,GAASpE,SAAS,yBAClBoE,EAASjH,KAAK,yBAAyBG,KAAK,WACxC,GAAIE,GAAOtB,EAAEgD,KAEboF,GAAOC,MACHhC,IAAK/E,EAAKL,KAAK,OAAOC,KAAK,OAC3BoH,KAAMhH,EAAKJ,KAAK,iBAIxBgH,EAAShH,KAAK,cAAe,KAAKqH,IAAI,SAAU,KAChDL,EAASjH,KAAK,mBAAmBU,KAAK,IACtCuG,EAASjH,KAAK,wBAAwBU,KAAK,IAE3C3B,EAAEoB,KAAKgH,EAAQ,SAAUI,EAAGC,GACxBN,EAAKO,kBAAkB/H,GACnB0F,IAAKoC,EAAMpC,IACXiC,KAAMG,EAAMH,SAKxB,GAAIzH,GAAKX,EAAQY,WAAW,qBAC5BoH,GAAShH,KAAK,KAAML,GACpBqH,EAASjH,KAAK,2BAA2BC,KAAK,cAAe,IAAML,GACnEqH,EAASjH,KAAK,qBAAqBC,KAAK,OAAQ,IAAML,IAE1D2C,WAAY,SAAU7C,EAAWT,GAC7B,GAAIa,GAAmBJ,EAAUK,SAAS,6BAG1C,OAFAD,GAAiBE,KAAK,mBAAmBD,WAAWc,YAAY,UAAU6G,GAAG,GAAG7E,SAAS,UAElF/C,EAAiBY,QAE5BrB,gBAAgB,EAEhBC,aAAc,oBAEdqI,cAAe,GAEf1E,gBAAiB,SAAUC,EAAMjE,GAC7BC,EAAK,2BAA4BgE,EAEjC,IAAIgE,GAAOnF,IACX,OAAOhD,GAAEoE,MACLC,IAAK,iDACLC,KAAM,MACNC,SAAU,OACVC,QAAS,SAAUC,GACfN,EAAKxC,KAAK8C,GAEVzE,EAAE+E,aAAa,uEACf/E,EAAEgF,cAAc,iFAAkF,WAC9FhF,EAAEgF,cAAc,oEAAqE,WACjFb,EAAKlD,KAAK,kCAAkCgE,YACxCC,QAAS,cACTC,KAAM,GACNC,KAAM,EACNC,UAAW,SAGflB,EAAKlD,KAAK,kBAAkBe,GAAG,SAAU,SAAUC,GAC/C,GAAIiG,GAAWhI,EAAQyE,sBAAsB1D,KAAK,YAClDiH,GAASjH,KAAK,2BAA2BC,KAAK,QAAS,6BAA+Be,EAAEsD,QAG5FpB,EAAKlD,KAAK,kBAAkBe,GAAG,SAAU,SAAUC,GAC/C,GAAIiG,GAAWhI,EAAQyE,sBAAsB1D,KAAK,YAClDiH,GAASjH,KAAK,4BAA4BC,KAAK,QAAS,8BAAgCe,EAAEsD,WAKtG,IAAIsD,GAAmB1E,EAAKlD,KAAK,qBAC7B6H,EAAoB3E,EAAKlD,KAAK,qBAElC4H,GAAiBhC,SACbC,cAAe,SACfC,UAAU,EACVC,SAAU9G,EAAQU,QAAQoG,SAC1BC,SAAU/G,EAAQU,QAAQqG,SAC1BC,aAAc,SAAU7C,EAAK0E,EAAQzE,EAAMgE,GACvCnI,EAAK,mCAAoCkE,EAAKiE,GAC9CH,EAAKa,cAAc7E,GACfkC,IAAKhC,EACLiE,KAAMA,EACNW,QAAS,KAGbd,EAAKe,gBAAgBhJ,EAAQyE,sBAAuBR,GACpDgE,EAAKS,cAAgB,MAI7BE,EAAkBK,UACdC,OAAQ,iBACRC,MAAO,kBACPC,KAAM,IACNC,UAAW,UACXC,KAAM,WACFxJ,EAAEgD,MAAMlB,YAAY,qBAExB2H,OAAQ,WACJtB,EAAKe,gBAAgBhJ,EAAQyE,sBAAuBR,KAK5D,IAAIuF,GAAgBvB,EAAKwB,iBAAiBxF,EAAMjE,GAC5C0J,EAAe5J,EAAE,2BAGjB6J,EAAgB1B,EAAK2B,iBAAiB3F,EAAMjE,GAC5C6J,EAAe/J,EAAE,0BAErBmE,GAAKlD,KAAK,qBAAqBe,GAAG,QAAS,SAAUC,GACjDA,EAAEW,mBAGNuB,EAAKlD,KAAK,uBAAuBe,GAAG,QAAS,SAAUC,GACnDA,EAAEW,iBACFgH,EAAaI,MAAM,UAGvB7F,EAAKnC,GAAG,QAAS,kCAAmC,SAAUC,GAG1D,GAFAA,EAAEW,iBAEEC,QAAQ,oDAAqD,CAC7D,GAAIoH,GAAMjK,EAAEgD,MACRsF,EAAO2B,EAAIC,QAAQ,cAAcC,SAAS,eAAejJ,KAAK,aAE9DgH,EAAWhI,EAAQyE,sBAAsB1D,KAAK,YAClDiH,GAASjH,KAAK,cAAgBqH,EAAO,KAAKpF,SAC1C+G,EAAIC,QAAQ,iBAAiBhH,SAE7BiF,EAAKe,gBAAgBhJ,EAAQyE,sBAAuBR,MAI5DA,EAAKnC,GAAG,QAAS,gCAAiC,SAAUC,GACxDA,EAAEW,gBAEF,IAAIwH,GAAepK,EAAEgD,MAAMkH,QAAQ,gBACnC/B,GAAKS,cAAgBwB,EAAalJ,KAAK,KACvC,IAAImJ,GAAqBD,EAAanJ,KAAK,wBAEvCoJ,GAAmBtH,OAAS,GAC5B2G,EAAcY,QAAQD,EAAmBzE,OAAS,IAClDzB,EAAKlD,KAAK,uBAAuBsJ,QAAQ,UAEzCpG,EAAKlD,KAAK,qBAAqBsJ,QAAQ,WAK/CpG,EAAKnC,GAAG,QAAS,wCAAyC,SAAUC,GAChEA,EAAEW,gBAEF,IAAIwH,GAAepK,EAAEgD,MAAMkH,QAAQ,gBACnC/B,GAAKS,cAAgBwB,EAAalJ,KAAK,KACvC,IAAIsJ,GAAqBJ,EAAanJ,KAAK,wBAE3C4I,GAAcS,QAAQE,EAAmB5E,OAAS,IAClDmE,EAAaC,MAAM,UAGvB7F,EAAKlD,KAAK,mBAAmBe,GAAG,SAAU,SAAUC,GAChD,GAAI6C,GAAQ9B,KAAK8B,OAEb2F,MAAM3F,KAAWA,EAAQ,OACzBA,EAAQ,IACR9B,KAAK8B,MAAQ,IAGjB,IAAIoD,GAAWhI,EAAQyE,sBAAsB1D,KAAK,YAClDiH,GAAShH,KAAK,cAAe4D,GAC7BoD,EAASK,IAAI,SAAUzD,KAG3BX,EAAKlD,KAAK,kBAAkBe,GAAG,SAAU,SAAUC,GAC/CA,EAAEW,gBACF,IAAI8B,GAAOxE,EAAQyE,sBAAsB1D,KAAK,YAC9CyD,GAAKxD,KAAK,aAAc8B,KAAK8B,SAGjCX,EAAKlD,KAAK,qBAAqBe,GAAG,SAAU,SAAUC,GAClDA,EAAEW,gBACF,IAAI8B,GAAOxE,EAAQyE,sBAAsB1D,KAAK,YAC9CyD,GAAKxD,KAAK,gBAAiB8B,KAAK8B,SAGpCX,EAAKlD,KAAK,iBAAiBe,GAAG,QAAS,SAAUC,GAC7C,GAAIyC,GAAOxE,EAAQyE,sBAAsB1D,KAAK,YAC1C+B,MAAK4B,QACLF,EAAKxD,KAAK,YAAa,QAEvBwD,EAAKxD,KAAK,YAAa,WAI/BiD,EAAKlD,KAAK,sBAAsBe,GAAG,SAAU,WACzC,GAAIkG,GAAWhI,EAAQyE,sBAAsB1D,KAAK,YAElDiH,GAAShH,KAAK,kBAAmB8B,KAAK8B,OAEtCoD,EAASjH,KAAK,iBAAiBsH,IAAI,kBAAkC,aAAfvF,KAAK8B,MAAuB,QAAU,UAM5G6E,iBAAkB,SAAUxF,EAAMjE,GAC9B,GAAIiI,GAAOnF,KAEP4G,EAAe5J,EACf,ixBAiBF0K,SAAShI,SAASiI,MAEhBC,EAAiB5K,EAAE6K,UAAW3K,EAAQU,QAAQ4B,gBAClDoI,GAAeE,cAAgBF,EAAeE,cAAcC,QAAQ,YAAa,IAAM,gBACvFH,EAAeI,aAAeJ,EAAeI,aAAe,WAC5D,IAAItB,GAAgB1J,EAAE,gCAAgCuC,SAASqI,GAAgBtI,MAqB/E,OAnBAsH,GAAa5H,GAAG,kBAAmB,WAC/B0H,EAAcY,QAAQ,IACtBnC,EAAKS,cAAgB,KAGzBgB,EAAa3I,KAAK,8BAA8Be,GAAG,QAAS,SAAUC,GAClEA,EAAEW,iBAEFzC,EAAK,+BAEL,IAAI8K,GAAkBvB,EAAcwB,WAAa,EACjD/C,GAAKa,cAAc7E,GACfgH,QAASF,IAGb9C,EAAKe,gBAAgBhJ,EAAQyE,sBAAuBR,GACpDyF,EAAaI,MAAM,UAGhBN,GAGXI,iBAAkB,SAAU3F,EAAMjE,GAC9B,GAAIiI,GAAOnF,KAEP+G,EAAe/J,EACf,ixBAiBF0K,SAAShI,SAASiI,MAEhBS,EAAiBpL,EAAE6K,UAAW3K,EAAQU,QAAQ4B,gBAClD4I,GAAeN,cAAgBM,EAAeN,cAAcC,QAAQ,YAAa,IAAM,gBACvFK,EAAeJ,aAAeI,EAAeJ,aAAe,YAC5DI,EAAeC,cAAgBC,YAAkB,IACjD,IAAIzB,GAAgB7J,EAAE,gCAAgCuC,SAAS6I,GAAgB9I,MAwB/E,OAtBAyH,GAAa/H,GAAG,kBAAmB,WAC/B6H,EAAcS,QAAQ,IACtBnC,EAAKS,cAAgB,KAGzBmB,EAAa9I,KAAK,8BAA8Be,GAAG,QAAS,SAAUC,GAClEA,EAAEW,iBAEFzC,EAAK,+BAEL,IAAIoL,GAAkB1B,EAAcqB,WAAa,GAC7C5J,EAAO6C,EAAKlD,KAAK,IAAMkH,EAAKS,eAAe3H,KAAK,kBACpDkH,GAAKa,cAAc7E,GACfkC,IAAK/E,EAAKJ,KAAK,OACfoH,KAAMhH,EAAKJ,KAAK,aAChB+H,QAASsC,IAGbpD,EAAKe,gBAAgBhJ,EAAQyE,sBAAuBR,GACpD4F,EAAaC,MAAM,UAGhBH,GAGXpE,gBAAiB,SAAUtB,EAAMxD,EAAWT,GACxC,GAAIiI,GAAOnF,IACXmF,GAAKS,cAAgB,GACrBzE,EAAKlD,KAAK,sBAAsBU,KAAK,IACrChB,EAAUM,KAAK,2BAA2BG,KAAK,WAC3C,GAAIE,GAAOtB,EAAEgD,MACTwI,EAAclK,EAAKL,KAAK,iBACxBgK,EAAkB3J,EAAKL,KAAK,oBAEhC,IAAIgK,EAAgBlI,OAAS,EACzBoF,EAAKa,cAAc7E,GACfgH,QAASF,EAAgBtJ,aAE1B,CACH,GAAI0C,GAAMmH,EAAYjD,IAAI,mBAC1BlE,GAAMA,EAAIoH,MAAM,MAAOV,QAAQ,QAAS,GACxC,IAAIzC,GAAOtI,EAAEsB,GAAMJ,KAAK,aACpB+H,EAAU3H,EAAKL,KAAK,oBAExBkH,GAAKa,cAAc7E,GACfkC,IAAKhC,EACLiE,KAAMA,EACNW,QAASA,EAAQtH,QAAU,OAKvC,IAAIuG,GAAWvH,EAAUM,KAAK,aAC1ByK,EAASxD,EAAShH,KAAK,aACvByK,EAAQzD,EAAShH,KAAK,cACtB0K,EAAW1D,EAAShH,KAAK,iBACzBwG,EAASQ,EAAShH,KAAK,cAE3BiD,GAAKlD,KAAK,kBAAkB2E,IAAI+F,GAChCxH,EAAKlD,KAAK,qBAAqB2E,IAAIgG,GACnCzH,EAAKlD,KAAK,iBAAiBc,KAAK,UAAsB,SAAX2J,GAC3CvH,EAAKlD,KAAK,mBAAmB2E,IAAI8B,GACjCvD,EAAKlD,KAAK,sBAAsB2E,IAAIsC,EAAShH,KAAK,oBAAsB,aAExElB,EAAEgF,cAAc,iFAAkF,WAC9FhF,EAAEgF,cAAc,oEAAqE,WACjF,GAAI6G,GAAW3D,EAASjH,KAAK,2BAA2BC,KAAK,UAAY,EACzE2K,GAAWA,EAASd,QAAQ,yBAA0B,IAAIA,QAAQ,KAAM,IAAIe,OAC5E3H,EAAKlD,KAAK,kBAAkBA,KAAK,KAAKC,KAAK,QAAS,MAAQ2K,GAAU/F,MAAM7E,KAAK,SAAS2E,IAAIiG,EAE9F,IAAIE,GAAW7D,EAASjH,KAAK,4BAA4BC,KAAK,UAAY,EAC1E6K,GAAWA,EAAShB,QAAQ,0BAA2B,IAAIA,QAAQ,KAAM,IAAIe,OAC7E3H,EAAKlD,KAAK,kBAAkBA,KAAK,KAAKC,KAAK,QAAS,MAAQ6K,GAAUjG,MAAM7E,KAAK,SAAS2E,IAAImG,QAK1GrD,kBAAmB,SAAU/H,EAAWqL,GACpC7L,EAAK,oBAAqBQ,EAAWqL,EAErC,IAAI9D,GAAWvH,EAAUM,KAAK,aAC1BgL,EAAgB/D,EAASjH,KAAK,mBAC9BJ,EAAKqH,EAAShH,KAAK,MACnBG,EAAQ4K,EAAcjL,WAAW+B,OACjCmJ,EAAgB,IAAV7K,EAAc,SAAW,GAC/B8K,EAAgB,0BAA4BH,EAAK3F,IAAM,KACvD+F,EAAsD,aAArClE,EAAShH,KAAK,mBAAoC,0BAA4B,EAEnGgH,GAASjH,KAAK,wBAAwBsC,OAClC,qBAAuB1C,EAAK,oBAAsBQ,EAAQ,YAAc6K,EAAM,UAGlF,IAAIG,GAAU,EACVL,GAAKb,SACLkB,GAAW,oBAAsBH,EAAM,KACvCG,GAAW,6CAA+CL,EAAKb,QAAU,SACzEkB,GAAW,0CACXA,GAAW,WAEXA,GAAW,mBAAqBL,EAAK1D,KAAO,iBAAmB4D,EAAM,KACrEG,GAAW,uCAAyCF,EAAgBC,EAAiB,WACrFC,GAAW,oCAAsCL,EAAK/C,QAAU,SAChEoD,GAAW,UAGfJ,EAAc1I,OAAO8I,IAGzBrD,cAAe,SAAU7E,EAAM6H,GAC3B7L,EAAK,gBAAiBgE,EAAM6H,EAE5B,IAAIM,GAAc,GAEdD,EAAU,EACVL,GAAKb,SACLkB,GAAW,oFACXA,GAAW,gEAAkEL,EAAKb,QAAU,gBAE5FkB,GAAW,oCAAsCL,EAAK3F,IAAM,gBAAkB2F,EAAK1D,KAAO,OAC1F+D,GAAW,gEAAkEL,EAAK/C,QAAU,cAC5FqD,EAAc,iHAGlBD,GAAW,0CACXA,GAAW,4GACXA,GAAW,4GAA8GC,EACzHD,GAAW,gHACXA,GAAW,YAEPrJ,KAAK4F,eACLzE,EAAKlD,KAAK,IAAM+B,KAAK4F,eAAejH,KAAK0K,GACzCrJ,KAAK4F,cAAgB,IAErBzE,EAAKlD,KAAK,sBAAsBsC,OAC5B,+CAAgD,GAAKgJ,OAAQC,UAAY,KAAOH,EAAU,WAKtGnD,gBAAiB,SAAUvI,EAAWwD,GAClC,GAAIgE,GAAOnF,KACPkF,EAAWvH,EAAUM,KAAK,YAC9BiH,GAASjH,KAAK,mBAAmBU,KAAK,IACtCuG,EAASjH,KAAK,wBAAwBU,KAAK,IAE3CwC,EAAKlD,KAAK,sBAAsBA,KAAK,iBAAiBG,KAAK,WACvD,GAAIgJ,GAAepK,EAAEgD,MACjByJ,EAAarC,EAAanJ,KAAK,yBAC/ByL,EAAatC,EAAanJ,KAAK,yBAC/BgF,EAAMmE,EAAanJ,KAAK,MAEF,KAAtBwL,EAAW1J,OACXoF,EAAKO,kBAAkB/H,GACnB0F,IAAKJ,EAAI/E,KAAK,OACdoH,KAAMrC,EAAI/E,KAAK,aACf+H,QAASyD,EAAW9G,QAGxBuC,EAAKO,kBAAkB/H,GACnBwK,QAASsB,EAAW7G,aAOzCI,QAQH,SAAWhG,GACP,GAAIC,GAAUD,EAAEE,QACZC,EAAOF,EAAQG,GAEnBH,GAAQI,WAAiB,MACrBsM,gBAAiB,SAAUhM,GACvB,GAAIwH,GAAOnF,IAEXhD,GAAEgF,cAAc,gDAAiD,WAC7DhF,EAAEgF,cAAc,+CAAgD,WAC5D,GAAI4H,GAAkBjM,EAAUM,KAAK,sBACjC4L,EAAWlM,EAAUM,KAAK,cAC1B6L,EAAcnM,EAAUM,KAAK,gBAEjCN,GAAUM,KAAK,8BAA8B8L,QACzC,mNAMJ,IAAIC,GAAcrM,EAAUM,KAAK,kBAC7BgM,EAAiBtM,EAAUM,KAAK,oBAEpC2L,GAAgBM,aACZC,sBAAsB,EACtBC,mBAAmB,EACnB7I,SAAU,OACVsI,SAAUA,EAASlL,OACnB0L,eACI,eACA,YACA,UAEJC,eAAgB,UAEhBC,uBACIC,kBACI,SACA,aAKZR,EAAYhL,GAAG,QAAS,SAAUC,GAC9BA,EAAEW,iBAEGoK,EAAY7G,SAAS,cACtByG,EAAgBa,OAChBX,EAAYY,OACZV,EAAYlJ,SAAS,YACrBmJ,EAAenL,YAAY,eAInCmL,EAAejL,GAAG,QAAS,SAAUC,GACjCA,EAAEW,iBAEGqK,EAAe9G,SAAS,cACzBgC,EAAKwF,WAAWhN,GAEhBiM,EAAgBc,OAChBZ,EAAYW,OACZT,EAAYlL,YAAY,YACxBmL,EAAenJ,SAAS,oBAO5C6J,WAAY,SAAUhN,EAAWuM,GAC7B,GAAIJ,GAAcnM,EAAUM,KAAK,gBAEjC,KAAKiM,EAAa,CACd,GAAIN,GAAkBjM,EAAUM,KAAK,qBACrCiM,GAAcN,EAAgBZ,KAAK,eAGvCc,EAAYc,YACRrJ,SAAU,OACVsI,SAAUK,EAAYW,QAAQ3C,QAAQ,UAGtC4B,EAAY3G,SAAS,oBACrB2G,EAAY9L,SAAS,OAAOI,KAAK,WAC7B,GAAI0M,GAAM9N,EAAEgD,MACR+K,EAAWjB,EAAY5L,KAAK,cAAgB,KAGhD,IAFA6M,EAAWA,EAASC,MAAM,KAEtBF,EAAI5M,KAAK,SACT,GAAI4M,EAAI3H,SAAS,aACb2H,EAAI7M,KAAK,UAAUmF,KAAK,sBAAwB2H,EAAS,GAAK,kBAAoBA,EAAS,GAAK,gBAC7F,CACH,GAAIE,GAAQH,EAAI9M,SAAS,SACrBkN,EAAQJ,EAAI9M,SAAS,2BACrBmN,EAASL,EAAI9M,SAAS,MAE1BiN,GAAMnK,SAAS,wBAA0BiK,EAAS,IAE9CI,EAAOpL,OAAS,EAChBoL,EAAOrK,SAAS,UAAYiK,EAAS,IAErCG,EAAMpK,SAAS,gBAAgBsC,KAAK,sBAAwB2H,EAAS,GAAK,gBAQlGvN,KAAM,SAAUC,EAAaC,EAAWC,EAAWT,GAC/CC,EAAK,wBAAyBQ,EAE9B,IAAII,GAAmBJ,EAAUM,KAAK,8BAClCiM,EAAcvM,EAAUM,KAAK,sBAC7B6L,EAAcnM,EAAUM,KAAK,iBAC7B4L,EAAWlM,EAAUM,KAAK,aAEN,KAApB4L,EAAS9J,QACThC,EAAiBwC,OAAO,mEAGD,IAAvBuJ,EAAY/J,OACZhC,EAAiBwC,OAAO,wEAExBuJ,EAAYY,OAGW,IAAvBR,EAAYnK,SACZmK,EAAclN,EAAE,kDAChBe,EAAiBwC,OAAO2J,IAG5BlK,KAAK2J,gBAAgBhM,IAGzB6C,WAAY,SAAU7C,EAAWT,GAC7BC,EAAK,8BAA+BQ,EAEpC,IAAIwH,GAAOnF,KACPjC,EAAmBJ,EAAUM,KAAK,8BAClC4L,EAAWlM,EAAUM,KAAK,cAC1B2L,EAAkB5M,EAAE,IAAMW,EAAUO,KAAK,OAAOD,KAAK,sBACrDiM,EAAcN,EAAgBZ,KAAK,cAOvC,OALA7D,GAAKwF,WAAWhN,EAAWuM,GAC3BL,EAASlL,KAAKuL,EAAYW,QAAQ3C,QAAQ,SAC1CvK,EAAUM,KAAK,2CAA2CiC,SAC1DvC,EAAUM,KAAK,iBAAiBwM,OAEzB1M,EAAiBY,QAG5BrB,gBAAgB,EAEhBC,aAAc,gBAEd2D,gBAAiB,SAAUC,EAAMjE,GAC7BC,EAAK,mCAEL,IAAIgI,GAAOnF,IAEX,OAAOhD,GAAEoE,MACLC,IAAK,6CACLC,KAAM,MACNC,SAAU,OACVC,QAAS,SAAUC,GACfN,EAAKxC,KAAK8C,GAEVN,EAAKlD,KAAK,oBAAoBe,GAAG,SAAU,WACvC,GAAIrB,GAAYT,EAAQyE,sBACpBmI,EAAcnM,EAAUM,KAAK,gBAEjC6L,GAAY5L,KAAK,SAAU8B,KAAK8B,SAGpCX,EAAKlD,KAAK,kBAAkBe,GAAG,SAAU,WACrC,GAAIrB,GAAYT,EAAQyE,sBACpBmI,EAAcnM,EAAUM,KAAK,gBAEjC6L,GAAY5L,KAAK,SAAU8B,KAAK8B,SAGpCX,EAAKlD,KAAK,mBAAmBe,GAAG,SAAU,WACtC,GAAIrB,GAAYT,EAAQyE,sBACpBmI,EAAcnM,EAAUM,KAAK,gBAEjC6L,GAAY5L,KAAK,UAAW8B,KAAK8B,SAGrCX,EAAKlD,KAAK,kBAAkBe,GAAG,SAAU,WACrC,GAAIrB,GAAYT,EAAQyE,sBACpBmI,EAAcnM,EAAUM,KAAK,gBAEjC6L,GAAYhL,YAAY,+BACpBkB,KAAK8B,OACLgI,EAAYhJ,SAASd,KAAK8B,OAE9BqD,EAAKwF,WAAWhN,GAChBwD,EAAKlD,KAAK,wBAAwBsH,IAAI,UAA0B,oBAAfvF,KAAK8B,MAA8B,QAAU,UAGlGX,EAAKlD,KAAK,gBAAgBe,GAAG,SAAU,WACnC,GAAIrB,GAAYT,EAAQyE,sBACpBmI,EAAcnM,EAAUM,KAAK,gBAEjC6L,GAAY5L,KAAK,YAAa8B,KAAK8B,OACnCqD,EAAKwF,WAAWhN,SAMhC8E,gBAAiB,SAAUtB,EAAMxD,EAAWT,GACxCC,EAAK,mCAAoCQ,EACzC,IAAImM,GAAcnM,EAAUM,KAAK,iBAE7BmN,EAAS,EACTtB,GAAY3G,SAAS,eACrBiI,EAAS,cACFtB,EAAY3G,SAAS,qBAC5BiI,EAAS,mBAGbjK,EAAKlD,KAAK,oBAAoB2E,IAAIkH,EAAY5L,KAAK,WAAa,IAChEiD,EAAKlD,KAAK,kBAAkB2E,IAAIkH,EAAY5L,KAAK,WAAa,OAC9DiD,EAAKlD,KAAK,mBAAmB2E,IAAIkH,EAAY5L,KAAK,YAClDiD,EAAKlD,KAAK,kBAAkB2E,IAAIwI,GAChCjK,EAAKlD,KAAK,wBAAwBsH,IAAI,UAAsB,oBAAX6F,EAA+B,QAAU,QAC1FjK,EAAKlD,KAAK,gBAAgB2E,IAAIkH,EAAY5L,KAAK,cAAgB,UAIxE8E,QASH,SAAWhG,EAAGqO,GACV,GAAIpO,GAAUD,EAAEE,QACZC,EAAOF,EAAQG,GAEnBH,GAAQI,WAAsB,WAC1BG,KAAM,SAAUC,EAAaC,EAAWC,EAAWT,GAC/CC,EAAK,6BAA8BQ,GAEnCqC,KAAKsL,uBAAuB,WACxBC,eAAe5N,MAIvB6C,WAAY,SAAU7C,EAAWT,GAC7BC,EAAK,mCAAoCQ,EAEzC,IAAII,GAAmBJ,EAAUK,SAAS,6BAI1C,OAHAD,GAAiBE,KAAK,oBAAoBiC,SAC1CvC,EAAUM,KAAK,eAAeU,KAAK,IAE5BZ,EAAiBY,QAG5BrB,gBAAgB,EAEhBC,aAAc,sBAEd2D,gBAAiB,SAAUC,EAAMjE,GAC7BC,EAAK,4BAA6BgE,EAClC,IAAIgE,GAAOnF,IAEX,OAAOhD,GAAEoE,MACLC,IAAK,kDACLC,KAAM,MACNC,SAAU,OACVC,QAAS,SAAUC,GACfN,EAAKxC,KAAK8C,GAEV0D,EAAKmG,uBAAuB,WACxB,GAAI3N,GAAYT,EAAQyE,qBACxBwD,GAAKqG,iBAAiB7N,EAAWwD,IAGrC,IAAIsK,GAAWtK,EAAKlD,KAAK,YACzBkD,GAAKlD,KAAK,YAAYe,GAAG,QAAS,WAC9ByM,EAASf,OAAOgB,OAAO,IAAM1L,KAAK8B,OAAO2I,MAEzC,IAAI9M,GAAYT,EAAQyE,sBACpBgK,EAAShO,EAAUM,KAAK,UACxB2N,EAAajO,EAAUM,KAAK,cAChCN,GAAUO,KAAK,eAAgB8B,KAAK8B,OAEpC6J,EAAsB,aAAf3L,KAAK8B,MAAuB,OAAS,UAC5C8J,EAA0B,aAAf5L,KAAK8B,MAAuB,OAAS,UAE7B,aAAf9B,KAAK8B,OACLqD,EAAK0G,mBAAmB1K,EAAMxD,KAItCwD,EAAKlD,KAAK,uBAAuBe,GAAG,SAAU,WAC1C,GAAI2M,GAAS3O,EAAEgD,KAAK8B,OAChBuB,EAAMsI,EAAOzN,KAAK,MAClByN,GAAO5L,OAAS,GAAKsD,GAAOA,EAAItD,OAAS,EACzC7C,EAAQyE,sBAAsB1D,KAAK,0BAA0BC,KAAK,MAAOmF,GAEzEyI,MAAM,4CAId3K,EAAKlD,KAAK,mBAAmBe,GAAG,QAAS,WACrC,GAAIrB,GAAYT,EAAQyE,qBAExBhE,GAAUM,KAAK,qBAAqBa,YAAY,gDAAgDgC,SAAS,oBAAsBd,KAAK8B,aAMpJwJ,uBAAwB,SAAUS,GAC9B,GAAI5G,GAAOnF,KACPgM,EAAS,0CACT3K,EAAM,+CAAiD2K,EAAS,mBAEhEX,GAAOY,QAAUZ,EAAOY,OAAOC,MAAQD,OAAOC,KAAKC,OACnDJ,EAAS5M,KAAKgG,GAEdnI,EAAEgF,cAAcX,EAAK,WACjB0K,EAAS5M,KAAKgG,MAK1B0G,mBAAoB,SAAU1K,EAAMxD,GAChC,GAAIuN,GAAQ/J,EAAKlD,KAAK,qBAAqB,EAE3CmO,YAAW,WACPH,OAAOC,KAAKG,MAAM9E,QAAQ2D,EAAO,SACjCe,OAAOC,KAAKG,MAAM9E,QAAQ2D,EAAO,WAC7BoB,QAAS,MAEd,IAEH,IAAIC,GAAM5O,EAAUM,KAAK,eAAe+K,KAAK,MAC7CoD,YAAW,WACPH,OAAOC,KAAKG,MAAM9E,QAAQgF,EAAK,WAChC,MAGP9J,gBAAiB,SAAUtB,EAAMxD,EAAWT,GACxC,GAAIiI,GAAOnF,IAEXmF,GAAKmG,uBAAuB,WACxB,GAAIkB,GAAU7O,EAAUO,KAAK,iBAAmB,QAC5CuO,EAAQ9O,EAAUO,KAAK,cAEvBwO,EAAQ/O,EAAUM,KAAK,qBAAqBkF,SAAS,0BAA4B,QAAU,MAC/FhC,GAAKlD,KAAK,mBAAqByO,EAAQ,KAAK3N,KAAK,WAAW,GAC5DoC,EAAKlD,KAAK,kBAAoBuO,EAAU,KAAKzN,KAAK,WAAW,EAE7D,IAAIsE,GAAM1F,EAAUM,KAAK,UAAUC,KAAK,OACpCyN,EAAS,8CAAgDtI,EAAM,aAC9DoJ,KACDA,EAAQ,kBAEZtL,EAAKlD,KAAK,qBAAqB2E,IAAI6J,GACnCtL,EAAKlD,KAAK,uBAAuB2E,IAAI+I,GAErCxK,EAAKlD,KAAK,aAAayM,OAAOgB,OAAO,IAAMc,GAAS/B,OAE/C9M,EAAUM,KAAK,eAAe+K,KAAK,OAOpB,aAAZwD,GACArH,EAAK0G,mBAAmB1K,EAAMxD,IAPlCwH,EAAKqG,iBAAiB7N,EAAWwD,GAEjB,aAAZqL,GACArH,EAAK0G,mBAAmB1K,EAAMxD,OAU9C6N,iBAAkB,SAAU7N,EAAWwD,GACnC,GAAIxD,EAAUM,KAAK,eAAe+K,KAAK,OACnChJ,KAAK6L,mBAAmB1K,EAAMxD,OAC3B,CACH,GAAIgP,GAAShP,EAAUM,KAAK,eAAe,GACvCsO,EAAM,GAAIN,QAAOC,KAAKU,IAAID,GAC1BE,KAAM,GACNC,UAAW,YAIX5B,EAAQ/J,EAAKlD,KAAK,qBAAqB,GACvC8O,EAAY,GAAId,QAAOC,KAAKC,OAAOa,UAAU9B,EAGjDqB,GAAIU,YAAY,iBAAkB,WAC9BF,EAAUG,UAAUX,EAAIY,cAG5B,IAAIC,KACJL,GAAUE,YAAY,iBAAkB,WACpC,GAAId,GAASY,EAAUM,WAEvB,IAAqB,GAAjBlB,EAAOpM,OAAX,CAKAqN,EAAQE,QAAQ,SAAUC,GACtBA,EAAOC,OAAO,QAElBJ,IAGA,IAAIK,GAAS,GAAIxB,QAAOC,KAAKwB,YAC7BvB,GAAOmB,QAAQ,SAAUb,GACrB,IAAKA,EAAMkB,SAEP,WADAC,SAAQxQ,IAAI,sCAIhB,IAAImF,IACAlB,IAAKoL,EAAMlK,KACXsL,KAAM,GAAI5B,QAAOC,KAAK4B,KAAK,GAAI,IAC/BC,OAAQ,GAAI9B,QAAOC,KAAK8B,MAAM,EAAG,GACjCC,OAAQ,GAAIhC,QAAOC,KAAK8B,MAAM,GAAI,IAClCE,WAAY,GAAIjC,QAAOC,KAAK4B,KAAK,GAAI,IAIzCV,GAAQ/H,KAAK,GAAI4G,QAAOC,KAAKiC,QACzB5B,IAAKA,EACLhK,KAAMA,EACN7D,MAAO+N,EAAM2B,KACbC,SAAU5B,EAAMkB,SAASW,YAGzB7B,EAAMkB,SAASY,SAEfd,EAAOe,MAAM/B,EAAMkB,SAASY,UAE5Bd,EAAO5F,OAAO4E,EAAMkB,SAASW,YAGrC/B,EAAIkC,UAAUhB,GACd9P,EAAUO,KAAK,aAAcgN,EAAMpJ,UAGvCnE,EAAUM,KAAK,eAAe+K,KAAK,MAAOuD,OAKvDvJ,OAAQqI,QASX,SAAWrO,GACP,GAAIC,GAAUD,EAAEE,QACZwR,EAAgB1R,EAAE0R,cAClBvR,EAAOF,EAAQG,GAEnBH,GAAQI,WAAsB,WAC1BC,gBAAgB,EAEhBC,aAAc,qBACdC,KAAM,SAAUC,EAAaC,EAAWC,EAAWT,GAC/C,GACIU,GAAUV,EAAQU,QAElBG,EAAmBJ,EAAUK,SAAS,6BAC1CD,GAAiBgB,KAAK,mBAAmB,GAEzChB,EAAiBiB,GAAG,QAAS,SAAUC,GACO,kBAA/BrB,GAAQsB,oBACftB,EAAQsB,mBAAmBC,KAAK1B,EAAawB,EAAGtB,GAGV,kBAA/BC,GAAQwB,oBACfxB,EAAQwB,mBAAmBD,KAAK1B,EAAawB,EAAGvB,GAGZ,kBAA7BE,GAAQyB,kBACfzB,EAAQyB,iBAAiBF,KAAK1B,EAAawB,IAInD,IAAIK,GAASvB,EAAiBwB,SAAS3B,EAAQ4B,iBAAiBF,MAChEA,GAAON,GAAG,gBAAiB,WACvB7B,EAAK,oBAAqBQ,GAEc,kBAA7BC,GAAQ6B,kBACf7B,EAAQ6B,iBAAiBN,KAAK1B,EAAaE,EAAW2B,MAKlEkB,WAAY,SAAU7C,EAAWT,GAC7BC,EAAK,mCAAoCQ,EAEzC,IAAII,GAAmBJ,EAAUM,KAAK,8BAClCJ,EAAKE,EAAiBG,KAAK,MAC3BoB,EAAS0B,SAASC,UAAUpD,EAChC,OAAIyB,GACOA,EAAO4I,UAEPnK,EAAiBY,QAIhCuC,gBAAiB,SAAUC,EAAMjE,GAG7B,MAFAC,GAAK,4BAA6BgE,GAE3BnE,EAAEoE,MACLC,IAAK,kDACLC,KAAM,MACNC,SAAU,OACVC,QAAS,SAAUC,GACfN,EAAKxC,KAAK8C,GAEVN,EAAKlD,KAAK,gBAAgBe,GAAG,QAAS,WAClC,GAAI0C,GAAOxE,EAAQyE,qBACnBD,GAAKzD,KAAK,cAAc+B,KAAK4B,QAAU,WAAa,eAAe,sBAGvE,IAAI+M,GAAoBxN,EAAKlD,KAAK,uBAClCyQ,GAAcE,sBAAsBD,EAAmB,SAAUE,GAC7D,GAAInN,GAAOxE,EAAQyE,qBACnBD,GAAKzD,KAAK,cAAcsH,IAAI,mBAAoBsJ,GAChDnN,EAAKxD,KAAK,eAAgB2Q,IAG9B,IAAIC,GAAkB3N,EAAKlD,KAAK,mBAChC6Q,GAAgB9P,GAAG,SAAU,WACzB,GAAI+P,GAAe/O,KAAK8B,OAAS,GAC7BnE,EAAYT,EAAQyE,sBACpBqN,EAAchS,EAAEgD,MAAM9B,KAAK,OACH,MAAxB6Q,EAAajG,OACbnL,EAAUM,KAAK,cAAcsH,IAAIyJ,EAAa,KAE1CvH,MAAMsH,KACNA,EAAe,EACf/O,KAAK8B,MAAQiN,GAEjBpR,EAAUM,KAAK,cAAcsH,IAAIyJ,EAAaD,EAAe,QAIrE,IAAIE,GAAiB9N,EAAKlD,KAAK,kBAC/BgR,GAAejQ,GAAG,SAAU,WACxB,GAAI+P,GAAe/O,KAAK8B,OAAS,GAC7BnE,EAAYT,EAAQyE,sBACpBqN,EAAchS,EAAEgD,MAAM9B,KAAK,OACH,MAAxB6Q,EAAajG,OACbnL,EAAUM,KAAK,cAAcsH,IAAIyJ,EAAa,KAE1CvH,MAAMsH,KACNA,EAAe,EACf/O,KAAK8B,MAAQiN,GAEjBpR,EAAUM,KAAK,cAAcsH,IAAIyJ,EAAaD,EAAe,aAOjFtM,gBAAiB,SAAUtB,EAAMxD,EAAWT,GACxCC,EAAK,wCAAyCQ,GAC9CwD,EAAKlD,KAAK,uBAAuB2E,IAAIjF,EAAUO,KAAK,iBAAiBqJ,QAAQ,UAC7EpG,EAAKlD,KAAK,oBAAoBG,KAAK,WAC/BpB,EAAEgD,MAAM4C,IAAIjF,EAAUM,KAAK,cAAcsH,IAAIvI,EAAEgD,MAAM9B,KAAK,SAAS6J,QAAQ,KAAM,OAErF5G,EAAKlD,KAAK,mBAAmBG,KAAK,WAC9BpB,EAAEgD,MAAM4C,IAAIjF,EAAUM,KAAK,cAAcsH,IAAIvI,EAAEgD,MAAM9B,KAAK,SAAS6J,QAAQ,KAAM,OAErF5G,EAAKlD,KAAK,kCAAkCc,KAAK,UAAWpB,EAAUM,KAAK,KAAKkF,SAAS,SACzFhC,EAAKlD,KAAK,gBAAgBc,KAAK,UAAWpB,EAAUM,KAAK,cAAckF,SAAS,uBAGpFpC,QAAS,SAAUpD,EAAWT,GAC1BC,EAAK,2BAA4BQ,EAEjC,IAAIE,GAAKF,EAAUM,KAAK,8BAA8BC,KAAK,MACvDoB,EAAS0B,SAASC,UAAUpD,EAC5ByB,IACAA,EAAOyB,aAKpBiC,QAUH,SAAWhG,GACP,GAAIC,GAAUD,EAAEE,QACZC,EAAOF,EAAQG,GAEnBH,GAAQI,WAAoB,SACxBG,KAAM,SAAUC,EAAaC,EAAWC,EAAWT,GAC/C,GAAIgS,GAASvR,EAAUM,KAAK,SACxBiR,GAAOnP,QACPmP,EAAOhP,SAEPvC,EAAUO,KAAK,gBACfP,EAAUM,KAAK,YAAYsH,IAAI,UAAW5H,EAAUO,KAAK,gBAE7DlB,EAAEgF,cAAc,2DAA4D,WACxEhF,EAAEgF,cAAc,yDAA0D,WACtErE,EAAUM,KAAK,YAAYkR,WACvB5C,IAAK,UACL6C,gBAAiB,OACjBC,aAAa,EACbC,SACIC,EAAG,GACHC,EAAG,GACHC,MAAO,GAEXC,aACIC,SACIC,KAAM,WAEVC,OACID,KAAM,YAGdE,gBAAiB,SAAU7Q,EAAG8Q,EAAIC,GAC1BrS,EAAUO,KAAK,QAAU8R,IACzBD,EAAGpR,KAAKoR,EAAGpR,OAAS,MAAQhB,EAAUO,KAAK,QAAU8R,MAGjE,IAAIxK,GAAIyK,YAAY,WAChB,IACI,GAAI1D,GAAM5O,EAAUM,KAAK,YAAYkR,UAAU,MAAO,YACtD5C,GAAI2D,aACJC,cAAc3K,GAChB,MAAOvG,GACL9B,EAAK,qCAEV,SAIfqD,WAAY,SAAU7C,EAAWT,GAC7BC,EAAK,gCAAiCQ,EACtC,IAAII,GAAmBJ,EAAUK,SAAS,8BACtCkR,EAAS,8wBACT3J,EAAM,sFACV5H,GAAUM,KAAK,yBAAyBiC,QACxC,IAAIkQ,GAAMpT,EAAE0C,SAASiI,MAAM1J,KAAK,wDAQhC,OAPImS,GAAIrQ,OAAS,GACT/C,EAAEoT,EAAIA,EAAIrQ,OAAS,IAAI7B,KAAK,QAAUP,EAAUO,KAAK,QACrDlB,EAAEuI,GAAK8K,aAAa1S,EAAUM,KAAK,aACnCjB,EAAEkS,GAAQoB,YAAY3S,EAAUM,KAAK,cAItCF,EAAiBY,QAG5BrB,gBAAgB,EAEhBC,aAAc,kBAEd2D,gBAAiB,SAAUC,EAAMjE,GAG7B,MAFAC,GAAK,yBAA0BgE,GAExBnE,EAAEoE,MACLC,IAAK,gDACLC,KAAM,MACNC,SAAU,OACVC,QAAS,SAAUC,GACfN,EAAKxC,KAAK8C,EAEV,IAAI9D,GAAYT,EAAQyE,qBACxBR,GAAKlD,KAAK,UAAUe,GAAG,SAAU,SAAUC;AACvC,GAAI2D,GAAMjF,EAAUO,KAAK,QAAU8B,KAAK8B,MACxCX,GAAKlD,KAAK,iBAAiB2E,IAAIA,KAEnCzB,EAAKlD,KAAK,iBAAiBe,GAAG,SAAU,SAAUC,GAC9C,GAAIsR,GAAepP,EAAKlD,KAAK,UAAU2E,KACvCjF,GAAUO,KAAK,QAAUqS,EAAcvQ,KAAK8B,SAEhDX,EAAKlD,KAAK,WAAWe,GAAG,SAAU,SAAUC,GACxCtB,EAAUO,KAAK,cAAe8B,KAAK8B,OACnCnE,EAAUM,KAAK,YAAYsH,IAAI,SAAUvF,KAAK8B,MAC9C,IAAIyK,GAAM5O,EAAUM,KAAK,YAAYkR,UAAU,MAAO,YACtD5C,GAAI2D,mBAKpBzN,gBAAiB,SAAUtB,EAAMxD,EAAWT,GACxC,GAAIwH,GAAS/G,EAAUO,KAAK,eACxBsS,EAAerP,EAAKlD,KAAK,UAAU2E,KACvCzB,GAAKlD,KAAK,WAAW2E,IAAI8B,GACzBvD,EAAKlD,KAAK,iBAAiB2E,IAAIjF,EAAUO,KAAK,QAAUsS,OAGjExN,QASH,SAAWhG,GACP,GAAIC,GAAUD,EAAEE,QACZC,EAAOF,EAAQG,GAEnBH,GAAQI,WAAkB,OACtBG,KAAM,SAAUC,EAAaC,EAAWC,EAAWT,GAC/CC,EAAK,yBAA0BQ,EAE/B,IAAII,GAAmBJ,EAAUK,SAAS,8BACtCiF,EAAMlF,EAAiBE,KAAK,MAEhCgF,GAAIsC,IAAI,UAAW,gBACdtC,EAAIsC,IAAI,mBACTtC,EAAIsC,IAAI,iBAAkB,SAG9B,IAAI3H,GAAUV,EAAQU,OACkB,mBAA7BA,GAAQ6B,kBACf7B,EAAQ6B,iBAAiBN,KAAK1B,EAAaE,IAInDL,gBAAgB,EAEhBC,aAAc,iBAEd2D,gBAAiB,SAAUC,EAAMjE,GAC7BC,EAAK,wBAAyBgE,EAAMjE,EAEpC,IAAIiI,GAAOnF,IACG9C,GAAQU,OAEtB,OAAOZ,GAAEoE,MACLC,IAAK,8CACLC,KAAM,MACNC,SAAU,OACVC,QAAS,SAAUC,GACfN,EAAKxC,KAAK8C,EAEV,IAAIgP,GAAUtP,EAAKlD,KAAK,cACxBwS,GAAQzR,GAAG,SAAU,WACjB,GAAI0R,GAAO1Q,KAAK8B,MAAMgH,OAClB6H,EAAW,kNACXC,EAAOH,EAAQI,OACfC,EAAYL,EAAQvJ,QAAQ,cAE5ByJ,GAAQI,KAAKL,IACbxT,EAAQyE,sBAAsB1D,KAAK,KAAKC,KAAK,OAAQwS,GACrDE,EAAKlG,OACLoG,EAAUhS,YAAY,eAEtB8R,EAAKnG,OACLqG,EAAUhQ,SAAS,eAI3B,IAAIkQ,GAAY7P,EAAKlD,KAAK,gBAC1B+S,GAAUhS,GAAG,SAAU,WACnB9B,EAAQyE,sBAAsB1D,KAAK,KAAKC,KAAK,SAAU8B,KAAK8B,QAGhE,IAAImP,GAAc9P,EAAKlD,KAAK,kBAC5BgT,GAAYjS,GAAG,QAAS,WACpB,GAAIiE,GAAM/F,EAAQyE,sBAAsB1D,KAAK,MAEzCgT,GAAYC,GAAG,aACfT,EAAQ1R,KAAK,YAAY,GACzBiS,EAAUjS,KAAK,YAAY,GAC3BkE,EAAIG,KAAK,qBAETqN,EAAQ1R,KAAK,YAAY,GACzBiS,EAAUjS,KAAK,YAAY,GAC3BkE,EAAIkO,OAAO,OAInB,IAAIC,GAAajQ,EAAKlD,KAAK,eAC3BmT,GAAWpS,GAAG,SAAU,WACpB,GAAIqS,GAAQnU,EAAQyE,sBAAsB1D,KAAK,eAC/CoT,GAAM9L,IAAI,aAAcvF,KAAK8B,QAGjC,IAAIwP,GAAcnQ,EAAKlD,KAAK,WAC5BqT,GAAYtS,GAAG,SAAU,WACrB,GAAIqS,GAAQnU,EAAQyE,sBAAsB1D,KAAK,gBAAgBA,KAAK,MACpEoT,GAAM9L,IAAI,iBAAkBvF,KAAK8B,QAGrC,IAAIyP,GAAkBpQ,EAAKlD,KAAK,oBAChCsT,GAAgBvS,GAAG,QAAS,WACxB9B,EAAQyE,sBAAsB1D,KAAK,OAAO+B,KAAK4B,QAAU,WAAa,eAAe,mBAGzF,IAAI4P,GAAWrQ,EAAKlD,KAAK,eACzBuT,GAASxS,GAAG,SAAU,WAClB,GAAIiE,GAAM/F,EAAQyE,sBAAsB1D,KAAK,OACzC2E,EAAM5C,KAAK8B,KAEfmB,GAAInE,YAAY,wCACZ8D,GACAK,EAAInC,SAAS8B,IAIrB,IAAI6O,GAAatQ,EAAKlD,KAAK,gBACvByT,EAAcvQ,EAAKlD,KAAK,gBAC5BwT,GAAWzS,GAAG,SAAU,WACpB,GAAIiE,GAAM/F,EAAQyE,sBAAsB1D,KAAK,OACzC0T,GAAY3R,KAAK8B,MACjB8P,EAAYC,KAAKC,MAAMH,EAAWxM,EAAKuH,MAEvCiF,IAAY,IACZA,EAAWxM,EAAK7B,MAChBsO,EAAYzM,EAAKT,OACjB1E,KAAK8B,MAAQ6P,GAGjB1O,EAAIsC,KACAjC,MAASqO,EACTjN,OAAUkN,IAEdF,EAAY9O,IAAIgP,KAEpBF,EAAY1S,GAAG,SAAU,WACrB,GAAIiE,GAAM/F,EAAQyE,sBAAsB1D,KAAK,OACzC2T,GAAa5R,KAAK8B,MAClB6P,EAAWE,KAAKC,MAAMF,EAAYzM,EAAKuH,MAEvCkF,IAAa,IACbD,EAAWxM,EAAK7B,MAChBsO,EAAYzM,EAAKT,OACjB1E,KAAK8B,MAAQ8P,GAGjB3O,EAAIsC,KACAb,OAAUkN,EACVtO,MAASqO,IAEbF,EAAW7O,IAAI+O,IAGnB,IAAII,GAAY5Q,EAAKlD,KAAK,cAC1B8T,GAAUlO,SACNC,cAAe,SACfC,UAAU,EACVC,SAAU9G,EAAQU,QAAQoG,SAC1BC,SAAU/G,EAAQU,QAAQqG,SAC1BC,aAAc,SAAU7C,EAAK2Q,EAAaC,EAAU3M,GAChD,GAAIrC,GAAM/F,EAAQyE,sBAAsB1D,KAAK,OACzCoF,EAAM,kBAAoBiC,CAE9BtI,GAAE,WAAWkB,KAAK,MAAOmF,GAAK0B,KAAK,WAC/B9B,EAAI/E,KAAK,MAAOmF,GAAKkC,KACjBjC,MAAOtD,KAAKsD,MACZoB,OAAQ1E,KAAK0E,SAEjBS,EAAKuH,MAAQ1M,KAAKsD,MAAQtD,KAAK0E,OAC/BS,EAAK7B,MAAQtD,KAAKsD,MAClB6B,EAAKT,OAAS1E,KAAK0E,OACnB+M,EAAW7O,IAAI5C,KAAKsD,OACpBoO,EAAY9O,IAAI5C,KAAK0E,iBAQ7CjC,gBAAiB,SAAUtB,EAAMxD,EAAWT,GACxCC,EAAK,oCAAqCQ,EAE1C,IAAIwH,GAAOnF,KACPoR,EAAajQ,EAAKlD,KAAK,gBACvBqT,EAAcnQ,EAAKlD,KAAK,YACxBsT,EAAkBpQ,EAAKlD,KAAK,qBAC5BwT,EAAatQ,EAAKlD,KAAK,gBACvByT,EAAcvQ,EAAKlD,KAAK,iBACxBuT,EAAWrQ,EAAKlD,KAAK,gBACrBwS,EAAUtP,EAAKlD,KAAK,eACpB+S,EAAY7P,EAAKlD,KAAK,iBACtBgT,EAAc9P,EAAKlD,KAAK,kBAE5BwS,GAAQI,OAAOnG,OACf+F,EAAQvJ,QAAQ,eAAepI,YAAY,YAE3C,IAAIuS,GAAQ1T,EAAUM,KAAK,gBACvBgF,EAAMoO,EAAMpT,KAAK,OAEjBiU,EAAIjP,EAAIvC,OAAO,IACfwR,GAAEnS,OAAS,GACXkR,EAAYlS,KAAK,WAAW,GAC5B0R,EAAQ1R,KAAK,YAAY,GAAO6D,IAAIsP,EAAEhU,KAAK,SAC3C8S,EAAUjS,KAAK,YAAY,GAAO6D,IAAIsP,EAAEhU,KAAK,aAE7C+S,EAAYlS,KAAK,WAAW,GAC5B0R,EAAQ1R,KAAK,YAAY,GAAM6D,IAAI,IACnCoO,EAAUjS,KAAK,YAAY,GAAM6D,IAAI,IAGzC,IAAIuP,GAAQd,EAAM9L,IAAI,aACR,WAAV4M,GAA+B,WAAVA,IACrBA,EAAQ,OAGZ,IAAIC,GAASnP,EAAIsC,IAAI,iBAEjBtC,GAAIE,SAAS,eACbqO,EAAS5O,IAAI,eACNK,EAAIE,SAAS,cACpBqO,EAAS5O,IAAI,cACNK,EAAIE,SAAS,iBACpBqO,EAAS5O,IAAI,iBAEb4O,EAAS5O,IAAI,IAEjBwO,EAAWxO,IAAIuP,GACfb,EAAY1O,IAAIwP,GAChBb,EAAgBxS,KAAK,UAAWkE,EAAIE,SAAS,mBAC7CsO,EAAW7O,IAAIK,EAAIK,SACnBoO,EAAY9O,IAAIK,EAAIyB,UAEpB1H,EAAE,WAAWkB,KAAK,MAAO+E,EAAI/E,KAAK,QAAQ6G,KAAK,WAC3CI,EAAKuH,MAAQ1M,KAAKsD,MAAQtD,KAAK0E,OAC/BS,EAAK7B,MAAQtD,KAAKsD,MAClB6B,EAAKT,OAAS1E,KAAK0E,YAKhC1B,QASH,SAAWhG,GACP,GAAIC,GAAUD,EAAEE,QACZwR,EAAgB1R,EAAE0R,cAClBvR,EAAOF,EAAQG,GAEnB4D,UAASqR,mBAAoB,EAC7BrR,SAASsR,IAAIC,aAAgB,GAAI,EAIjCtV,EAAQI,WAAiB,MACrBG,KAAM,SAAUC,EAAaC,EAAWC,EAAWT,GAC/CC,EAAK,wBAAyBQ,EAE9B,IAAIC,GAAUV,EAAQU,QAElBG,EAAmBJ,EAAUM,KAAK,8BAClCuU,EAAgBzU,EAAiBE,KAAK,wCAE1C,IAA6B,IAAzBuU,EAAczS,OAAc,CAC5B,GAAI0S,GAAc1U,EAAiBY,MACnC6T,GAAgBxV,EAAE,qEAClBe,EAAiBY,KAAK6T,GACtBA,EAAc7T,KAAK8T,GACnBD,EAAcpP,KAAK,sDAGlBoP,EAActU,KAAK,OACpBsU,EAActU,KAAK,KAAMhB,EAAQY,WAAW,iCAGhD0U,EAAczT,KAAK,mBAAmB,GACtCyT,EAAcxT,GAAG,QAAS,SAAUC,GACU,kBAA/BrB,GAAQsB,oBACftB,EAAQsB,mBAAmBC,KAAK1B,EAAawB,EAAGtB,GAGV,kBAA/BC,GAAQwB,oBACfxB,EAAQwB,mBAAmBD,KAAK1B,EAAawB,EAAGvB,GAGZ,kBAA7BE,GAAQyB,kBACfzB,EAAQyB,iBAAiBF,KAAK1B,EAAawB,IAInD,IAAIK,GAASkT,EAAcjT,SAAS3B,EAAQ4B,iBAAiBF,MAC7DA,GAAON,GAAG,gBAAiB,WACvB7B,EAAK,oBAAqBQ,GAEc,kBAA7BC,GAAQ6B,kBACf7B,EAAQ6B,iBAAiBN,KAAK1B,EAAaE,EAAW2B,MAKlEkB,WAAY,SAAU7C,EAAWT,GAC7BC,EAAK,8BAA+BQ,EAEpC,IAAII,GAAmBJ,EAAUM,KAAK,8BAClCyU,EAAuB3U,EAAiBE,KAAK,mCAE7CJ,EAAK6U,EAAqB1U,WAAWE,KAAK,MAC1CoB,EAAS0B,SAASC,UAAUpD,EAKhC,OAJIyB,IACAoT,EAAqB/T,KAAK,8DAAgEW,EAAO4I,UAAY,UAG1GnK,EAAiBY,QAG5BoC,QAAS,SAAUpD,EAAWT,GAC1BC,EAAK,2BAA4BQ,EAEjC,IAAIE,GAAKF,EAAUM,KAAK,8BAA8BC,KAAK,MACvDoB,EAAS0B,SAASC,UAAUpD,EAC5ByB,IACAA,EAAOyB,WAIfzD,gBAAgB,EAEhBC,aAAc,gBAEd2D,gBAAiB,SAAUC,EAAMjE,GAG7B,MAFAC,GAAK,oCAEEH,EAAEoE,MACLC,IAAK,6CACLC,KAAM,MACNC,SAAU,OACVC,QAAS,SAAUC,GACfN,EAAKxC,KAAK8C,GAKVN,EAAKlD,KAAK,0BAA0B4F,SAChCC,cAAe,SACfC,UAAU,EACVC,SAAU9G,EAAQU,QAAQoG,SAC1BC,SAAU/G,EAAQU,QAAQqG,SAC1BC,aAAc,SAAU7C,EAAK2Q,EAAaC,EAAU3M,GAChD,GAAIqN,GAASzV,EAAQyE,sBAAsB1D,KAAK,mCAC5C2U,EAAW,UAAYvH,OAAOiD,SAASuE,KAAO,kBAAoBvN,CACtEqN,GAAOpN,IAAI,mBAAoB,QAAUqN,EAAW,MACpDzR,EAAKlD,KAAK,+BAA+BC,KAAK,MAAO0U,MAG7DzR,EAAKlD,KAAK,4BAA4Be,GAAG,QAAS,SAAUC,GACxDA,EAAEW,gBAEF,IAAI+S,GAASzV,EAAQyE,sBAAsB1D,KAAK,kCAChD0U,GAAOpN,IAAI,mBAAoB,IAC/BpE,EAAKlD,KAAK,+BAA+BC,KAAK,MAAO,oCAGzD,IAAI4U,GAAc3R,EAAKlD,KAAK,gBAC5ByQ,GAAcE,sBAAsBkE,EAAa,SAAUjE,GACvD8D,OAAOpN,IAAI,mBAAoBsJ,KAGnC1N,EAAKlD,KAAK,qBAAqBe,GAAG,SAAU,WACxC,GAAI2T,GAASzV,EAAQyE,sBAAsB1D,KAAK,kCAEhD0U,GAAOpN,IAAI,oBAAqBvF,KAAK8B,SAGzCX,EAAKlD,KAAK,mBAAmBe,GAAG,SAAU,WACtC,GAAI2T,GAASzV,EAAQyE,sBAAsB1D,KAAK,kCAEhD0U,GAAOpN,IAAI,kBAAmBvF,KAAK8B,SAGvCX,EAAKlD,KAAK,uBAAuBe,GAAG,SAAU,WAC1C,GAAI2T,GAASzV,EAAQyE,sBAAsB1D,KAAK,kCAEhD0U,GAAOpN,IAAI,sBAAuBvF,KAAK8B,SAM3CX,EAAKlD,KAAK,gBAAgBG,KAAK,WAC3B,GAAI2U,GAAM/V,EAAEgD,MACRgT,EAAYD,EAAI7U,KAAK,kBAEzB6U,GAAI/T,GAAG,SAAU,WACb,GAAI+P,GAAe/O,KAAK8B,OAAS,GAC7B6Q,EAASzV,EAAQyE,sBAAsB1D,KAAK,mCAAmCgV,IAAI,EAE3D,MAAxBlE,EAAajG,OACb6J,EAAOO,MAAMF,GAAa,IAEtBvL,MAAMsH,KACNA,EAAe,EACf/O,KAAK8B,MAAQiN,GAEjB4D,EAAOO,MAAMF,GAAajE,EAAe,UAQrD5N,EAAKlD,KAAK,eAAeG,KAAK,WAC1B,GAAI2U,GAAM/V,EAAEgD,MACRgT,EAAYD,EAAI7U,KAAK,kBAEzB6U,GAAI/T,GAAG,SAAU,WACb,GAAImU,GAAcnT,KAAK8B,OAAS,GAC5B6Q,EAASzV,EAAQyE,sBAAsB1D,KAAK,mCAAmCgV,IAAI,EAE5D,MAAvBE,EAAYrK,OACZ6J,EAAOO,MAAMF,GAAa,IAEtBvL,MAAM0L,KACNA,EAAc,EACdnT,KAAK8B,MAAQqR,GAEjBR,EAAOO,MAAMF,GAAaG,EAAc,UAQpDhS,EAAKlD,KAAK,eAAee,GAAG,SAAU,WAClC,GAAI0F,GAAS1E,KAAK8B,OAAS,EACvB2F,OAAM/C,KACNA,EAAS,GAGb,IAAIiO,GAASzV,EAAQyE,sBAAsB1D,KAAK,kCAChD0U,GAAOpN,IAAI,SAAUb,KAGzBvD,EAAKlD,KAAK,mBAAmBe,GAAG,SAAU,WACtC,GAAIoU,GAAYpT,KAAK8B,OAAS,EAC1B2F,OAAM2L,KACNA,EAAY,GAGhB,IAAIT,GAASzV,EAAQyE,sBAAsB1D,KAAK,kCAChD0U,GAAOpN,IAAI,aAAc6N,EAAY,QAGzCjS,EAAKlD,KAAK,cAAce,GAAG,SAAU,WACjC,GAAIsE,GAAQtD,KAAK8B,OAAS,EACtB2F,OAAMnE,KACNA,EAAQ,GAGZ,IAAIqP,GAASzV,EAAQyE,sBAAsB1D,KAAK,kCAChD0U,GAAOpN,IAAI,QAASjC,KAGxBnC,EAAKlD,KAAK,kBAAkBe,GAAG,SAAU,WACrC,GAAIqU,GAAWrT,KAAK8B,OAAS,EACzB2F,OAAM4L,KACNA,EAAW,GAGf,IAAIV,GAASzV,EAAQyE,sBAAsB1D,KAAK,kCAChD0U,GAAOpN,IAAI,YAAa8N,EAAW,YAMnD5Q,gBAAiB,SAAUtB,EAAMxD,EAAWT,GACxCC,EAAK,mCAAoCQ,EAEzC,IAAIgV,GAAShV,EAAUM,KAAK,mCAAmCgV,IAAI,GAE/DL,EAAWD,EAAOO,MAAMI,eAC5BV,IAAYA,GAAY,IAAI7K,QAAQ,0BAA2B,MAC/D5G,EAAKlD,KAAK,+BAA+BC,KAAK,MAAoB,SAAb0U,GAAoC,KAAbA,EAAkBA,EAAW,mCAEzGzR,EAAKlD,KAAK,qBAAqB2E,IAAI+P,EAAOO,MAAMK,kBAAoB,UACpEpS,EAAKlD,KAAK,uBAAuB2E,IAAI+P,EAAOO,MAAMM,oBAAsB,SACxErS,EAAKlD,KAAK,mBAAmB2E,IAAI+P,EAAOO,MAAM9J,gBAAkB,QAEhEjI,EAAKlD,KAAK,iBAAiB2E,IAAI+P,EAAOO,MAAM9D,iBAAmB,IAAI7H,QAAQ,UAE3EpG,EAAKlD,KAAK,gBAAgBG,KAAK,WAC3B,GAAI2U,GAAM/V,EAAEgD,MACRgT,EAAYD,EAAI7U,KAAK,kBAEzB6U,GAAInQ,KAAK+P,EAAOO,MAAMF,IAAc,IAAIjL,QAAQ,KAAM,OAE1D5G,EAAKlD,KAAK,eAAeG,KAAK,WAC1B,GAAI2U,GAAM/V,EAAEgD,MACRgT,EAAYD,EAAI7U,KAAK,kBAEzB6U,GAAInQ,KAAK+P,EAAOO,MAAMF,IAAc,IAAIjL,QAAQ,KAAM,OAG1D5G,EAAKlD,KAAK,eAAe2E,KAAK+P,EAAOO,MAAMxO,QAAU,IAAIqD,QAAQ,KAAM,KACvE5G,EAAKlD,KAAK,mBAAmB2E,KAAK+P,EAAOO,MAAME,WAAa,IAAIrL,QAAQ,KAAM,KAC9E5G,EAAKlD,KAAK,cAAc2E,KAAK+P,EAAOO,MAAM5P,OAAS,IAAIyE,QAAQ,KAAM,KACrE5G,EAAKlD,KAAK,gBAAgB2E,KAAK+P,EAAOO,MAAMG,UAAY,IAAItL,QAAQ,KAAM,QAInF/E,QASH,SAAWhG,GACP,GAAIC,GAAUD,EAAEE,QACZC,EAAOF,EAAQG,GAEnBH,GAAQI,WAAkB,OACtBG,KAAM,SAAUC,EAAaC,EAAWC,EAAWT,GAC/CC,EAAK,yBAA0BQ,EAE/B,IAAIwH,GAAOnF,KAEPiD,EAAMtF,EAAUM,KAAK,sBACzBgF,GAAI/E,KAAK,KAAMhB,EAAQY,WAAW,mBAElC,IAAI2V,GAAUxQ,EAAIvC,QACb+S,GAAQtQ,SAAS,mBAClBF,EAAIG,KAAK,qCACTqQ,EAAUxQ,EAAIvC,UAGlB+S,EAAQvV,KAAK,UAAW+E,EAAI/E,KAAK,OACjCuV,EAAQvV,KAAK,iBAAkB+E,EAAI/E,KAAK,mBACxCuV,EAAQvV,KAAK,mBAAoB+E,EAAI/E,KAAK,qBAC1CuV,EAAQvV,KAAK,iBAAkB+E,EAAI/E,KAAK,mBACxCuV,EAAQvV,KAAK,cAAe+E,EAAI/E,KAAK,gBACrCuV,EAAQvV,KAAK,gBAAiB+E,EAAI/E,KAAK,kBAEvClB,EAAEgF,cAAc,oCAAqC,WACjDyB,SAASC,IAAM,+CACfyB,EAAKuO,0BAA0B/V,MAIvC6C,WAAY,SAAU7C,GAClBR,EAAK,0CAEL,IAAIsW,GAAU9V,EAAUM,KAAK,kBACzBU,EAAO,wBAUX,OATAA,IAAQ,cAAgBqB,KAAKkD,YAAc,KAC3CvE,GAAQ,eAAiB8U,EAAQvV,KAAK,kBAAoB,qBAC1DS,GAAQ,0BAA4B8U,EAAQvV,KAAK,kBAAoB,KACrES,GAAQ,4BAA8B8U,EAAQvV,KAAK,oBAAsB,KACzES,GAAQ,0BAA4B8U,EAAQvV,KAAK,kBAAoB,KACrES,GAAQ,uBAAyB8U,EAAQvV,KAAK,eAAiB,KAC/DS,GAAQ,yBAA2B8U,EAAQvV,KAAK,iBAAmB,OACnEuV,EAAQ9U,KAAKA,GAENhB,EAAUM,KAAK,8BAA8BU,QAGxDrB,gBAAgB,EAEhBC,aAAc,iBAEd2D,gBAAiB,SAAUC,EAAMjE,GAC7BC,EAAK,wBAAyBgE,EAC9B,IAAIgE,GAAOnF,IAEX,OAAOhD,GAAEoE,MACLC,IAAK,8CACLC,KAAM,MACNC,SAAU,OACVC,QAAS,SAAUC,GACfN,EAAKxC,KAAK8C,EAEV,IAAIkS,GAAexS,EAAKlD,KAAK,uBAC7B0V,GAAa3U,GAAG,SAAU,WACtBmG,EAAKyO,YAAc5T,KAAK8B,MACxB5E,EAAQyE,sBAAsB1D,KAAK,kBAAkBsH,IAAI,eAAgBvF,KAAK8B,QAGlF,IAAI+R,GAAiB1S,EAAKlD,KAAK,gBAC/B4V,GAAe7U,GAAG,SAAU,WACxB,GAAIsE,GAAQtD,KAAK8B,OACb2F,MAAMnE,IAAUA,EAAQ,KACxBA,EAAQ,EACRtD,KAAK8B,MAAQwB,GAGjB6B,EAAK2O,YAAcxQ,EACnBpG,EAAQyE,sBAAsB1D,KAAK,kBAAkBsH,IAAI,eAAgBjC,IAG7E,IAAIwP,GAAc3R,EAAKlD,KAAK,iBACxBiN,EAAQ4H,EAAY7U,KAAK,SACzB8V,EAAYjB,EAAY7U,KAAK,uBACjC6U,GAAYkB,aACRC,OAAQ,MACRvW,UAAWoV,EAAYpS,SACvB/C,UAAW,qBACXuW,MAAO,OACPC,gBACIC,YAAe,iBAEpBpV,GAAG,0BAA2B,SAAUC,GACvC,GAAIoV,GAAWpV,EAAE4P,MAAMyF,OAElBpJ,GAAMtI,OAAuC,IAA9BsI,EAAMtI,MAAMkG,OAAO/I,SACnCsU,EAAW,GACXN,EAAUxO,IAAI,mBAAoB,KAGtCJ,EAAKoP,YAAcF,EACnBnX,EAAQyE,sBAAsB1D,KAAK,kBAAkBsH,IAAI,eAAgB8O,KAG7ElT,EAAKlD,KAAK,eAAee,GAAG,QAAS,WACjC2U,EAAa5U,KAAK,YAAaiB,KAAK4B,SAAS4S,aAAa,WAC1DX,EAAe9U,KAAK,YAAaiB,KAAK4B,SACtCkR,EAAYkB,YAAYhU,KAAK4B,QAAU,SAAW,WAE7C5B,KAAK4B,UACN1E,EAAQyE,sBAAsB1D,KAAK,kBAAkBsH,IAAI,SAAU,IACnEoO,EAAaa,aAAa,MAAO,IACjCX,EAAejR,IAAI,IACnBkQ,EAAYkB,YAAY,WAAY,iBAI5C,IAAIS,GAAoBtT,EAAKlD,KAAK,sBAClCwW,GAAkB5Q,SACdC,cAAe,SACfC,UAAU,EACVC,SAAU9G,EAAQU,QAAQoG,SAC1BC,SAAU/G,EAAQU,QAAQqG,SAC1BC,aAAc,SAAU7C,GACpBnE,EAAQyE,sBAAsB1D,KAAK,kBAAkBC,KAAK,iBAAkBmD,GAC5E8D,EAAKuP,0BAA0BxX,KAIvC,IAAIkH,GAAiBjD,EAAKlD,KAAK,kBAC/BmG,GAAepF,GAAG,QAAS,WACvB9B,EAAQyE,sBAAsB1D,KAAK,kBAAkBC,KAAK,iBAAkB8B,KAAK4B,SACjFuD,EAAKuO,0BAA0BxW,IAGnC,IAAIyX,GAAaxT,EAAKlD,KAAK,cAC3B0W,GAAW3V,GAAG,QAAS,WACnB9B,EAAQyE,sBAAsB1D,KAAK,kBAAkBC,KAAK,cAAe8B,KAAK4B,SAC9EuD,EAAKuO,0BAA0BxW,IAGnC,IAAIwP,GAAQvL,EAAKlD,KAAK,eACtByO,GAAM1N,GAAG,QAAS,SAAUC,GACpBe,KAAK4B,UACL1E,EAAQyE,sBAAsB1D,KAAK,kBAAkBC,KAAK,mBAAoB8B,KAAK8B,OACnFqD,EAAKuO,0BAA0BxW,KAIvC,IAAI0X,GAAqBzT,EAAKlD,KAAK,sBACnC2W,GAAmB5V,GAAG,QAAS,SAAUC,GACrC/B,EAAQyE,sBAAsB1D,KAAK,kBAAkBC,KAAK,gBAAiB8B,KAAK4B,SAChFuD,EAAKuO,0BAA0BxW,SAM/CuF,gBAAiB,SAAUtB,EAAMxD,EAAWT,GACxCC,EAAK,oCAAqCgE,EAAMxD,EAEhD,IAAI8V,GAAU9V,EAAUM,KAAK,kBACzB6V,EAAcL,EAAQlO,IAAI,iBAAmB,GAC7CsP,EAAkC,QAAhBf,EAElBgB,EAAY3T,EAAKlD,KAAK,eACtB4V,EAAiB1S,EAAKlD,KAAK,iBAC3B6U,EAAc3R,EAAKlD,KAAK,iBACxB0V,EAAexS,EAAKlD,KAAK,uBAE7B6W,GAAU/V,KAAK,UAAW8V,GAC1BlB,EAAa5U,KAAK,YAAa8V,GAAiBL,aAAa,WAAWA,aAAa,MAAOf,EAAQlO,IAAI,iBACxGsO,EAAe9U,KAAK,YAAa8V,GAAiBjS,IAAIiS,EAAkBf,EAAY/L,QAAQ,KAAM,IAAM,IACxG+K,EAAYkB,YAAYa,EAAkB,SAAW,WAAWb,YAAY,WAAYa,EAAkBpB,EAAQlO,IAAI,gBAAkB,IAExIpE,EAAKlD,KAAK,mBAAmBc,KAAK,UAA8C,SAAnC0U,EAAQvV,KAAK,mBAC1DiD,EAAKlD,KAAK,eAAec,KAAK,UAA2C,SAAhC0U,EAAQvV,KAAK,gBACtDiD,EAAKlD,KAAK,gBAAgByN,OAAO,WAAa+H,EAAQvV,KAAK,oBAAsB,MAAMa,KAAK,WAAW,GACvGoC,EAAKlD,KAAK,uBAAuBc,KAAK,UAA6C,SAAlC0U,EAAQvV,KAAK,mBAGlEwV,0BAA2B,SAAU/V,GAC5BA,EAAUoX,SACXpX,EAAYA,EAAUgE,sBAE1B,IAAI8R,GAAU9V,EAAUM,KAAK,kBACzBoF,EAAMoQ,EAAQvV,KAAK,kBACnBqF,EAAYkQ,EAAQvV,KAAK,kBACzB8W,EAASvB,EAAQvV,KAAK,eACtB+W,EAAcxB,EAAQvV,KAAK,oBAC3BgX,EAAWzB,EAAQvV,KAAK,iBACxBqG,EAAiBd,SAASgQ,EAAQvV,KAAK,YACvCiX,EAAa9R,EAAM,kBAEvBlG,GAAK,gBAAiBkG,EAAK,eAAgB4R,GAC3C1Q,EAAeC,OACXjB,UAAWA,EACXyR,OAAQA,EACRE,SAAUA,EACVD,YAAaA,EACbtQ,YAAa,2CACbC,YAAa,0CACbtB,MAAO,OACP8R,YAAY,EACZC,WACI5P,MAAO0P,EACPG,UACI7Q,KAAMpB,IAGFoB,KAAMpB,EAAM,yBAEZoB,KAAMpB,EAAM,0BAGtBwB,QAAS,UAGfN,EAAeO,QAAQ,WACnB3H,EAAK,iCAIbuX,0BAA2B,SAAUxX,GACjC,GAAIuW,GAAUvW,EAAQyE,sBAAsB1D,KAAK,kBAC7CsG,EAAiBd,SAASgQ,EAAQvV,KAAK,YACvCmF,EAAMoQ,EAAQvV,KAAK,iBAEvBqG,GAAeQ,OACXN,KAAMpB,KAEVkB,EAAeS,UAGxBhC,QASH,SAAWhG,GACP,GAAIC,GAAUD,EAAEE,QACZC,EAAOF,EAAQG,GAEnBH,GAAQI,WAAkB,OACtBmD,WAAY,SAAU7C,EAAWT,GAC7BC,EAAK,+BAAgCQ,EAErC,IAAII,GAAmBJ,EAAUK,SAAS,6BAG1C,OAFAD,GAAiBE,KAAK,gBAAgBiC,SAE/BnC,EAAiBY,QAG5BrB,gBAAgB,EAEhBC,aAAc,iBAEd2D,gBAAiB,SAAUC,EAAMjE,GAG7B,MAFAC,GAAK,wBAAyBgE,GAEvBnE,EAAEoE,MACLC,IAAK,8CACLC,KAAM,MACNC,SAAU,OACVC,QAAS,SAAUC,GACfN,EAAKxC,KAAK8C,EAEV,IAAI8T,GAAUpU,EAAKlD,KAAK,kBACxBsX,GAAQvW,GAAG,QAAS,SAAUC,GAC1BA,EAAEW,gBAEF,IAAI4V,GAAYC,OAAO,mCACnBC,EAAa,8IACbC,EAAQH,EAAUG,MAAMD,EACxBC,IAASA,EAAM,GACfzY,EAAQyE,sBAAsB1D,KAAK,0BAA0BC,KAAK,MAAO,kCAAoCyX,EAAM,GAAK,gCAExH7J,MAAM,+BAId,IAAI8J,GAASzU,EAAKlD,KAAK,iBACvB2X,GAAO5W,GAAG,QAAS,SAAUC,GACzBA,EAAEW,iBAEF1C,EAAQyE,sBAAsB1D,KAAK,qBAAqBa,YAAY,yBAAyBgC,SAAS,2BAG1G,IAAI+U,GAAQ1U,EAAKlD,KAAK,gBACtB4X,GAAM7W,GAAG,QAAS,SAAUC,GACxBA,EAAEW,iBAEF1C,EAAQyE,sBAAsB1D,KAAK,qBAAqBa,YAAY,0BAA0BgC,SAAS,0BAG3G,IAAIgV,GAAc3U,EAAKlD,KAAK,kBAC5B6X,GAAY9W,GAAG,QAAS,WACpB,GAAI+W,GAAY7Y,EAAQyE,sBAAsB1D,KAAK,0BAC/C+X,EAAaD,EAAU7X,KAAK,OAC5B+X,EAAUD,EAAWjO,QAAQ,UAAW,IAAO,0CAA4C+N,EAAY5E,GAAG,YAAc,EAAI,EAEhI/T,GAAK,gBAAkB6Y,EAAY,YAAcC,GACjDF,EAAU7X,KAAK,MAAO+X,SAMtCxT,gBAAiB,SAAUtB,EAAMxD,EAAWT,GACxCC,EAAK,oCAAqCQ,EAE1C,IAAIoY,GAAYpY,EAAUM,KAAK,0BAC3B6X,EAAc3U,EAAKlD,KAAK,mBACxBoF,EAAM0S,EAAU7X,KAAK,MAEzB4X,GAAY/W,KAAK,UAAWsE,EAAIzE,QAAQ,uBAIjDoE,QASH,SAAWhG,GACP,GAAIC,GAAUD,EAAEE,QACZC,EAAOF,EAAQG,GAEnBH,GAAQI,WAAoB,SACxBmD,WAAY,SAAU7C,EAAWT,GAC7BC,EAAK,iCAAkCQ,EAEvC,IAAII,GAAmBJ,EAAUK,SAAS,6BAG1C,OAFAD,GAAiBE,KAAK,kBAAkBiC,SAEjCnC,EAAiBY,QAG5BrB,gBAAgB,EAEhBC,aAAc,mBAEd2D,gBAAiB,SAAUC,EAAMjE,GAG7B,MAFAC,GAAK,0BAA2BgE,GAEzBnE,EAAEoE,MACLC,IAAK,gDACLC,KAAM,MACNC,SAAU,OACVC,QAAS,SAAUC,GACfN,EAAKxC,KAAK8C,EAEV,IAAI8T,GAAUpU,EAAKlD,KAAK,oBACxBsX,GAAQvW,GAAG,QAAS,SAAUC,GAC1BA,EAAEW,gBAEF,IAAI4V,GAAYC,OAAO,qCACnBS,EAAe,2IACfP,EAAQH,EAAUG,MAAMO,EACxBP,IAASA,EAAM,GACfzY,EAAQyE,sBAAsB1D,KAAK,0BAA0BC,KAAK,MAAO,iCAAmCyX,EAAM,IAElH7J,MAAM,iCAId,IAAI8J,GAASzU,EAAKlD,KAAK,mBACvB2X,GAAO5W,GAAG,QAAS,SAAUC,GACzBA,EAAEW,iBAEF1C,EAAQyE,sBAAsB1D,KAAK,qBAAqBa,YAAY,yBAAyBgC,SAAS,2BAG1G,IAAI+U,GAAQ1U,EAAKlD,KAAK,kBACtB4X,GAAM7W,GAAG,QAAS,SAAUC,GACxBA,EAAEW,iBAEF1C,EAAQyE,sBAAsB1D,KAAK,qBAAqBa,YAAY,0BAA0BgC,SAAS,0BAG3G,IAAIgV,GAAc3U,EAAKlD,KAAK,oBAC5B6X,GAAY9W,GAAG,QAAS,WACpB,GAAI+W,GAAY7Y,EAAQyE,sBAAsB1D,KAAK,0BAC/C+X,EAAaD,EAAU7X,KAAK,OAC5B+X,EAAUD,EAAWjO,QAAQ,UAAW,IAAO,cAAgB+N,EAAY5E,GAAG,YAAc,EAAI,EAEpG/T,GAAK,gBAAkB6Y,EAAY,YAAcC,GACjDF,EAAU7X,KAAK,MAAO+X,SAMtCxT,gBAAiB,SAAUtB,EAAMxD,EAAWT,GACxCC,EAAK,sCAAuCQ,EAE5C,IAAIoY,GAAYpY,EAAUM,KAAK,0BAC3B6X,EAAc3U,EAAKlD,KAAK,qBACxBoF,EAAM0S,EAAU7X,KAAK,MAEzB4X,GAAY/W,KAAK,UAAWsE,EAAIzE,QAAQ,uBAIjDoE","file":"keditor-components-0.0.0.min.js","sourcesContent":["/**!\r\n * KEditor - Kademi content editor\r\n * @copyright: Kademi (http://kademi.co)\r\n * @author: Kademi (http://kademi.co)\r\n * @version: 0.0.0\r\n * @dependencies: $, $.fn.draggable, $.fn.droppable, $.fn.sortable, Bootstrap (optional), FontAwesome (optional)\r\n */\r\n/**\r\n * KEditor accordion Component\r\n * @copyright: Kademi (http://kademi.co)\r\n * @author: Kademi (http://kademi.co)\r\n * @version: @{version}\r\n * @dependencies: $, $.fn.draggable, $.fn.droppable, $.fn.sortable, Bootstrap, FontAwesome (optional)\r\n */\r\n(function ($) {\r\n    var KEditor = $.keditor;\r\n    var flog = KEditor.log;\r\n\r\n    KEditor.components['accordion'] = {\r\n        settingEnabled: true,\r\n        settingTitle: 'Accordion Settings',\r\n\r\n        init: function (contentArea, container, component, keditor) {\r\n            var options = keditor.options;\r\n            var id = keditor.generateId('accordion');\r\n            var componentContent = component.children('.keditor-component-content');\r\n            componentContent.find('.accordionWrap .panel-group').attr('id', id);\r\n            componentContent.find('.accordionWrap a[data-toggle]').attr('data-parent', '#' + id);\r\n\r\n\r\n            var panels = componentContent.find('.panel');\r\n            panels.each(function (index, item) {\r\n                var p = $(item);\r\n                var itemId = keditor.generateId('heading' + index);\r\n                var panelCollapseId = keditor.generateId('collapse' + index);\r\n                p.find('.panel-heading').attr('id', itemId);\r\n                p.find('.panel-collapse').attr('aria-labelledby', itemId).attr('id', panelCollapseId);\r\n                var title = p.find('a[data-toggle]').html();\r\n                p.find('a[data-toggle]').attr('href', '#' + panelCollapseId).attr('aria-controls', '#' + panelCollapseId);\r\n                if (title.indexOf('<div>') === -1) {\r\n                    p.find('a[data-toggle]').html('<div>' + title + '</div>');\r\n                }\r\n            });\r\n\r\n            componentContent.find('.accordionWrap .panel-collapse').collapse('show');\r\n            componentContent.find('.panel-footer, .btnAddAccordionItem').removeClass('hide');\r\n            componentContent.find('.panel-title a div').prop('contenteditable', true);\r\n            componentContent.find('.panel-collapse .panel-body').prop('contenteditable', true);\r\n\r\n            componentContent.find('.panel-title a div, .panel-collapse .panel-body').on('input', function (e) {\r\n                if (typeof options.onComponentChanged === 'function') {\r\n                    options.onComponentChanged.call(contentArea, e, component);\r\n                }\r\n\r\n                if (typeof options.onContainerChanged === 'function') {\r\n                    options.onContainerChanged.call(contentArea, e, container);\r\n                }\r\n\r\n                if (typeof options.onContentChanged === 'function') {\r\n                    options.onContentChanged.call(contentArea, e);\r\n                }\r\n            });\r\n\r\n            var editor = componentContent.find('.panel-title a div, .panel-collapse .panel-body').ckeditor(options.ckeditorOptions).editor;\r\n            editor.on('instanceReady', function () {\r\n                flog('CKEditor is ready', component);\r\n\r\n                if (typeof options.onComponentReady === 'function') {\r\n                    options.onComponentReady.call(contentArea, component, editor);\r\n                }\r\n            });\r\n\r\n            $(document).off('click', '.btnDeleteAccordionItem').on('click', '.btnDeleteAccordionItem', function (e) {\r\n                e.preventDefault();\r\n\r\n                if (confirm('Are you sure you want to delete this item?')) {\r\n                    var panelsCount = componentContent.find('.panel').length;\r\n                    if (panelsCount > 1) {\r\n                        $(this).parents('.panel').remove();\r\n                    } else {\r\n                        Msg.error('You cant delete the last item');\r\n                    }\r\n                }\r\n            });\r\n\r\n            $(document).off('click', '.btnAddAccordionItem').on('click', '.btnAddAccordionItem', function (e) {\r\n                e.preventDefault();\r\n                var clone = componentContent.find('.panel').first().clone();\r\n                var itemId = keditor.generateId('heading');\r\n                var panelCollapseId = keditor.generateId('collapse');\r\n                clone.find('.panel-heading').attr('id', itemId);\r\n                clone.find('.panel-collapse').attr('aria-labelledby', itemId).attr('id', panelCollapseId);\r\n                clone.find('a[data-toggle]').attr('href', '#' + panelCollapseId);\r\n                componentContent.find('.accordionWrap .panel-group').append(clone);\r\n                var editor = clone.find('.panel-title a div, .panel-collapse .panel-body').ckeditor(options.ckeditorOptions).editor;\r\n                editor.on('instanceReady', function () {\r\n                    flog('CKEditor is ready', component);\r\n\r\n                    if (typeof options.onComponentReady === 'function') {\r\n                        options.onComponentReady.call(contentArea, component, editor);\r\n                    }\r\n                });\r\n            });\r\n        },\r\n\r\n        getContent: function (component, keditor) {\r\n            var componentContent = component.children('.keditor-component-content');\r\n            componentContent.find('.panel-title a div').each(function () {\r\n                var h = $(this).html();\r\n                $(this).parent('a').html(h);\r\n            });\r\n            componentContent.find('.panel-collapse .panel-body').each(function () {\r\n                var h = $(this).html();\r\n                $(this).replaceWith('<div class=\"panel-body\">' + h + '</div>');\r\n            });\r\n            if (component.attr('data-initial-collapsed') == 'true'){\r\n                componentContent.find('.panel').each(function () {\r\n                    var panelTitle = $(this).find('.panel-heading a');\r\n                    var panelCollapse = $(this).find('.panel-collapse');\r\n                    panelCollapse.addClass('collapse').attr('aria-expanded', 'false').removeClass('in');\r\n                    panelTitle.addClass('collapsed').attr('aria-expanded', 'false');\r\n                });\r\n            }\r\n            componentContent.find('.panel-footer, .btnAddAccordionItem').addClass('hide');\r\n\r\n            return componentContent.html();\r\n        },\r\n\r\n        destroy: function (component, keditor) {\r\n            flog('destroy \"text\" component', component);\r\n\r\n            var id = component.find('.keditor-component-content').attr('id');\r\n            var editor = CKEDITOR.instances[id];\r\n            if (editor) {\r\n                editor.destroy();\r\n            }\r\n        },\r\n        initSettingForm: function (form, keditor) {\r\n            flog('init \"accordion\" settings', form);\r\n\r\n            return $.ajax({\r\n                url: '/static/keditor/componentAccordionSettings.html',\r\n                type: 'get',\r\n                dataType: 'HTML',\r\n                success: function (resp) {\r\n                    form.html(resp);\r\n\r\n                    form.find('.collapsedAll').on('click', function () {\r\n                        var comp = keditor.getSettingComponent();\r\n                        comp.attr('data-initial-collapsed', this.checked);\r\n                    });\r\n\r\n                    form.find('.panelStyle').on('change', function (e) {\r\n                        var comp = keditor.getSettingComponent();\r\n                        var old = comp.attr('data-panel-style') || 'panel-default';\r\n                        comp.attr('data-panel-style', this.value);\r\n                        comp.find('.panel').removeClass(old).addClass(this.value);\r\n                    });\r\n                    \r\n                    $.getStyleOnce('/static/bootstrap-iconpicker/1.7.0/css/bootstrap-iconpicker.min.css');\r\n                    $.getScriptOnce('/static/bootstrap-iconpicker/1.7.0/js/iconset/iconset-fontawesome-4.2.0.min.js', function () {\r\n                        $.getScriptOnce('/static/bootstrap-iconpicker/1.7.0/js/bootstrap-iconpicker.min.js', function () {\r\n                            form.find('.btn-collapsed-icon, .btn-expanded-icon').iconpicker({\r\n                                iconset: 'fontawesome',\r\n                                cols: 10,\r\n                                rows: 4,\r\n                                placement: 'left'\r\n                            });\r\n                            \r\n                            form.find('.btn-collapsed-icon').on('change', function (e) {\r\n                                var component = keditor.getSettingComponent();\r\n                                var dynamicElement = component.find('[data-dynamic-href]');\r\n                                \r\n                                component.attr('data-collapsed-icon', e.icon);\r\n                                keditor.initDynamicContent(dynamicElement);\r\n                            });\r\n                            \r\n                            form.find('.btn-expanded-icon').on('change', function (e) {\r\n                                var component = keditor.getSettingComponent();\r\n                                var dynamicElement = component.find('[data-dynamic-href]');\r\n                                \r\n                                component.attr('data-expanded-icon', e.icon);\r\n                                keditor.initDynamicContent(dynamicElement);\r\n                            });\r\n                        });\r\n                    });\r\n                            \r\n                }\r\n            });\r\n        },\r\n\r\n        showSettingForm: function (form, component, keditor) {\r\n            flog('showSettingForm \"Accordion\" component');\r\n            var dataAttributes = keditor.getDataAttributes(component, ['data-type'], false);\r\n            \r\n            form.find('.collapsedAll').prop('checked', component.attr('data-initial-collapsed') == 'true');\r\n            form.find('.panelStyle').val(component.attr('data-panel-style'));\r\n            \r\n            $.getScriptOnce('/static/bootstrap-iconpicker/1.7.0/js/iconset/iconset-fontawesome-4.2.0.min.js', function () {\r\n                $.getScriptOnce('/static/bootstrap-iconpicker/1.7.0/js/bootstrap-iconpicker.min.js', function () {\r\n                    var iconCollapsed = dataAttributes['data-collapsed-icon'] || 'fa-caret-up';\r\n                    form.find('.btn-collapsed-icon').find('i').attr('class', 'fa ' + iconCollapsed).end().find('input').val(iconCollapsed);\r\n                    var iconExpanded = dataAttributes['data-expanded-icon'] || 'fa-caret-down';\r\n                    form.find('.btn-expanded-icon').find('i').attr('class', 'fa ' + iconExpanded).end().find('input').val(iconExpanded);\r\n                });\r\n            });\r\n        }\r\n    };\r\n})(jQuery);\r\n\r\n\r\n/**\r\n * KEditor Audio Component\r\n * @copyright: Kademi (http://kademi.co)\r\n * @author: Kademi (http://kademi.co)\r\n * @version: @{version}\r\n * @dependencies: $, $.fn.draggable, $.fn.droppable, $.fn.sortable, Bootstrap, FontAwesome (optional)\r\n */\r\n(function ($) {\r\n    var KEditor = $.keditor;\r\n    var flog = KEditor.log;\r\n    \r\n    KEditor.components['audio'] = {\r\n        init: function (contentArea, container, component, keditor) {\r\n            flog('init \"audio\" component', component);\r\n            \r\n            this.component = component;\r\n            var img = component.find('img[data-src]');\r\n            var componentId = '';\r\n            if (!img.attr('id')) {\r\n                componentId = keditor.generateId('component-audio');\r\n                img.attr('id', componentId);\r\n            } else {\r\n                componentId = img.attr('id');\r\n            }\r\n            if (!img.parent().hasClass('audio-wrapper')) {\r\n                img.wrap('<div class=\"audio-wrapper\"></div>');\r\n            }\r\n            this.src = img.attr('data-src');\r\n            this.width = img.attr('data-width');\r\n            this.autostart = img.attr('data-autostart') === 'true';\r\n            var instance = this;\r\n            $.getScriptOnce('/static/jwplayer/6.10/jwplayer.js', function () {\r\n                jwplayer.key = 'cXefLoB9RQlBo/XvVncatU90OaeJMXMOY/lamKrzOi0=';\r\n                instance.buildJWAudioPlayerPreview(componentId);\r\n            });\r\n            \r\n        },\r\n        \r\n        getContent: function (component, keditor) {\r\n            flog('getContent \"audio\" component', component);\r\n            \r\n            var img = component.find('img[data-src]');\r\n            var componentId = img.attr('id');\r\n            \r\n            var html = '<img data-componentId=\"' + componentId + '\" src=\"/theme/apps/content/preview/audio.png\" data-autostart=\"' + this.autostart + '\" data-width=\"' + this.width + '\" data-src=\"' + this.src + '\" data-kaudio=\"' + this.src + '\" />';\r\n            return html;\r\n        },\r\n        \r\n        settingEnabled: true,\r\n        \r\n        settingTitle: 'Audio settings',\r\n        \r\n        initSettingForm: function (form, keditor) {\r\n            flog('init \"audio\" settings', form);\r\n            \r\n            return $.ajax({\r\n                url: '/static/keditor/componentAudioSettings.html',\r\n                type: 'get',\r\n                dataType: 'HTML',\r\n                success: function (resp) {\r\n                    form.html(resp);\r\n                }\r\n            });\r\n        },\r\n        \r\n        showSettingForm: function (form, component, keditor) {\r\n            flog('showSettingForm \"audio\" component', form, component);\r\n            \r\n            var instance = this;\r\n            var btnAudioFileInput = form.find('.btn-audioFileInput');\r\n            btnAudioFileInput.mselect({\r\n                contentTypes: ['audio'],\r\n                bs3Modal: true,\r\n                pagePath: keditor.options.pagePath,\r\n                basePath: keditor.options.basePath,\r\n                onSelectFile: function (url) {\r\n                    instance.src = url;\r\n                    instance.refreshAudioPlayerPreview();\r\n                }\r\n            });\r\n            \r\n            var img = component.find('img[data-src]');\r\n            var componentId = img.attr('id');\r\n            \r\n            var autoplayToggle = form.find('#audio-autoplay');\r\n            if (this.autostart) {\r\n                autoplayToggle.prop('checked', true);\r\n            }\r\n            autoplayToggle.on('click', function (e) {\r\n                instance.autostart = this.checked;\r\n                instance.buildJWAudioPlayerPreview(componentId);\r\n            });\r\n            \r\n            var audioWidth = form.find('#audio-width');\r\n            audioWidth.val(this.width);\r\n            audioWidth.on('change', function () {\r\n                instance.width = this.value;\r\n                instance.resizeAudioPlayerPreview();\r\n            });\r\n        },\r\n        \r\n        buildJWAudioPlayerPreview: function (componentId) {\r\n            var width = this.width;\r\n            var src = this.src;\r\n            var autostart = this.autostart;\r\n            var playerInstance = jwplayer(componentId);\r\n            playerInstance.setup({\r\n                file: src,\r\n                width: width,\r\n                height: 30,\r\n                autostart: autostart,\r\n                flashplayer: \"/static/jwplayer/6.10/jwplayer.flash.swf\",\r\n                html5player: \"/static/jwplayer/6.10/jwplayer.html5.js\",\r\n                primary: \"flash\"\r\n            });\r\n            playerInstance.onReady(function () {\r\n                log('jwplayer preview init done');\r\n            });\r\n        },\r\n        \r\n        refreshAudioPlayerPreview: function () {\r\n            var instance = this;\r\n            var playerInstance = jwplayer(instance.componentId);\r\n            var src = instance.src;\r\n            playerInstance.load([{\r\n                file: src\r\n            }]);\r\n            playerInstance.play();\r\n        },\r\n        \r\n        resizeAudioPlayerPreview: function () {\r\n            var instance = this;\r\n            var playerInstance = jwplayer(instance.componentId);\r\n            var width = instance.width;\r\n            \r\n            playerInstance.resize(width, 30);\r\n        }\r\n    };\r\n    \r\n})(jQuery);\r\n\r\n/**\r\n * KEditor Carousel Component\r\n * @copyright: Kademi (http://kademi.co)\r\n * @author: Kademi (http://kademi.co)\r\n * @version: @{version}\r\n * @dependencies: $, $.fn.draggable, $.fn.droppable, $.fn.sortable, Bootstrap, FontAwesome (optional)\r\n */\r\n(function ($) {\r\n    var KEditor = $.keditor;\r\n    var flog = KEditor.log;\r\n    \r\n    KEditor.components['carousel'] = {\r\n        init: function (contentArea, container, component, keditor) {\r\n            flog('init \"carousel\" component', component);\r\n            var componentContent = component.children('.keditor-component-content');\r\n            var carousel = componentContent.find('.carousel');\r\n            \r\n            if (carousel.find('.carousel-img').length === 0 && carousel.find('.carousel-content').length === 0) {\r\n                var self = this;\r\n                var images = [];\r\n                \r\n                carousel.addClass('carousel-fixed-height');\r\n                carousel.find('.carousel-inner .item').each(function () {\r\n                    var item = $(this);\r\n                    \r\n                    images.push({\r\n                        src: item.find('img').attr('src'),\r\n                        hash: item.attr('data-hash')\r\n                    });\r\n                });\r\n                \r\n                carousel.attr('data-height', 300).css('height', 300);\r\n                carousel.find('.carousel-inner').html('');\r\n                carousel.find('.carousel-indicators').html('');\r\n                \r\n                $.each(images, function (i, image) {\r\n                    self.addItemToCarousel(component, {\r\n                        src: image.src,\r\n                        hash: image.hash\r\n                    });\r\n                });\r\n            }\r\n            \r\n            var id = keditor.generateId('component-carousel');\r\n            carousel.attr('id', id);\r\n            carousel.find('.carousel-indicators li').attr('data-target', '#' + id);\r\n            carousel.find('.carousel-control').attr('href', '#' + id);\r\n        },\r\n        getContent: function (component, keditor) {\r\n            var componentContent = component.children('.keditor-component-content');\r\n            componentContent.find('.carousel-inner').children().removeClass('active').eq(0).addClass('active');\r\n            \r\n            return componentContent.html();\r\n        },\r\n        settingEnabled: true,\r\n        \r\n        settingTitle: 'Carousel settings',\r\n        \r\n        editingItemId: '',\r\n        \r\n        initSettingForm: function (form, keditor) {\r\n            flog('init \"carousel\" settings', form);\r\n            \r\n            var self = this;\r\n            return $.ajax({\r\n                url: '/static/keditor/componentCarouselSettings.html',\r\n                type: 'get',\r\n                dataType: 'HTML',\r\n                success: function (resp) {\r\n                    form.html(resp);\r\n                    \r\n                    $.getStyleOnce('/static/bootstrap-iconpicker/1.7.0/css/bootstrap-iconpicker.min.css');\r\n                    $.getScriptOnce('/static/bootstrap-iconpicker/1.7.0/js/iconset/iconset-fontawesome-4.2.0.min.js', function () {\r\n                        $.getScriptOnce('/static/bootstrap-iconpicker/1.7.0/js/bootstrap-iconpicker.min.js', function () {\r\n                            form.find('.btn-prev-icon, .btn-next-icon').iconpicker({\r\n                                iconset: 'fontawesome',\r\n                                cols: 10,\r\n                                rows: 4,\r\n                                placement: 'left'\r\n                            });\r\n                            \r\n                            form.find('.btn-prev-icon').on('change', function (e) {\r\n                                var carousel = keditor.getSettingComponent().find('.carousel');\r\n                                carousel.find('.glyphicon-chevron-left').attr('class', 'fa glyphicon-chevron-left ' + e.icon);\r\n                            });\r\n                            \r\n                            form.find('.btn-next-icon').on('change', function (e) {\r\n                                var carousel = keditor.getSettingComponent().find('.carousel');\r\n                                carousel.find('.glyphicon-chevron-right').attr('class', 'fa glyphicon-chevron-right ' + e.icon);\r\n                            });\r\n                        });\r\n                    });\r\n                    \r\n                    var carouselAddImage = form.find('.carouselAddImage');\r\n                    var carouselItemsWrap = form.find('.carouselItemsWrap');\r\n                    \r\n                    carouselAddImage.mselect({\r\n                        contentTypes: ['image'],\r\n                        bs3Modal: true,\r\n                        pagePath: keditor.options.pagePath,\r\n                        basePath: keditor.options.basePath,\r\n                        onSelectFile: function (url, relUrl, type, hash) {\r\n                            flog('Keditor carousel selected a file', url, hash);\r\n                            self.addItemToList(form, {\r\n                                src: url,\r\n                                hash: hash,\r\n                                caption: ''\r\n                            });\r\n                            \r\n                            self.refreshCarousel(keditor.getSettingComponent(), form);\r\n                            self.editingItemId = '';\r\n                        }\r\n                    });\r\n                    \r\n                    carouselItemsWrap.sortable({\r\n                        handle: '.btn-sort-item',\r\n                        items: '> .carouselItem',\r\n                        axis: 'y',\r\n                        tolerance: 'pointer',\r\n                        sort: function () {\r\n                            $(this).removeClass('ui-state-default');\r\n                        },\r\n                        update: function () {\r\n                            self.refreshCarousel(keditor.getSettingComponent(), form);\r\n                        }\r\n                    });\r\n                    \r\n                    // Content modal\r\n                    var editorContent = self.initModalContent(form, keditor)\r\n                    var modalContent = $('#modal-carousel-content');\r\n                    \r\n                    // Caption modal\r\n                    var editorCaption = self.initModalCaption(form, keditor)\r\n                    var modalCaption = $('#modal-carousel-caption');\r\n                    \r\n                    form.find('.carouselAddImage').on('click', function (e) {\r\n                        e.preventDefault();\r\n                    });\r\n                    \r\n                    form.find('.carouselAddContent').on('click', function (e) {\r\n                        e.preventDefault();\r\n                        modalContent.modal('show');\r\n                    });\r\n                    \r\n                    form.on('click', '.carouselItem a.btn-remove-item', function (e) {\r\n                        e.preventDefault();\r\n                        \r\n                        if (confirm('Are you sure that you want to delete this image?')) {\r\n                            var btn = $(this);\r\n                            var hash = btn.closest('.btn-group').siblings('[data-hash]').attr('data-hash');\r\n                            \r\n                            var carousel = keditor.getSettingComponent().find('.carousel');\r\n                            carousel.find('[data-hash=' + hash + ']').remove();\r\n                            btn.closest('.carouselItem').remove();\r\n                            \r\n                            self.refreshCarousel(keditor.getSettingComponent(), form);\r\n                        }\r\n                    });\r\n                    \r\n                    form.on('click', '.carouselItem a.btn-edit-item', function (e) {\r\n                        e.preventDefault();\r\n                        \r\n                        var carouselItem = $(this).closest('.carouselItem');\r\n                        self.editingItemId = carouselItem.attr('id');\r\n                        var txtCarouselContent = carouselItem.find('.txt-carousel-content');\r\n                        \r\n                        if (txtCarouselContent.length > 0) {\r\n                            editorContent.setData(txtCarouselContent.val() || '');\r\n                            form.find('.carouselAddContent').trigger('click');\r\n                        } else {\r\n                            form.find('.carouselAddImage').trigger('click');\r\n                        }\r\n                    });\r\n                    \r\n                    \r\n                    form.on('click', '.carouselItem a.btn-edit-caption-item', function (e) {\r\n                        e.preventDefault();\r\n                        \r\n                        var carouselItem = $(this).closest('.carouselItem');\r\n                        self.editingItemId = carouselItem.attr('id');\r\n                        var txtCarouselCaption = carouselItem.find('.txt-carousel-caption');\r\n                        \r\n                        editorCaption.setData(txtCarouselCaption.val() || '');\r\n                        modalCaption.modal('show');\r\n                    });\r\n                    \r\n                    form.find('.carouselHeight').on('change', function (e) {\r\n                        var value = this.value;\r\n                        \r\n                        if (isNaN(value) || +value < 200) {\r\n                            value = 200;\r\n                            this.value = 200;\r\n                        }\r\n                        \r\n                        var carousel = keditor.getSettingComponent().find('.carousel');\r\n                        carousel.attr('data-height', value);\r\n                        carousel.css('height', value);\r\n                    });\r\n                    \r\n                    form.find('.carouselPause').on('change', function (e) {\r\n                        e.preventDefault();\r\n                        var comp = keditor.getSettingComponent().find('.carousel');\r\n                        comp.attr('data-pause', this.value);\r\n                    });\r\n                    \r\n                    form.find('.carouselInterval').on('change', function (e) {\r\n                        e.preventDefault();\r\n                        var comp = keditor.getSettingComponent().find('.carousel');\r\n                        comp.attr('data-interval', this.value);\r\n                    });\r\n                    \r\n                    form.find('.carouselWrap').on('click', function (e) {\r\n                        var comp = keditor.getSettingComponent().find('.carousel');\r\n                        if (this.checked) {\r\n                            comp.attr('data-wrap', 'true');\r\n                        } else {\r\n                            comp.attr('data-wrap', 'false');\r\n                        }\r\n                    });\r\n                    \r\n                    form.find('.select-image-size').on('change', function () {\r\n                        var carousel = keditor.getSettingComponent().find('.carousel');\r\n                        \r\n                        carousel.attr('data-image-size', this.value);\r\n                        \r\n                        carousel.find('.carousel-img').css('background-size', this.value === 'centered' ? 'unset' : '');\r\n                    });\r\n                }\r\n            });\r\n        },\r\n        \r\n        initModalContent: function (form, keditor) {\r\n            var self = this;\r\n            \r\n            var modalContent = $(\r\n                '<div class=\"modal fade\" tabindex=\"-1\" id=\"modal-carousel-content\">' +\r\n                '    <div class=\"modal-dialog modal-lg\">' +\r\n                '        <div class=\"modal-content\">' +\r\n                '            <div class=\"modal-header\">' +\r\n                '                <button type=\"button\" class=\"close\" data-dismiss=\"modal\">&times;</button>' +\r\n                '                <h4 class=\"modal-title\">Edit content</h4>' +\r\n                '            </div>' +\r\n                '            <div class=\"modal-body\">' +\r\n                '                <textarea id=\"modal-carousel-content-body\" class=\"form-control\" rows=\"12\"></textarea>' +\r\n                '            </div>' +\r\n                '            <div class=\"modal-footer\">' +\r\n                '                <button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\">Close</button>' +\r\n                '                <button type=\"button\" class=\"btn btn-primary btn-carousel-save-content\">Save</button>' +\r\n                '            </div>' +\r\n                '        </div>' +\r\n                '    </div>' +\r\n                '</div>'\r\n            ).appendTo(document.body);\r\n            \r\n            var contentOptions = $.extend({}, keditor.options.ckeditorOptions);\r\n            contentOptions.removePlugins = contentOptions.removePlugins.replace(',autogrow', '') + ',sourcedialog';\r\n            contentOptions.extraPlugins = contentOptions.extraPlugins + ',autogrow';\r\n            var editorContent = $('#modal-carousel-content-body').ckeditor(contentOptions).editor;\r\n            \r\n            modalContent.on('hidden.bs.modal', function () {\r\n                editorContent.setData('');\r\n                self.editingItemId = '';\r\n            });\r\n            \r\n            modalContent.find('.btn-carousel-save-content').on('click', function (e) {\r\n                e.preventDefault();\r\n                \r\n                flog('Keditor carousel add content');\r\n                \r\n                var carouselContent = editorContent.getData() || '';\r\n                self.addItemToList(form, {\r\n                    content: carouselContent\r\n                });\r\n                \r\n                self.refreshCarousel(keditor.getSettingComponent(), form);\r\n                modalContent.modal('hide');\r\n            });\r\n            \r\n            return editorContent;\r\n        },\r\n        \r\n        initModalCaption: function (form, keditor) {\r\n            var self = this;\r\n            \r\n            var modalCaption = $(\r\n                '<div class=\"modal fade\" tabindex=\"-1\" id=\"modal-carousel-caption\">' +\r\n                '    <div class=\"modal-dialog modal-lg\">' +\r\n                '        <div class=\"modal-content\">' +\r\n                '            <div class=\"modal-header\">' +\r\n                '                <button type=\"button\" class=\"close\" data-dismiss=\"modal\">&times;</button>' +\r\n                '                <h4 class=\"modal-title\">Edit caption</h4>' +\r\n                '            </div>' +\r\n                '            <div class=\"modal-body\">' +\r\n                '                <textarea id=\"modal-carousel-caption-body\" class=\"form-control\" rows=\"12\"></textarea>' +\r\n                '            </div>' +\r\n                '            <div class=\"modal-footer\">' +\r\n                '                <button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\">Close</button>' +\r\n                '                <button type=\"button\" class=\"btn btn-primary btn-carousel-save-caption\">Save</button>' +\r\n                '            </div>' +\r\n                '        </div>' +\r\n                '    </div>' +\r\n                '</div>'\r\n            ).appendTo(document.body);\r\n            \r\n            var captionOptions = $.extend({}, keditor.options.ckeditorOptions);\r\n            captionOptions.removePlugins = captionOptions.removePlugins.replace(',autogrow', '') + ',sourcedialog';\r\n            captionOptions.extraPlugins = captionOptions.extraPlugins + ',autogrow';\r\n            captionOptions.toolbarGroups = toolbarSets['Lite'];\r\n            var editorCaption = $('#modal-carousel-caption-body').ckeditor(captionOptions).editor;\r\n            \r\n            modalCaption.on('hidden.bs.modal', function () {\r\n                editorCaption.setData('');\r\n                self.editingItemId = '';\r\n            });\r\n            \r\n            modalCaption.find('.btn-carousel-save-caption').on('click', function (e) {\r\n                e.preventDefault();\r\n                \r\n                flog('Keditor carousel add content');\r\n                \r\n                var carouselCaption = editorCaption.getData() || '';\r\n                var item = form.find('#' + self.editingItemId).find('.img-responsive');\r\n                self.addItemToList(form, {\r\n                    src: item.attr('src'),\r\n                    hash: item.attr('data-hash'),\r\n                    caption: carouselCaption\r\n                });\r\n                \r\n                self.refreshCarousel(keditor.getSettingComponent(), form);\r\n                modalCaption.modal('hide');\r\n            });\r\n            \r\n            return editorCaption;\r\n        },\r\n        \r\n        showSettingForm: function (form, component, keditor) {\r\n            var self = this;\r\n            self.editingItemId = '';\r\n            form.find('.carouselItemsWrap').html('');\r\n            component.find('.carousel-inner > .item').each(function () {\r\n                var item = $(this);\r\n                var carouselImg = item.find('.carousel-img');\r\n                var carouselContent = item.find('.carousel-content');\r\n                \r\n                if (carouselContent.length > 0) {\r\n                    self.addItemToList(form, {\r\n                        content: carouselContent.html()\r\n                    });\r\n                } else {\r\n                    var url = carouselImg.css('background-image');\r\n                    url = url.slice(4, -1).replace(/['\"]/g, '');\r\n                    var hash = $(item).attr('data-hash');\r\n                    var caption = item.find('.carousel-caption');\r\n                    \r\n                    self.addItemToList(form, {\r\n                        src: url,\r\n                        hash: hash,\r\n                        caption: caption.html() || ''\r\n                    });\r\n                }\r\n            });\r\n            \r\n            var carousel = component.find('.carousel');\r\n            var isWrap = carousel.attr('data-wrap');\r\n            var pause = carousel.attr('data-pause');\r\n            var interval = carousel.attr('data-interval');\r\n            var height = carousel.attr('data-height');\r\n            \r\n            form.find('.carouselPause').val(pause);\r\n            form.find('.carouselInterval').val(interval);\r\n            form.find('.carouselWrap').prop('checked', isWrap === 'true');\r\n            form.find('.carouselHeight').val(height);\r\n            form.find('.select-image-size').val(carousel.attr('data-image-size') || 'stretched');\r\n            \r\n            $.getScriptOnce('/static/bootstrap-iconpicker/1.7.0/js/iconset/iconset-fontawesome-4.2.0.min.js', function () {\r\n                $.getScriptOnce('/static/bootstrap-iconpicker/1.7.0/js/bootstrap-iconpicker.min.js', function () {\r\n                    var iconPrev = carousel.find('.glyphicon-chevron-left').attr('class') || '';\r\n                    iconPrev = iconPrev.replace('glyphicon-chevron-left', '').replace('fa', '').trim();\r\n                    form.find('.btn-prev-icon').find('i').attr('class', 'fa ' + iconPrev).end().find('input').val(iconPrev);\r\n                    \r\n                    var iconNext = carousel.find('.glyphicon-chevron-right').attr('class') || '';\r\n                    iconNext = iconNext.replace('glyphicon-chevron-right', '').replace('fa', '').trim();\r\n                    form.find('.btn-next-icon').find('i').attr('class', 'fa ' + iconNext).end().find('input').val(iconNext);\r\n                });\r\n            });\r\n        },\r\n        \r\n        addItemToCarousel: function (component, data) {\r\n            flog('addItemToCarousel', component, data);\r\n            \r\n            var carousel = component.find('.carousel');\r\n            var carouselInner = carousel.find('.carousel-inner');\r\n            var id = carousel.attr('id');\r\n            var index = carouselInner.children().length;\r\n            var cls = index === 0 ? 'active' : '';\r\n            var backgroundUrl = \"background-image: url('\" + data.src + \"')\";\r\n            var backgroundSize = carousel.attr('data-image-size') === 'centered' ? ';background-size: unset' : '';\r\n            \r\n            carousel.find('.carousel-indicators').append(\r\n                '<li data-target=\"#' + id + '\" data-slide-to=\"' + index + '\" class=\"' + cls + '\"></li>'\r\n            );\r\n            \r\n            var itemStr = '';\r\n            if (data.content) {\r\n                itemStr += '<div class=\"item ' + cls + '\">';\r\n                itemStr += '   <div class=\"carousel-content clearfix\">' + data.content + '</div>';\r\n                itemStr += '   <div class=\"carousel-caption\"></div>';\r\n                itemStr += '</div>';\r\n            } else {\r\n                itemStr += '<div data-hash=\"' + data.hash + '\" class=\"item ' + cls + '\">';\r\n                itemStr += '   <div class=\"carousel-img\" style=\"' + backgroundUrl + backgroundSize + '\"></div>';\r\n                itemStr += '   <div class=\"carousel-caption\">' + data.caption + '</div>';\r\n                itemStr += '</div>';\r\n            }\r\n            \r\n            carouselInner.append(itemStr);\r\n        },\r\n        \r\n        addItemToList: function (form, data) {\r\n            flog('addItemToList', form, data);\r\n            \r\n            var editCaption = '';\r\n            \r\n            var itemStr = '';\r\n            if (data.content) {\r\n                itemStr += '<img class=\"img-responsive\" src=\"/static/keditor/componentCarouselContent.png\" />';\r\n                itemStr += '<textarea style=\"display: none\" class=\"txt-carousel-content\">' + data.content + '</textarea>';\r\n            } else {\r\n                itemStr += '<img class=\"img-responsive\" src=\"' + data.src + '\" data-hash=\"' + data.hash + '\" />';\r\n                itemStr += '<textarea style=\"display: none\" class=\"txt-carousel-caption\">' + data.caption + '</textarea>';\r\n                editCaption = '<a title=\"Edit caption\" class=\"btn btn-success btn-edit-caption-item\" href=\"#\"><i class=\"fa fa-file\"></i></a>';\r\n            }\r\n            \r\n            itemStr += '   <div class=\"btn-group btn-group-xs\">';\r\n            itemStr += '       <a title=\"Reorder item\" class=\"btn btn-info btn-sort-item\" href=\"#\"><i class=\"fa fa-sort\"></i></a>';\r\n            itemStr += '       <a title=\"Edit item\" class=\"btn btn-primary btn-edit-item\" href=\"#\"><i class=\"fa fa-edit\"></i></a>' + editCaption;\r\n            itemStr += '       <a title=\"Delete item\" class=\"btn btn-danger btn-remove-item\" href=\"#\"><i class=\"fa fa-trash\"></i></a>';\r\n            itemStr += '   </div>';\r\n            \r\n            if (this.editingItemId) {\r\n                form.find('#' + this.editingItemId).html(itemStr);\r\n                this.editingItemId = '';\r\n            } else {\r\n                form.find('.carouselItemsWrap').append(\r\n                    '<div class=\"carouselItem\" id=\"carouselItem-' + (new Date()).getTime() + '\">' + itemStr + '</div>'\r\n                );\r\n            }\r\n        },\r\n        \r\n        refreshCarousel: function (component, form) {\r\n            var self = this;\r\n            var carousel = component.find('.carousel');\r\n            carousel.find('.carousel-inner').html('');\r\n            carousel.find('.carousel-indicators').html('');\r\n            \r\n            form.find('.carouselItemsWrap').find('.carouselItem').each(function () {\r\n                var carouselItem = $(this);\r\n                var txtContent = carouselItem.find('.txt-carousel-content');\r\n                var txtCaption = carouselItem.find('.txt-carousel-caption');\r\n                var img = carouselItem.find('img');\r\n                \r\n                if (txtContent.length === 0) {\r\n                    self.addItemToCarousel(component, {\r\n                        src: img.attr('src'),\r\n                        hash: img.attr('data-hash'),\r\n                        caption: txtCaption.val()\r\n                    });\r\n                } else {\r\n                    self.addItemToCarousel(component, {\r\n                        content: txtContent.val()\r\n                    });\r\n                }\r\n            });\r\n        }\r\n    }\r\n    \r\n})(jQuery);\r\n/**\r\n * KEditor Form Component\r\n * @copyright: Kademi (http://kademi.co)\r\n * @author: Kademi (http://kademi.co)\r\n * @version: @{version}\r\n * @dependencies: $, $.fn.draggable, $.fn.droppable, $.fn.sortable, Bootstrap, FontAwesome (optional)\r\n */\r\n(function ($) {\r\n    var KEditor = $.keditor;\r\n    var flog = KEditor.log;\r\n    \r\n    KEditor.components['form'] = {\r\n        initFormBuilder: function (component) {\r\n            var self = this;\r\n            \r\n            $.getScriptOnce('/static/formBuilder/2.5.3/form-builder.min.js', function () {\r\n                $.getScriptOnce('/static/formBuilder/2.5.3/form-render.min.js', function () {\r\n                    var formBuilderArea = component.find('.form-builder-area');\r\n                    var formData = component.find('.form-data');\r\n                    var formContent = component.find('.form-content');\r\n                    \r\n                    component.find('.keditor-component-content').prepend(\r\n                        '<p class=\"form-builder-tools\" style=\"text-align: right;\">' +\r\n                        '    <a href=\"#\" class=\"btn btn-primary btn-preview-form\">Preview form</a> ' +\r\n                        '    <a href=\"#\" class=\"btn btn-info btn-edit-form disabled\">Edit form</a>' +\r\n                        '</p>'\r\n                    );\r\n                    \r\n                    var btnEditForm = component.find('.btn-edit-form');\r\n                    var btnPreviewForm = component.find('.btn-preview-form');\r\n                    \r\n                    formBuilderArea.formBuilder({\r\n                        disableInjectedStyle: true,\r\n                        showActionButtons: false,\r\n                        dataType: 'json',\r\n                        formData: formData.html(),\r\n                        disableFields: [\r\n                            'autocomplete',\r\n                            'paragraph',\r\n                            'header'\r\n                        ],\r\n                        disabledAttrs: ['access'],\r\n                        \r\n                        typeUserDisabledAttrs: {\r\n                            'checkbox-group': [\r\n                                'toggle',\r\n                                'inline'\r\n                            ]\r\n                        }\r\n                    });\r\n                    \r\n                    btnEditForm.on('click', function (e) {\r\n                        e.preventDefault();\r\n                        \r\n                        if (!btnEditForm.hasClass('disabled')) {\r\n                            formBuilderArea.show();\r\n                            formContent.hide();\r\n                            btnEditForm.addClass('disabled');\r\n                            btnPreviewForm.removeClass('disabled');\r\n                        }\r\n                    });\r\n                    \r\n                    btnPreviewForm.on('click', function (e) {\r\n                        e.preventDefault();\r\n                        \r\n                        if (!btnPreviewForm.hasClass('disabled')) {\r\n                            self.renderForm(component);\r\n                            \r\n                            formBuilderArea.hide();\r\n                            formContent.show();\r\n                            btnEditForm.removeClass('disabled');\r\n                            btnPreviewForm.addClass('disabled');\r\n                        }\r\n                    });\r\n                })\r\n            });\r\n        },\r\n        \r\n        renderForm: function (component, formBuilder) {\r\n            var formContent = component.find('.form-content');\r\n            \r\n            if (!formBuilder) {\r\n                var formBuilderArea = component.find('.form-builder-area');\r\n                formBuilder = formBuilderArea.data('formBuilder');\r\n            }\r\n            \r\n            formContent.formRender({\r\n                dataType: 'json',\r\n                formData: formBuilder.actions.getData('json')\r\n            });\r\n            \r\n            if (formContent.hasClass('form-horizontal')) {\r\n                formContent.children('div').each(function () {\r\n                    var div = $(this);\r\n                    var dataGrid = formContent.attr('data-grid') || '4-8';\r\n                    dataGrid = dataGrid.split('-');\r\n                    \r\n                    if (div.attr('class')) {\r\n                        if (div.hasClass('fb-button')) {\r\n                            div.find('button').wrap('<div class=\"col-sm-' + dataGrid[1] + ' col-sm-offset-' + dataGrid[0] + '\"></div>');\r\n                        } else {\r\n                            var label = div.children('label');\r\n                            var input = div.children('input, select, textarea');\r\n                            var subDiv = div.children('div');\r\n                            \r\n                            label.addClass('control-label col-sm-' + dataGrid[0]);\r\n                            \r\n                            if (subDiv.length > 0) {\r\n                                subDiv.addClass('col-sm-' + dataGrid[1]);\r\n                            } else {\r\n                                input.addClass('form-control').wrap('<div class=\"col-sm-' + dataGrid[1] + '\"></div>');\r\n                            }\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        },\r\n        \r\n        init: function (contentArea, container, component, keditor) {\r\n            flog('init \"form\" component', component);\r\n            \r\n            var componentContent = component.find('.keditor-component-content');\r\n            var formBuilder = component.find('.form-builder-area');\r\n            var formContent = component.find('.form-content');\r\n            var formData = component.find('.form-data');\r\n            \r\n            if (formData.length === 0) {\r\n                componentContent.append('<div class=\"form-data\" style=\"display: none !important;\"></div>')\r\n            }\r\n            \r\n            if (formContent.length === 0) {\r\n                componentContent.append('<form class=\"form-content\" style=\"display: none !important;\"></form>')\r\n            } else {\r\n                formContent.hide()\r\n            }\r\n            \r\n            if (formBuilder.length === 0) {\r\n                formBuilder = $('<div class=\"form-builder-area clearfix\"></div>');\r\n                componentContent.append(formBuilder);\r\n            }\r\n            \r\n            this.initFormBuilder(component);\r\n        },\r\n        \r\n        getContent: function (component, keditor) {\r\n            flog('getContent \"form\" component', component);\r\n            \r\n            var self = this;\r\n            var componentContent = component.find('.keditor-component-content');\r\n            var formData = component.find('.form-data');\r\n            var formBuilderArea = $('#' + component.attr('id')).find('.form-builder-area');\r\n            var formBuilder = formBuilderArea.data('formBuilder');\r\n            \r\n            self.renderForm(component, formBuilder);\r\n            formData.html(formBuilder.actions.getData('json'));\r\n            component.find('.form-builder-area, .form-builder-tools').remove();\r\n            component.find('.form-content').show();\r\n            \r\n            return componentContent.html();\r\n        },\r\n        \r\n        settingEnabled: true,\r\n        \r\n        settingTitle: 'Form Settings',\r\n        \r\n        initSettingForm: function (form, keditor) {\r\n            flog('initSettingForm \"form\" component');\r\n            \r\n            var self = this;\r\n            \r\n            return $.ajax({\r\n                url: '/static/keditor/componentFormSettings.html',\r\n                type: 'get',\r\n                dataType: 'HTML',\r\n                success: function (resp) {\r\n                    form.html(resp);\r\n                    \r\n                    form.find('.txt-form-action').on('change', function () {\r\n                        var component = keditor.getSettingComponent();\r\n                        var formContent = component.find('.form-content');\r\n                        \r\n                        formContent.attr('action', this.value);\r\n                    });\r\n                    \r\n                    form.find('.select-method').on('change', function () {\r\n                        var component = keditor.getSettingComponent();\r\n                        var formContent = component.find('.form-content');\r\n                        \r\n                        formContent.attr('action', this.value);\r\n                    });\r\n                    \r\n                    form.find('.select-enctype').on('change', function () {\r\n                        var component = keditor.getSettingComponent();\r\n                        var formContent = component.find('.form-content');\r\n                        \r\n                        formContent.attr('enctype', this.value);\r\n                    });\r\n                    \r\n                    form.find('.select-layout').on('change', function () {\r\n                        var component = keditor.getSettingComponent();\r\n                        var formContent = component.find('.form-content');\r\n                        \r\n                        formContent.removeClass('form-inline form-horizontal');\r\n                        if (this.value) {\r\n                            formContent.addClass(this.value);\r\n                        }\r\n                        self.renderForm(component);\r\n                        form.find('.select-grid-wrapper').css('display', this.value === 'form-horizontal' ? 'block' : 'none');\r\n                    });\r\n                    \r\n                    form.find('.select-grid').on('change', function () {\r\n                        var component = keditor.getSettingComponent();\r\n                        var formContent = component.find('.form-content');\r\n                        \r\n                        formContent.attr('data-grid', this.value);\r\n                        self.renderForm(component);\r\n                    });\r\n                }\r\n            });\r\n        },\r\n        \r\n        showSettingForm: function (form, component, keditor) {\r\n            flog('showSettingForm \"form\" component', component);\r\n            var formContent = component.find('.form-content');\r\n            \r\n            var layout = '';\r\n            if (formContent.hasClass('form-inline')) {\r\n                layout = 'form-inline';\r\n            } else if (formContent.hasClass('form-horizontal')) {\r\n                layout = 'form-horizontal';\r\n            }\r\n            \r\n            form.find('.txt-form-action').val(formContent.attr('action') || '');\r\n            form.find('.select-method').val(formContent.attr('method') || 'get');\r\n            form.find('.select-enctype').val(formContent.attr('enctype'));\r\n            form.find('.select-layout').val(layout);\r\n            form.find('.select-grid-wrapper').css('display', layout === 'form-horizontal' ? 'block' : 'none');\r\n            form.find('.select-grid').val(formContent.attr('data-grid') || '4-8');\r\n        }\r\n    };\r\n    \r\n})(jQuery);\r\n\r\n/**\r\n * KEditor Google Map Component\r\n * @copyright: Kademi (http://kademi.co)\r\n * @author: Kademi (http://kademi.co)\r\n * @version: @{version}\r\n * @dependencies: $, $.fn.draggable, $.fn.droppable, $.fn.sortable, Bootstrap, FontAwesome (optional)\r\n */\r\n(function ($, window) {\r\n    var KEditor = $.keditor;\r\n    var flog = KEditor.log;\r\n    \r\n    KEditor.components['googlemap'] = {\r\n        init: function (contentArea, container, component, keditor) {\r\n            flog('init \"googlemap\" component', component);\r\n            \r\n            this.callWhenGoogleMapReady(function () {\r\n                initKGoogleMap(component);\r\n            });\r\n        },\r\n        \r\n        getContent: function (component, keditor) {\r\n            flog('getContent \"googlemap\" component', component);\r\n            \r\n            var componentContent = component.children('.keditor-component-content');\r\n            componentContent.find('.googlemap-cover').remove();\r\n            component.find('.kgooglemap').html('');\r\n            \r\n            return componentContent.html();\r\n        },\r\n        \r\n        settingEnabled: true,\r\n        \r\n        settingTitle: 'Google Map Settings',\r\n        \r\n        initSettingForm: function (form, keditor) {\r\n            flog('init \"googlemap\" settings', form);\r\n            var self = this;\r\n            \r\n            return $.ajax({\r\n                url: '/static/keditor/componentGoogleMapSettings.html',\r\n                type: 'get',\r\n                dataType: 'HTML',\r\n                success: function (resp) {\r\n                    form.html(resp);\r\n                    \r\n                    self.callWhenGoogleMapReady(function () {\r\n                        var component = keditor.getSettingComponent();\r\n                        self.initAutocomplete(component, form);\r\n                    });\r\n                    \r\n                    var mapTypes = form.find('.map-type');\r\n                    form.find('.mapType').on('click', function () {\r\n                        mapTypes.hide().filter('.' + this.value).show();\r\n                        \r\n                        var component = keditor.getSettingComponent();\r\n                        var iframe = component.find('iframe');\r\n                        var kgooglemap = component.find('.kgooglemap');\r\n                        component.attr('data-maptype', this.value);\r\n                        \r\n                        iframe[this.value === 'manually' ? 'hide' : 'show']();\r\n                        kgooglemap[this.value === 'manually' ? 'show' : 'hide']();\r\n                        \r\n                        if (this.value === 'manually') {\r\n                            self.makeGoogleMapFresh(form, component);\r\n                        }\r\n                    });\r\n                    \r\n                    form.find('[name=mapEmbedCode]').on('change', function () {\r\n                        var iframe = $(this.value);\r\n                        var src = iframe.attr('src');\r\n                        if (iframe.length > 0 && src && src.length > 0) {\r\n                            keditor.getSettingComponent().find('.embed-responsive-item').attr('src', src);\r\n                        } else {\r\n                            alert('Your Google Map embed code is invalid!');\r\n                        }\r\n                    });\r\n                    \r\n                    form.find('[name=mapRatio]').on('click', function () {\r\n                        var component = keditor.getSettingComponent();\r\n                        \r\n                        component.find('.embed-responsive').removeClass('embed-responsive-4by3 embed-responsive-16by9').addClass('embed-responsive-' + this.value);\r\n                    });\r\n                }\r\n            });\r\n        },\r\n        \r\n        callWhenGoogleMapReady: function (callback) {\r\n            var self = this;\r\n            var apiKey = 'AIzaSyBUcuZxwpBXCPztG7ot-rITXJbycPuS7gs';\r\n            var url = 'https://maps.googleapis.com/maps/api/js?key=' + apiKey + '&libraries=places';\r\n            \r\n            if (window.google && window.google.maps && google.maps.places) {\r\n                callback.call(self);\r\n            } else {\r\n                $.getScriptOnce(url, function () {\r\n                    callback.call(self);\r\n                });\r\n            }\r\n        },\r\n        \r\n        makeGoogleMapFresh: function (form, component) {\r\n            var input = form.find('[name=mapAddress]')[0];\r\n            \r\n            setTimeout(function () {\r\n                google.maps.event.trigger(input, 'focus');\r\n                google.maps.event.trigger(input, 'keydown', {\r\n                    keyCode: 13\r\n                });\r\n            }, 1000);\r\n            \r\n            var map = component.find('.kgooglemap').data('map');\r\n            setTimeout(function () {\r\n                google.maps.event.trigger(map, \"resize\");\r\n            }, 100);\r\n        },\r\n        \r\n        showSettingForm: function (form, component, keditor) {\r\n            var self = this;\r\n            \r\n            self.callWhenGoogleMapReady(function () {\r\n                var maptype = component.attr('data-maptype') || 'embed';\r\n                var place = component.attr('data-place');\r\n                \r\n                var ratio = component.find('.embed-responsive').hasClass('embed-responsive-16by9') ? '16by9' : '4by3';\r\n                form.find('.mapRatio[value=' + ratio + ']').prop('checked', true);\r\n                form.find('.mapType[value=' + maptype + ']').prop('checked', true);\r\n                \r\n                var src = component.find('iframe').attr('src');\r\n                var iframe = '<iframe class=\"embed-responsive-item\" src=\"' + src + '\"></iframe>';\r\n                if (!place) {\r\n                    place = 'Hanoi, Vietnam';\r\n                }\r\n                form.find('[name=mapAddress]').val(place);\r\n                form.find('[name=mapEmbedCode]').val(iframe);\r\n                \r\n                form.find('.map-type').hide().filter('.' + maptype).show();\r\n                \r\n                if (!component.find('.kgooglemap').data('map')) {\r\n                    self.initAutocomplete(component, form);\r\n                    \r\n                    if (maptype === 'manually') {\r\n                        self.makeGoogleMapFresh(form, component);\r\n                    }\r\n                } else {\r\n                    if (maptype === 'manually') {\r\n                        self.makeGoogleMapFresh(form, component);\r\n                    }\r\n                }\r\n            });\r\n        },\r\n        \r\n        initAutocomplete: function (component, form) {\r\n            if (component.find('.kgooglemap').data('map')) {\r\n                this.makeGoogleMapFresh(form, component);\r\n            } else {\r\n                var mapDiv = component.find('.kgooglemap')[0];\r\n                var map = new google.maps.Map(mapDiv, {\r\n                    zoom: 13,\r\n                    mapTypeId: 'roadmap'\r\n                });\r\n                \r\n                // Create the search box and link it to the UI element.\r\n                var input = form.find('[name=mapAddress]')[0];\r\n                var searchBox = new google.maps.places.SearchBox(input);\r\n                \r\n                // Bias the SearchBox results towards current map's viewport.\r\n                map.addListener('bounds_changed', function () {\r\n                    searchBox.setBounds(map.getBounds());\r\n                });\r\n                \r\n                var markers = [];\r\n                searchBox.addListener('places_changed', function () {\r\n                    var places = searchBox.getPlaces();\r\n                    \r\n                    if (places.length == 0) {\r\n                        return;\r\n                    }\r\n                    \r\n                    // Clear out the old markers.\r\n                    markers.forEach(function (marker) {\r\n                        marker.setMap(null);\r\n                    });\r\n                    markers = [];\r\n                    \r\n                    // For each place, get the icon, name and location.\r\n                    var bounds = new google.maps.LatLngBounds();\r\n                    places.forEach(function (place) {\r\n                        if (!place.geometry) {\r\n                            console.log(\"Returned place contains no geometry\");\r\n                            return;\r\n                        }\r\n                        \r\n                        var icon = {\r\n                            url: place.icon,\r\n                            size: new google.maps.Size(71, 71),\r\n                            origin: new google.maps.Point(0, 0),\r\n                            anchor: new google.maps.Point(17, 34),\r\n                            scaledSize: new google.maps.Size(25, 25)\r\n                        };\r\n                        \r\n                        // Create a marker for each place.\r\n                        markers.push(new google.maps.Marker({\r\n                            map: map,\r\n                            icon: icon,\r\n                            title: place.name,\r\n                            position: place.geometry.location\r\n                        }));\r\n                        \r\n                        if (place.geometry.viewport) {\r\n                            // Only geocodes have viewport.\r\n                            bounds.union(place.geometry.viewport);\r\n                        } else {\r\n                            bounds.extend(place.geometry.location);\r\n                        }\r\n                    });\r\n                    map.fitBounds(bounds);\r\n                    component.attr('data-place', input.value);\r\n                });\r\n                \r\n                component.find('.kgooglemap').data('map', map);\r\n            }\r\n        }\r\n    };\r\n    \r\n})(jQuery, window);\r\n\r\n/**\r\n * KEditor Jumbotron Component\r\n * @copyright: Kademi (http://kademi.co)\r\n * @author: Kademi (http://kademi.co)\r\n * @version: @{version}\r\n * @dependencies: $, $.fn.draggable, $.fn.droppable, $.fn.sortable, Bootstrap, FontAwesome (optional)\r\n */\r\n(function ($) {\r\n    var KEditor = $.keditor;\r\n    var contentEditor = $.contentEditor;\r\n    var flog = KEditor.log;\r\n    \r\n    KEditor.components['jumbotron'] = {\r\n        settingEnabled: true,\r\n        \r\n        settingTitle: 'Jumbotron Settings',\r\n        init: function (contentArea, container, component, keditor) {\r\n            var self = this;\r\n            var options = keditor.options;\r\n            \r\n            var componentContent = component.children('.keditor-component-content');\r\n            componentContent.prop('contenteditable', true);\r\n            \r\n            componentContent.on('input', function (e) {\r\n                if (typeof options.onComponentChanged === 'function') {\r\n                    options.onComponentChanged.call(contentArea, e, component);\r\n                }\r\n                \r\n                if (typeof options.onContainerChanged === 'function') {\r\n                    options.onContainerChanged.call(contentArea, e, container);\r\n                }\r\n                \r\n                if (typeof options.onContentChanged === 'function') {\r\n                    options.onContentChanged.call(contentArea, e);\r\n                }\r\n            });\r\n            \r\n            var editor = componentContent.ckeditor(options.ckeditorOptions).editor;\r\n            editor.on('instanceReady', function () {\r\n                flog('CKEditor is ready', component);\r\n                \r\n                if (typeof options.onComponentReady === 'function') {\r\n                    options.onComponentReady.call(contentArea, component, editor);\r\n                }\r\n            });\r\n        },\r\n        \r\n        getContent: function (component, keditor) {\r\n            flog('getContent \"jumbotron\" component', component);\r\n            \r\n            var componentContent = component.find('.keditor-component-content');\r\n            var id = componentContent.attr('id');\r\n            var editor = CKEDITOR.instances[id];\r\n            if (editor) {\r\n                return editor.getData();\r\n            } else {\r\n                return componentContent.html();\r\n            }\r\n        },\r\n        \r\n        initSettingForm: function (form, keditor) {\r\n            flog('init \"jumbotron\" settings', form);\r\n            \r\n            return $.ajax({\r\n                url: '/static/keditor/componentJumbotronSettings.html',\r\n                type: 'get',\r\n                dataType: 'HTML',\r\n                success: function (resp) {\r\n                    form.html(resp);\r\n                    \r\n                    form.find('.chk-inverse').on('click', function () {\r\n                        var comp = keditor.getSettingComponent();\r\n                        comp.find('.jumbotron')[this.checked ? 'addClass' : 'removeClass']('jumbotron-inverse');\r\n                    });\r\n                    \r\n                    var buttonColorPicker = form.find('.button-color-picker');\r\n                    contentEditor.initSimpleColorPicker(buttonColorPicker, function (color) {\r\n                        var comp = keditor.getSettingComponent();\r\n                        comp.find('.jumbotron').css('background-color', color);\r\n                        comp.attr('data-bgcolor', color);\r\n                    });\r\n                    \r\n                    var paddingSettings = form.find('.paddingSettings');\r\n                    paddingSettings.on('change', function () {\r\n                        var paddingValue = this.value || '';\r\n                        var component = keditor.getSettingComponent();\r\n                        var paddingProp = $(this).attr('name');\r\n                        if (paddingValue.trim() === '') {\r\n                            component.find('.jumbotron').css(paddingProp, '');\r\n                        } else {\r\n                            if (isNaN(paddingValue)) {\r\n                                paddingValue = 0;\r\n                                this.value = paddingValue;\r\n                            }\r\n                            component.find('.jumbotron').css(paddingProp, paddingValue + 'px');\r\n                        }\r\n                    });\r\n                    \r\n                    var marginSettings = form.find('.marginSettings');\r\n                    marginSettings.on('change', function () {\r\n                        var paddingValue = this.value || '';\r\n                        var component = keditor.getSettingComponent();\r\n                        var paddingProp = $(this).attr('name');\r\n                        if (paddingValue.trim() === '') {\r\n                            component.find('.jumbotron').css(paddingProp, '');\r\n                        } else {\r\n                            if (isNaN(paddingValue)) {\r\n                                paddingValue = 0;\r\n                                this.value = paddingValue;\r\n                            }\r\n                            component.find('.jumbotron').css(paddingProp, paddingValue + 'px');\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n        },\r\n        \r\n        showSettingForm: function (form, component, keditor) {\r\n            flog('showSettingForm \"jumbotron\" component', component);\r\n            form.find('[name=button-color]').val(component.attr('data-bgcolor')).trigger('update');\r\n            form.find('.paddingSettings').each(function () {\r\n                $(this).val(component.find('.jumbotron').css($(this).attr('name')).replace('px', ''));\r\n            });\r\n            form.find('.marginSettings').each(function () {\r\n                $(this).val(component.find('.jumbotron').css($(this).attr('name')).replace('px', ''));\r\n            });\r\n            form.find('[name=showButton][value=false]').prop('checked', component.find('a').hasClass('hide'));\r\n            form.find('.chk-inverse').prop('checked', component.find('.jumbotron').hasClass('jumbotron-inverse'));\r\n        },\r\n        \r\n        destroy: function (component, keditor) {\r\n            flog('destroy \"text\" component', component);\r\n            \r\n            var id = component.find('.keditor-component-content').attr('id');\r\n            var editor = CKEDITOR.instances[id];\r\n            if (editor) {\r\n                editor.destroy();\r\n            }\r\n        }\r\n    };\r\n    \r\n})(jQuery);\r\n\r\n\r\n/**\r\n * KEditor SVG Map Component (Australia)\r\n * @copyright: Kademi (http://kademi.co)\r\n * @author: Kademi (http://kademi.co)\r\n * @version: @{version}\r\n * @dependencies: $, $.fn.draggable, $.fn.droppable, $.fn.sortable, Bootstrap, FontAwesome (optional)\r\n */\r\n(function ($) {\r\n    var KEditor = $.keditor;\r\n    var flog = KEditor.log;\r\n    \r\n    KEditor.components['ksvgmap'] = {\r\n        init: function (contentArea, container, component, keditor) {\r\n            var script = component.find('script');\r\n            if (script.length) {\r\n                script.remove();\r\n            }\r\n            if (component.attr('data-height')) {\r\n                component.find('.ksvgmap').css('height', +component.attr('data-height'));\r\n            }\r\n            $.getScriptOnce('/static/jquery-jvectormap/jquery-jvectormap-2.0.3.min.js', function () {\r\n                $.getScriptOnce('/static/jquery-jvectormap/jquery-jvectormap-au-mill.js', function () {\r\n                    component.find('.ksvgmap').vectorMap({\r\n                        map: 'au_mill',\r\n                        backgroundColor: '#fff',\r\n                        zoomButtons: false,\r\n                        focusOn: {\r\n                            x: 0.5,\r\n                            y: 0.5,\r\n                            scale: 1\r\n                        },\r\n                        regionStyle: {\r\n                            initial: {\r\n                                fill: '#efefef'\r\n                            },\r\n                            hover: {\r\n                                fill: \"#00aa90\"\r\n                            }\r\n                        },\r\n                        onRegionTipShow: function (e, el, code) {\r\n                            if (component.attr('data-' + code))\r\n                                el.html(el.html() + ' - ' + component.attr('data-' + code));\r\n                        }\r\n                    });\r\n                    var i = setInterval(function () {\r\n                        try {\r\n                            var map = component.find('.ksvgmap').vectorMap('get', 'mapObject');\r\n                            map.updateSize();\r\n                            clearInterval(i);\r\n                        } catch (e) {\r\n                            flog('trying to get jvectormap object');\r\n                        }\r\n                    }, 50);\r\n                });\r\n            });\r\n        },\r\n        getContent: function (component, keditor) {\r\n            flog('getContent \"svgmap\" component', component);\r\n            var componentContent = component.children('.keditor-component-content');\r\n            var script = '<script>$(function(){$(document.body).hasClass(\"content-editor-page\")||$.getScriptOnce(\"/static/jquery-jvectormap/jquery-jvectormap-2.0.3.min.js\",function(){$.getScriptOnce(\"/static/jquery-jvectormap/jquery-jvectormap-au-mill.js\",function(){$(\".ksvgmap\").each(function(){var a=$(this).parents(\"[data-type=component-ksvgmap]\");a.hasClass(\"ksvgInit\")||(a.addClass(\"ksvgInit\"),$(this).vectorMap({map:\"au_mill\",backgroundColor:\"#fff\",zoomButtons:!1,scale:5,regionStyle:{initial:{fill:\"#efefef\"},hover:{fill:\"#00aa90\"}},onRegionTipShow:function(b,c,d){a.attr(\"data-\"+d)&&c.html(\"<span class=\\'vectormap-tip-region-name\\'>\"+c.html()+\"</span><span class=\\'vectormap-tip-separator\\'> - </span><span class=\\'vectormap-tip-region-data\\'>\"+a.attr(\"data-\"+d)+\"</span>\")}}))})})})});</script>';\r\n            var css = '<link rel=\"stylesheet\" href=\"/static/jquery-jvectormap/jquery-jvectormap-2.0.3.css\">';\r\n            component.find('.jvectormap-container').remove();\r\n            var arr = $(document.body).find('[data-type=\"component-ksvgmap\"]:not(.keditor-snippet)');\r\n            if (arr.length > 0) {\r\n                if ($(arr[arr.length - 1]).attr('id') === component.attr('id')) {\r\n                    $(css).insertBefore(component.find('.ksvgmap'));\r\n                    $(script).insertAfter(component.find('.ksvgmap'));\r\n                }\r\n            }\r\n            \r\n            return componentContent.html();\r\n        },\r\n        \r\n        settingEnabled: true,\r\n        \r\n        settingTitle: 'SVGMap Settings',\r\n        \r\n        initSettingForm: function (form, keditor) {\r\n            flog('init \"svgmap\" settings', form);\r\n            \r\n            return $.ajax({\r\n                url: '/static/keditor/componentKsvgMapSettings.html',\r\n                type: 'get',\r\n                dataType: 'HTML',\r\n                success: function (resp) {\r\n                    form.html(resp);\r\n                    \r\n                    var component = keditor.getSettingComponent();\r\n                    form.find('.state').on('change', function (e) {\r\n                        var val = component.attr('data-' + this.value);\r\n                        form.find('.stateMessage').val(val);\r\n                    });\r\n                    form.find('.stateMessage').on('change', function (e) {\r\n                        var currentState = form.find('.state').val();\r\n                        component.attr('data-' + currentState, this.value);\r\n                    });\r\n                    form.find('.height').on('change', function (e) {\r\n                        component.attr('data-height', this.value);\r\n                        component.find('.ksvgmap').css('height', this.value);\r\n                        var map = component.find('.ksvgmap').vectorMap('get', 'mapObject');\r\n                        map.updateSize();\r\n                    });\r\n                }\r\n            });\r\n        },\r\n        showSettingForm: function (form, component, keditor) {\r\n            var height = component.attr('data-height');\r\n            var defaultState = form.find('.state').val();\r\n            form.find('.height').val(height);\r\n            form.find('.stateMessage').val(component.attr('data-' + defaultState));\r\n        }\r\n    };\r\n})(jQuery);\r\n\r\n/**\r\n * KEditor Photo Component\r\n * @copyright: Kademi (http://kademi.co)\r\n * @author: Kademi (http://kademi.co)\r\n * @version: @{version}\r\n * @dependencies: $, $.fn.draggable, $.fn.droppable, $.fn.sortable, Bootstrap, FontAwesome (optional)\r\n */\r\n(function ($) {\r\n    var KEditor = $.keditor;\r\n    var flog = KEditor.log;\r\n    \r\n    KEditor.components['photo'] = {\r\n        init: function (contentArea, container, component, keditor) {\r\n            flog('init \"photo\" component', component);\r\n            \r\n            var componentContent = component.children('.keditor-component-content');\r\n            var img = componentContent.find('img');\r\n            \r\n            img.css('display', 'inline-block');\r\n            if (!img.css('vertical-align')) {\r\n                img.css('vertical-align', 'middle');\r\n            }\r\n            \r\n            var options = keditor.options;\r\n            if (typeof options.onComponentReady === 'function') {\r\n                options.onComponentReady.call(contentArea, component);\r\n            }\r\n        },\r\n        \r\n        settingEnabled: true,\r\n        \r\n        settingTitle: 'Photo Settings',\r\n        \r\n        initSettingForm: function (form, keditor) {\r\n            flog('init \"photo\" settings', form, keditor);\r\n            \r\n            var self = this;\r\n            var options = keditor.options;\r\n            \r\n            return $.ajax({\r\n                url: '/static/keditor/componentPhotoSettings.html',\r\n                type: 'get',\r\n                dataType: 'HTML',\r\n                success: function (resp) {\r\n                    form.html(resp);\r\n                    \r\n                    var txtLink = form.find('#photo-link');\r\n                    txtLink.on('change', function () {\r\n                        var link = this.value.trim();\r\n                        var pattern =  /(https?:\\/\\/(?:www\\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\\.[^\\s]{2,}|www\\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\\.[^\\s]{2,}|https?:\\/\\/(?:www\\.|(?!www))[a-zA-Z0-9]\\.[^\\s]{2,}|www\\.[a-zA-Z0-9]\\.[^\\s]{2,})/;\r\n                        var span = txtLink.next();\r\n                        var formGroup = txtLink.closest('.form-group');\r\n                        \r\n                        if (pattern.test(link)) {\r\n                            keditor.getSettingComponent().find('a').attr('href', link);\r\n                            span.hide();\r\n                            formGroup.removeClass('has-error');\r\n                        } else {\r\n                            span.show();\r\n                            formGroup.addClass('has-error');\r\n                        }\r\n                    });\r\n                    \r\n                    var cbbTarget = form.find('#photo-target');\r\n                    cbbTarget.on('change', function () {\r\n                        keditor.getSettingComponent().find('a').attr('target', this.value);\r\n                    });\r\n                    \r\n                    var chkLinkable = form.find('#photo-linkable');\r\n                    chkLinkable.on('click', function () {\r\n                        var img = keditor.getSettingComponent().find('img');\r\n                        \r\n                        if (chkLinkable.is(':checked')) {\r\n                            txtLink.prop('disabled', false);\r\n                            cbbTarget.prop('disabled', false);\r\n                            img.wrap('<a href=\"\"></a>');\r\n                        } else {\r\n                            txtLink.prop('disabled', true);\r\n                            cbbTarget.prop('disabled', true);\r\n                            img.unwrap('a');\r\n                        }\r\n                    });\r\n                    \r\n                    var inputAlign = form.find('#photo-align');\r\n                    inputAlign.on('change', function () {\r\n                        var panel = keditor.getSettingComponent().find('.photo-panel');\r\n                        panel.css('text-align', this.value);\r\n                    });\r\n                    \r\n                    var inputVAlign = form.find('#v-align');\r\n                    inputVAlign.on('change', function () {\r\n                        var panel = keditor.getSettingComponent().find('.photo-panel').find('img');\r\n                        panel.css('vertical-align', this.value);\r\n                    });\r\n                    \r\n                    var inputResponsive = form.find('#photo-responsive');\r\n                    inputResponsive.on('click', function () {\r\n                        keditor.getSettingComponent().find('img')[this.checked ? 'addClass' : 'removeClass']('img-responsive');\r\n                    });\r\n                    \r\n                    var cbbStyle = form.find('#photo-style');\r\n                    cbbStyle.on('change', function () {\r\n                        var img = keditor.getSettingComponent().find('img');\r\n                        var val = this.value;\r\n                        \r\n                        img.removeClass('img-rounded img-circle img-thumbnail');\r\n                        if (val) {\r\n                            img.addClass(val);\r\n                        }\r\n                    });\r\n                    \r\n                    var inputWidth = form.find('#photo-width');\r\n                    var inputHeight = form.find('#photo-height');\r\n                    inputWidth.on('change', function () {\r\n                        var img = keditor.getSettingComponent().find('img');\r\n                        var newWidth = +this.value;\r\n                        var newHeight = Math.round(newWidth / self.ratio);\r\n                        \r\n                        if (newWidth <= 0) {\r\n                            newWidth = self.width;\r\n                            newHeight = self.height;\r\n                            this.value = newWidth;\r\n                        }\r\n                        \r\n                        img.css({\r\n                            'width': newWidth,\r\n                            'height': newHeight\r\n                        });\r\n                        inputHeight.val(newHeight);\r\n                    });\r\n                    inputHeight.on('change', function () {\r\n                        var img = keditor.getSettingComponent().find('img');\r\n                        var newHeight = +this.value;\r\n                        var newWidth = Math.round(newHeight * self.ratio);\r\n                        \r\n                        if (newHeight <= 0) {\r\n                            newWidth = self.width;\r\n                            newHeight = self.height;\r\n                            this.value = newHeight;\r\n                        }\r\n                        \r\n                        img.css({\r\n                            'height': newHeight,\r\n                            'width': newWidth\r\n                        });\r\n                        inputWidth.val(newWidth);\r\n                    });\r\n                    \r\n                    var photoEdit = form.find('#photo-edit');\r\n                    photoEdit.mselect({\r\n                        contentTypes: ['image'],\r\n                        bs3Modal: true,\r\n                        pagePath: keditor.options.pagePath,\r\n                        basePath: keditor.options.basePath,\r\n                        onSelectFile: function (url, relativeUrl, fileType, hash) {\r\n                            var img = keditor.getSettingComponent().find('img');\r\n                            var src = '/_hashes/files/' + hash;\r\n                            \r\n                            $('<img />').attr('src', src).load(function () {\r\n                                img.attr('src', src).css({\r\n                                    width: this.width,\r\n                                    height: this.height\r\n                                })\r\n                                self.ratio = this.width / this.height;\r\n                                self.width = this.width;\r\n                                self.height = this.height;\r\n                                inputWidth.val(this.width);\r\n                                inputHeight.val(this.height);\r\n                            });\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n        },\r\n        \r\n        showSettingForm: function (form, component, keditor) {\r\n            flog('showSettingForm \"photo\" component', component);\r\n            \r\n            var self = this;\r\n            var inputAlign = form.find('#photo-align');\r\n            var inputVAlign = form.find('#v-align');\r\n            var inputResponsive = form.find('#photo-responsive');\r\n            var inputWidth = form.find('#photo-width');\r\n            var inputHeight = form.find('#photo-height');\r\n            var cbbStyle = form.find('#photo-style');\r\n            var txtLink = form.find('#photo-link');\r\n            var cbbTarget = form.find('#photo-target');\r\n            var chkLinkable = form.find('#photo-linkable');\r\n            \r\n            txtLink.next().hide();\r\n            txtLink.closest('.form-group').removeClass('has-error');\r\n            \r\n            var panel = component.find('.photo-panel');\r\n            var img = panel.find('img');\r\n            \r\n            var a = img.parent('a');\r\n            if (a.length > 0) {\r\n                chkLinkable.prop('checked', true);\r\n                txtLink.prop('disabled', false).val(a.attr('href'));\r\n                cbbTarget.prop('disabled', false).val(a.attr('target'));\r\n            } else {\r\n                chkLinkable.prop('checked', false);\r\n                txtLink.prop('disabled', true).val('');\r\n                cbbTarget.prop('disabled', true).val('');\r\n            }\r\n            \r\n            var algin = panel.css('text-align');\r\n            if (algin !== 'right' || algin !== 'center') {\r\n                algin = 'left';\r\n            }\r\n            \r\n            var valign = img.css('vertical-align');\r\n            \r\n            if (img.hasClass('img-rounded')) {\r\n                cbbStyle.val('img-rounded');\r\n            } else if (img.hasClass('img-circle')) {\r\n                cbbStyle.val('img-circle');\r\n            } else if (img.hasClass('img-thumbnail')) {\r\n                cbbStyle.val('img-thumbnail');\r\n            } else {\r\n                cbbStyle.val('');\r\n            }\r\n            inputAlign.val(algin);\r\n            inputVAlign.val(valign);\r\n            inputResponsive.prop('checked', img.hasClass('img-responsive'));\r\n            inputWidth.val(img.width());\r\n            inputHeight.val(img.height());\r\n            \r\n            $('<img />').attr('src', img.attr('src')).load(function () {\r\n                self.ratio = this.width / this.height;\r\n                self.width = this.width;\r\n                self.height = this.height;\r\n            });\r\n        }\r\n    };\r\n    \r\n})(jQuery);\r\n\r\n/**\r\n * KEditor Text Component\r\n * @copyright: Kademi (http://kademi.co)\r\n * @author: Kademi (http://kademi.co)\r\n * @version: @{version}\r\n * @dependencies: $, $.fn.draggable, $.fn.droppable, $.fn.sortable, Bootstrap, FontAwesome (optional)\r\n */\r\n(function ($) {\r\n    var KEditor = $.keditor;\r\n    var contentEditor = $.contentEditor;\r\n    var flog = KEditor.log;\r\n    \r\n    CKEDITOR.disableAutoInline = true;\r\n    CKEDITOR.dtd.$removeEmpty['i'] = false;\r\n    \r\n    // Text component\r\n    // ---------------------------------------------------------------------\r\n    KEditor.components['text'] = {\r\n        init: function (contentArea, container, component, keditor) {\r\n            flog('init \"text\" component', component);\r\n            \r\n            var options = keditor.options;\r\n            \r\n            var componentContent = component.find('.keditor-component-content');\r\n            var ckeditorPlace = componentContent.find('.keditor-component-text-content-inner');\r\n            \r\n            if (ckeditorPlace.length === 0) {\r\n                var contentHtml = componentContent.html();\r\n                ckeditorPlace = $('<div class=\"keditor-component-text-content-inner clearfix\"></div>');\r\n                componentContent.html(ckeditorPlace);\r\n                ckeditorPlace.html(contentHtml);\r\n                ckeditorPlace.wrap('<div class=\"keditor-component-text-content\"></div>');\r\n            }\r\n            \r\n            if (!ckeditorPlace.attr('id')) {\r\n                ckeditorPlace.attr('id', keditor.generateId('component-text-content-inner'));\r\n            }\r\n            \r\n            ckeditorPlace.prop('contenteditable', true);\r\n            ckeditorPlace.on('input', function (e) {\r\n                if (typeof options.onComponentChanged === 'function') {\r\n                    options.onComponentChanged.call(contentArea, e, component);\r\n                }\r\n                \r\n                if (typeof options.onContainerChanged === 'function') {\r\n                    options.onContainerChanged.call(contentArea, e, container);\r\n                }\r\n                \r\n                if (typeof options.onContentChanged === 'function') {\r\n                    options.onContentChanged.call(contentArea, e);\r\n                }\r\n            });\r\n            \r\n            var editor = ckeditorPlace.ckeditor(options.ckeditorOptions).editor;\r\n            editor.on('instanceReady', function () {\r\n                flog('CKEditor is ready', component);\r\n                \r\n                if (typeof options.onComponentReady === 'function') {\r\n                    options.onComponentReady.call(contentArea, component, editor);\r\n                }\r\n            });\r\n        },\r\n        \r\n        getContent: function (component, keditor) {\r\n            flog('getContent \"text\" component', component);\r\n            \r\n            var componentContent = component.find('.keditor-component-content');\r\n            var componentTextContent = componentContent.find('.keditor-component-text-content');\r\n            \r\n            var id = componentTextContent.children().attr('id');\r\n            var editor = CKEDITOR.instances[id];\r\n            if (editor) {\r\n                componentTextContent.html('<div class=\"keditor-component-text-content-inner clearfix\">' + editor.getData() + '</div>');\r\n            }\r\n            \r\n            return componentContent.html();\r\n        },\r\n        \r\n        destroy: function (component, keditor) {\r\n            flog('destroy \"text\" component', component);\r\n            \r\n            var id = component.find('.keditor-component-content').attr('id');\r\n            var editor = CKEDITOR.instances[id];\r\n            if (editor) {\r\n                editor.destroy();\r\n            }\r\n        },\r\n        \r\n        settingEnabled: true,\r\n        \r\n        settingTitle: 'Text Settings',\r\n        \r\n        initSettingForm: function (form, keditor) {\r\n            flog('initSettingForm \"text\" component');\r\n            \r\n            return $.ajax({\r\n                url: '/static/keditor/componentTextSettings.html',\r\n                type: 'get',\r\n                dataType: 'HTML',\r\n                success: function (resp) {\r\n                    form.html(resp);\r\n                    \r\n                    // =================================================================================\r\n                    // Backgrounds\r\n                    // =================================================================================\r\n                    form.find('.background-image-edit').mselect({\r\n                        contentTypes: ['image'],\r\n                        bs3Modal: true,\r\n                        pagePath: keditor.options.pagePath,\r\n                        basePath: keditor.options.basePath,\r\n                        onSelectFile: function (url, relativeUrl, fileType, hash) {\r\n                            var target = keditor.getSettingComponent().find('.keditor-component-text-content');\r\n                            var imageUrl = 'http://' + window.location.host + '/_hashes/files/' + hash;\r\n                            target.css('background-image', 'url(\"' + imageUrl + '\")');\r\n                            form.find('.background-image-previewer').attr('src', imageUrl);\r\n                        }\r\n                    });\r\n                    form.find('.background-image-delete').on('click', function (e) {\r\n                        e.preventDefault();\r\n                        \r\n                        var target = keditor.getSettingComponent().find('.keditor-component-text-content');\r\n                        target.css('background-image', '');\r\n                        form.find('.background-image-previewer').attr('src', '/static/images/photo_holder.png');\r\n                    });\r\n                    \r\n                    var colorPicker = form.find('.txt-bg-color');\r\n                    contentEditor.initSimpleColorPicker(colorPicker, function (color) {\r\n                        target.css('background-color', color);\r\n                    });\r\n                    \r\n                    form.find('.select-bg-repeat').on('change', function () {\r\n                        var target = keditor.getSettingComponent().find('.keditor-component-text-content');\r\n                        \r\n                        target.css('background-repeat', this.value);\r\n                    });\r\n                    \r\n                    form.find('.select-bg-size').on('change', function () {\r\n                        var target = keditor.getSettingComponent().find('.keditor-component-text-content');\r\n                        \r\n                        target.css('background-size', this.value);\r\n                    });\r\n                    \r\n                    form.find('.select-bg-position').on('change', function () {\r\n                        var target = keditor.getSettingComponent().find('.keditor-component-text-content');\r\n                        \r\n                        target.css('background-position', this.value);\r\n                    });\r\n                    \r\n                    // =================================================================================\r\n                    // Padding\r\n                    // =================================================================================\r\n                    form.find('.txt-padding').each(function () {\r\n                        var txt = $(this);\r\n                        var styleName = txt.attr('data-style-name');\r\n                        \r\n                        txt.on('change', function () {\r\n                            var paddingValue = this.value || '';\r\n                            var target = keditor.getSettingComponent().find('.keditor-component-text-content').get(0);\r\n                            \r\n                            if (paddingValue.trim() === '') {\r\n                                target.style[styleName] = '';\r\n                            } else {\r\n                                if (isNaN(paddingValue)) {\r\n                                    paddingValue = 0;\r\n                                    this.value = paddingValue;\r\n                                }\r\n                                target.style[styleName] = paddingValue + 'px';\r\n                            }\r\n                        });\r\n                    });\r\n                    \r\n                    // =================================================================================\r\n                    // Margin\r\n                    // =================================================================================\r\n                    form.find('.txt-margin').each(function () {\r\n                        var txt = $(this);\r\n                        var styleName = txt.attr('data-style-name');\r\n                        \r\n                        txt.on('change', function () {\r\n                            var marginValue = this.value || '';\r\n                            var target = keditor.getSettingComponent().find('.keditor-component-text-content').get(0);\r\n                            \r\n                            if (marginValue.trim() === '') {\r\n                                target.style[styleName] = '';\r\n                            } else {\r\n                                if (isNaN(marginValue)) {\r\n                                    marginValue = 0;\r\n                                    this.value = marginValue;\r\n                                }\r\n                                target.style[styleName] = marginValue + 'px';\r\n                            }\r\n                        });\r\n                    });\r\n                    \r\n                    // =================================================================================\r\n                    // Width and Height\r\n                    // =================================================================================\r\n                    form.find('.txt-height').on('change', function () {\r\n                        var height = this.value || '';\r\n                        if (isNaN(height)) {\r\n                            height = '';\r\n                        }\r\n                        \r\n                        var target = keditor.getSettingComponent().find('.keditor-component-text-content');\r\n                        target.css('height', height);\r\n                    });\r\n                    \r\n                    form.find('.txt-max-height').on('change', function () {\r\n                        var maxHeight = this.value || '';\r\n                        if (isNaN(maxHeight)) {\r\n                            maxHeight = '';\r\n                        }\r\n                        \r\n                        var target = keditor.getSettingComponent().find('.keditor-component-text-content');\r\n                        target.css('max-height', maxHeight + 'px');\r\n                    });\r\n                    \r\n                    form.find('.txt-width').on('change', function () {\r\n                        var width = this.value || '';\r\n                        if (isNaN(width)) {\r\n                            width = '';\r\n                        }\r\n                        \r\n                        var target = keditor.getSettingComponent().find('.keditor-component-text-content');\r\n                        target.css('width', width);\r\n                    });\r\n                    \r\n                    form.find('.txt-max-width').on('change', function () {\r\n                        var maxWidth = this.value || '';\r\n                        if (isNaN(maxWidth)) {\r\n                            maxWidth = '';\r\n                        }\r\n                        \r\n                        var target = keditor.getSettingComponent().find('.keditor-component-text-content');\r\n                        target.css('max-width', maxWidth + 'px');\r\n                    });\r\n                }\r\n            });\r\n        },\r\n\r\n        showSettingForm: function (form, component, keditor) {\r\n            flog('showSettingForm \"text\" component', component);\r\n\r\n            var target = component.find('.keditor-component-text-content').get(0);\r\n\r\n            var imageUrl = target.style.backgroundImage;\r\n            imageUrl = (imageUrl || '').replace(/^url\\(['\"]+(.+)['\"]+\\)$/, '$1');\r\n            form.find('.background-image-previewer').attr('src', imageUrl !== 'none' && imageUrl !== '' ? imageUrl : '/static/images/photo_holder.png');\r\n\r\n            form.find('.select-bg-repeat').val(target.style.backgroundRepeat || 'repeat');\r\n            form.find('.select-bg-position').val(target.style.backgroundPosition || '0% 0%');\r\n            form.find('.select-bg-size').val(target.style.backgroundSize || 'auto');\r\n\r\n            form.find('.txt-bg-color').val(target.style.backgroundColor || '').trigger('update')\r\n\r\n            form.find('.txt-padding').each(function () {\r\n                var txt = $(this);\r\n                var styleName = txt.attr('data-style-name');\r\n\r\n                txt.val((target.style[styleName] || '').replace('px', ''));\r\n            });\r\n            form.find('.txt-margin').each(function () {\r\n                var txt = $(this);\r\n                var styleName = txt.attr('data-style-name');\r\n\r\n                txt.val((target.style[styleName] || '').replace('px', ''));\r\n            });\r\n\r\n            form.find('.txt-height').val((target.style.height || '').replace('px', ''));\r\n            form.find('.txt-max-height').val((target.style.maxHeight || '').replace('px', ''));\r\n            form.find('.txt-width').val((target.style.width || '').replace('px', ''));\r\n            form.find('.txt-maxWith').val((target.style.maxWidth || '').replace('px', ''));\r\n        }\r\n    };\r\n    \r\n})(jQuery);\r\n\r\n/**\r\n * KEditor Video Component\r\n * @copyright: Kademi (http://kademi.co)\r\n * @author: Kademi (http://kademi.co)\r\n * @version: @{version}\r\n * @dependencies: $, $.fn.draggable, $.fn.droppable, $.fn.sortable, Bootstrap, FontAwesome (optional)\r\n */\r\n(function ($) {\r\n    var KEditor = $.keditor;\r\n    var flog = KEditor.log;\r\n    \r\n    KEditor.components['video'] = {\r\n        init: function (contentArea, container, component, keditor) {\r\n            flog('init \"video\" component', component);\r\n            \r\n            var self = this;\r\n            \r\n            var img = component.find('img[data-video-src]');\r\n            img.attr('id', keditor.generateId('component-video'));\r\n            \r\n            var wrapper = img.parent();\r\n            if (!wrapper.hasClass('video-wrapper')) {\r\n                img.wrap('<div class=\"video-wrapper\"></div>');\r\n                wrapper = img.parent();\r\n            }\r\n            \r\n            wrapper.attr('data-id', img.attr('id'));\r\n            wrapper.attr('data-autostart', img.attr('data-autostart'));\r\n            wrapper.attr('data-aspectratio', img.attr('data-aspectratio'));\r\n            wrapper.attr('data-video-src', img.attr('data-video-src'));\r\n            wrapper.attr('data-repeat', img.attr('data-repeat'));\r\n            wrapper.attr('data-controls', img.attr('data-controls'));\r\n            \r\n            $.getScriptOnce('/static/jwplayer/6.10/jwplayer.js', function () {\r\n                jwplayer.key = 'cXefLoB9RQlBo/XvVncatU90OaeJMXMOY/lamKrzOi0=';\r\n                self.buildJWVideoPlayerPreview(component);\r\n            });\r\n        },\r\n        \r\n        getContent: function (component) {\r\n            flog('getContent \"video\" component, component');\r\n            \r\n            var wrapper = component.find('.video-wrapper');\r\n            var html = '<img class=\"video-jw\" ';\r\n            html += '       id=\"' + this.componentId + '\" ';\r\n            html += '       src=\"' + wrapper.attr('data-video-src') + '/alt-640-360.png\" ';\r\n            html += '       data-autostart=\"' + wrapper.attr('data-autostart') + '\" ';\r\n            html += '       data-aspectratio=\"' + wrapper.attr('data-aspectratio') + '\" ';\r\n            html += '       data-video-src=\"' + wrapper.attr('data-video-src') + '\" ';\r\n            html += '       data-repeat=\"' + wrapper.attr('data-repeat') + '\" ';\r\n            html += '       data-controls=\"' + wrapper.attr('data-controls') + '\" />';\r\n            wrapper.html(html);\r\n            \r\n            return component.find('.keditor-component-content').html();\r\n        },\r\n        \r\n        settingEnabled: true,\r\n        \r\n        settingTitle: 'Video Settings',\r\n        \r\n        initSettingForm: function (form, keditor) {\r\n            flog('init \"video\" settings', form);\r\n            var self = this;\r\n            \r\n            return $.ajax({\r\n                url: '/static/keditor/componentVideoSettings.html',\r\n                type: 'get',\r\n                dataType: 'HTML',\r\n                success: function (resp) {\r\n                    form.html(resp);\r\n                    \r\n                    var selectPicker = form.find('.select-border-style');\r\n                    selectPicker.on('change', function () {\r\n                        self.borderStyle = this.value;\r\n                        keditor.getSettingComponent().find('.video-wrapper').css('border-style', this.value);\r\n                    });\r\n                    \r\n                    var txtBorderWidth = form.find('.border-width');\r\n                    txtBorderWidth.on('change', function () {\r\n                        var width = this.value;\r\n                        if (isNaN(width) || width < 0) {\r\n                            width = 1;\r\n                            this.value = width;\r\n                        }\r\n                        \r\n                        self.borderWidth = width;\r\n                        keditor.getSettingComponent().find('.video-wrapper').css('border-width', width);\r\n                    });\r\n                    \r\n                    var colorPicker = form.find('.color-picker');\r\n                    var input = colorPicker.find('input');\r\n                    var previewer = colorPicker.find('.input-group-addon i');\r\n                    colorPicker.colorpicker({\r\n                        format: 'hex',\r\n                        container: colorPicker.parent(),\r\n                        component: '.input-group-addon',\r\n                        align: 'left',\r\n                        colorSelectors: {\r\n                            'transparent': 'transparent'\r\n                        }\r\n                    }).on('changeColor.colorpicker', function (e) {\r\n                        var colorHex = e.color.toHex();\r\n                        \r\n                        if (!input.val() || input.val().trim().length === 0) {\r\n                            colorHex = '';\r\n                            previewer.css('background-color', '');\r\n                        }\r\n                        \r\n                        self.borderColor = colorHex;\r\n                        keditor.getSettingComponent().find('.video-wrapper').css('border-color', colorHex);\r\n                    });\r\n                    \r\n                    form.find('.chk-border').on('click', function () {\r\n                        selectPicker.prop('disabled', !this.checked).selectpicker('refresh');\r\n                        txtBorderWidth.prop('disabled', !this.checked);\r\n                        colorPicker.colorpicker(this.checked ? 'enable' : 'disable');\r\n                        \r\n                        if (!this.checked) {\r\n                            keditor.getSettingComponent().find('.video-wrapper').css('border', '');\r\n                            selectPicker.selectpicker('val', '');\r\n                            txtBorderWidth.val('');\r\n                            colorPicker.colorpicker('setValue', 'transparent');\r\n                        }\r\n                    });\r\n                    \r\n                    var btnVideoFileInput = form.find('.btn-videoFileInput');\r\n                    btnVideoFileInput.mselect({\r\n                        contentTypes: ['video'],\r\n                        bs3Modal: true,\r\n                        pagePath: keditor.options.pagePath,\r\n                        basePath: keditor.options.basePath,\r\n                        onSelectFile: function (url) {\r\n                            keditor.getSettingComponent().find('.video-wrapper').attr('data-video-src', url);\r\n                            self.refreshVideoPlayerPreview(keditor);\r\n                        }\r\n                    });\r\n                    \r\n                    var autoplayToggle = form.find('#video-autoplay');\r\n                    autoplayToggle.on('click', function () {\r\n                        keditor.getSettingComponent().find('.video-wrapper').attr('data-autostart', this.checked);\r\n                        self.buildJWVideoPlayerPreview(keditor);\r\n                    });\r\n                    \r\n                    var loopToggle = form.find('#video-loop');\r\n                    loopToggle.on('click', function () {\r\n                        keditor.getSettingComponent().find('.video-wrapper').attr('data-repeat', this.checked);\r\n                        self.buildJWVideoPlayerPreview(keditor);\r\n                    });\r\n                    \r\n                    var ratio = form.find('.video-ratio');\r\n                    ratio.on('click', function (e) {\r\n                        if (this.checked) {\r\n                            keditor.getSettingComponent().find('.video-wrapper').attr('data-aspectratio', this.value);\r\n                            self.buildJWVideoPlayerPreview(keditor);\r\n                        }\r\n                    });\r\n                    \r\n                    var showcontrolsToggle = form.find('#video-showcontrols');\r\n                    showcontrolsToggle.on('click', function (e) {\r\n                        keditor.getSettingComponent().find('.video-wrapper').attr('data-controls', this.checked);\r\n                        self.buildJWVideoPlayerPreview(keditor);\r\n                    });\r\n                }\r\n            });\r\n        },\r\n        \r\n        showSettingForm: function (form, component, keditor) {\r\n            flog('showSettingForm \"video\" component', form, component);\r\n            \r\n            var wrapper = component.find('.video-wrapper');\r\n            var borderWidth = wrapper.css('border-width') || '';\r\n            var isBorderEnabled = borderWidth !== '0px';\r\n            \r\n            var chkBorder = form.find('.chk-border');\r\n            var txtBorderWidth = form.find('.border-width');\r\n            var colorPicker = form.find('.color-picker');\r\n            var selectPicker = form.find('.select-border-style');\r\n            \r\n            chkBorder.prop('checked', isBorderEnabled);\r\n            selectPicker.prop('disabled', !isBorderEnabled).selectpicker('refresh').selectpicker('val', wrapper.css('border-style'));\r\n            txtBorderWidth.prop('disabled', !isBorderEnabled).val(isBorderEnabled ? borderWidth.replace('px', '') : '');\r\n            colorPicker.colorpicker(isBorderEnabled ? 'enable' : 'disable').colorpicker('setValue', isBorderEnabled ? wrapper.css('border-color') : '');\r\n            \r\n            form.find('#video-autoplay').prop('checked', wrapper.attr('data-autostart') === 'true');\r\n            form.find('#video-loop').prop('checked', wrapper.attr('data-repeat') === 'true');\r\n            form.find('.video-ratio').filter('[value=\"' + wrapper.attr('data-aspectratio') + '\"]').prop('checked', true);\r\n            form.find('#video-showcontrols').prop('checked', wrapper.attr('data-controls') === 'true');\r\n        },\r\n        \r\n        buildJWVideoPlayerPreview: function (component) {\r\n            if (!component.jquery) {\r\n                component = component.getSettingComponent();\r\n            }\r\n            var wrapper = component.find('.video-wrapper');\r\n            var src = wrapper.attr('data-video-src');\r\n            var autostart = wrapper.attr('data-autostart');\r\n            var repeat = wrapper.attr('data-repeat');\r\n            var aspectratio = wrapper.attr('data-aspectratio');\r\n            var controls = wrapper.attr('data-controls');\r\n            var playerInstance = jwplayer(wrapper.attr('data-id'));\r\n            var posterHref = src + '/alt-640-360.png';\r\n            \r\n            flog(\"buildJWPlayer\", src, \"aspectratio=\", aspectratio);\r\n            playerInstance.setup({\r\n                autostart: autostart,\r\n                repeat: repeat,\r\n                controls: controls,\r\n                aspectratio: aspectratio,\r\n                flashplayer: \"/static/jwplayer/6.10/jwplayer.flash.swf\",\r\n                html5player: \"/static/jwplayer/6.10/jwplayer.html5.js\",\r\n                width: \"100%\",\r\n                androidhls: true, //enable hls on android 4.1+\r\n                playlist: [{\r\n                    image: posterHref,\r\n                    sources: [{\r\n                        file: src\r\n                    }\r\n                        , {\r\n                            file: src + \"/../alt-640-360.webm\"\r\n                        }, {\r\n                            file: src + \"/../alt-640-360.m4v\"\r\n                        }]\r\n                }]\r\n                , primary: \"flash\"\r\n            });\r\n            \r\n            playerInstance.onReady(function () {\r\n                flog('jwplayer preview init done');\r\n            });\r\n        },\r\n        \r\n        refreshVideoPlayerPreview: function (keditor) {\r\n            var wrapper = keditor.getSettingComponent().find('.video-wrapper');\r\n            var playerInstance = jwplayer(wrapper.attr('data-id'));\r\n            var src = wrapper.attr('data-video-src');\r\n            \r\n            playerInstance.load([{\r\n                file: src\r\n            }]);\r\n            playerInstance.play();\r\n        }\r\n    };\r\n})(jQuery);\r\n\r\n/**\r\n * KEditor Vimeo Component\r\n * @copyright: Kademi (http://kademi.co)\r\n * @author: Kademi (http://kademi.co)\r\n * @version: @{version}\r\n * @dependencies: $, $.fn.draggable, $.fn.droppable, $.fn.sortable, Bootstrap, FontAwesome (optional)\r\n */\r\n(function ($) {\r\n    var KEditor = $.keditor;\r\n    var flog = KEditor.log;\r\n    \r\n    KEditor.components['vimeo'] = {\r\n        getContent: function (component, keditor) {\r\n            flog('getContent \"vimeo\" component', component);\r\n            \r\n            var componentContent = component.children('.keditor-component-content');\r\n            componentContent.find('.vimeo-cover').remove();\r\n            \r\n            return componentContent.html();\r\n        },\r\n        \r\n        settingEnabled: true,\r\n        \r\n        settingTitle: 'Vimeo Settings',\r\n        \r\n        initSettingForm: function (form, keditor) {\r\n            flog('init \"vimeo\" settings', form);\r\n            \r\n            return $.ajax({\r\n                url: '/static/keditor/componentVimeoSettings.html',\r\n                type: 'get',\r\n                dataType: 'HTML',\r\n                success: function (resp) {\r\n                    form.html(resp);\r\n                    \r\n                    var btnEdit = form.find('.btn-vimeo-edit');\r\n                    btnEdit.on('click', function (e) {\r\n                        e.preventDefault();\r\n                        \r\n                        var inputData = prompt('Please enter Vimeo URL in here:');\r\n                        var vimeoRegex = /https?:\\/\\/(?:www\\.|player\\.)?vimeo.com\\/(?:channels\\/(?:\\w+\\/)?|groups\\/([^\\/]*)\\/videos\\/|album\\/(\\d+)\\/video\\/|video\\/|)(\\d+)(?:$|\\/|\\?)/;\r\n                        var match = inputData.match(vimeoRegex);\r\n                        if (match && match[1]) {\r\n                            keditor.getSettingComponent().find('.embed-responsive-item').attr('src', 'https://player.vimeo.com/video/' + match[1] + '?byline=0&portrait=0&badge=0');\r\n                        } else {\r\n                            alert('Your Vimeo URL is invalid!');\r\n                        }\r\n                    });\r\n                    \r\n                    var btn169 = form.find('.btn-vimeo-169');\r\n                    btn169.on('click', function (e) {\r\n                        e.preventDefault();\r\n                        \r\n                        keditor.getSettingComponent().find('.embed-responsive').removeClass('embed-responsive-4by3').addClass('embed-responsive-16by9');\r\n                    });\r\n                    \r\n                    var btn43 = form.find('.btn-vimeo-43');\r\n                    btn43.on('click', function (e) {\r\n                        e.preventDefault();\r\n                        \r\n                        keditor.getSettingComponent().find('.embed-responsive').removeClass('embed-responsive-16by9').addClass('embed-responsive-4by3');\r\n                    });\r\n                    \r\n                    var chkAutoplay = form.find('#vimeo-autoplay');\r\n                    chkAutoplay.on('click', function () {\r\n                        var embedItem = keditor.getSettingComponent().find('.embed-responsive-item');\r\n                        var currentUrl = embedItem.attr('src');\r\n                        var newUrl = (currentUrl.replace(/(\\?.+)+/, '')) + '?byline=0&portrait=0&badge=0&autoplay=' + (chkAutoplay.is(':checked') ? 1 : 0);\r\n                        \r\n                        flog('Current url: ' + currentUrl, 'New url: ' + newUrl);\r\n                        embedItem.attr('src', newUrl);\r\n                    });\r\n                }\r\n            });\r\n        },\r\n        \r\n        showSettingForm: function (form, component, keditor) {\r\n            flog('showSettingForm \"vimeo\" component', component);\r\n            \r\n            var embedItem = component.find('.embed-responsive-item');\r\n            var chkAutoplay = form.find('#vimeo-autoplay');\r\n            var src = embedItem.attr('src');\r\n            \r\n            chkAutoplay.prop('checked', src.indexOf('autoplay=1') !== -1);\r\n        }\r\n    };\r\n    \r\n})(jQuery);\r\n\r\n/**\r\n * KEditor Youtube Component\r\n * @copyright: Kademi (http://kademi.co)\r\n * @author: Kademi (http://kademi.co)\r\n * @version: @{version}\r\n * @dependencies: $, $.fn.draggable, $.fn.droppable, $.fn.sortable, Bootstrap, FontAwesome (optional)\r\n */\r\n(function ($) {\r\n    var KEditor = $.keditor;\r\n    var flog = KEditor.log;\r\n    \r\n    KEditor.components['youtube'] = {\r\n        getContent: function (component, keditor) {\r\n            flog('getContent \"youtube\" component', component);\r\n            \r\n            var componentContent = component.children('.keditor-component-content');\r\n            componentContent.find('.youtube-cover').remove();\r\n            \r\n            return componentContent.html();\r\n        },\r\n        \r\n        settingEnabled: true,\r\n        \r\n        settingTitle: 'Youtube Settings',\r\n        \r\n        initSettingForm: function (form, keditor) {\r\n            flog('init \"youtube\" settings', form);\r\n            \r\n            return $.ajax({\r\n                url: '/static/keditor/componentYoutubeSettings.html',\r\n                type: 'get',\r\n                dataType: 'HTML',\r\n                success: function (resp) {\r\n                    form.html(resp);\r\n                    \r\n                    var btnEdit = form.find('.btn-youtube-edit');\r\n                    btnEdit.on('click', function (e) {\r\n                        e.preventDefault();\r\n                        \r\n                        var inputData = prompt('Please enter Youtube URL in here:');\r\n                        var youtubeRegex = /^(?:http(?:s)?:\\/\\/)?(?:www\\.)?(?:m\\.)?(?:youtu\\.be\\/|youtube\\.com\\/(?:(?:watch)?\\?(?:.*&)?v(?:i)?=|(?:embed|v|vi|user)\\/))([^\\?&\\\"'>]+)/;\r\n                        var match = inputData.match(youtubeRegex);\r\n                        if (match && match[1]) {\r\n                            keditor.getSettingComponent().find('.embed-responsive-item').attr('src', 'https://www.youtube.com/embed/' + match[1]);\r\n                        } else {\r\n                            alert('Your Youtube URL is invalid!');\r\n                        }\r\n                    });\r\n                    \r\n                    var btn169 = form.find('.btn-youtube-169');\r\n                    btn169.on('click', function (e) {\r\n                        e.preventDefault();\r\n                        \r\n                        keditor.getSettingComponent().find('.embed-responsive').removeClass('embed-responsive-4by3').addClass('embed-responsive-16by9');\r\n                    });\r\n                    \r\n                    var btn43 = form.find('.btn-youtube-43');\r\n                    btn43.on('click', function (e) {\r\n                        e.preventDefault();\r\n                        \r\n                        keditor.getSettingComponent().find('.embed-responsive').removeClass('embed-responsive-16by9').addClass('embed-responsive-4by3');\r\n                    });\r\n                    \r\n                    var chkAutoplay = form.find('#youtube-autoplay');\r\n                    chkAutoplay.on('click', function () {\r\n                        var embedItem = keditor.getSettingComponent().find('.embed-responsive-item');\r\n                        var currentUrl = embedItem.attr('src');\r\n                        var newUrl = (currentUrl.replace(/(\\?.+)+/, '')) + '?autoplay=' + (chkAutoplay.is(':checked') ? 1 : 0);\r\n                        \r\n                        flog('Current url: ' + currentUrl, 'New url: ' + newUrl);\r\n                        embedItem.attr('src', newUrl);\r\n                    });\r\n                }\r\n            });\r\n        },\r\n        \r\n        showSettingForm: function (form, component, keditor) {\r\n            flog('showSettingForm \"youtube\" component', component);\r\n            \r\n            var embedItem = component.find('.embed-responsive-item');\r\n            var chkAutoplay = form.find('#youtube-autoplay');\r\n            var src = embedItem.attr('src');\r\n            \r\n            chkAutoplay.prop('checked', src.indexOf('autoplay=1') !== -1);\r\n        }\r\n    };\r\n    \r\n})(jQuery);\r\n"]}