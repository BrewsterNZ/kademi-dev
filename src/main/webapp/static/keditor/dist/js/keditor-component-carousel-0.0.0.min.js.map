{"version":3,"sources":["keditor-component-carousel-0.0.0.js"],"names":["$","KEditor","keditor","flog","log","components","init","contentArea","container","component","componentContent","children","carousel","find","length","self","this","images","addClass","each","item","push","src","attr","hash","css","html","i","image","addItemToCarousel","id","generateId","getContent","settingEnabled","settingTitle","editingItemId","initSettingForm","form","ajax","url","type","dataType","success","resp","basePath","window","location","pathname","substr","lastIndexOf","carouselAddImage","carouselItemsWrap","mselect","contentTypes","bs3Modal","pagePath","onSelectFile","relUrl","addItemToList","caption","refreshCarousel","getSettingComponent","sortable","handle","items","axis","tolerance","sort","removeClass","update","editorContent","initModalContent","modalContent","editorCaption","initModalCaption","modalCaption","on","e","preventDefault","modal","document","body","confirm","btn","closest","siblings","remove","carouselItem","txtCarouselContent","setData","val","trigger","txtCarouselCaption","value","isNaN","comp","checked","appendTo","contentOptions","extend","options","ckeditorOptions","removePlugins","replace","extraPlugins","ckeditor","editor","carouselContent","getData","content","captionOptions","toolbarGroups","toolbarSets","carouselCaption","showSettingForm","carouselImg","slice","isWrap","pause","interval","height","prop","data","index","cls","backgroundUrl","append","itemStr","editCaption","Date","getTime","txtContent","txtCaption","img","jQuery"],"mappings":"CAUA,SAAWA,GACP,GAAIC,GAAUD,EAAEE,QACZC,EAAOF,EAAQG,GAEnBH,GAAQI,WAAqB,UACzBC,KAAM,SAAUC,EAAaC,EAAWC,EAAWP,GAC/CC,EAAK,4BAA6BM,EAClC,IAAIC,GAAmBD,EAAUE,SAAS,8BACtCC,EAAWF,EAAiBG,KAAK,YAErC,IAA8C,IAA1CD,EAASC,KAAK,iBAAiBC,QAA8D,IAA9CF,EAASC,KAAK,qBAAqBC,OAAc,CAChG,GAAIC,GAAOC,KACPC,IAEJL,GAASM,SAAS,yBAClBN,EAASC,KAAK,yBAAyBM,KAAK,WACxC,GAAIC,GAAOpB,EAAEgB,KAEbC,GAAOI,MACHC,IAAKF,EAAKP,KAAK,OAAOU,KAAK,OAC3BC,KAAMJ,EAAKG,KAAK,iBAIxBX,EAASW,KAAK,cAAe,KAAKE,IAAI,SAAU,KAChDb,EAASC,KAAK,mBAAmBa,KAAK,IACtCd,EAASC,KAAK,wBAAwBa,KAAK,IAE3C1B,EAAEmB,KAAKF,EAAQ,SAAUU,EAAGC,GACxBb,EAAKc,kBAAkBpB,EAAWmB,EAAMN,IAAKM,EAAMJ,QAI3D,GAAIM,GAAK5B,EAAQ6B,WAAW,qBAC5BnB,GAASW,KAAK,KAAMO,GACpBlB,EAASC,KAAK,2BAA2BU,KAAK,cAAe,IAAMO,GACnElB,EAASC,KAAK,qBAAqBU,KAAK,OAAQ,IAAMO,IAE1DE,WAAY,SAAUvB,EAAWP,GAC7B,GAAIQ,GAAmBD,EAAUE,SAAS,6BAC1C,OAAOD,GAAiBgB,QAE5BO,gBAAgB,EAEhBC,aAAc,oBAEdC,cAAe,GAEfC,gBAAiB,SAAUC,EAAMnC,GAC7BC,EAAK,2BAA4BkC,EAEjC,IAAItB,GAAOC,IACX,OAAOhB,GAAEsC,MACLC,IAAK,iDACLC,KAAM,MACNC,SAAU,OACVC,QAAS,SAAUC,GACfN,EAAKX,KAAKiB,EAEV,IAAIC,GAAWC,OAAOC,SAASC,SAASC,OAAO,EAAGH,OAAOC,SAASC,SAASE,YAAY,KAAO,GAC1FC,EAAmBb,EAAKxB,KAAK,qBAC7BsC,EAAoBd,EAAKxB,KAAK,qBAElCqC,GAAiBE,SACbC,cAAe,SACfC,UAAU,EACVC,SAAUX,EACVA,SAAUA,EACVY,aAAc,SAAUjB,EAAKkB,EAAQjB,EAAMhB,GACvCrB,EAAK,mCAAoCoC,EAAKf,GAC9CT,EAAK2C,cAAcrB,GACff,IAAKiB,EACLf,KAAMA,EACNmC,QAAS,KAGb5C,EAAK6C,gBAAgB1D,EAAQ2D,sBAAuBxB,GACpDtB,EAAKoB,cAAgB,MAI7BgB,EAAkBW,UACdC,OAAQ,iBACRC,MAAO,kBACPC,KAAM,IACNC,UAAW,UACXC,KAAM,WACFnE,EAAEgB,MAAMoD,YAAY,qBAExBC,OAAQ,WACJtD,EAAK6C,gBAAgB1D,EAAQ2D,sBAAuBxB,KAK5D,IAAIiC,GAAgBvD,EAAKwD,iBAAiBlC,EAAMnC,GAC5CsE,EAAexE,EAAE,2BAGjByE,EAAgB1D,EAAK2D,iBAAiBrC,EAAMnC,GAC5CyE,EAAe3E,EAAE,0BAErBqC,GAAKxB,KAAK,qBAAqB+D,GAAG,QAAS,SAAUC,GACjDA,EAAEC,mBAGNzC,EAAKxB,KAAK,uBAAuB+D,GAAG,QAAS,SAAUC,GACnDA,EAAEC,iBACFN,EAAaO,MAAM,UAGvB/E,EAAEgF,SAASC,MAAML,GAAG,QAAS,kCAAmC,SAAUC,GAGtE,GAFAA,EAAEC,iBAEEI,QAAQ,oDAAqD,CAC7D,GAAIC,GAAMnF,EAAEgB,MACRQ,EAAO2D,EAAIC,QAAQ,cAAcC,SAAS,eAAe9D,KAAK,YAElER,GAAK6C,gBAAgB1D,EAAQ2D,sBAAuBrC,GACpD2D,EAAIC,QAAQ,iBAAiBE,YAIrCtF,EAAEgF,SAASC,MAAML,GAAG,QAAS,gCAAiC,SAAUC,GACpEA,EAAEC,gBAEF,IAAIS,GAAevF,EAAEgB,MAAMoE,QAAQ,gBACnCrE,GAAKoB,cAAgBoD,EAAahE,KAAK,KACvC,IAAIiE,GAAqBD,EAAa1E,KAAK,wBAEvC2E,GAAmB1E,OAAS,GAC5BwD,EAAcmB,QAAQD,EAAmBE,OAAS,IAClDrD,EAAKxB,KAAK,uBAAuB8E,QAAQ,UAEzCtD,EAAKxB,KAAK,qBAAqB8E,QAAQ,WAK/C3F,EAAEgF,SAASC,MAAML,GAAG,QAAS,wCAAyC,SAAUC,GAC5EA,EAAEC,gBAEF,IAAIS,GAAevF,EAAEgB,MAAMoE,QAAQ,gBACnCrE,GAAKoB,cAAgBoD,EAAahE,KAAK,KACvC,IAAIqE,GAAqBL,EAAa1E,KAAK,wBAE3C4D,GAAcgB,QAAQG,EAAmBF,OAAS,IAClDf,EAAaI,MAAM,UAGvB1C,EAAKxB,KAAK,mBAAmB+D,GAAG,SAAU,SAAUC,GAChD,GAAIgB,GAAQ7E,KAAK6E,OAEbC,MAAMD,IAAmB,KAARA,KACjBA,EAAQ,IACR7E,KAAK6E,MAAQ,IAGjB,IAAIjF,GAAWV,EAAQ2D,sBAAsBhD,KAAK,YAClDD,GAASW,KAAK,cAAesE,GAC7BjF,EAASa,IAAI,SAAUoE,KAG3BxD,EAAKxB,KAAK,kBAAkB+D,GAAG,SAAU,SAAUC,GAC/CA,EAAEC,gBACF,IAAIiB,GAAO7F,EAAQ2D,sBAAsBhD,KAAK,YAC9CkF,GAAKxE,KAAK,aAAcP,KAAK6E,SAGjCxD,EAAKxB,KAAK,qBAAqB+D,GAAG,SAAU,SAAUC,GAClDA,EAAEC,gBACF,IAAIiB,GAAO7F,EAAQ2D,sBAAsBhD,KAAK,YAC9CkF,GAAKxE,KAAK,gBAAiBP,KAAK6E,SAGpCxD,EAAKxB,KAAK,iBAAiB+D,GAAG,QAAS,SAAUC,GAC7C,GAAIkB,GAAO7F,EAAQ2D,sBAAsBhD,KAAK,YAC1CG,MAAKgF,QACLD,EAAKxE,KAAK,YAAa,QAEvBwE,EAAKxE,KAAK,YAAa,eAO3CgD,iBAAkB,SAAUlC,EAAMnC,GAC9B,GAAIa,GAAOC,KAEPwD,EAAexE,EACf,ixBAiBFiG,SAASjB,SAASC,MAEhBiB,EAAiBlG,EAAEmG,UAAWjG,EAAQkG,QAAQC,gBAClDH,GAAeI,cAAgBJ,EAAeI,cAAcC,QAAQ,YAAa,IAAM,gBACvFL,EAAeM,aAAeN,EAAeM,aAAe,WAC5D,IAAIlC,GAAgBtE,EAAE,gCAAgCyG,SAASP,GAAgBQ,MAqB/E,OAnBAlC,GAAaI,GAAG,kBAAmB,WAC/BN,EAAcmB,QAAQ,IACtB1E,EAAKoB,cAAgB,KAGzBqC,EAAa3D,KAAK,8BAA8B+D,GAAG,QAAS,SAAUC,GAClEA,EAAEC,iBAEF3E,EAAK,+BAEL,IAAIwG,GAAkBrC,EAAcsC,WAAa,EACjD7F,GAAK2C,cAAcrB,GACfwE,QAASF,IAGb5F,EAAK6C,gBAAgB1D,EAAQ2D,sBAAuBxB,GACpDmC,EAAaO,MAAM,UAGhBT,GAGXI,iBAAkB,SAAUrC,EAAMnC,GAC9B,GAAIa,GAAOC,KAEP2D,EAAe3E,EACf,ixBAiBFiG,SAASjB,SAASC,MAEhB6B,EAAiB9G,EAAEmG,UAAWjG,EAAQkG,QAAQC,gBAClDS,GAAeR,cAAgBQ,EAAeR,cAAcC,QAAQ,YAAa,IAAM,gBACvFO,EAAeN,aAAeM,EAAeN,aAAe,YAC5DM,EAAeC,cAAgBC,YAAkB,IACjD,IAAIvC,GAAgBzE,EAAE,gCAAgCyG,SAASK,GAAgBJ,MAwB/E,OAtBA/B,GAAaC,GAAG,kBAAmB,WAC/BH,EAAcgB,QAAQ,IACtB1E,EAAKoB,cAAgB,KAGzBwC,EAAa9D,KAAK,8BAA8B+D,GAAG,QAAS,SAAUC,GAClEA,EAAEC,iBAEF3E,EAAK,+BAEL,IAAI8G,GAAkBxC,EAAcmC,WAAa,GAC7CxF,EAAOiB,EAAKxB,KAAK,IAAME,EAAKoB,eAAetB,KAAK,kBACpDE,GAAK2C,cAAcrB,GACff,IAAKF,EAAKG,KAAK,OACfC,KAAMJ,EAAKG,KAAK,aAChBoC,QAASsD,IAGblG,EAAK6C,gBAAgB1D,EAAQ2D,sBAAuBxB,GACpDsC,EAAaI,MAAM,UAGhBN,GAGXyC,gBAAiB,SAAU7E,EAAM5B,EAAWP,GACxC,GAAIa,GAAOC,IACXD,GAAKoB,cAAgB,GACrBE,EAAKxB,KAAK,sBAAsBa,KAAK,IACrCjB,EAAUI,KAAK,2BAA2BM,KAAK,WAC3C,GAAIC,GAAOpB,EAAEgB,MACTmG,EAAc/F,EAAKP,KAAK,iBACxB8F,EAAkBvF,EAAKP,KAAK,oBAEhC,IAAI8F,EAAgB7F,OAAS,EACzBC,EAAK2C,cAAcrB,GACfwE,QAASF,EAAgBjF,aAE1B,CACH,GAAIa,GAAM4E,EAAY1F,IAAI,mBAC1Bc,GAAMA,EAAI6E,MAAM,EAAG,IAAIb,QAAQ,QAAS,GACxC,IAAI/E,GAAOxB,EAAEoB,GAAMG,KAAK,aACpBoC,EAAUvC,EAAKP,KAAK,oBAExBE,GAAK2C,cAAcrB,GACff,IAAKiB,EACLf,KAAMA,EACNmC,QAASA,EAAQjC,QAAU,OAKvC,IAAI2F,GAAS5G,EAAUI,KAAK,aAAaU,KAAK,aAC1C+F,EAAQ7G,EAAUI,KAAK,aAAaU,KAAK,cACzCgG,EAAW9G,EAAUI,KAAK,aAAaU,KAAK,iBAC5CiG,EAAS/G,EAAUI,KAAK,aAAaU,KAAK,cAE9Cc,GAAKxB,KAAK,kBAAkB6E,IAAI4B,GAChCjF,EAAKxB,KAAK,qBAAqB6E,IAAI6B,GACnClF,EAAKxB,KAAK,iBAAiB4G,KAAK,UAAsB,SAAXJ,GAC3ChF,EAAKxB,KAAK,mBAAmB6E,IAAI8B,IAGrC3F,kBAAmB,SAAUpB,EAAWiH,GACpCvH,EAAK,oBAAqBM,EAAWiH,EAErC,IAAI9G,GAAWH,EAAUI,KAAK,aAC1BiB,EAAKlB,EAASW,KAAK,MACnBoG,EAAQ/G,EAASC,KAAK,wBAAwBF,WAAWG,OACzD8G,EAAgB,IAAVD,EAAc,SAAW,GAC/BE,EAAgB,0BAA4BH,EAAKpG,IAAM,IAE3DV,GAASC,KAAK,wBAAwBiH,OAClC,qBAAuBhG,EAAK,oBAAsB6F,EAAQ,YAAcC,EAAM,UAGlF,IAAIG,GAAU,EACVL,GAAKb,SACLkB,GAAW,oBAAsBH,EAAM,KACvCG,GAAW,6CAA+CL,EAAKb,QAAU,SACzEkB,GAAW,0CACXA,GAAW,WAEXA,GAAW,mBAAqBL,EAAKlG,KAAO,iBAAmBoG,EAAM,KACrEG,GAAW,uCAAyCF,EAAgB,WACpEE,GAAW,oCAAsCL,EAAK/D,QAAU,SAChEoE,GAAW,UAGfnH,EAASC,KAAK,mBAAmBiH,OAAOC,IAG5CrE,cAAe,SAAUrB,EAAMqF,GAC3BvH,EAAK,gBAAiBkC,EAAMqF,EAE5B,IAAIM,GAAc,GAEdD,EAAU,EACVL,GAAKb,SACLkB,GAAW,oFACXA,GAAW,gEAAkEL,EAAKb,QAAU,gBAE5FkB,GAAW,oCAAsCL,EAAKpG,IAAM,gBAAkBoG,EAAKlG,KAAO,OAC1FuG,GAAW,gEAAkEL,EAAK/D,QAAU,cAC5FqE,EAAc,iHAGlBD,GAAW,0CACXA,GAAW,4GACXA,GAAW,4GAA8GC,EACzHD,GAAW,gHACXA,GAAW,YAEP/G,KAAKmB,eACLE,EAAKxB,KAAK,IAAMG,KAAKmB,eAAeT,KAAKqG,GACzC/G,KAAKmB,cAAgB,IAErBE,EAAKxB,KAAK,sBAAsBiH,OAC5B,+CAAgD,GAAKG,OAAQC,UAAY,KAAOH,EAAU,WAKtGnE,gBAAiB,SAAUnD,EAAW4B,GAClC,GAAItB,GAAOC,KACPJ,EAAWH,EAAUI,KAAK,YAC9BD,GAASC,KAAK,mBAAmBa,KAAK,IACtCd,EAASC,KAAK,wBAAwBa,KAAK,IAE3CW,EAAKxB,KAAK,sBAAsBA,KAAK,iBAAiBM,KAAK,WACvD,GAAIoE,GAAevF,EAAEgB,MACjBmH,EAAa5C,EAAa1E,KAAK,yBAC/BuH,EAAa7C,EAAa1E,KAAK,yBAC/BwH,EAAM9C,EAAa1E,KAAK,MAEF,KAAtBsH,EAAWrH,OACXC,EAAKc,kBAAkBpB,GACnBa,IAAK+G,EAAI9G,KAAK,OACdC,KAAM6G,EAAI9G,KAAK,aACfoC,QAASyE,EAAW1C,QAGxB3E,EAAKc,kBAAkBpB,GACnBoG,QAASsB,EAAWzC,aAOzC4C","file":"keditor-component-carousel-0.0.0.min.js","sourcesContent":["/**\r\n * Created by Anh on 7/27/2016.\r\n */\r\n/**\r\n * KEditor Carousel Component\r\n * @copyright: Kademi (http://kademi.co)\r\n * @author: Kademi (http://kademi.co)\r\n * @version: @{version}\r\n * @dependencies: $, $.fn.draggable, $.fn.droppable, $.fn.sortable, Bootstrap, FontAwesome (optional)\r\n */\r\n(function ($) {\r\n    var KEditor = $.keditor;\r\n    var flog = KEditor.log;\r\n    \r\n    KEditor.components['carousel'] = {\r\n        init: function (contentArea, container, component, keditor) {\r\n            flog('init \"carousel\" component', component);\r\n            var componentContent = component.children('.keditor-component-content');\r\n            var carousel = componentContent.find('.carousel');\r\n            \r\n            if (carousel.find('.carousel-img').length === 0 && carousel.find('.carousel-content').length === 0) {\r\n                var self = this;\r\n                var images = [];\r\n                \r\n                carousel.addClass('carousel-fixed-height');\r\n                carousel.find('.carousel-inner .item').each(function () {\r\n                    var item = $(this);\r\n                    \r\n                    images.push({\r\n                        src: item.find('img').attr('src'),\r\n                        hash: item.attr('data-hash')\r\n                    });\r\n                });\r\n                \r\n                carousel.attr('data-height', 200).css('height', 200);\r\n                carousel.find('.carousel-inner').html('');\r\n                carousel.find('.carousel-indicators').html('');\r\n                \r\n                $.each(images, function (i, image) {\r\n                    self.addItemToCarousel(component, image.src, image.hash);\r\n                });\r\n            }\r\n            \r\n            var id = keditor.generateId('component-carousel');\r\n            carousel.attr('id', id);\r\n            carousel.find('.carousel-indicators li').attr('data-target', '#' + id);\r\n            carousel.find('.carousel-control').attr('href', '#' + id);\r\n        },\r\n        getContent: function (component, keditor) {\r\n            var componentContent = component.children('.keditor-component-content');\r\n            return componentContent.html();\r\n        },\r\n        settingEnabled: true,\r\n        \r\n        settingTitle: 'Carousel settings',\r\n        \r\n        editingItemId: '',\r\n        \r\n        initSettingForm: function (form, keditor) {\r\n            flog('init \"carousel\" settings', form);\r\n            \r\n            var self = this;\r\n            return $.ajax({\r\n                url: '/static/keditor/componentCarouselSettings.html',\r\n                type: 'get',\r\n                dataType: 'HTML',\r\n                success: function (resp) {\r\n                    form.html(resp);\r\n                    \r\n                    var basePath = window.location.pathname.substr(0, window.location.pathname.lastIndexOf('/') + 1);\r\n                    var carouselAddImage = form.find('.carouselAddImage');\r\n                    var carouselItemsWrap = form.find('.carouselItemsWrap');\r\n                    \r\n                    carouselAddImage.mselect({\r\n                        contentTypes: ['image'],\r\n                        bs3Modal: true,\r\n                        pagePath: basePath,\r\n                        basePath: basePath,\r\n                        onSelectFile: function (url, relUrl, type, hash) {\r\n                            flog('Keditor carousel selected a file', url, hash);\r\n                            self.addItemToList(form, {\r\n                                src: url,\r\n                                hash: hash,\r\n                                caption: ''\r\n                            });\r\n                            \r\n                            self.refreshCarousel(keditor.getSettingComponent(), form);\r\n                            self.editingItemId = '';\r\n                        }\r\n                    });\r\n                    \r\n                    carouselItemsWrap.sortable({\r\n                        handle: '.btn-sort-item',\r\n                        items: '> .carouselItem',\r\n                        axis: 'y',\r\n                        tolerance: 'pointer',\r\n                        sort: function () {\r\n                            $(this).removeClass('ui-state-default');\r\n                        },\r\n                        update: function () {\r\n                            self.refreshCarousel(keditor.getSettingComponent(), form);\r\n                        }\r\n                    });\r\n                    \r\n                    // Content modal\r\n                    var editorContent = self.initModalContent(form, keditor)\r\n                    var modalContent = $('#modal-carousel-content');\r\n                    \r\n                    // Caption modal\r\n                    var editorCaption = self.initModalCaption(form, keditor)\r\n                    var modalCaption = $('#modal-carousel-caption');\r\n                    \r\n                    form.find('.carouselAddImage').on('click', function (e) {\r\n                        e.preventDefault();\r\n                    });\r\n                    \r\n                    form.find('.carouselAddContent').on('click', function (e) {\r\n                        e.preventDefault();\r\n                        modalContent.modal('show');\r\n                    });\r\n                    \r\n                    $(document.body).on('click', '.carouselItem a.btn-remove-item', function (e) {\r\n                        e.preventDefault();\r\n                        \r\n                        if (confirm('Are you sure that you want to delete this image?')) {\r\n                            var btn = $(this);\r\n                            var hash = btn.closest('.btn-group').siblings('[data-hash]').attr('data-hash');\r\n                            \r\n                            self.refreshCarousel(keditor.getSettingComponent(), hash);\r\n                            btn.closest('.carouselItem').remove();\r\n                        }\r\n                    });\r\n                    \r\n                    $(document.body).on('click', '.carouselItem a.btn-edit-item', function (e) {\r\n                        e.preventDefault();\r\n                        \r\n                        var carouselItem = $(this).closest('.carouselItem');\r\n                        self.editingItemId = carouselItem.attr('id');\r\n                        var txtCarouselContent = carouselItem.find('.txt-carousel-content');\r\n                        \r\n                        if (txtCarouselContent.length > 0) {\r\n                            editorContent.setData(txtCarouselContent.val() || '');\r\n                            form.find('.carouselAddContent').trigger('click');\r\n                        } else {\r\n                            form.find('.carouselAddImage').trigger('click');\r\n                        }\r\n                    });\r\n                    \r\n                    \r\n                    $(document.body).on('click', '.carouselItem a.btn-edit-caption-item', function (e) {\r\n                        e.preventDefault();\r\n                        \r\n                        var carouselItem = $(this).closest('.carouselItem');\r\n                        self.editingItemId = carouselItem.attr('id');\r\n                        var txtCarouselCaption = carouselItem.find('.txt-carousel-caption');\r\n                        \r\n                        editorCaption.setData(txtCarouselCaption.val() || '');\r\n                        modalCaption.modal('show');\r\n                    });\r\n                    \r\n                    form.find('.carouselHeight').on('change', function (e) {\r\n                        var value = this.value;\r\n                        \r\n                        if (isNaN(value) || +value < 200) {\r\n                            value = 200;\r\n                            this.value = 200;\r\n                        }\r\n                        \r\n                        var carousel = keditor.getSettingComponent().find('.carousel');\r\n                        carousel.attr('data-height', value);\r\n                        carousel.css('height', value);\r\n                    });\r\n                    \r\n                    form.find('.carouselPause').on('change', function (e) {\r\n                        e.preventDefault();\r\n                        var comp = keditor.getSettingComponent().find('.carousel');\r\n                        comp.attr('data-pause', this.value);\r\n                    });\r\n                    \r\n                    form.find('.carouselInterval').on('change', function (e) {\r\n                        e.preventDefault();\r\n                        var comp = keditor.getSettingComponent().find('.carousel');\r\n                        comp.attr('data-interval', this.value);\r\n                    });\r\n                    \r\n                    form.find('.carouselWrap').on('click', function (e) {\r\n                        var comp = keditor.getSettingComponent().find('.carousel');\r\n                        if (this.checked) {\r\n                            comp.attr('data-wrap', 'true');\r\n                        } else {\r\n                            comp.attr('data-wrap', 'false');\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n        },\r\n        \r\n        initModalContent: function (form, keditor) {\r\n            var self = this;\r\n            \r\n            var modalContent = $(\r\n                '<div class=\"modal fade\" tabindex=\"-1\" id=\"modal-carousel-content\">' +\r\n                '    <div class=\"modal-dialog modal-lg\">' +\r\n                '        <div class=\"modal-content\">' +\r\n                '            <div class=\"modal-header\">' +\r\n                '                <button type=\"button\" class=\"close\" data-dismiss=\"modal\">&times;</button>' +\r\n                '                <h4 class=\"modal-title\">Edit content</h4>' +\r\n                '            </div>' +\r\n                '            <div class=\"modal-body\">' +\r\n                '                <textarea id=\"modal-carousel-content-body\" class=\"form-control\" rows=\"12\"></textarea>' +\r\n                '            </div>' +\r\n                '            <div class=\"modal-footer\">' +\r\n                '                <button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\">Close</button>' +\r\n                '                <button type=\"button\" class=\"btn btn-primary btn-carousel-save-content\">Save</button>' +\r\n                '            </div>' +\r\n                '        </div>' +\r\n                '    </div>' +\r\n                '</div>'\r\n            ).appendTo(document.body);\r\n            \r\n            var contentOptions = $.extend({}, keditor.options.ckeditorOptions);\r\n            contentOptions.removePlugins = contentOptions.removePlugins.replace(',autogrow', '') + ',sourcedialog';\r\n            contentOptions.extraPlugins = contentOptions.extraPlugins + ',autogrow';\r\n            var editorContent = $('#modal-carousel-content-body').ckeditor(contentOptions).editor;\r\n            \r\n            modalContent.on('hidden.bs.modal', function () {\r\n                editorContent.setData('');\r\n                self.editingItemId = '';\r\n            });\r\n            \r\n            modalContent.find('.btn-carousel-save-content').on('click', function (e) {\r\n                e.preventDefault();\r\n                \r\n                flog('Keditor carousel add content');\r\n                \r\n                var carouselContent = editorContent.getData() || '';\r\n                self.addItemToList(form, {\r\n                    content: carouselContent\r\n                });\r\n                \r\n                self.refreshCarousel(keditor.getSettingComponent(), form);\r\n                modalContent.modal('hide');\r\n            });\r\n            \r\n            return editorContent;\r\n        },\r\n        \r\n        initModalCaption: function (form, keditor) {\r\n            var self = this;\r\n            \r\n            var modalCaption = $(\r\n                '<div class=\"modal fade\" tabindex=\"-1\" id=\"modal-carousel-caption\">' +\r\n                '    <div class=\"modal-dialog modal-lg\">' +\r\n                '        <div class=\"modal-content\">' +\r\n                '            <div class=\"modal-header\">' +\r\n                '                <button type=\"button\" class=\"close\" data-dismiss=\"modal\">&times;</button>' +\r\n                '                <h4 class=\"modal-title\">Edit caption</h4>' +\r\n                '            </div>' +\r\n                '            <div class=\"modal-body\">' +\r\n                '                <textarea id=\"modal-carousel-caption-body\" class=\"form-control\" rows=\"12\"></textarea>' +\r\n                '            </div>' +\r\n                '            <div class=\"modal-footer\">' +\r\n                '                <button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\">Close</button>' +\r\n                '                <button type=\"button\" class=\"btn btn-primary btn-carousel-save-caption\">Save</button>' +\r\n                '            </div>' +\r\n                '        </div>' +\r\n                '    </div>' +\r\n                '</div>'\r\n            ).appendTo(document.body);\r\n            \r\n            var captionOptions = $.extend({}, keditor.options.ckeditorOptions);\r\n            captionOptions.removePlugins = captionOptions.removePlugins.replace(',autogrow', '') + ',sourcedialog';\r\n            captionOptions.extraPlugins = captionOptions.extraPlugins + ',autogrow';\r\n            captionOptions.toolbarGroups = toolbarSets['Lite'];\r\n            var editorCaption = $('#modal-carousel-caption-body').ckeditor(captionOptions).editor;\r\n            \r\n            modalCaption.on('hidden.bs.modal', function () {\r\n                editorCaption.setData('');\r\n                self.editingItemId = '';\r\n            });\r\n            \r\n            modalCaption.find('.btn-carousel-save-caption').on('click', function (e) {\r\n                e.preventDefault();\r\n                \r\n                flog('Keditor carousel add content');\r\n                \r\n                var carouselCaption = editorCaption.getData() || '';\r\n                var item = form.find('#' + self.editingItemId).find('.img-responsive');\r\n                self.addItemToList(form, {\r\n                    src: item.attr('src'),\r\n                    hash: item.attr('data-hash'),\r\n                    caption: carouselCaption\r\n                });\r\n                \r\n                self.refreshCarousel(keditor.getSettingComponent(), form);\r\n                modalCaption.modal('hide');\r\n            });\r\n            \r\n            return editorCaption;\r\n        },\r\n        \r\n        showSettingForm: function (form, component, keditor) {\r\n            var self = this;\r\n            self.editingItemId = '';\r\n            form.find('.carouselItemsWrap').html('');\r\n            component.find('.carousel-inner > .item').each(function () {\r\n                var item = $(this);\r\n                var carouselImg = item.find('.carousel-img');\r\n                var carouselContent = item.find('.carousel-content');\r\n                \r\n                if (carouselContent.length > 0) {\r\n                    self.addItemToList(form, {\r\n                        content: carouselContent.html()\r\n                    });\r\n                } else {\r\n                    var url = carouselImg.css('background-image');\r\n                    url = url.slice(4, -1).replace(/['\"]/g, '');\r\n                    var hash = $(item).attr('data-hash');\r\n                    var caption = item.find('.carousel-caption');\r\n                    \r\n                    self.addItemToList(form, {\r\n                        src: url,\r\n                        hash: hash,\r\n                        caption: caption.html() || ''\r\n                    });\r\n                }\r\n            });\r\n            \r\n            var isWrap = component.find('.carousel').attr('data-wrap');\r\n            var pause = component.find('.carousel').attr('data-pause');\r\n            var interval = component.find('.carousel').attr('data-interval');\r\n            var height = component.find('.carousel').attr('data-height');\r\n            \r\n            form.find('.carouselPause').val(pause);\r\n            form.find('.carouselInterval').val(interval);\r\n            form.find('.carouselWrap').prop('checked', isWrap === 'true');\r\n            form.find('.carouselHeight').val(height);\r\n        },\r\n        \r\n        addItemToCarousel: function (component, data) {\r\n            flog('addItemToCarousel', component, data);\r\n            \r\n            var carousel = component.find('.carousel');\r\n            var id = carousel.attr('id');\r\n            var index = carousel.find('.carousel-indicators').children().length;\r\n            var cls = index === 0 ? 'active' : '';\r\n            var backgroundUrl = \"background-image: url('\" + data.src + \"')\";\r\n            \r\n            carousel.find('.carousel-indicators').append(\r\n                '<li data-target=\"#' + id + '\" data-slide-to=\"' + index + '\" class=\"' + cls + '\"></li>'\r\n            );\r\n            \r\n            var itemStr = '';\r\n            if (data.content) {\r\n                itemStr += '<div class=\"item ' + cls + '\">';\r\n                itemStr += '   <div class=\"carousel-content clearfix\">' + data.content + '</div>';\r\n                itemStr += '   <div class=\"carousel-caption\"></div>';\r\n                itemStr += '</div>';\r\n            } else {\r\n                itemStr += '<div data-hash=\"' + data.hash + '\" class=\"item ' + cls + '\">';\r\n                itemStr += '   <div class=\"carousel-img\" style=\"' + backgroundUrl + '\"></div>';\r\n                itemStr += '   <div class=\"carousel-caption\">' + data.caption + '</div>';\r\n                itemStr += '</div>';\r\n            }\r\n            \r\n            carousel.find('.carousel-inner').append(itemStr);\r\n        },\r\n        \r\n        addItemToList: function (form, data) {\r\n            flog('addItemToList', form, data);\r\n            \r\n            var editCaption = '';\r\n            \r\n            var itemStr = '';\r\n            if (data.content) {\r\n                itemStr += '<img class=\"img-responsive\" src=\"/static/keditor/componentCarouselContent.png\" />';\r\n                itemStr += '<textarea style=\"display: none\" class=\"txt-carousel-content\">' + data.content + '</textarea>';\r\n            } else {\r\n                itemStr += '<img class=\"img-responsive\" src=\"' + data.src + '\" data-hash=\"' + data.hash + '\" />';\r\n                itemStr += '<textarea style=\"display: none\" class=\"txt-carousel-caption\">' + data.caption + '</textarea>';\r\n                editCaption = '<a title=\"Edit caption\" class=\"btn btn-success btn-edit-caption-item\" href=\"#\"><i class=\"fa fa-file\"></i></a>';\r\n            }\r\n            \r\n            itemStr += '   <div class=\"btn-group btn-group-xs\">';\r\n            itemStr += '       <a title=\"Reorder item\" class=\"btn btn-info btn-sort-item\" href=\"#\"><i class=\"fa fa-sort\"></i></a>';\r\n            itemStr += '       <a title=\"Edit item\" class=\"btn btn-primary btn-edit-item\" href=\"#\"><i class=\"fa fa-edit\"></i></a>' + editCaption;\r\n            itemStr += '       <a title=\"Delete item\" class=\"btn btn-danger btn-remove-item\" href=\"#\"><i class=\"fa fa-trash\"></i></a>';\r\n            itemStr += '   </div>';\r\n            \r\n            if (this.editingItemId) {\r\n                form.find('#' + this.editingItemId).html(itemStr);\r\n                this.editingItemId = '';\r\n            } else {\r\n                form.find('.carouselItemsWrap').append(\r\n                    '<div class=\"carouselItem\" id=\"carouselItem-' + (new Date()).getTime() + '\">' + itemStr + '</div>'\r\n                );\r\n            }\r\n        },\r\n        \r\n        refreshCarousel: function (component, form) {\r\n            var self = this;\r\n            var carousel = component.find('.carousel');\r\n            carousel.find('.carousel-inner').html('');\r\n            carousel.find('.carousel-indicators').html('');\r\n            \r\n            form.find('.carouselItemsWrap').find('.carouselItem').each(function () {\r\n                var carouselItem = $(this);\r\n                var txtContent = carouselItem.find('.txt-carousel-content');\r\n                var txtCaption = carouselItem.find('.txt-carousel-caption');\r\n                var img = carouselItem.find('img');\r\n                \r\n                if (txtContent.length === 0) {\r\n                    self.addItemToCarousel(component, {\r\n                        src: img.attr('src'),\r\n                        hash: img.attr('data-hash'),\r\n                        caption: txtCaption.val()\r\n                    });\r\n                } else {\r\n                    self.addItemToCarousel(component, {\r\n                        content: txtContent.val()\r\n                    });\r\n                }\r\n            });\r\n        }\r\n    }\r\n    \r\n})(jQuery);"],"sourceRoot":"/source/"}