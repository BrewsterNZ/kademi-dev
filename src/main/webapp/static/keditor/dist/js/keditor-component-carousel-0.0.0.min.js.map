{"version":3,"sources":["keditor-component-carousel-0.0.0.js"],"names":["$","KEditor","keditor","flog","log","components","init","contentArea","container","component","componentContent","children","carousel","find","id","generateId","attr","getContent","html","settingEnabled","settingTitle","initSettingForm","form","ajax","url","type","dataType","success","resp","basePath","window","location","pathname","substr","lastIndexOf","carouselAddImage","carouselImageWrap","self","this","mselect","contentTypes","bs3Modal","pagePath","onSelectFile","relUrl","hash","addImageToList","addImageToCarousel","getSettingComponent","sortable","handle","items","axis","tolerance","sort","removeClass","update","rearrangeItems","document","body","on","e","preventDefault","confirm","btn","closest","siblings","refreshCarousel","remove","comp","value","checked","showSettingForm","each","index","item","isWrap","pause","interval","val","prop","length","cls","append","src","addClass","carouselImageItem","img","jQuery"],"mappings":"CAUA,SAAWA,GACP,GAAIC,GAAUD,EAAEE,QACZC,EAAOF,EAAQG,GAEnBH,GAAQI,WAAqB,UACzBC,KAAM,SAAUC,EAAaC,EAAWC,EAAWP,GAC/CC,EAAK,4BAA6BM,EAClC,IAAIC,GAAmBD,EAAUE,SAAS,8BACtCC,EAAWF,EAAiBG,KAAK,aACjCC,EAAKZ,EAAQa,WAAW,qBAC5BH,GAASI,KAAK,KAAMF,GACpBF,EAASC,KAAK,2BAA2BG,KAAK,cAAeF,GAC7DF,EAASC,KAAK,qBAAqBG,KAAK,OAAQ,IAAMF,IAE1DG,WAAY,SAAUR,EAAWP,GAC7B,GAAIQ,GAAmBD,EAAUE,SAAS,6BAC1C,OAAOD,GAAiBQ,QAE5BC,gBAAgB,EAEhBC,aAAc,oBAEdC,gBAAiB,SAAUC,EAAMpB,GAG7B,MAFAC,GAAK,2BAA4BmB,GAE1BtB,EAAEuB,MACLC,IAAK,iDACLC,KAAM,MACNC,SAAU,OACVC,QAAS,SAAUC,GACfN,EAAKJ,KAAKU,EAEV,IAAIC,GAAWC,OAAOC,SAASC,SAASC,OAAO,EAAGH,OAAOC,SAASC,SAASE,YAAY,KAAO,GAC1FC,EAAmBb,EAAKT,KAAK,qBAC7BuB,EAAoBd,EAAKT,KAAK,sBAC9BwB,EAAOC,IAEXH,GAAiBI,SACbC,cAAe,SACfC,UAAU,EACVC,SAAUb,EACVA,SAAUA,EACVc,aAAc,SAAUnB,EAAKoB,EAAQnB,EAAMoB,GACvC1C,EAAK,mCAAoCqB,EAAKqB,GAC9CR,EAAKS,eAAexB,EAAME,EAAKqB,GAC/BR,EAAKU,mBAAmB7C,EAAQ8C,sBAAuBxB,EAAKqB,MAIpET,EAAkBa,UACdC,OAAQ,kBACRC,MAAO,uBACPC,KAAM,IACNC,UAAW,UACXC,KAAM,WACFtD,EAAEsC,MAAMiB,YAAY,qBAExBC,OAAQ,WACJnB,EAAKoB,eAAevD,EAAQ8C,sBAAsB1B,MAI1DtB,EAAE0D,SAASC,MAAMC,GAAG,QAAS,wCAAyC,SAAUC,GAG5E,GAFAA,EAAEC,iBAEEC,QAAQ,oDAAqD,CAC7D,GAAIC,GAAMhE,EAAEsC,MACRO,EAAOmB,EAAIC,QAAQ,cAAcC,SAAS,eAAelD,KAAK,YAElEqB,GAAK8B,gBAAgBjE,EAAQ8C,sBAAuBH,GACpDmB,EAAIC,QAAQ,sBAAsBG,YAI1C9C,EAAKT,KAAK,kBAAkB+C,GAAG,SAAU,SAAUC,GAC/CA,EAAEC,gBACF,IAAIO,GAAOnE,EAAQ8C,sBAAsBnC,KAAK,YAC9CwD,GAAKrD,KAAK,aAAcsB,KAAKgC,SAGjChD,EAAKT,KAAK,qBAAqB+C,GAAG,SAAU,SAAUC,GAClDA,EAAEC,gBACF,IAAIO,GAAOnE,EAAQ8C,sBAAsBnC,KAAK,YAC9CwD,GAAKrD,KAAK,gBAAiBsB,KAAKgC,SAGpChD,EAAKT,KAAK,iBAAiB+C,GAAG,QAAS,SAAUC,GAC7C,GAAIQ,GAAOnE,EAAQ8C,sBAAsBnC,KAAK,YAC1CyB,MAAKiC,QACLF,EAAKrD,KAAK,YAAa,QAEvBqD,EAAKrD,KAAK,YAAa,eAO3CwD,gBAAiB,SAAUlD,EAAMb,EAAWP,GACxC,GAAImC,GAAOC,IACXhB,GAAKT,KAAK,sBAAsBK,KAAK,IACrCT,EAAUI,KAAK,2BAA2B4D,KAAK,SAAUC,EAAOC,GAC5D,GAAInD,GAAMxB,EAAE2E,GAAM9D,KAAK,OAAOG,KAAK,OAC/B6B,EAAO7C,EAAE2E,GAAM3D,KAAK,YACxBqB,GAAKS,eAAexB,EAAME,EAAKqB,IAGnC,IAAI+B,GAASnE,EAAUI,KAAK,aAAaG,KAAK,aAC1C6D,EAAQpE,EAAUI,KAAK,aAAaG,KAAK,cACzC8D,EAAWrE,EAAUI,KAAK,aAAaG,KAAK,gBAEhDM,GAAKT,KAAK,kBAAkBkE,IAAIF,GAChCvD,EAAKT,KAAK,qBAAqBkE,IAAID,GACnCxD,EAAKT,KAAK,iBAAiBmE,KAAK,UAAsB,SAAXJ,IAG/C7B,mBAAoB,SAAUtC,EAAWe,EAAKqB,GAC1C,GAAIjC,GAAWH,EAAUI,KAAK,aAC1B6D,EAAQ9D,EAASC,KAAK,wBAAwBF,WAAWsE,OACzDC,EAAgB,IAAVR,EAAc,SAAW,EACnC9D,GAASC,KAAK,wBAAwBsE,OAAO,oBAAsBvE,EAASI,KAAK,MAAQ,oBAAsB0D,EAAQ,YAAcQ,EAAM,WAE3ItE,EAASC,KAAK,mBAAmBsE,OAC7B,mBAAqBtC,EAAO,iBAAmBqC,EAAM,kBACnC1D,EAAM,oFAMhCsB,eAAgB,SAAUxB,EAAM8D,EAAKvC,GACjCvB,EAAKT,KAAK,sBAAsBsE,OAC5B,sEACyCC,EAAM,gBAAkBvC,EAAO,wQAShFsB,gBAAiB,SAAU1D,EAAWoC,GAClCpC,EAAUI,KAAK,cAAgBgC,EAAO,KAAKuB,SACtC3D,EAAUI,KAAK,gCAAgCoE,QAChDxE,EAAUI,KAAK,qCAAqCwE,SAAS,UAEjE5E,EAAUI,KAAK,sCAAsCuD,UAGzDX,eAAgB,SAAUhD,EAAWa,GACjC,GAAIe,GAAOC,KACP1B,EAAWH,EAAUI,KAAK,YAC9BD,GAASC,KAAK,mBAAmBK,KAAK,IACtCN,EAASC,KAAK,wBAAwBK,KAAK,IAE3CI,EAAKT,KAAK,sBAAsBA,KAAK,sBAAsB4D,KAAK,WAC5D,GAAIa,GAAoBtF,EAAEsC,MACtBiD,EAAMD,EAAkBzE,KAAK,MAEjCwB,GAAKU,mBAAmBtC,EAAW8E,EAAIvE,KAAK,OAAQuE,EAAIvE,KAAK,mBAK1EwE","file":"keditor-component-carousel-0.0.0.min.js","sourcesContent":["/**\n * Created by Anh on 7/27/2016.\n */\n/**\n * KEditor Carousel Component\n * @copyright: Kademi (http://kademi.co)\n * @author: Kademi (http://kademi.co)\n * @version: @{version}\n * @dependencies: $, $.fn.draggable, $.fn.droppable, $.fn.sortable, Bootstrap, FontAwesome (optional)\n */\n(function ($) {\n    var KEditor = $.keditor;\n    var flog = KEditor.log;\n\n    KEditor.components['carousel'] = {\n        init: function (contentArea, container, component, keditor) {\n            flog('init \"carousel\" component', component);\n            var componentContent = component.children('.keditor-component-content');\n            var carousel = componentContent.find('.carousel');\n            var id = keditor.generateId('component-carousel');\n            carousel.attr('id', id);\n            carousel.find('.carousel-indicators li').attr('data-target', id);\n            carousel.find('.carousel-control').attr('href', '#' + id);\n        },\n        getContent: function (component, keditor) {\n            var componentContent = component.children('.keditor-component-content');\n            return componentContent.html();\n        },\n        settingEnabled: true,\n\n        settingTitle: 'Carousel settings',\n\n        initSettingForm: function (form, keditor) {\n            flog('init \"carousel\" settings', form);\n    \n            return $.ajax({\n                url: '/static/keditor/componentCarouselSettings.html',\n                type: 'get',\n                dataType: 'HTML',\n                success: function (resp) {\n                    form.html(resp);\n    \n                    var basePath = window.location.pathname.substr(0, window.location.pathname.lastIndexOf('/') + 1);\n                    var carouselAddImage = form.find('.carouselAddImage');\n                    var carouselImageWrap = form.find('.carouselImageWrap');\n                    var self = this;\n    \n                    carouselAddImage.mselect({\n                        contentTypes: ['image'],\n                        bs3Modal: true,\n                        pagePath: basePath,\n                        basePath: basePath,\n                        onSelectFile: function (url, relUrl, type, hash) {\n                            flog('keditor carousel selected a file', url, hash);\n                            self.addImageToList(form, url, hash);\n                            self.addImageToCarousel(keditor.getSettingComponent(), url, hash);\n                        }\n                    });\n    \n                    carouselImageWrap.sortable({\n                        handle: '.btn-sort-image',\n                        items: '> .carouselImageItem',\n                        axis: 'y',\n                        tolerance: 'pointer',\n                        sort: function () {\n                            $(this).removeClass('ui-state-default');\n                        },\n                        update: function () {\n                            self.rearrangeItems(keditor.getSettingComponent(),form);\n                        }\n                    });\n    \n                    $(document.body).on('click', '.carouselImageItem a.btn-remove-image', function (e) {\n                        e.preventDefault();\n        \n                        if (confirm('Are you sure that you want to delete this image?')) {\n                            var btn = $(this);\n                            var hash = btn.closest('.btn-group').siblings('[data-hash]').attr('data-hash');\n            \n                            self.refreshCarousel(keditor.getSettingComponent(), hash);\n                            btn.closest('.carouselImageItem').remove();\n                        }\n                    });\n    \n                    form.find('.carouselPause').on('change', function (e) {\n                        e.preventDefault();\n                        var comp = keditor.getSettingComponent().find('.carousel');\n                        comp.attr('data-pause', this.value);\n                    });\n    \n                    form.find('.carouselInterval').on('change', function (e) {\n                        e.preventDefault();\n                        var comp = keditor.getSettingComponent().find('.carousel');\n                        comp.attr('data-interval', this.value);\n                    });\n    \n                    form.find('.carouselWrap').on('click', function (e) {\n                        var comp = keditor.getSettingComponent().find('.carousel');\n                        if (this.checked) {\n                            comp.attr('data-wrap', 'true');\n                        } else {\n                            comp.attr('data-wrap', 'false');\n                        }\n                    });\n                }\n            });\n        },\n\n        showSettingForm: function (form, component, keditor) {\n            var self = this;\n            form.find('.carouselImageWrap').html('');\n            component.find('.carousel-inner > .item').each(function (index, item) {\n                var url = $(item).find('img').attr('src');\n                var hash = $(item).attr('data-hash');\n                self.addImageToList(form, url, hash);\n            });\n\n            var isWrap = component.find('.carousel').attr('data-wrap');\n            var pause = component.find('.carousel').attr('data-pause');\n            var interval = component.find('.carousel').attr('data-interval');\n\n            form.find('.carouselPause').val(pause);\n            form.find('.carouselInterval').val(interval);\n            form.find('.carouselWrap').prop('checked', isWrap === 'true');\n        },\n\n        addImageToCarousel: function (component, url, hash) {\n            var carousel = component.find('.carousel');\n            var index = carousel.find('.carousel-indicators').children().length;\n            var cls = index === 0 ? 'active' : '';\n            carousel.find('.carousel-indicators').append('<li data-target=\"' + carousel.attr('id') + '\" data-slide-to=\"' + index + '\" class=\"' + cls + '\"></li>');\n\n            carousel.find('.carousel-inner').append(\n                '<div data-hash=\"' + hash + '\" class=\"item ' + cls + '\">' +\n                '   <img src=\"' + url + '\" alt=\"\" width=\"100%\" height=\"\" />' +\n                '   <div class=\"carousel-caption\"></div>' +\n                '</div>'\n            );\n        },\n\n        addImageToList: function (form, src, hash) {\n            form.find('.carouselImageWrap').append(\n                '<div class=\"carouselImageItem\">' +\n                '   <img class=\"img-responsive\" src=\"' + src + '\" data-hash=\"' + hash + '\" />' +\n                '   <div class=\"btn-group btn-group-sm\">' +\n                '       <a class=\"btn btn-info btn-sort-image\" href=\"#\"><i class=\"fa fa-sort\"></i></a>' +\n                '       <a title=\"Delete this image\" class=\"btn btn-danger btn-remove-image\" href=\"#\"><i class=\"fa fa-trash\"></i></a>' +\n                '   </div>' +\n                '</div>'\n            );\n        },\n\n        refreshCarousel: function (component, hash) {\n            component.find('[data-hash=' + hash + ']').remove();\n            if (!component.find('.carousel-inner .item.active').length) {\n                component.find('.carousel-inner .item:first-child').addClass('active');\n            }\n            component.find('.carousel-indicators li:last-child').remove();\n        },\n\n        rearrangeItems: function (component, form) {\n            var self = this;\n            var carousel = component.find('.carousel');\n            carousel.find('.carousel-inner').html('');\n            carousel.find('.carousel-indicators').html('');\n\n            form.find('.carouselImageWrap').find('.carouselImageItem').each(function () {\n                var carouselImageItem = $(this);\n                var img = carouselImageItem.find('img');\n\n                self.addImageToCarousel(component, img.attr('src'), img.attr('data-hash'));\n            });\n        }\n    }\n\n})(jQuery);"],"sourceRoot":"/source/"}