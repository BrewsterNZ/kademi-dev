{"version":3,"sources":["keditor-component-carousel-0.0.0.js"],"names":["$","KEditor","keditor","flog","log","components","init","contentArea","container","component","componentContent","children","carousel","find","id","generateId","attr","getContent","html","settingEnabled","settingTitle","initSettingForm","form","append","basePath","window","location","pathname","substr","lastIndexOf","carouselAddImage","carouselImageWrap","self","this","mselect","contentTypes","bs3Modal","pagePath","onSelectFile","url","relUrl","type","hash","addImageToList","addImageToCarousel","getSettingComponent","sortable","handle","items","axis","tolerance","sort","removeClass","update","rearrangeItems","document","body","on","e","preventDefault","confirm","btn","closest","siblings","refreshCarousel","remove","comp","value","checked","showSettingForm","each","index","item","isWrap","pause","interval","val","prop","length","cls","src","addClass","carouselImageItem","img","jQuery"],"mappings":"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","file":"keditor-component-carousel-0.0.0.min.js","sourcesContent":["/**\r\n * Created by Anh on 7/27/2016.\r\n */\r\n/**\r\n * KEditor Carousel Component\r\n * @copyright: Kademi (http://kademi.co)\r\n * @author: Kademi (http://kademi.co)\r\n * @version: @{version}\r\n * @dependencies: $, $.fn.draggable, $.fn.droppable, $.fn.sortable, Bootstrap, FontAwesome (optional)\r\n */\r\n(function ($) {\r\n    var KEditor = $.keditor;\r\n    var flog = KEditor.log;\r\n\r\n    KEditor.components['carousel'] = {\r\n        init: function (contentArea, container, component, keditor) {\r\n            flog('init \"carousel\" component', component);\r\n            var componentContent = component.children('.keditor-component-content');\r\n            var carousel = componentContent.find('.carousel');\r\n            var id = keditor.generateId('component-carousel');\r\n            carousel.attr('id', id);\r\n            carousel.find('.carousel-indicators li').attr('data-target', id);\r\n            carousel.find('.carousel-control').attr('href', '#' + id);\r\n        },\r\n        getContent: function (component, keditor) {\r\n            var componentContent = component.children('.keditor-component-content');\r\n            return componentContent.html();\r\n        },\r\n        settingEnabled: true,\r\n\r\n        settingTitle: 'Carousel settings',\r\n\r\n        initSettingForm: function (form, keditor) {\r\n            form.append(\r\n                '<form class=\"form-horizontal\">' +\r\n                '   <div class=\"form-group\">' +\r\n                '       <div class=\"col-sm-12\">' +\r\n                '           <div class=\"carouselImageWrap\"></div>' +\r\n                '       </div>' +\r\n                '   </div>' +\r\n                '   <div class=\"form-group\">' +\r\n                '       <div class=\"col-sm-12\">' +\r\n                '           <button type=\"button\" class=\"btn btn-block btn-primary carouselAddImage\"><i class=\"fa fa-plus\"></i> Add Image</button>' +\r\n                '       </div>' +\r\n                '   </div>' +\r\n                '   <div class=\"form-group\">' +\r\n                '       <label for=\"photo-responsive\" class=\"col-sm-12\">Cycle continuously</label>' +\r\n                '       <div class=\"col-sm-12\">' +\r\n                '           <input type=\"checkbox\" class=\"carouselWrap\" />' +\r\n                '       </div>' +\r\n                '   </div>' +\r\n                '   <div class=\"form-group\">' +\r\n                '       <label for=\"photo-align\" class=\"col-sm-12\">Pause</label>' +\r\n                '       <div class=\"col-sm-12\">' +\r\n                '           <select class=\"form-control carouselPause\">' +\r\n                '               <option selected value=\"\">No</option>' +\r\n                '               <option value=\"hover\">Hover</option>' +\r\n                '           </select>' +\r\n                '       </div>' +\r\n                '   </div>' +\r\n                '   <div class=\"form-group\">' +\r\n                '       <label for=\"photo-height\" class=\"col-sm-12\">Interval</label>' +\r\n                '       <div class=\"col-sm-12\">' +\r\n                '           <input type=\"number\" class=\"form-control carouselInterval\" value=\"5000\" />' +\r\n                '       </div>' +\r\n                '   </div>' +\r\n                '</form>'\r\n            );\r\n\r\n            var basePath = window.location.pathname.substr(0, window.location.pathname.lastIndexOf('/') + 1);\r\n            var carouselAddImage = form.find('.carouselAddImage');\r\n            var carouselImageWrap = form.find('.carouselImageWrap');\r\n            var self = this;\r\n\r\n            carouselAddImage.mselect({\r\n                contentTypes: ['image'],\r\n                bs3Modal: true,\r\n                pagePath: basePath,\r\n                basePath: basePath,\r\n                onSelectFile: function (url, relUrl, type, hash) {\r\n                    flog('keditor carousel selected a file', url, hash);\r\n                    self.addImageToList(form, url, hash);\r\n                    self.addImageToCarousel(keditor.getSettingComponent(), url, hash);\r\n                }\r\n            });\r\n\r\n            carouselImageWrap.sortable({\r\n                handle: '.btn-sort-image',\r\n                items: '> .carouselImageItem',\r\n                axis: 'y',\r\n                tolerance: 'pointer',\r\n                sort: function () {\r\n                    $(this).removeClass('ui-state-default');\r\n                },\r\n                update: function () {\r\n                    self.rearrangeItems(keditor.getSettingComponent(),form);\r\n                }\r\n            });\r\n\r\n            $(document.body).on('click', '.carouselImageItem a.btn-remove-image', function (e) {\r\n                e.preventDefault();\r\n\r\n                if (confirm('Are you sure that you want to delete this image?')) {\r\n                    var btn = $(this);\r\n                    var hash = btn.closest('.btn-group').siblings('[data-hash]').attr('data-hash');\r\n\r\n                    self.refreshCarousel(keditor.getSettingComponent(), hash);\r\n                    btn.closest('.carouselImageItem').remove();\r\n                }\r\n            });\r\n\r\n            form.find('.carouselPause').on('change', function (e) {\r\n                e.preventDefault();\r\n                var comp = keditor.getSettingComponent().find('.carousel');\r\n                comp.attr('data-pause', this.value);\r\n            });\r\n\r\n            form.find('.carouselInterval').on('change', function (e) {\r\n                e.preventDefault();\r\n                var comp = keditor.getSettingComponent().find('.carousel');\r\n                comp.attr('data-interval', this.value);\r\n            });\r\n\r\n            form.find('.carouselWrap').on('click', function (e) {\r\n                var comp = keditor.getSettingComponent().find('.carousel');\r\n                if (this.checked) {\r\n                    comp.attr('data-wrap', 'true');\r\n                } else {\r\n                    comp.attr('data-wrap', 'false');\r\n                }\r\n            });\r\n        },\r\n\r\n        showSettingForm: function (form, component, keditor) {\r\n            var self = this;\r\n            form.find('.carouselImageWrap').html('');\r\n            component.find('.carousel-inner > .item').each(function (index, item) {\r\n                var url = $(item).find('img').attr('src');\r\n                var hash = $(item).attr('data-hash');\r\n                self.addImageToList(form, url, hash);\r\n            });\r\n\r\n            var isWrap = component.find('.carousel').attr('data-wrap');\r\n            var pause = component.find('.carousel').attr('data-pause');\r\n            var interval = component.find('.carousel').attr('data-interval');\r\n\r\n            form.find('.carouselPause').val(pause);\r\n            form.find('.carouselInterval').val(interval);\r\n            form.find('.carouselWrap').prop('checked', isWrap === 'true');\r\n        },\r\n\r\n        addImageToCarousel: function (component, url, hash) {\r\n            var carousel = component.find('.carousel');\r\n            var index = carousel.find('.carousel-indicators').children().length;\r\n            var cls = index === 0 ? 'active' : '';\r\n            carousel.find('.carousel-indicators').append('<li data-target=\"' + carousel.attr('id') + '\" data-slide-to=\"' + index + '\" class=\"' + cls + '\"></li>');\r\n\r\n            carousel.find('.carousel-inner').append(\r\n                '<div data-hash=\"' + hash + '\" class=\"item ' + cls + '\">' +\r\n                '   <img src=\"' + url + '\" alt=\"\" width=\"100%\" height=\"\" />' +\r\n                '   <div class=\"carousel-caption\"></div>' +\r\n                '</div>'\r\n            );\r\n        },\r\n\r\n        addImageToList: function (form, src, hash) {\r\n            form.find('.carouselImageWrap').append(\r\n                '<div class=\"carouselImageItem\">' +\r\n                '   <img class=\"img-responsive\" src=\"' + src + '\" data-hash=\"' + hash + '\" />' +\r\n                '   <div class=\"btn-group btn-group-sm\">' +\r\n                '       <a class=\"btn btn-info btn-sort-image\" href=\"#\"><i class=\"fa fa-sort\"></i></a>' +\r\n                '       <a title=\"Delete this image\" class=\"btn btn-danger btn-remove-image\" href=\"#\"><i class=\"fa fa-trash\"></i></a>' +\r\n                '   </div>' +\r\n                '</div>'\r\n            );\r\n        },\r\n\r\n        refreshCarousel: function (component, hash) {\r\n            component.find('[data-hash=' + hash + ']').remove();\r\n            if (!component.find('.carousel-inner .item.active').length) {\r\n                component.find('.carousel-inner .item:first-child').addClass('active');\r\n            }\r\n            component.find('.carousel-indicators li:last-child').remove();\r\n        },\r\n\r\n        rearrangeItems: function (component, form) {\r\n            var self = this;\r\n            var carousel = component.find('.carousel');\r\n            carousel.find('.carousel-inner').html('');\r\n            carousel.find('.carousel-indicators').html('');\r\n\r\n            form.find('.carouselImageWrap').find('.carouselImageItem').each(function () {\r\n                var carouselImageItem = $(this);\r\n                var img = carouselImageItem.find('img');\r\n\r\n                self.addImageToCarousel(component, img.attr('src'), img.attr('data-hash'));\r\n            });\r\n        }\r\n    }\r\n\r\n})(jQuery);"]}