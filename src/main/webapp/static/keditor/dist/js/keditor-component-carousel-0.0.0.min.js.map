{"version":3,"sources":["keditor-component-carousel-0.0.0.js"],"names":["$","KEditor","keditor","flog","log","components","init","contentArea","container","component","componentContent","children","carousel","find","id","generateId","attr","getContent","html","settingEnabled","settingTitle","initSettingForm","form","ajax","url","type","dataType","success","resp","basePath","window","location","pathname","substr","lastIndexOf","carouselAddImage","carouselImageWrap","self","this","mselect","contentTypes","bs3Modal","pagePath","onSelectFile","relUrl","hash","addImageToList","addImageToCarousel","getSettingComponent","sortable","handle","items","axis","tolerance","sort","removeClass","update","rearrangeItems","document","body","on","e","preventDefault","confirm","btn","closest","siblings","refreshCarousel","remove","comp","value","checked","showSettingForm","each","index","item","isWrap","pause","interval","val","prop","length","cls","append","src","addClass","carouselImageItem","img","jQuery"],"mappings":"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","file":"keditor-component-carousel-0.0.0.min.js","sourcesContent":["/**\r\n * Created by Anh on 7/27/2016.\r\n */\r\n/**\r\n * KEditor Carousel Component\r\n * @copyright: Kademi (http://kademi.co)\r\n * @author: Kademi (http://kademi.co)\r\n * @version: @{version}\r\n * @dependencies: $, $.fn.draggable, $.fn.droppable, $.fn.sortable, Bootstrap, FontAwesome (optional)\r\n */\r\n(function ($) {\r\n    var KEditor = $.keditor;\r\n    var flog = KEditor.log;\r\n\r\n    KEditor.components['carousel'] = {\r\n        init: function (contentArea, container, component, keditor) {\r\n            flog('init \"carousel\" component', component);\r\n            var componentContent = component.children('.keditor-component-content');\r\n            var carousel = componentContent.find('.carousel');\r\n            var id = keditor.generateId('component-carousel');\r\n            carousel.attr('id', id);\r\n            carousel.find('.carousel-indicators li').attr('data-target', id);\r\n            carousel.find('.carousel-control').attr('href', '#' + id);\r\n        },\r\n        getContent: function (component, keditor) {\r\n            var componentContent = component.children('.keditor-component-content');\r\n            return componentContent.html();\r\n        },\r\n        settingEnabled: true,\r\n\r\n        settingTitle: 'Carousel settings',\r\n\r\n        initSettingForm: function (form, keditor) {\r\n            flog('init \"carousel\" settings', form);\r\n    \r\n            return $.ajax({\r\n                url: '/static/keditor/componentCarouselSettings.html',\r\n                type: 'get',\r\n                dataType: 'HTML',\r\n                success: function (resp) {\r\n                    form.html(resp);\r\n    \r\n                    var basePath = window.location.pathname.substr(0, window.location.pathname.lastIndexOf('/') + 1);\r\n                    var carouselAddImage = form.find('.carouselAddImage');\r\n                    var carouselImageWrap = form.find('.carouselImageWrap');\r\n                    var self = this;\r\n    \r\n                    carouselAddImage.mselect({\r\n                        contentTypes: ['image'],\r\n                        bs3Modal: true,\r\n                        pagePath: basePath,\r\n                        basePath: basePath,\r\n                        onSelectFile: function (url, relUrl, type, hash) {\r\n                            flog('keditor carousel selected a file', url, hash);\r\n                            self.addImageToList(form, url, hash);\r\n                            self.addImageToCarousel(keditor.getSettingComponent(), url, hash);\r\n                        }\r\n                    });\r\n    \r\n                    carouselImageWrap.sortable({\r\n                        handle: '.btn-sort-image',\r\n                        items: '> .carouselImageItem',\r\n                        axis: 'y',\r\n                        tolerance: 'pointer',\r\n                        sort: function () {\r\n                            $(this).removeClass('ui-state-default');\r\n                        },\r\n                        update: function () {\r\n                            self.rearrangeItems(keditor.getSettingComponent(),form);\r\n                        }\r\n                    });\r\n    \r\n                    $(document.body).on('click', '.carouselImageItem a.btn-remove-image', function (e) {\r\n                        e.preventDefault();\r\n        \r\n                        if (confirm('Are you sure that you want to delete this image?')) {\r\n                            var btn = $(this);\r\n                            var hash = btn.closest('.btn-group').siblings('[data-hash]').attr('data-hash');\r\n            \r\n                            self.refreshCarousel(keditor.getSettingComponent(), hash);\r\n                            btn.closest('.carouselImageItem').remove();\r\n                        }\r\n                    });\r\n    \r\n                    form.find('.carouselPause').on('change', function (e) {\r\n                        e.preventDefault();\r\n                        var comp = keditor.getSettingComponent().find('.carousel');\r\n                        comp.attr('data-pause', this.value);\r\n                    });\r\n    \r\n                    form.find('.carouselInterval').on('change', function (e) {\r\n                        e.preventDefault();\r\n                        var comp = keditor.getSettingComponent().find('.carousel');\r\n                        comp.attr('data-interval', this.value);\r\n                    });\r\n    \r\n                    form.find('.carouselWrap').on('click', function (e) {\r\n                        var comp = keditor.getSettingComponent().find('.carousel');\r\n                        if (this.checked) {\r\n                            comp.attr('data-wrap', 'true');\r\n                        } else {\r\n                            comp.attr('data-wrap', 'false');\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n        },\r\n\r\n        showSettingForm: function (form, component, keditor) {\r\n            var self = this;\r\n            form.find('.carouselImageWrap').html('');\r\n            component.find('.carousel-inner > .item').each(function (index, item) {\r\n                var url = $(item).find('img').attr('src');\r\n                var hash = $(item).attr('data-hash');\r\n                self.addImageToList(form, url, hash);\r\n            });\r\n\r\n            var isWrap = component.find('.carousel').attr('data-wrap');\r\n            var pause = component.find('.carousel').attr('data-pause');\r\n            var interval = component.find('.carousel').attr('data-interval');\r\n\r\n            form.find('.carouselPause').val(pause);\r\n            form.find('.carouselInterval').val(interval);\r\n            form.find('.carouselWrap').prop('checked', isWrap === 'true');\r\n        },\r\n\r\n        addImageToCarousel: function (component, url, hash) {\r\n            var carousel = component.find('.carousel');\r\n            var index = carousel.find('.carousel-indicators').children().length;\r\n            var cls = index === 0 ? 'active' : '';\r\n            carousel.find('.carousel-indicators').append('<li data-target=\"' + carousel.attr('id') + '\" data-slide-to=\"' + index + '\" class=\"' + cls + '\"></li>');\r\n\r\n            carousel.find('.carousel-inner').append(\r\n                '<div data-hash=\"' + hash + '\" class=\"item ' + cls + '\">' +\r\n                '   <img src=\"' + url + '\" alt=\"\" width=\"100%\" height=\"\" />' +\r\n                '   <div class=\"carousel-caption\"></div>' +\r\n                '</div>'\r\n            );\r\n        },\r\n\r\n        addImageToList: function (form, src, hash) {\r\n            form.find('.carouselImageWrap').append(\r\n                '<div class=\"carouselImageItem\">' +\r\n                '   <img class=\"img-responsive\" src=\"' + src + '\" data-hash=\"' + hash + '\" />' +\r\n                '   <div class=\"btn-group btn-group-sm\">' +\r\n                '       <a class=\"btn btn-info btn-sort-image\" href=\"#\"><i class=\"fa fa-sort\"></i></a>' +\r\n                '       <a title=\"Delete this image\" class=\"btn btn-danger btn-remove-image\" href=\"#\"><i class=\"fa fa-trash\"></i></a>' +\r\n                '   </div>' +\r\n                '</div>'\r\n            );\r\n        },\r\n\r\n        refreshCarousel: function (component, hash) {\r\n            component.find('[data-hash=' + hash + ']').remove();\r\n            if (!component.find('.carousel-inner .item.active').length) {\r\n                component.find('.carousel-inner .item:first-child').addClass('active');\r\n            }\r\n            component.find('.carousel-indicators li:last-child').remove();\r\n        },\r\n\r\n        rearrangeItems: function (component, form) {\r\n            var self = this;\r\n            var carousel = component.find('.carousel');\r\n            carousel.find('.carousel-inner').html('');\r\n            carousel.find('.carousel-indicators').html('');\r\n\r\n            form.find('.carouselImageWrap').find('.carouselImageItem').each(function () {\r\n                var carouselImageItem = $(this);\r\n                var img = carouselImageItem.find('img');\r\n\r\n                self.addImageToCarousel(component, img.attr('src'), img.attr('data-hash'));\r\n            });\r\n        }\r\n    }\r\n\r\n})(jQuery);"],"sourceRoot":"/source/"}