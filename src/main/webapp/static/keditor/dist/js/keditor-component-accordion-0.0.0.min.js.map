{"version":3,"sources":["keditor-component-accordion-0.0.0.js"],"names":["$","KEditor","keditor","flog","log","components","settingEnabled","settingTitle","init","contentArea","container","component","options","id","generateId","componentContent","children","find","attr","panels","each","index","item","p","itemId","panelCollapseId","title","html","indexOf","collapse","removeClass","prop","on","e","onComponentChanged","call","onContainerChanged","onContentChanged","editor","ckeditor","ckeditorOptions","onComponentReady","document","off","preventDefault","confirm","panelsCount","length","this","parents","remove","Msg","error","clone","first","append","getContent","h","parent","replaceWith","panelTitle","panelCollapse","addClass","removeAttr","css","text","destroy","CKEDITOR","instances","initSettingForm","form","ajax","url","type","dataType","success","resp","comp","getSettingComponent","checked","old","value","getStyleOnce","getScriptOnce","iconpicker","iconset","cols","rows","placement","icon","className","showSettingForm","dataAttributes","getDataAttributes","val","iconCollapsed","end","iconExpanded","jQuery"],"mappings":"CAcA,SAAWA,GACP,GAAIC,GAAUD,EAAEE,QACZC,EAAOF,EAAQG,GAEnBH,GAAQI,WAAsB,WAC1BC,gBAAgB,EAChBC,aAAc,qBAEdC,KAAM,SAAUC,EAAaC,EAAWC,EAAWT,GAC/C,GAAIU,GAAUV,EAAQU,QAClBC,EAAKX,EAAQY,WAAW,aACxBC,EAAmBJ,EAAUK,SAAS,6BAC1CD,GAAiBE,KAAK,+BAA+BC,KAAK,KAAML,GAChEE,EAAiBE,KAAK,iCAAiCC,KAAK,cAAe,IAAML,EAGjF,IAAIM,GAASJ,EAAiBE,KAAK,SACnCE,GAAOC,KAAK,SAAUC,EAAOC,GACzB,GAAIC,GAAIvB,EAAEsB,GACNE,EAAStB,EAAQY,WAAW,UAAYO,GACxCI,EAAkBvB,EAAQY,WAAW,WAAaO,EACtDE,GAAEN,KAAK,kBAAkBC,KAAK,KAAMM,GACpCD,EAAEN,KAAK,mBAAmBC,KAAK,kBAAmBM,GAAQN,KAAK,KAAMO,EACrE,IAAIC,GAAQH,EAAEN,KAAK,kBAAkBU,MACrCJ,GAAEN,KAAK,kBAAkBC,KAAK,OAAQ,IAAMO,GAAiBP,KAAK,gBAAiB,IAAMO,GACrFC,EAAME,QAAQ,eACdL,EAAEN,KAAK,kBAAkBU,KAAK,QAAUD,EAAQ,YAIxDX,EAAiBE,KAAK,kCAAkCY,SAAS,QACjEd,EAAiBE,KAAK,uCAAuCa,YAAY,QACzEf,EAAiBE,KAAK,kCAAkCc,KAAK,mBAAmB,GAChFhB,EAAiBE,KAAK,+BAA+Bc,KAAK,mBAAmB,GAE7EhB,EAAiBE,KAAK,+DAA+De,GAAG,QAAS,SAAUC,GAC7D,kBAA/BrB,GAAQsB,oBACftB,EAAQsB,mBAAmBC,KAAK1B,EAAawB,EAAGtB,GAGV,kBAA/BC,GAAQwB,oBACfxB,EAAQwB,mBAAmBD,KAAK1B,EAAawB,EAAGvB,GAGZ,kBAA7BE,GAAQyB,kBAKvB,IAAIC,GAASvB,EAAiBE,KAAK,+DAA+DsB,SAAS3B,EAAQ4B,iBAAiBF,MACpIA,GAAON,GAAG,gBAAiB,WACvB7B,EAAK,oBAAqBQ,GAEc,kBAA7BC,GAAQ6B,kBACf7B,EAAQ6B,iBAAiBN,KAAK1B,EAAaE,EAAW2B,KAI9DtC,EAAE0C,UAAUC,IAAI,QAAS,2BAA2BX,GAAG,QAAS,0BAA2B,SAAUC,GAGjG,GAFAA,EAAEW,iBAEEC,QAAQ,8CAA+C,CACvD,GAAIC,GAAc/B,EAAiBE,KAAK,UAAU8B,MAC9CD,GAAc,EACd9C,EAAEgD,MAAMC,QAAQ,UAAUC,SAE1BC,IAAIC,MAAM,oCAKtBpD,EAAE0C,UAAUC,IAAI,QAAS,wBAAwBX,GAAG,QAAS,uBAAwB,SAAUC,GAC3FA,EAAEW,gBACF,IAAIS,GAAQtC,EAAiBE,KAAK,UAAUqC,QAAQD,QAChD7B,EAAStB,EAAQY,WAAW,WAC5BW,EAAkBvB,EAAQY,WAAW,WACzCuC,GAAMpC,KAAK,kBAAkBC,KAAK,KAAMM,GACxC6B,EAAMpC,KAAK,mBAAmBC,KAAK,kBAAmBM,GAAQN,KAAK,KAAMO,GACzE4B,EAAMpC,KAAK,kBAAkBC,KAAK,OAAQ,IAAMO,GAChDV,EAAiBE,KAAK,+BAA+BsC,OAAOF,EAC5D,IAAIf,GAASe,EAAMpC,KAAK,mDAAmDsB,SAAS3B,EAAQ4B,iBAAiBF,MAC7GA,GAAON,GAAG,gBAAiB,WACvB7B,EAAK,oBAAqBQ,GAEc,kBAA7BC,GAAQ6B,kBACf7B,EAAQ6B,iBAAiBN,KAAK1B,EAAaE,EAAW2B,QAMtEkB,WAAY,SAAU7C,EAAWT,GAC7B,GAAIa,GAAmBJ,EAAUK,SAAS,6BAsB1C,OArBAD,GAAiBE,KAAK,sBAAsBG,KAAK,WAC7C,GAAIqC,GAAIzD,EAAEgD,MAAMrB,MAChB3B,GAAEgD,MAAMU,OAAO,KAAK/B,KAAK8B,KAE7B1C,EAAiBE,KAAK,+BAA+BG,KAAK,WACtD,GAAIqC,GAAIzD,EAAEgD,MAAMrB,MAChB3B,GAAEgD,MAAMW,YAAY,2BAA6BF,EAAI,YAET,QAA5C9C,EAAUO,KAAK,2BACfH,EAAiBE,KAAK,UAAUG,KAAK,WACjC,GAAIwC,GAAa5D,EAAEgD,MAAM/B,KAAK,oBAC1B4C,EAAgB7D,EAAEgD,MAAM/B,KAAK,kBACjC4C,GAAcC,SAAS,YAAY5C,KAAK,gBAAiB,SAASY,YAAY,MAC9E8B,EAAWE,SAAS,aAAa5C,KAAK,gBAAiB,WAG/DH,EAAiBE,KAAK,uCAAuC6C,SAAS,QACtE/C,EAAiBE,KAAK,qBAAqB8C,WAAW,mBACtDhD,EAAiBE,KAAK,mBAAmBG,KAAK,WAC3CpB,EAAEgD,MAAMgB,IAAI,UAAW,QAAQC,KAAKjE,EAAEgD,MAAMiB,UAExClD,EAAiBY,QAG5BuC,QAAS,SAAUvD,EAAWT,GAC1BC,EAAK,2BAA4BQ,EAEjC,IAAIE,GAAKF,EAAUM,KAAK,8BAA8BC,KAAK,MACvDoB,EAAS6B,SAASC,UAAUvD,EAC5ByB,IACAA,EAAO4B,WAGfG,gBAAiB,SAAUC,EAAMpE,GAG7B,MAFAC,GAAK,4BAA6BmE,GAE3BtE,EAAEuE,MACLC,IAAK,kDACLC,KAAM,MACNC,SAAU,OACVC,QAAS,SAAUC,GACfN,EAAK3C,KAAKiD,GAEVN,EAAKrD,KAAK,iBAAiBe,GAAG,QAAS,WACnC,GAAI6C,GAAO3E,EAAQ4E,qBACnBD,GAAK3D,KAAK,yBAA0B8B,KAAK+B,WAG7CT,EAAKrD,KAAK,eAAee,GAAG,SAAU,SAAUC,GAC5C,GAAI4C,GAAO3E,EAAQ4E,sBACfE,EAAMH,EAAK3D,KAAK,qBAAuB,eAC3C2D,GAAK3D,KAAK,mBAAoB8B,KAAKiC,OACnCJ,EAAK5D,KAAK,UAAUa,YAAYkD,GAAKlB,SAASd,KAAKiC,SAGvDjF,EAAEkF,aAAa,uEACflF,EAAEmF,cAAc,iFAAkF,WAC9FnF,EAAEmF,cAAc,oEAAqE,WACjFb,EAAKrD,KAAK,2CAA2CmE,YACjDC,QAAS,cACTC,KAAM,GACNC,KAAM,EACNC,UAAW,SAGflB,EAAKrD,KAAK,uBAAuBe,GAAG,SAAU,SAAUC,GACpD,GAAItB,GAAYT,EAAQ4E,qBACxBnE,GAAUO,KAAK,sBAAuBe,EAAEwD,MACxC9E,EAAUM,KAAK,uBAAuBG,KAAK,WACvC4B,KAAK0C,UAAY,yBAA0BzD,EAAEwD,SAIrDnB,EAAKrD,KAAK,sBAAsBe,GAAG,SAAU,SAAUC,GACnD,GAAItB,GAAYT,EAAQ4E,qBACxBnE,GAAUO,KAAK,qBAAsBe,EAAEwD,MACvC9E,EAAUM,KAAK,sBAAsBG,KAAK,WACtC4B,KAAK0C,UAAY,wBAAyBzD,EAAEwD,iBAUxEE,gBAAiB,SAAUrB,EAAM3D,EAAWT,GACxCC,EAAK,wCACL,IAAIyF,GAAiB1F,EAAQ2F,kBAAkBlF,GAAY,cAAc,EAEzE2D,GAAKrD,KAAK,iBAAiBc,KAAK,UAAuD,QAA5CpB,EAAUO,KAAK,2BAC1DoD,EAAKrD,KAAK,eAAe6E,IAAInF,EAAUO,KAAK,qBAE5ClB,EAAEmF,cAAc,iFAAkF,WAC9FnF,EAAEmF,cAAc,oEAAqE,WACjF,GAAIY,GAAgBH,EAAe,wBAA0B,aAC7DtB,GAAKrD,KAAK,uBAAuBA,KAAK,KAAKC,KAAK,QAAS,MAAQ6E,GAAeC,MAAM/E,KAAK,SAAS6E,IAAIC,EACxG,IAAIE,GAAeL,EAAe,uBAAyB,eAC3DtB,GAAKrD,KAAK,sBAAsBA,KAAK,KAAKC,KAAK,QAAS,MAAQ+E,GAAcD,MAAM/E,KAAK,SAAS6E,IAAIG,UAKvHC","file":"keditor-component-accordion-0.0.0.min.js","sourcesContent":["/**!\r\n * KEditor - Kademi content editor\r\n * @copyright: Kademi (http://kademi.co)\r\n * @author: Kademi (http://kademi.co)\r\n * @version: 0.0.0\r\n * @dependencies: $, $.fn.draggable, $.fn.droppable, $.fn.sortable, Bootstrap (optional), FontAwesome (optional)\r\n */\r\n/**\r\n * KEditor accordion Component\r\n * @copyright: Kademi (http://kademi.co)\r\n * @author: Kademi (http://kademi.co)\r\n * @version: @{version}\r\n * @dependencies: $, $.fn.draggable, $.fn.droppable, $.fn.sortable, Bootstrap, FontAwesome (optional)\r\n */\r\n(function ($) {\r\n    var KEditor = $.keditor;\r\n    var flog = KEditor.log;\r\n\r\n    KEditor.components['accordion'] = {\r\n        settingEnabled: true,\r\n        settingTitle: 'Accordion Settings',\r\n\r\n        init: function (contentArea, container, component, keditor) {\r\n            var options = keditor.options;\r\n            var id = keditor.generateId('accordion');\r\n            var componentContent = component.children('.keditor-component-content');\r\n            componentContent.find('.accordionWrap .panel-group').attr('id', id);\r\n            componentContent.find('.accordionWrap a[data-toggle]').attr('data-parent', '#' + id);\r\n\r\n\r\n            var panels = componentContent.find('.panel');\r\n            panels.each(function (index, item) {\r\n                var p = $(item);\r\n                var itemId = keditor.generateId('heading' + index);\r\n                var panelCollapseId = keditor.generateId('collapse' + index);\r\n                p.find('.panel-heading').attr('id', itemId);\r\n                p.find('.panel-collapse').attr('aria-labelledby', itemId).attr('id', panelCollapseId);\r\n                var title = p.find('a[data-toggle]').html();\r\n                p.find('a[data-toggle]').attr('href', '#' + panelCollapseId).attr('aria-controls', '#' + panelCollapseId);\r\n                if (title.indexOf('<div>') === -1) {\r\n                    p.find('a[data-toggle]').html('<div>' + title + '</div>');\r\n                }\r\n            });\r\n\r\n            componentContent.find('.accordionWrap .panel-collapse').collapse('show');\r\n            componentContent.find('.panel-footer, .btnAddAccordionItem').removeClass('hide');\r\n            componentContent.find('.panel-title a .accHeadingText').prop('contenteditable', true);\r\n            componentContent.find('.panel-collapse .panel-body').prop('contenteditable', true);\r\n\r\n            componentContent.find('.panel-title a .accHeadingText, .panel-collapse .panel-body').on('input', function (e) {\r\n                if (typeof options.onComponentChanged === 'function') {\r\n                    options.onComponentChanged.call(contentArea, e, component);\r\n                }\r\n\r\n                if (typeof options.onContainerChanged === 'function') {\r\n                    options.onContainerChanged.call(contentArea, e, container);\r\n                }\r\n\r\n                if (typeof options.onContentChanged === 'function') {\r\n                    // options.onContentChanged.call(contentArea, e);\r\n                }\r\n            });\r\n\r\n            var editor = componentContent.find('.panel-title a .accHeadingText, .panel-collapse .panel-body').ckeditor(options.ckeditorOptions).editor;\r\n            editor.on('instanceReady', function () {\r\n                flog('CKEditor is ready', component);\r\n\r\n                if (typeof options.onComponentReady === 'function') {\r\n                    options.onComponentReady.call(contentArea, component, editor);\r\n                }\r\n            });\r\n\r\n            $(document).off('click', '.btnDeleteAccordionItem').on('click', '.btnDeleteAccordionItem', function (e) {\r\n                e.preventDefault();\r\n\r\n                if (confirm('Are you sure you want to delete this item?')) {\r\n                    var panelsCount = componentContent.find('.panel').length;\r\n                    if (panelsCount > 1) {\r\n                        $(this).parents('.panel').remove();\r\n                    } else {\r\n                        Msg.error('You cant delete the last item');\r\n                    }\r\n                }\r\n            });\r\n\r\n            $(document).off('click', '.btnAddAccordionItem').on('click', '.btnAddAccordionItem', function (e) {\r\n                e.preventDefault();\r\n                var clone = componentContent.find('.panel').first().clone();\r\n                var itemId = keditor.generateId('heading');\r\n                var panelCollapseId = keditor.generateId('collapse');\r\n                clone.find('.panel-heading').attr('id', itemId);\r\n                clone.find('.panel-collapse').attr('aria-labelledby', itemId).attr('id', panelCollapseId);\r\n                clone.find('a[data-toggle]').attr('href', '#' + panelCollapseId);\r\n                componentContent.find('.accordionWrap .panel-group').append(clone);\r\n                var editor = clone.find('.panel-title a div, .panel-collapse .panel-body').ckeditor(options.ckeditorOptions).editor;\r\n                editor.on('instanceReady', function () {\r\n                    flog('CKEditor is ready', component);\r\n\r\n                    if (typeof options.onComponentReady === 'function') {\r\n                        options.onComponentReady.call(contentArea, component, editor);\r\n                    }\r\n                });\r\n            });\r\n        },\r\n\r\n        getContent: function (component, keditor) {\r\n            var componentContent = component.children('.keditor-component-content');\r\n            componentContent.find('.panel-title a div').each(function () {\r\n                var h = $(this).html();\r\n                $(this).parent('a').html(h);\r\n            });\r\n            componentContent.find('.panel-collapse .panel-body').each(function () {\r\n                var h = $(this).html();\r\n                $(this).replaceWith('<div class=\"panel-body\">' + h + '</div>');\r\n            });\r\n            if (component.attr('data-initial-collapsed') == 'true'){\r\n                componentContent.find('.panel').each(function () {\r\n                    var panelTitle = $(this).find('.panel-heading a');\r\n                    var panelCollapse = $(this).find('.panel-collapse');\r\n                    panelCollapse.addClass('collapse').attr('aria-expanded', 'false').removeClass('in');\r\n                    panelTitle.addClass('collapsed').attr('aria-expanded', 'false');\r\n                });\r\n            }\r\n            componentContent.find('.panel-footer, .btnAddAccordionItem').addClass('hide');\r\n            componentContent.find('[contenteditable]').removeAttr('contenteditable');\r\n            componentContent.find('.accHeadingText').each(function () {\r\n               $(this).css('outline', 'none').text($(this).text());\r\n            });\r\n            return componentContent.html();\r\n        },\r\n\r\n        destroy: function (component, keditor) {\r\n            flog('destroy \"text\" component', component);\r\n\r\n            var id = component.find('.keditor-component-content').attr('id');\r\n            var editor = CKEDITOR.instances[id];\r\n            if (editor) {\r\n                editor.destroy();\r\n            }\r\n        },\r\n        initSettingForm: function (form, keditor) {\r\n            flog('init \"accordion\" settings', form);\r\n\r\n            return $.ajax({\r\n                url: '/static/keditor/componentAccordionSettings.html',\r\n                type: 'get',\r\n                dataType: 'HTML',\r\n                success: function (resp) {\r\n                    form.html(resp);\r\n\r\n                    form.find('.collapsedAll').on('click', function () {\r\n                        var comp = keditor.getSettingComponent();\r\n                        comp.attr('data-initial-collapsed', this.checked);\r\n                    });\r\n\r\n                    form.find('.panelStyle').on('change', function (e) {\r\n                        var comp = keditor.getSettingComponent();\r\n                        var old = comp.attr('data-panel-style') || 'panel-default';\r\n                        comp.attr('data-panel-style', this.value);\r\n                        comp.find('.panel').removeClass(old).addClass(this.value);\r\n                    });\r\n                    \r\n                    $.getStyleOnce('/static/bootstrap-iconpicker/1.7.0/css/bootstrap-iconpicker.min.css');\r\n                    $.getScriptOnce('/static/bootstrap-iconpicker/1.7.0/js/iconset/iconset-fontawesome-4.2.0.min.js', function () {\r\n                        $.getScriptOnce('/static/bootstrap-iconpicker/1.7.0/js/bootstrap-iconpicker.min.js', function () {\r\n                            form.find('.btn-collapsed-icon, .btn-expanded-icon').iconpicker({\r\n                                iconset: 'fontawesome',\r\n                                cols: 10,\r\n                                rows: 4,\r\n                                placement: 'left'\r\n                            });\r\n                            \r\n                            form.find('.btn-collapsed-icon').on('change', function (e) {\r\n                                var component = keditor.getSettingComponent();\r\n                                component.attr('data-collapsed-icon', e.icon);\r\n                                component.find('.panelIconCollapsed').each(function () {\r\n                                    this.className = \"panelIconCollapsed fa \"+ e.icon;\r\n                                })\r\n                            });\r\n                            \r\n                            form.find('.btn-expanded-icon').on('change', function (e) {\r\n                                var component = keditor.getSettingComponent();\r\n                                component.attr('data-expanded-icon', e.icon);\r\n                                component.find('.panelIconExpanded').each(function () {\r\n                                    this.className = \"panelIconExpanded fa \"+ e.icon;\r\n                                })\r\n                            });\r\n                        });\r\n                    });\r\n                            \r\n                }\r\n            });\r\n        },\r\n\r\n        showSettingForm: function (form, component, keditor) {\r\n            flog('showSettingForm \"Accordion\" component');\r\n            var dataAttributes = keditor.getDataAttributes(component, ['data-type'], false);\r\n            \r\n            form.find('.collapsedAll').prop('checked', component.attr('data-initial-collapsed') == 'true');\r\n            form.find('.panelStyle').val(component.attr('data-panel-style'));\r\n            \r\n            $.getScriptOnce('/static/bootstrap-iconpicker/1.7.0/js/iconset/iconset-fontawesome-4.2.0.min.js', function () {\r\n                $.getScriptOnce('/static/bootstrap-iconpicker/1.7.0/js/bootstrap-iconpicker.min.js', function () {\r\n                    var iconCollapsed = dataAttributes['data-collapsed-icon'] || 'fa-caret-up';\r\n                    form.find('.btn-collapsed-icon').find('i').attr('class', 'fa ' + iconCollapsed).end().find('input').val(iconCollapsed);\r\n                    var iconExpanded = dataAttributes['data-expanded-icon'] || 'fa-caret-down';\r\n                    form.find('.btn-expanded-icon').find('i').attr('class', 'fa ' + iconExpanded).end().find('input').val(iconExpanded);\r\n                });\r\n            });\r\n        }\r\n    };\r\n})(jQuery);\r\n\r\n"]}