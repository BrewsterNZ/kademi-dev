{"version":3,"sources":["keditor-component-accordion-0.0.0.js"],"names":["$","KEditor","keditor","flog","log","components","settingEnabled","settingTitle","init","contentArea","container","component","options","id","generateId","componentContent","children","find","attr","panels","each","index","item","p","itemId","panelCollapseId","title","html","indexOf","collapse","removeClass","prop","on","e","onComponentChanged","call","onContainerChanged","onContentChanged","editor","ckeditor","ckeditorOptions","onComponentReady","document","off","preventDefault","confirm","panelsCount","length","this","parents","remove","Msg","error","clone","first","append","getContent","h","parent","replaceWith","panelTitle","panelCollapse","addClass","destroy","CKEDITOR","instances","initSettingForm","form","ajax","url","type","dataType","success","resp","comp","getSettingComponent","checked","old","value","showSettingForm","val","jQuery"],"mappings":"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","file":"keditor-component-accordion-0.0.0.min.js","sourcesContent":["/**\n * KEditor accordion Component\n * @copyright: Kademi (http://kademi.co)\n * @author: Kademi (http://kademi.co)\n * @version: @{version}\n * @dependencies: $, $.fn.draggable, $.fn.droppable, $.fn.sortable, Bootstrap, FontAwesome (optional)\n */\n(function ($) {\n    var KEditor = $.keditor;\n    var flog = KEditor.log;\n\n    KEditor.components['accordion'] = {\n        settingEnabled: true,\n        settingTitle: 'Accordion Settings',\n\n        init: function (contentArea, container, component, keditor) {\n            var options = keditor.options;\n            var id = keditor.generateId('accordion');\n            var componentContent = component.children('.keditor-component-content');\n            componentContent.find('.accordionWrap .panel-group').attr('id', id);\n            componentContent.find('.accordionWrap a[data-toggle]').attr('data-parent', '#' + id);\n\n\n            var panels = componentContent.find('.panel');\n            panels.each(function (index, item) {\n                var p = $(item);\n                var itemId = keditor.generateId('heading' + index);\n                var panelCollapseId = keditor.generateId('collapse' + index);\n                p.find('.panel-heading').attr('id', itemId);\n                p.find('.panel-collapse').attr('aria-labelledby', itemId).attr('id', panelCollapseId);\n                var title = p.find('a[data-toggle]').html();\n                p.find('a[data-toggle]').attr('href', '#' + panelCollapseId).attr('aria-controls', '#' + panelCollapseId);\n                if (title.indexOf('<div>') === -1) {\n                    p.find('a[data-toggle]').html('<div>' + title + '</div>');\n                }\n            });\n\n            componentContent.find('.accordionWrap .panel-collapse').collapse('show');\n            componentContent.find('.panel-footer, .btnAddAccordionItem').removeClass('hide');\n            componentContent.find('.panel-title a div').prop('contenteditable', true);\n            componentContent.find('.panel-collapse .panel-body').prop('contenteditable', true);\n\n            componentContent.find('.panel-title a div, .panel-collapse .panel-body').on('input', function (e) {\n                if (typeof options.onComponentChanged === 'function') {\n                    options.onComponentChanged.call(contentArea, e, component);\n                }\n\n                if (typeof options.onContainerChanged === 'function') {\n                    options.onContainerChanged.call(contentArea, e, container);\n                }\n\n                if (typeof options.onContentChanged === 'function') {\n                    options.onContentChanged.call(contentArea, e);\n                }\n            });\n\n            var editor = componentContent.find('.panel-title a div, .panel-collapse .panel-body').ckeditor(options.ckeditorOptions).editor;\n            editor.on('instanceReady', function () {\n                flog('CKEditor is ready', component);\n\n                if (typeof options.onComponentReady === 'function') {\n                    options.onComponentReady.call(contentArea, component, editor);\n                }\n            });\n\n            $(document).off('click', '.btnDeleteAccordionItem').on('click', '.btnDeleteAccordionItem', function (e) {\n                e.preventDefault();\n\n                if (confirm('Are you sure you want to delete this item?')) {\n                    var panelsCount = componentContent.find('.panel').length;\n                    if (panelsCount > 1) {\n                        $(this).parents('.panel').remove();\n                    } else {\n                        Msg.error('You cant delete the last item');\n                    }\n                }\n            });\n\n            $(document).off('click', '.btnAddAccordionItem').on('click', '.btnAddAccordionItem', function (e) {\n                e.preventDefault();\n                var clone = componentContent.find('.panel').first().clone();\n                var itemId = keditor.generateId('heading');\n                var panelCollapseId = keditor.generateId('collapse');\n                clone.find('.panel-heading').attr('id', itemId);\n                clone.find('.panel-collapse').attr('aria-labelledby', itemId).attr('id', panelCollapseId);\n                clone.find('a[data-toggle]').attr('href', '#' + panelCollapseId);\n                componentContent.find('.accordionWrap .panel-group').append(clone);\n                var editor = clone.find('.panel-title a div, .panel-collapse .panel-body').ckeditor(options.ckeditorOptions).editor;\n                editor.on('instanceReady', function () {\n                    flog('CKEditor is ready', component);\n\n                    if (typeof options.onComponentReady === 'function') {\n                        options.onComponentReady.call(contentArea, component, editor);\n                    }\n                });\n            });\n        },\n\n        getContent: function (component, keditor) {\n            var componentContent = component.children('.keditor-component-content');\n            componentContent.find('.panel-title a div').each(function () {\n                var h = $(this).html();\n                $(this).parent('a').html(h);\n            });\n            componentContent.find('.panel-collapse .panel-body').each(function () {\n                var h = $(this).html();\n                $(this).replaceWith('<div class=\"panel-body\">' + h + '</div>');\n            });\n            if (component.attr('data-initial-collapsed') == 'true'){\n                componentContent.find('.panel').each(function () {\n                    var panelTitle = $(this).find('.panel-heading a');\n                    var panelCollapse = $(this).find('.panel-collapse');\n                    panelCollapse.addClass('collapse').attr('aria-expanded', 'false').removeClass('in');\n                    panelTitle.addClass('collapsed').attr('aria-expanded', 'false');\n                });\n            }\n            componentContent.find('.panel-footer, .btnAddAccordionItem').addClass('hide');\n\n            return componentContent.html();\n        },\n\n        destroy: function (component, keditor) {\n            flog('destroy \"text\" component', component);\n\n            var id = component.find('.keditor-component-content').attr('id');\n            var editor = CKEDITOR.instances[id];\n            if (editor) {\n                editor.destroy();\n            }\n        },\n        initSettingForm: function (form, keditor) {\n            flog('init \"accordion\" settings', form);\n\n            return $.ajax({\n                url: '/static/keditor/componentAccordionSettings.html',\n                type: 'get',\n                dataType: 'HTML',\n                success: function (resp) {\n                    form.html(resp);\n\n                    form.find('.collapsedAll').on('click', function () {\n                        var comp = keditor.getSettingComponent();\n                        comp.attr('data-initial-collapsed', this.checked);\n                    });\n\n                    form.find('.panelStyle').on('change', function (e) {\n                        var comp = keditor.getSettingComponent();\n                        var old = comp.attr('data-panel-style') || 'panel-default';\n                        comp.attr('data-panel-style', this.value);\n                        comp.find('.panel').removeClass(old).addClass(this.value);\n                    });\n                }\n            });\n        },\n\n        showSettingForm: function (form, component, keditor) {\n            form.find('.collapsedAll').prop('checked', component.attr('data-initial-collapsed') == 'true');\n            form.find('.panelStyle').val(component.attr('data-panel-style'));\n        }\n    };\n})(jQuery);\n\n"]}