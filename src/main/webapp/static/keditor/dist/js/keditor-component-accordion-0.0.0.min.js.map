{"version":3,"sources":["keditor-component-accordion-0.0.0.js"],"names":["$","KEditor","keditor","flog","log","components","settingEnabled","settingTitle","init","contentArea","container","component","options","id","generateId","componentContent","children","find","attr","panels","each","index","item","p","itemId","panelCollapseId","collapse","removeClass","prop","on","e","onComponentChanged","call","onContainerChanged","onContentChanged","editor","ckeditor","ckeditorOptions","onComponentReady","document","off","preventDefault","confirm","panelsCount","length","this","parents","remove","Msg","error","clone","first","append","getContent","h","html","replaceWith","panelTitle","panelCollapse","addClass","removeAttr","css","text","destroy","CKEDITOR","instances","initSettingForm","form","ajax","url","type","dataType","success","resp","comp","getSettingComponent","checked","old","value","getStyleOnce","getScriptOnce","iconpicker","iconset","cols","rows","placement","icon","className","showSettingForm","dataAttributes","getDataAttributes","val","iconCollapsed","end","iconExpanded","jQuery"],"mappings":"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","file":"keditor-component-accordion-0.0.0.min.js","sourcesContent":["/**!\r\n * KEditor - Kademi content editor\r\n * @copyright: Kademi (http://kademi.co)\r\n * @author: Kademi (http://kademi.co)\r\n * @version: 0.0.0\r\n * @dependencies: $, $.fn.draggable, $.fn.droppable, $.fn.sortable, Bootstrap (optional), FontAwesome (optional)\r\n */\r\n/**\r\n * KEditor accordion Component\r\n * @copyright: Kademi (http://kademi.co)\r\n * @author: Kademi (http://kademi.co)\r\n * @version: @{version}\r\n * @dependencies: $, $.fn.draggable, $.fn.droppable, $.fn.sortable, Bootstrap, FontAwesome (optional)\r\n */\r\n(function ($) {\r\n    var KEditor = $.keditor;\r\n    var flog = KEditor.log;\r\n\r\n    KEditor.components['accordion'] = {\r\n        settingEnabled: true,\r\n        settingTitle: 'Accordion Settings',\r\n\r\n        init: function (contentArea, container, component, keditor) {\r\n            var options = keditor.options;\r\n            var id = keditor.generateId('accordion');\r\n            var componentContent = component.children('.keditor-component-content');\r\n            componentContent.find('.accordionWrap .panel-group').attr('id', id);\r\n            componentContent.find('.accordionWrap a[data-toggle]').attr('data-parent', '#' + id);\r\n\r\n\r\n            var panels = componentContent.find('.panel');\r\n            panels.each(function (index, item) {\r\n                var p = $(item);\r\n                var itemId = keditor.generateId('heading' + index);\r\n                var panelCollapseId = keditor.generateId('collapse' + index);\r\n                p.find('.panel-heading').attr('id', itemId);\r\n                p.find('.panel-collapse').attr('aria-labelledby', itemId).attr('id', panelCollapseId);\r\n                p.find('a[data-toggle]').attr('href', '#' + panelCollapseId).attr('aria-controls', '#' + panelCollapseId);\r\n            });\r\n\r\n            componentContent.find('.accordionWrap .panel-collapse').collapse('show');\r\n            componentContent.find('.panel-footer, .btnAddAccordionItem').removeClass('hide');\r\n            componentContent.find('.panel-title a .accHeadingText').prop('contenteditable', true);\r\n            componentContent.find('.panel-collapse .panel-body').prop('contenteditable', true);\r\n\r\n            componentContent.find('.panel-title a .accHeadingText, .panel-collapse .panel-body').on('input', function (e) {\r\n                if (typeof options.onComponentChanged === 'function') {\r\n                    options.onComponentChanged.call(keditor, e, component, contentArea);\r\n                }\r\n                \r\n                if (typeof options.onContainerChanged === 'function') {\r\n                    options.onContainerChanged.call(keditor, e, container, contentArea);\r\n                }\r\n                \r\n                if (typeof options.onContentChanged === 'function') {\r\n                    options.onContentChanged.call(keditor, e, contentArea);\r\n                }\r\n            });\r\n\r\n            var editor = componentContent.find('.panel-title a .accHeadingText, .panel-collapse .panel-body').ckeditor(options.ckeditorOptions).editor;\r\n            editor.on('instanceReady', function () {\r\n                flog('CKEditor is ready', component);\r\n\r\n                if (typeof options.onComponentReady === 'function') {\r\n                    options.onComponentReady.call(contentArea, component, editor);\r\n                }\r\n            });\r\n\r\n            $(document).off('click', '.btnDeleteAccordionItem').on('click', '.btnDeleteAccordionItem', function (e) {\r\n                e.preventDefault();\r\n\r\n                if (confirm('Are you sure you want to delete this item?')) {\r\n                    var panelsCount = componentContent.find('.panel').length;\r\n                    if (panelsCount > 1) {\r\n                        $(this).parents('.panel').remove();\r\n                    } else {\r\n                        Msg.error('You cant delete the last item');\r\n                    }\r\n                }\r\n            });\r\n\r\n            $(document).off('click', '.btnAddAccordionItem').on('click', '.btnAddAccordionItem', function (e) {\r\n                e.preventDefault();\r\n                var clone = componentContent.find('.panel').first().clone();\r\n                var itemId = keditor.generateId('heading');\r\n                var panelCollapseId = keditor.generateId('collapse');\r\n                clone.find('.panel-heading').attr('id', itemId);\r\n                clone.find('.panel-collapse').attr('aria-labelledby', itemId).attr('id', panelCollapseId);\r\n                clone.find('a[data-toggle]').attr('href', '#' + panelCollapseId);\r\n                componentContent.find('.accordionWrap .panel-group').append(clone);\r\n                var editor = clone.find('.panel-title a .accHeadingText, .panel-collapse .panel-body').ckeditor(options.ckeditorOptions).editor;\r\n                editor.on('instanceReady', function () {\r\n                    flog('CKEditor is ready', component);\r\n\r\n                    if (typeof options.onComponentReady === 'function') {\r\n                        options.onComponentReady.call(contentArea, component, editor);\r\n                    }\r\n                });\r\n            });\r\n        },\r\n\r\n        getContent: function (component, keditor) {\r\n            var componentContent = component.children('.keditor-component-content');\r\n            componentContent.find('.panel-collapse .panel-body').each(function () {\r\n                var h = $(this).html();\r\n                $(this).replaceWith('<div class=\"panel-body\">' + h + '</div>');\r\n            });\r\n            if (component.attr('data-initial-collapsed') == 'true'){\r\n                componentContent.find('.panel').each(function () {\r\n                    var panelTitle = $(this).find('.panel-heading a');\r\n                    var panelCollapse = $(this).find('.panel-collapse');\r\n                    panelCollapse.addClass('collapse').attr('aria-expanded', 'false').removeClass('in');\r\n                    panelTitle.addClass('collapsed').attr('aria-expanded', 'false');\r\n                });\r\n            }\r\n            componentContent.find('.panel-footer, .btnAddAccordionItem').addClass('hide');\r\n            componentContent.find('[contenteditable]').removeAttr('contenteditable');\r\n            componentContent.find('.accHeadingText').each(function () {\r\n               $(this).css('outline', 'none').text($(this).text());\r\n            });\r\n            return componentContent.html();\r\n        },\r\n\r\n        destroy: function (component, keditor) {\r\n            flog('destroy \"text\" component', component);\r\n\r\n            var id = component.find('.keditor-component-content').attr('id');\r\n            var editor = CKEDITOR.instances[id];\r\n            if (editor) {\r\n                editor.destroy();\r\n            }\r\n        },\r\n        initSettingForm: function (form, keditor) {\r\n            flog('init \"accordion\" settings', form);\r\n\r\n            return $.ajax({\r\n                url: '/static/keditor/componentAccordionSettings.html',\r\n                type: 'get',\r\n                dataType: 'HTML',\r\n                success: function (resp) {\r\n                    form.html(resp);\r\n\r\n                    form.find('.collapsedAll').on('click', function () {\r\n                        var comp = keditor.getSettingComponent();\r\n                        comp.attr('data-initial-collapsed', this.checked);\r\n                    });\r\n\r\n                    form.find('.panelStyle').on('change', function (e) {\r\n                        var comp = keditor.getSettingComponent();\r\n                        var old = comp.attr('data-panel-style') || 'panel-default';\r\n                        comp.attr('data-panel-style', this.value);\r\n                        comp.find('.panel').removeClass(old).addClass(this.value);\r\n                    });\r\n                    \r\n                    $.getStyleOnce('/static/bootstrap-iconpicker/1.7.0/css/bootstrap-iconpicker.min.css');\r\n                    $.getScriptOnce('/static/bootstrap-iconpicker/1.7.0/js/iconset/iconset-fontawesome-4.2.0.min.js', function () {\r\n                        $.getScriptOnce('/static/bootstrap-iconpicker/1.7.0/js/bootstrap-iconpicker.min.js', function () {\r\n                            form.find('.btn-collapsed-icon, .btn-expanded-icon').iconpicker({\r\n                                iconset: 'fontawesome',\r\n                                cols: 10,\r\n                                rows: 4,\r\n                                placement: 'left'\r\n                            });\r\n                            \r\n                            form.find('.btn-collapsed-icon').on('change', function (e) {\r\n                                var component = keditor.getSettingComponent();\r\n                                component.attr('data-collapsed-icon', e.icon);\r\n                                component.find('.panelIconCollapsed').each(function () {\r\n                                    this.className = \"panelIconCollapsed fa \"+ e.icon;\r\n                                })\r\n                            });\r\n                            \r\n                            form.find('.btn-expanded-icon').on('change', function (e) {\r\n                                var component = keditor.getSettingComponent();\r\n                                component.attr('data-expanded-icon', e.icon);\r\n                                component.find('.panelIconExpanded').each(function () {\r\n                                    this.className = \"panelIconExpanded fa \"+ e.icon;\r\n                                })\r\n                            });\r\n                        });\r\n                    });\r\n                            \r\n                }\r\n            });\r\n        },\r\n\r\n        showSettingForm: function (form, component, keditor) {\r\n            flog('showSettingForm \"Accordion\" component');\r\n            var dataAttributes = keditor.getDataAttributes(component, ['data-type'], false);\r\n            \r\n            form.find('.collapsedAll').prop('checked', component.attr('data-initial-collapsed') == 'true');\r\n            form.find('.panelStyle').val(component.attr('data-panel-style'));\r\n            \r\n            $.getScriptOnce('/static/bootstrap-iconpicker/1.7.0/js/iconset/iconset-fontawesome-4.2.0.min.js', function () {\r\n                $.getScriptOnce('/static/bootstrap-iconpicker/1.7.0/js/bootstrap-iconpicker.min.js', function () {\r\n                    var iconCollapsed = dataAttributes['data-collapsed-icon'] || 'fa-caret-up';\r\n                    form.find('.btn-collapsed-icon').find('i').attr('class', 'fa ' + iconCollapsed).end().find('input').val(iconCollapsed);\r\n                    var iconExpanded = dataAttributes['data-expanded-icon'] || 'fa-caret-down';\r\n                    form.find('.btn-expanded-icon').find('i').attr('class', 'fa ' + iconExpanded).end().find('input').val(iconExpanded);\r\n                });\r\n            });\r\n        }\r\n    };\r\n})(jQuery);\r\n\r\n"]}