/**!
 * KEditor - Kademi content editor
 * @copyright: Kademi (http://kademi.co)
 * @author: Kademi (http://kademi.co)
 * @version: 0.0.0
 * @dependencies: $, $.fn.draggable, $.fn.droppable, $.fn.sortable, Bootstrap (optional), FontAwesome (optional)
 */
!function(a){var t=a.keditor,e=t.log;t.components.carousel={init:function(a,t,n,i){e('init "carousel" component',n);var r=n.children(".keditor-component-content"),o=r.find(".carousel"),s=i.generateId("component-carousel");o.attr("id",s),o.find(".carousel-indicators li").attr("data-target",s),o.find(".carousel-control").attr("href","#"+s)},getContent:function(a,t){var e=a.children(".keditor-component-content");return e.html()},settingEnabled:!0,settingTitle:"Carousel settings",initSettingForm:function(t,n){return e('init "carousel" settings',t),a.ajax({url:"/static/keditor/componentCarouselSettings.html",type:"get",dataType:"HTML",success:function(i){t.html(i);var r=window.location.pathname.substr(0,window.location.pathname.lastIndexOf("/")+1),o=t.find(".carouselAddImage"),s=t.find(".carouselImageWrap"),c=this;o.mselect({contentTypes:["image"],bs3Modal:!0,pagePath:r,basePath:r,onSelectFile:function(a,i,r,o){e("keditor carousel selected a file",a,o),c.addImageToList(t,a,o),c.addImageToCarousel(n.getSettingComponent(),a,o)}}),s.sortable({handle:".btn-sort-image",items:"> .carouselImageItem",axis:"y",tolerance:"pointer",sort:function(){a(this).removeClass("ui-state-default")},update:function(){c.rearrangeItems(n.getSettingComponent(),t)}}),a(document.body).on("click",".carouselImageItem a.btn-remove-image",function(t){if(t.preventDefault(),confirm("Are you sure that you want to delete this image?")){var e=a(this),i=e.closest(".btn-group").siblings("[data-hash]").attr("data-hash");c.refreshCarousel(n.getSettingComponent(),i),e.closest(".carouselImageItem").remove()}}),t.find(".carouselPause").on("change",function(a){a.preventDefault();var t=n.getSettingComponent().find(".carousel");t.attr("data-pause",this.value)}),t.find(".carouselInterval").on("change",function(a){a.preventDefault();var t=n.getSettingComponent().find(".carousel");t.attr("data-interval",this.value)}),t.find(".carouselWrap").on("click",function(a){var t=n.getSettingComponent().find(".carousel");this.checked?t.attr("data-wrap","true"):t.attr("data-wrap","false")})}})},showSettingForm:function(t,e,n){var i=this;t.find(".carouselImageWrap").html(""),e.find(".carousel-inner > .item").each(function(e,n){var r=a(n).find("img").attr("src"),o=a(n).attr("data-hash");i.addImageToList(t,r,o)});var r=e.find(".carousel").attr("data-wrap"),o=e.find(".carousel").attr("data-pause"),s=e.find(".carousel").attr("data-interval");t.find(".carouselPause").val(o),t.find(".carouselInterval").val(s),t.find(".carouselWrap").prop("checked","true"===r)},addImageToCarousel:function(a,t,e){var n=a.find(".carousel"),i=n.find(".carousel-indicators").children().length,r=0===i?"active":"";n.find(".carousel-indicators").append('<li data-target="'+n.attr("id")+'" data-slide-to="'+i+'" class="'+r+'"></li>'),n.find(".carousel-inner").append('<div data-hash="'+e+'" class="item '+r+'">   <img src="'+t+'" alt="" width="100%" height="" />   <div class="carousel-caption"></div></div>')},addImageToList:function(a,t,e){a.find(".carouselImageWrap").append('<div class="carouselImageItem">   <img class="img-responsive" src="'+t+'" data-hash="'+e+'" />   <div class="btn-group btn-group-sm">       <a class="btn btn-info btn-sort-image" href="#"><i class="fa fa-sort"></i></a>       <a title="Delete this image" class="btn btn-danger btn-remove-image" href="#"><i class="fa fa-trash"></i></a>   </div></div>')},refreshCarousel:function(a,t){a.find("[data-hash="+t+"]").remove(),a.find(".carousel-inner .item.active").length||a.find(".carousel-inner .item:first-child").addClass("active"),a.find(".carousel-indicators li:last-child").remove()},rearrangeItems:function(t,e){var n=this,i=t.find(".carousel");i.find(".carousel-inner").html(""),i.find(".carousel-indicators").html(""),e.find(".carouselImageWrap").find(".carouselImageItem").each(function(){var e=a(this),i=e.find("img");n.addImageToCarousel(t,i.attr("src"),i.attr("data-hash"))})}}}(jQuery);
//# sourceMappingURL=keditor-component-carousel-0.0.0.min.js.map
