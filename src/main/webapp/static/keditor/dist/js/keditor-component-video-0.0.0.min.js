/**!
 * KEditor - Kademi content editor
 * @copyright: Kademi (http://kademi.co)
 * @author: Kademi (http://kademi.co)
 * @version: 0.0.0
 * @dependencies: $, $.fn.draggable, $.fn.droppable, $.fn.sortable, Bootstrap (optional), FontAwesome (optional)
 */
!function(t){var e=t.keditor,a=e.log;e.components.video={init:function(e,r,o,i){a('init "video" component',o);var n=this,d=o.find("img[data-video-src]");d.attr("id",i.generateId("component-video"));var c=d.parent();c.hasClass("video-wrapper")||(d.wrap('<div class="video-wrapper"></div>'),c=d.parent()),c.attr("data-id",d.attr("id")),c.attr("data-autostart",d.attr("data-autostart")),c.attr("data-aspectratio",d.attr("data-aspectratio")),c.attr("data-video-src",d.attr("data-video-src")),c.attr("data-repeat",d.attr("data-repeat")),c.attr("data-controls",d.attr("data-controls")),t.getScriptOnce("/static/jwplayer/6.10/jwplayer.js",function(){jwplayer.key="cXefLoB9RQlBo/XvVncatU90OaeJMXMOY/lamKrzOi0=",n.buildJWVideoPlayerPreview(o)})},getContent:function(t){a('getContent "video" component, component');var e=t.find(".video-wrapper"),r='<img class="video-jw" ';return r+='       id="'+this.componentId+'" ',r+='       src="'+e.attr("data-video-src")+'/alt-640-360.png" ',r+='       data-autostart="'+e.attr("data-autostart")+'" ',r+='       data-aspectratio="'+e.attr("data-aspectratio")+'" ',r+='       data-video-src="'+e.attr("data-video-src")+'" ',r+='       data-repeat="'+e.attr("data-repeat")+'" ',r+='       data-controls="'+e.attr("data-controls")+'" />',e.html(r),t.find(".keditor-component-content").html()},settingEnabled:!0,settingTitle:"Video Settings",initSettingForm:function(e,r){a('init "video" settings',e);var o=this;return t.ajax({url:"/static/keditor/componentVideoSettings.html",type:"get",dataType:"HTML",success:function(t){e.html(t);var a=e.find(".select-border-style");a.on("change",function(){o.borderStyle=this.value,r.getSettingComponent().find(".video-wrapper").css("border-style",this.value)});var i=e.find(".border-width");i.on("change",function(){var t=this.value;(isNaN(t)||t<0)&&(t=1,this.value=t),o.borderWidth=t,r.getSettingComponent().find(".video-wrapper").css("border-width",t)});var n=e.find(".color-picker"),d=n.find("input"),c=n.find(".input-group-addon i");n.colorpicker({format:"hex",container:n.parent(),component:".input-group-addon",align:"left",colorSelectors:{transparent:"transparent"}}).on("changeColor.colorpicker",function(t){var e=t.color.toHex();d.val()&&0!==d.val().trim().length||(e="",c.css("background-color","")),o.borderColor=e,r.getSettingComponent().find(".video-wrapper").css("border-color",e)}),e.find(".chk-border").on("click",function(){a.prop("disabled",!this.checked).selectpicker("refresh"),i.prop("disabled",!this.checked),n.colorpicker(this.checked?"enable":"disable"),this.checked||(r.getSettingComponent().find(".video-wrapper").css("border",""),a.selectpicker("val",""),i.val(""),n.colorpicker("setValue","transparent"))});var p=e.find(".btn-videoFileInput");p.mselect({contentTypes:["video"],bs3Modal:!0,pagePath:r.options.pagePath,basePath:r.options.basePath,onSelectFile:function(t){r.getSettingComponent().find(".video-wrapper").attr("data-video-src",t),o.refreshVideoPlayerPreview(r)}});var s=e.find("#video-autoplay");s.on("click",function(){r.getSettingComponent().find(".video-wrapper").attr("data-autostart",this.checked),o.buildJWVideoPlayerPreview(r)});var l=e.find("#video-loop");l.on("click",function(){r.getSettingComponent().find(".video-wrapper").attr("data-repeat",this.checked),o.buildJWVideoPlayerPreview(r)});var v=e.find(".video-ratio");v.on("click",function(t){this.checked&&(r.getSettingComponent().find(".video-wrapper").attr("data-aspectratio",this.value),o.buildJWVideoPlayerPreview(r))});var f=e.find("#video-showcontrols");f.on("click",function(t){r.getSettingComponent().find(".video-wrapper").attr("data-controls",this.checked),o.buildJWVideoPlayerPreview(r)})}})},showSettingForm:function(t,e,r){a('showSettingForm "video" component',t,e);var o=e.find(".video-wrapper"),i=o.css("border-width")||"",n="0px"!==i,d=t.find(".chk-border"),c=t.find(".border-width"),p=t.find(".color-picker"),s=t.find(".select-border-style");d.prop("checked",n),s.prop("disabled",!n).selectpicker("refresh").selectpicker("val",o.css("border-style")),c.prop("disabled",!n).val(n?i.replace("px",""):""),p.colorpicker(n?"enable":"disable").colorpicker("setValue",n?o.css("border-color"):""),t.find("#video-autoplay").prop("checked","true"===o.attr("data-autostart")),t.find("#video-loop").prop("checked","true"===o.attr("data-repeat")),t.find(".video-ratio").filter('[value="'+o.attr("data-aspectratio")+'"]').prop("checked",!0),t.find("#video-showcontrols").prop("checked","true"===o.attr("data-controls"))},buildJWVideoPlayerPreview:function(t){t.jquery||(t=t.getSettingComponent());var e=t.find(".video-wrapper"),r=e.attr("data-video-src"),o=e.attr("data-autostart"),i=e.attr("data-repeat"),n=e.attr("data-aspectratio"),d=e.attr("data-controls"),c=jwplayer(e.attr("data-id")),p=r+"/alt-640-360.png";a("buildJWPlayer",r,"aspectratio=",n),c.setup({autostart:o,repeat:i,controls:d,aspectratio:n,flashplayer:"/static/jwplayer/6.10/jwplayer.flash.swf",html5player:"/static/jwplayer/6.10/jwplayer.html5.js",width:"100%",androidhls:!0,playlist:[{image:p,sources:[{file:r},{file:r+"/../alt-640-360.webm"},{file:r+"/../alt-640-360.m4v"}]}],primary:"flash"}),c.onReady(function(){a("jwplayer preview init done")})},refreshVideoPlayerPreview:function(t){var e=t.getSettingComponent().find(".video-wrapper"),a=jwplayer(e.attr("data-id")),r=e.attr("data-video-src");a.load([{file:r}]),a.play()}}}(jQuery);
//# sourceMappingURL=keditor-component-video-0.0.0.min.js.map
