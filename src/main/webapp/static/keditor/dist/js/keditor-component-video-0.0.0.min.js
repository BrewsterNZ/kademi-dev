/**!
 * KEditor - Kademi content editor
 * @copyright: Kademi (http://kademi.co)
 * @author: Kademi (http://kademi.co)
 * @version: 0.0.0
 * @dependencies: $, $.fn.draggable, $.fn.droppable, $.fn.sortable, Bootstrap (optional), FontAwesome (optional)
 */
!function(t){var e=t.keditor,a=e.log;e.components.video={init:function(e,r,o,i){a('init "video" component',o);var d=this,n=o.find("img[data-video-src]");n.attr("id",i.generateId("component-video"));var c=n.parent();c.hasClass("video-wrapper")||(n.wrap('<div class="video-wrapper"></div>'),c=n.parent()),c.attr("data-id",n.attr("id")),c.attr("data-autostart",n.attr("data-autostart")),c.attr("data-aspectratio",n.attr("data-aspectratio")),c.attr("data-video-src",n.attr("data-video-src")),c.attr("data-repeat",n.attr("data-repeat")),c.attr("data-controls",n.attr("data-controls")),t.getScriptOnce("/static/jwplayer/6.10/jwplayer.js",function(){jwplayer.key="cXefLoB9RQlBo/XvVncatU90OaeJMXMOY/lamKrzOi0=",d.buildJWVideoPlayerPreview(o)})},getContent:function(t){a('getContent "video" component, component');var e=t.find(".video-wrapper"),r='<img class="video-jw" ';return r+='       id="'+this.componentId+'" ',r+='       src="'+e.attr("data-video-src")+'/alt-640-360.png" ',r+='       data-autostart="'+e.attr("data-autostart")+'" ',r+='       data-aspectratio="'+e.attr("data-aspectratio")+'" ',r+='       data-video-src="'+e.attr("data-video-src")+'" ',r+='       data-repeat="'+e.attr("data-repeat")+'" ',r+='       data-controls="'+e.attr("data-controls")+'" />',e.html(r),t.find(".keditor-component-content").html()},settingEnabled:!0,settingTitle:"Video Settings",initSettingForm:function(e,r){a('init "video" settings',e);var o=this;return t.ajax({url:"/static/keditor/componentVideoSettings.html",type:"get",dataType:"HTML",success:function(a){e.html(a);var i=e.find(".select-border-style");i.on("change",function(){o.borderStyle=this.value,r.getSettingComponent().find(".video-wrapper").css("border-style",this.value)});var d=e.find(".border-width");d.on("change",function(){var t=this.value;(isNaN(t)||t<0)&&(t=1,this.value=t),o.borderWidth=t,r.getSettingComponent().find(".video-wrapper").css("border-width",t)});var n=e.find(".borderColor");t.contentEditor.initColorPicker(n,function(t){o.borderColor=t,r.getSettingComponent().find(".video-wrapper").css("border-color",t)}),e.find(".chk-border").on("click",function(){i.prop("disabled",!this.checked),d.prop("disabled",!this.checked),n.prop("disabled",!this.checked),this.checked||(r.getSettingComponent().find(".video-wrapper").css("border",""),i.val(""),d.val(""),n.val(""))});var c=e.find(".btn-videoFileInput");c.mselect({contentTypes:["video"],bs3Modal:!0,pagePath:r.options.pagePath,basePath:r.options.basePath,onSelectFile:function(t){r.getSettingComponent().find(".video-wrapper").attr("data-video-src",t),o.refreshVideoPlayerPreview(r)}});var p=e.find("#video-autoplay");p.on("click",function(){r.getSettingComponent().find(".video-wrapper").attr("data-autostart",this.checked),o.buildJWVideoPlayerPreview(r)});var s=e.find("#video-loop");s.on("click",function(){r.getSettingComponent().find(".video-wrapper").attr("data-repeat",this.checked),o.buildJWVideoPlayerPreview(r)});var l=e.find(".video-ratio");l.on("click",function(t){this.checked&&(r.getSettingComponent().find(".video-wrapper").attr("data-aspectratio",this.value),o.buildJWVideoPlayerPreview(r))});var v=e.find("#video-showcontrols");v.on("click",function(t){r.getSettingComponent().find(".video-wrapper").attr("data-controls",this.checked),o.buildJWVideoPlayerPreview(r)})}})},showSettingForm:function(t,e,r){a('showSettingForm "video" component',t,e);var o=e.find(".video-wrapper"),i=o.css("border-width")||"",d="0px"!==i,n=t.find(".chk-border"),c=t.find(".border-width"),p=t.find(".color-picker"),s=t.find(".select-border-style");n.prop("checked",d),s.prop("disabled",!d).val(o.css("border-style")),c.prop("disabled",!d).val(d?i.replace("px",""):""),p.colorpicker(d?"enable":"disable").colorpicker("setValue",d?o.css("border-color"):""),t.find("#video-autoplay").prop("checked","true"===o.attr("data-autostart")),t.find("#video-loop").prop("checked","true"===o.attr("data-repeat")),t.find(".video-ratio").filter('[value="'+o.attr("data-aspectratio")+'"]').prop("checked",!0),t.find("#video-showcontrols").prop("checked","true"===o.attr("data-controls"))},buildJWVideoPlayerPreview:function(t){t.jquery||(t=t.getSettingComponent());var e=t.find(".video-wrapper"),r=e.attr("data-video-src"),o=e.attr("data-autostart"),i=e.attr("data-repeat"),d=e.attr("data-aspectratio"),n=e.attr("data-controls"),c=jwplayer(e.attr("data-id")),p=r+"/alt-640-360.png";a("buildJWPlayer",r,"aspectratio=",d),c.setup({autostart:o,repeat:i,controls:n,aspectratio:d,flashplayer:"/static/jwplayer/6.10/jwplayer.flash.swf",html5player:"/static/jwplayer/6.10/jwplayer.html5.js",width:"100%",androidhls:!0,playlist:[{image:p,sources:[{file:r},{file:r+"/../alt-640-360.webm"},{file:r+"/../alt-640-360.m4v"}]}],primary:"flash"}),c.onReady(function(){a("jwplayer preview init done")})},refreshVideoPlayerPreview:function(t){var e=t.getSettingComponent().find(".video-wrapper"),a=jwplayer(e.attr("data-id")),r=e.attr("data-video-src");a.load([{file:r}]),a.play()}}}(jQuery);
//# sourceMappingURL=keditor-component-video-0.0.0.min.js.map
