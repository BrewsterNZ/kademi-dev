<html>
    <head>
        <meta charset="utf-8">
        <title>Default Example</title>
        <meta name="description" content="" />

        <meta name="viewport"
              content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0" />
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black" />

        <link rel="stylesheet" href="/static/bootstrap/3.3.5/css/bootstrap.min.css" />
        <link rel="stylesheet" href="/static/font-awesome/4.5.0/css/font-awesome.min.css" />
        <link rel="stylesheet" href="/static/bootstrap-msg/0.3/bootstrap-msg.min.css" type="text/css" />
        <link rel="stylesheet" href="/static/jquery.mselect/1.1.0/jquery.mselect-1.1.0.css" type="text/css" />

        <script src="/static/jquery/1.11.0/jquery-1.11.0.js"></script>
        <!-- Fuse specific scripts. We might be able to remove some of these after admin2 integration -->
        <script type="text/javascript" src="/static/js/common.js">//</script>
        <script type="text/javascript" src="/static/bootstrap-msg/0.3/bootstrap-msg.min.js">//</script>
        <!-- End Fuse specific scripts -->

        <script type="text/javascript" src="/theme/js/init-theme.js">//</script>
        <script src="/static/bootstrap/3.3.5/js/bootstrap.min.js">//</script>
        <script src="/static/jquery.cookie/1.4.0/jquery.cookie.min-1.4.0.js">//</script>
        <script type="text/javascript" src="/static/js/jquery.milton-tree.js">//</script>
        <script type="text/javascript" src="/static/js/jquery.jstree.js">//</script>
        <script type="text/javascript" src="/static/js/jquery.milton-upload.js">//</script>
        <script type="text/javascript" src="/static/jquery.mselect/1.1.0/jquery.mselect-1.1.0.js">//</script>
    </head>
<body>
    <div id="files" style="padding: 10px; overflow: hidden;"></div>

    <script>
        $(function () {
            // Optional: specify custom height
            window.frameElement.style.height = '500px';

            var url = window.location.search.replace('?url=', '');
            $('#files').mselect({
                useModal: false,
                onSelectFile: function (url, relUrl, fileType) {
                    if (isJWplayer()) {
                        if (fileType === 'video') {
                            selectAsset(url + '/alt-640-360.png');
                        } else {
                            alert('Your selected file is not video!');
                        }
                    } else {
                        selectAsset(url);
                    }
                },
                pagePath: "",
                basePath: url
            });
        });

        function isJWplayer() {
            return parent.top.$('#lnkImageSettings').data('image').hasClass('video-jw');
        }

        /**
         * USE THIS FUNCTION TO SELECT CUSTOM ASSET WITH CUSTOM VALUE TO RETURN
         * An asset can be a file, an image or a page in your own CMS
         */
        function selectAsset(assetValue) {
            // Get selected URL
            var inp = parent.top.$('#active-input').val();
            parent.top.$('#' + inp).val(assetValue);

            // Close dialog
            if (window.frameElement.id == 'ifrFileBrowse') {
                parent.top.$("#md-fileselect").data('simplemodal').hide();
            }
            if (window.frameElement.id == 'ifrImageBrowse') {
                parent.top.$("#md-imageselect").data('simplemodal').hide();
            }
        }
    </script>
</body>
</html>