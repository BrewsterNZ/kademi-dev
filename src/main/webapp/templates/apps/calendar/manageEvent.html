<html>
    <head>
        <title>Calendar</title>
        <link href="manageCalendars.css" rel="stylesheet" type="text/css" />
        <script type="text/javascript" src="calendars.js">//</script>
        <script type="text/javascript" src="manageCalendars.js">//</script>
        <script type="text/javascript" src="cal-utils.js">//</script>
        <style>
            .allowReg, .emailReg {
                display: none;
            }
            div.Details {
                min-height: 300px;
            }
        </style>
    </head>    
    <body class="calendar-event">
        <form action="" method="POST" class="manageEventForm">
            <section id="manageEvent" class="MainContent">
                <div class="pull-right">
                    <button class="Btn">Save changes</button>
                    <button class="Btn Cancel" type="button">Cancel</button>
                </div>
                <nav class="TabNav ClearFix">
                    <a href="#details">Details</a>
                    <a href="#description">Description</a>
                    <a href="#confirmation">Confirmation</a>
                    <a href="#entries">Attendees</a>
                </nav>                

                <div class="Content Details TabContent" rel="#details">
                    <input type="hidden" id="backgroundImageHash" name="backgroundImageHash" value="$!page.backgroundImageHash" />
                    <table class="Details">
                        <tbody>
                            <tr>
                                <th>Event title</th>
                                <td><input type="text" name="title" placeholder="Enter a name here" value="$page.title" class="required" /></td>
                            </tr>

                            <tr>
                                <th>Choose a start date</th>
                                <td><input type="text" name="startDate" placeholder="Start date" value="$formatter.formatDateTime(  $page.startDate )" class="DateTime" /></td>
                            </tr>
                            <tr>
                                <th>Choose a end date</th>
                                <td><input type="text" name="endDate" placeholder="End date" value="$formatter.formatDateTime( $page.endDate )" class="DateTime" /></td>
                            </tr>							
                            <tr>
                                <th>Location</th>
                                <td><input type="text" name="location" placeholder="38 Boulevarde Ave" value="$!page.location" class="" /></td>
                            </tr>
                            <tr>
                                <th>Organisor</th>
                                <td>
                                    <input type="text" name="organisor" placeholder="Email address or user id" value="$!page.organisor.email" class="required" />
                                </td>
                            </tr>                            
                        </tbody>
                    </table>                        
                </div>                    

                <div class="Content TabContent" rel="#description">
                    <textarea class="htmleditor" cols="100" name="html" rows="10" placeholder="">$!page.description</textarea>
                </div>                

                <div class="Content Details TabContent" rel="#confirmation">
                    <table class="Details checkVis">
                        <tbody>
                            <tr>
                                <th>Allow registration</th>
                                <td>
                                    $formatter.checkbox("allowRegistration", $page.allowRegistration)
                                    <label for="email" style="float: none">Allow users to register their attendance.</label>
                                </td>
                            </tr>

                            <tr class="allowReg">
                                <th>Allow guests</th>
                                <td>
                                    $formatter.checkbox("allowGuests", $page.allowGuests)
                                    <label for="email" style="float: none">Allow users to register guests.</label>
                                </td>
                            </tr>                            

                            <tr class="allowReg">
                                <th>Maximum attendees</th>
                                <td><input type="text" name="maxAttendees" placeholder="Leave empty if there's no limit" value="$!page.maxAttendees" class="numeric" /></td>
                            </tr>

                            <tr class="allowReg">
                                <th>Email confirmation</th>
                                <td>
                                    $formatter.checkbox("emailConfirm", $page.emailConfirm)
                                    <label for="email" style="float: none">Send an email confirmation to the user when they are awarded.</label>
                                </td>
                            </tr>
                            <tr class="allowReg emailReg">
                                <td colspan="2"><hr /></td>
                            </tr>

                            <tr class="allowReg emailReg">
                                <th>
                                    Details
                                    <small>The message to send when a user registers.</small>
                                </th>
                                <td>
                                    <textarea cols="100" name="details" rows="10" class="htmleditor" placeholder="Enter the details here">$!page.emailConfirmTemplate</textarea>
                                </td>
                            </tr>
                        </tbody>
                    </table> 
                </div>

                <div class="Content TabContent" rel="#entries">
                    <article class='Note'>
                        <table class="">
                            <tr>
                                <th>Attendees</th>
                                <td>$page.numAttendees attendees <a href="../attendees-${page.name}.html" class="Btn">View</a></td>
                            </tr>
                            <tr>
                                <th>Export to spreadsheet</th>
                                <td><a href="entries.csv" class="Btn">Export as CSV</a></td>
                            </tr>
                            <tr>
                                <th>Photos</th>
                                <td><a href="photos.html" class="Btn">View photo entries</a>  (for photo upload comps)</td>
                            </tr>

                        </table>
                    </article>
                </div>
            </section>
        </form>



        <script type="text/javascript">
            jQuery(function() {
                initManageEvent();
                checkVisibility();
                $(".checkVis input").click(function() {
                    checkVisibility();
                });
            });
            function checkVisibility() {
                log("checkVisibility");
                if( $("input[name=allowRegistration]").is(":checked") ) {
                    $(".allowReg").show(100);
                    log("checkVisibility2");
                    if( $("input[name=emailConfirm]").is(":checked") ) {
                        $(".emailReg").show(100);
                    } else {
                        $(".emailReg").hide(100);
                    }
                } else {
                    $(".allowReg").hide(100);
                }
            }
        </script>        
    </body>
</html>