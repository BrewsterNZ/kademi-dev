<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>$view.title</title>
        <link type="text/css" rel="stylesheet" href="viewLogs.css" />
    </head>
    <body class="manageApplications appsContainer">
        <article class="panel panel-default">
            <div class="panel-heading">
                <i class="clip-file-2"></i>
                <h3 class="panel-title">Logs</h3>
            </div>
            <div class="panel-body">
                <div class="row">
                    <div class="col-md-3 col-lg-2 col-xl-2">
                        <div class="input-group search-user input-group-sm">
                            <span class="input-group-addon">Level:</span>
                            <select class="form-control" id="level-filter">
                                <option value="">All levels</option>
                                <option value="info-only">Info</option>
                                <option value="danger-only">Error</option>
                                <option value="warning-only">Warn</option>
                                <option value="default-only">Trace</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-4 col-lg-3 col-xl-3">
                        <div class="input-group search-user input-group-sm">
                            <input type="text" id="user-query" class="form-control user-query" placeholder="Filter by User" value="" />
                            <span class="input-group-btn">
                                <button class="btn btn-sm btn-default" type="button" data-type="clearer" data-target="#user-query">
                                    <i class="fa fa-times"></i>
                                </button>
                            </span>
                        </div>
                    </div>
                    <div class="col-md-4 col-lg-3 col-xl-3">
                        <div class="input-group search-user input-group-sm">
                            <input type="text" id="message-query" class="form-control message-query" placeholder="Filter message" value="" />
                            <span class="input-group-btn">
                                <button class="btn btn-sm btn-default" type="button" data-type="clearer" data-target="#message-query">
                                    <i class="fa fa-times"></i>
                                </button>
                            </span>
                        </div>
                    </div>
                </div>
                <br />
                <div class="panel panel-default" style="margin: 0">
                    <div class="col-row row-header clearfix" style="overflow-y: scroll;">
                        <div class="col-lvl">Level</div>
                        <div class="col-user">User</div>
                        <div class="col-msg">Message</div>
                        <div class="col-date">Date</div>
                    </div>
                    <div id="logsBody">
                        #foreach($event in $page.recent)
                            #set($labelType = $event.level.toLowerCase())
                            #if($labelType == "error")
                                #set($labelType = "danger")
                            #elseif($labelType == "warn")
                                #set($labelType = "warning")
                            #elseif($labelType == "trace")
                                #set($labelType = "default")
                            #end
                            <div class="$labelType col-row clearfix">
                                <div class="col-lvl"><span class="label label-$labelType" >$event.level</span></div>
                                <div class="col-user"><a target="_blank" class="userName" href="$!event.userHref">$!event.userName</a></div>
                                <div class="col-msg">$event.message</div>
                                <div class="col-date"><abbr title="$formatter.formatDateISO8601($event.date)" class="timeago">$event.date</abbr></div>
                            </div>
                        #end
                        <div class="info col-row clearfix">
                            <div style="width:100%;">Beginning listening...</div>
                        </div>
                    </div>
                    <div class="panel-footer">
                        <button class="btn btn-info logs-clear">Clear</button>
                    </div>
                </div>
            </div>
        </article>

        <script type="text/javascript" src="/theme/apps/admin/viewLogs.js"></script>
        <script type="text/javascript">
            $(function () {
                initViewLogs({
                    orgId: '$page.organisation.id',
                    maxLimit: 3000
                });
            });
        </script>
    </body>
</html>