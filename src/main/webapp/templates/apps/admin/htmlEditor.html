<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Text editor</title>
        <link rel="template" href="editorBase" />
        <script type="text/javascript" src="/static/js/init-theme.js" bottom="true">//</script>
        <script type="text/javascript" src="/static/js/file.js" bottom="true">//</script>
        <script type="text/javascript" src="/static/js/toolbars.js" bottom="true">//</script>
        <script type="text/javascript" src="/static/ckeditor440/ckeditor.js" bottom="true">//</script>
        <script type="text/javascript" src="/static/ckeditor440/adapters/jquery.js" bottom="true">//</script>
        <script type="text/javascript" src="/static/js/keymap.js">//</script>
        <script type="text/javascript" src="htmlEditor.js">//</script>
        <link rel="stylesheet" type="text/css" href="textEditor.css" />
    </head>
    <body class="">
        #set($fname = $params.fileName)
        #set($file = $folder.child($fname))
        #set($useHash = $params.useHash)

        <div id="editor-wrapper">
            <div class="clearfix editor-toolbar">
                <div class="btn-toolbar pull-right" role="toolbar">
                    <i class="fa fa-spinner fa-spin fa-3x fa-fw" id="editor-loading"></i>
                    <div class="btn-group btn-group-sm">
                        <button class="btn btn-success btn-save-file">Save file</button>
                    </div>
                </div>
                <h3 class="pull-left">$file.name</h3>
            </div>
            <textarea id="editor" class="toolbar-Full">$formatter.htmlEncode($file.body)</textarea>
        </div>

        #foreach($cssPath in $file.cssPaths)
        <link rel="editor-stylesheet" href="${cssPath}" />
        #end

        <script type="text/javascript">
            var useHash = "$!useHash";
            $(function () {
                themeCssFiles.push('/static/editor/editor.css'); // just to format the editor itself a little
                themeCssFiles.push('/static/prettify/prettify.css');

                $("link[rel=editor-stylesheet]").each(function (i, n) {
                    var cssPath = $(n).attr("href");
                    themeCssFiles.push(cssPath);
                    $(n).remove();
                });
                initHtmlEditorPage('$fname');
            });

            window.onbeforeunload = function (e) {
                e.returnValue = "Are you sure you would like to leave the editor? You will lose any unsaved changes";
            }
        </script>
    </body>
</html>