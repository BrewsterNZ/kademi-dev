<html>    <head>        <title>Edit organisation details</title>        <script type="text/javascript" src="/static/chosen/1.1.0/chosen.jquery.js">//</script>        <link rel="stylesheet" href="/static/chosen/1.1.0/chosen.css"/>        <link rel="stylesheet" href="/theme/assets/plugins/bootstrap-chosen/1.0.1/bootstrap-chosen.css" />        <script type="text/javascript" src="editOrg.js" >//</script>    </head>    <body class="viewOrg">        <form method="post" action="$request.absolutePath" class="form-horizontal org-details">            <div class="btn-group pull-right" role="group" >                <a href="viewDetails" class="btn btn-lg btn-info"><i class="fa fa-users"></i> Members</a>                <button type="submit" class="btn btn-success btn-lg"><i class="fa fa-save"></i> Save</button>            </div>                                    <div style="margin-bottom: 15px">                <h2>                    <span class="fa fa-home"></span>                    $page.organisation.formattedName                </h2>                <div id="orgTypesContainer">                    <div class="dropdown pull-left" style="margin-right: 15px">                        <a data-toggle="dropdown" class="dropdown-toggle" href="#">                            <i class="clip-plus-circle fa-2x"></i>                        </a>                        <ul class="dropdown-menu">                            #foreach($orgType in $page.orgTypes)                            #if( !$page.isSelected($orgType) )                            <li class="addOrgType">                                <a href="/orgTypes/$orgType.name">                                    $formatter.firstNotNull($orgType.displayName, $orgType.name)                                </a>                            </li>                            #end                            #end                            <li class="divider"></li>                            <li>                                <a href="/orgTypes/">Manage organisation types/tags</a>                            </li>                        </ul>                    </div>                    #if( $page.selectedOrgTypes.isEmpty() )                    <i>This organisation has no tags. Click the + to add one</i>                    #else                    #foreach($m in $page.selectedOrgTypes)                    <div class="fluidLabel label label-success" style="margin-right: 5px">                        <i class="clip-users"></i>                        <span class="block-name">                            <a href="/orgTypes/$m.name">$formatter.firstNotNull($m.displayName, $m.name)</a>                            <a title="Remove this organisation tag" class="text-muted removeOrgType" href="/orgTypes/$m.name">                                <i class="fa fa-times"></i>                            </a>                        </span>                    </div>                    #end                    #end                    <div style="clear: both"></div>                </div>                <div style="clear: both"></div>            </div>            <div class="row">                <div class="col-md-8">                    <div id="form-body">                        <div class="panel panel-default">                            <div class="panel-heading">                                <i class="clip-pencil"></i>                                Organisation details                            </div>                            <div class="panel-body">                                <div class="form-group">                                    <label for="orgTitle" class="control-label col-md-2">Org ID</label>                                    <div class="col-md-8">                                        <input type="text" value="$!page.organisation.orgId" class="form-control required" name="orgId" id="orgId" placeholder="Your unique ID for the organisation" />                                        <p>This is used to uniquely identify the organisation database, and should never change.It <b>should not be the name</b>, because you may need to change the organisation name</p>                                    </div>                                </div>                                <div class="form-group">                                    <label for="orgTitle" class="control-label col-md-2">Kademi ID</label>                                    <div class="col-md-8">                                        <b>$page.organisation.id</b>                                        - This is Kademi's internal identifier for the organisation.                                    </div>                                </div>                                                                <div class="form-group">                                    <label for="orgTitle" class="control-label col-md-2">Name</label>                                    <div class="col-md-8">                                        <input type="text" value="$!page.organisation.title" class="form-control required" name="title" id="orgTitle" placeholder="User friendly name for the organisation" />                                        <p>This should be the user friendly name of the organisation, such as Human Resources for a department, or ACME Gift Store - London, for a retail store</p>                                    </div>                                </div>                                <div class="form-group">                                    <label for="orgPhone" class="control-label col-md-2">Email</label>                                    <div class="col-md-4">                                        <input type="text" value="$!page.organisation.email" class="form-control" name="email" id="orgEmail" />                                    </div>                                    <label for="orgPhone" class="control-label col-md-2">Phone</label>                                    <div class="col-md-4">                                        <input type="text" value="$!page.organisation.phone" class="form-control" name="phone" id="orgPhone" />                                    </div>                                </div>                            </div>                        </div>                        <div class="panel panel-default">                            <div class="panel-heading">                                Physical location                            </div>                            <div class="panel-body">                                <div class="form-group">                                    <label for="orgAddress" class="control-label col-md-2">Address</label>                                    <div class="col-md-8">                                        <input type="text" value="$!page.organisation.address" class="form-control" name="address" id="orgAddress" />                                    </div>                                </div>                                <div class="form-group">                                    <label for="orgAddress2" class="control-label col-md-2">Address Line2</label>                                    <div class="col-md-8">                                        <input type="text" value="$!page.organisation.addressLine2" class="form-control" name="addressLine2" id="orgAddress2" />                                    </div>                                </div>                                <div class="form-group">                                    <label for="orgState" class="control-label col-md-2">State</label>                                    <div class="col-md-4">                                        <input type="text" value="$!page.organisation.addressState" class="form-control" name="addressState" id="orgState" />                                    </div>                                    <label for="orgPostcode" class="control-label col-md-2">Postcode</label>                                    <div class="col-md-4">                                        <input type="text" value="$!page.organisation.postcode" class="form-control" name="postcode" id="orgPostcode" />                                    </div>                                </div>                                <div class="form-group">                                    <label for="country" class="control-label col-md-2">Country</label>                                    <div class="col-md-8">                                        <select name="country" class="form-control chosen-select" id="country">                                            <option value="">[No country selected]</option>                                            #foreach($cc in $formatter.countryCodes.list)                                            $formatter.option( $cc.alpha2Code, $cc.englishShortName, $page.organisation.country )                                            #end                                        </select>                                    </div>                                </div>                                <div class="form-group">                                    <label class="control-label col-md-2" for="location">Timezone</label>                                    <div class="col-md-8">                                        <select name="timezone" class="form-control chosen-select">                                            <option value="">[No timezone selected]</option>                                            #foreach($tzId in $page.timezoneIdList)                                            $formatter.option( $tzId, $tzId, $page.organisation.timezone )                                            #end                                        </select>                                        <small>This will be used as the default for any calendar events you create</small>                                    </div>                                </div>                                <div class="form-group">                                    <label for="orgState" class="control-label col-md-2">Lattitude</label>                                    <div class="col-md-4">                                        <input type="text" value="$!page.organisation.lat" class="form-control" name="lat" />                                    </div>                                    <label for="orgPostcode" class="control-label col-md-2">Longitude</label>                                    <div class="col-md-4">                                        <input type="text" value="$!page.organisation.lng" class="form-control" name="lng" />                                    </div>                                </div>                                <button class="btn btn-primary btnSearchAddress" type="button">Search for address</button>                                <br/>                                <div id="map" style="width: 100%; height: 300px"></div>                            </div>                        </div>                        #if( !$page.extraFields.isEmpty() )                        <div class="panel panel-default">                            <div class="panel-heading">                                Custom fields                            </div>                            <div class="panel-body">                                #set($fields = $page.extraFields)                                #foreach($field in $fields.keySet())                                <div class="control-group form-group">                                    <label class="control-label col-md-3 control-label" for="field_${field.name}">$field.text</label>                                    <div class="controls col-md-8">                                        $field.html( $fields[$field] )                                    </div>                                </div>                                #end                            </div>                        </div>                        #end                    </div>                    <div class="form-group">                        <div class="col-md-12">                            <button type="submit" class="btn btn-success btn-lg pull-right">Save</button>                        </div>                    </div>                </div>                <div class="col-md-4">                    <div class="panel panel-default">                        <div class="panel-heading">                            <i class="clip-pencil"></i>                            Administration domain                        </div>                        <div class="panel-body">                            <p>Set an administration domain value here if you want this organisation to have                                its own administration dashboard, so it can have its own administrators</p>                            <p>The value you enter must be unique across all of Kademi, and will be used to form                                an admin dashboard address like <b>mydomain</b>.kademi.olhub.com</p>                            <div class="form-group">                                <label class="control-label col-md-5" for="orgTitle">Admin Domain</label>                                <div class="col-md-7">                                    <input id="adminDomain" value="$!page.organisation.adminDomain" class="form-control regex" type="text" placeholder="Unique in all of Kademi. Used to identify the admin console" data-message="Admin Domain needs to be simple characters only. All lower case, no spaces and no special chatacters." name="adminDomain" data-regex="^(?:(?!-)[a-z0-9-]{1,63}(?!-)|)$">                                </div>                            </div>                                                        #if( $page.organisation.adminDomain )                            <p class="text-center">                            <a class="btn btn-lg btn-primary" href="/organisations/?gotoDomain=$page.organisation.adminDomain">                                <i class="fa fa-dashboard"></i>                                Login to admin console                            </a>                                                            </p>                            <div class="form-group">                                <label class="control-label col-md-5" for="orgHttps">Should force HTTPS?</label>                                <div class="col-md-7">                                   $formatter.checkbox("forceHttps", "forceHttps", $page.organisation.forceHttps)                                </div>                            </div>                            #end                                                    </div>                    </div>                    #portlets("orgSecondary")                </div>            </div>        </form>        #foreach($entry in $page.transactions.entrySet())        <h2>$entry.key.title</h2>        <table class="table">            <thead>                <tr>                    <th>Date</th>                    <th>Description</th>                    <th>Transaction Amount</th>                    <th>Balance</th>                </tr>            </thead>            <tbody>                #foreach($tx in $entry.value)                <tr>                    <td>$!tx.date</td>                    <td>$tx.description</td>                    <td>$tx.transactionAmount</td>                    <td>$tx.balance</td>                </tr>                #end            </tbody>        </table>        #end        <script type="text/javascript">            var map;            var infowindow;            var orgLat = null;            var orgLng = null;            #if ($page.organisation.lat) orgLat = $page.organisation.lat; #end                    #if ($page.organisation.lat) orgLng = $page.organisation.lng; #end        </script>        <script type="text/javascript">                    $(function () {                        initEditOrg();                    });        </script>        <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDS53FPtVGJPvZvrzh2sLcfPUQYS3gsh0c&libraries=places&callback=initMap" async defer></script>    </body></html>