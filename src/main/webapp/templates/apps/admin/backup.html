<html>    <head>        <title>Backup and Restore</title>        <link rel="stylesheet" href="/theme/assets/plugins/dropzone/downloads/css/dropzone.css"/>        <link href="/static/jquery-tree/jquery.tree.min.css" rel="stylesheet" type="text/css"/>        <style>            .loader {                display: none;                width: 100%;                height: 500px;                z-index: 9999;                background: url('/templates/ajax-loader.gif') 50% 50% no-repeat rgb(249,249,249);            }        </style>    </head>    <body class="">        <h1>Backup and Restore</h1>        <form class="form-horizontal" id="options">            <div class="row">                #foreach($appOptions in $page.options.entrySet())                <div class="col-md-12">                    <!-- <label>$appOptions.key</label> -->                    <div class="checkbox">                        #foreach($a in $appOptions.value.entrySet())                        <label class="checkbox-inline">                            <input type="checkbox" class="option" name="option_$a.value" value="true"> $a.key                        </label>                        #end                    </div>                </div>                #end            </div>        </form>        <a id="downloadBtn" href="backup.json" download="backup.json" class="btn btn-md btn-success"><i class="fa fa-download"></i> Download backup</a>        <button class="btn btn-mg btn-success" id="btn-restore" type="button" data-toggle="modal" data-target="#modal-file-upload"><i class="fa fa-upload"></i> Restore backup</button>        <div id="modal-file-upload" class="fileupload modal modal-md fade" aria-hidden="true" tabindex="-1">            <div class="modal-header">                <button aria-hidden="true" data-dismiss="modal" class="close" type="button">&times;</button>                <h4 class="modal-title">Upload backup file</h4>            </div>            <div class="modal-body">                <form action="$page.href/backup.json" class="dropzone dropzone-fullwidth" id="uploadFileDropzone">                </form>            </div>            <div class="modal-footer">                <button class="btn btn-sm btn-default" data-dismiss="modal" type="button">Close</button>            </div>        </div>        <script src="/theme/assets/plugins/dropzone/downloads/dropzone.min.js">//        </script>        <script src="/static/jquery-tree/jquery.tree.min.js" type="text/javascript">//</script>        <script type="text/javascript">            $(function () {                $('body').on('click', '#downloadBtn', function (e) {                    if ($('#options [type=checkbox].option:checked').length < 1) {                        e.preventDefault();                        Msg.warning("Please select at least one app to backup");                    } else {                        var options = $('#options [type=checkbox].option');                        var params = [];                        options.each(function (count, item) {                            var t = $(item);                            var checked = t.is(":checked");                            if (checked) {                                params.push({                                    name: t.attr('name'),                                    value: checked                                });                            }                        });                        var encodedParams = $.param(params);                        $('#downloadBtn').attr('href', 'backup.json?' + encodedParams)                    }                });                initUpload();            });            function initUpload() {                Dropzone.autoDiscover = false;                $("#uploadFileDropzone").dropzone({                    paramName: "backup", // The name that will be used to transfer the file                    maxFilesize: 500.0, // MB                    addRemoveLinks: true,                    parallelUploads: 1,                    uploadMultiple: false                });                var dz = Dropzone.forElement("#uploadFileDropzone");                dz.on("success", function (file, resp) {                    flog("added file", file);                    Msg.info("Restore complete");                });                dz.on("error", function (file, errorMessage) {                    Msg.error("An error occured uploading: " + file.name + " because: " + errorMessage);                });                $('body').on('hidden.bs.modal', '.fileupload', function () {                    dz.removeAllFiles();                    //$('#screenshot-div').reloadFragment();                });            }        </script>               </body></html>