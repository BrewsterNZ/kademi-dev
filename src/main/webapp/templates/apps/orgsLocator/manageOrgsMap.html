<html>    <head>        <title>Organisations map</title>        <link rel="stylesheet" type="text/css" href="/static/bootstrap-select/1.10.0/dist/css/bootstrap-select.min.css" />    </head>    <body class="viewOrg">        <div class="clearfix" style="margin-bottom: 10px;" id="orgDataStats">            <h4>Organisations with location $page.orgsWhitLocation                #if($page.orgsWhitoutLocation > 0)                 - Organisations without location: $page.orgsWhitoutLocation                 <button class="btn btn-info btn-sm" id="btnProcessLocation">                    <span class="fa fa-sitemap"></span>                    Process Orgs                </button>                 #end            </h4>         </div>        <div id="org-map"></div>        <script type="text/javascript" src="/static/jquery.scrollTo/2.1.2/jquery.scrollTo.min.js"></script>        <script type="text/javascript" src="/static/jquery.orgFinder/1.0.1/jquery.orgFinder-1.0.1.js"></script>        <script type="text/javascript" src="/static/bootstrap-select/1.10.0/dist/js/bootstrap-select.min.js"></script>        <script type="text/javascript">            var orgTypes = [];                    #foreach($orgType in $page.find("/orgTypes/").children)            orgTypes.push({            title: '$orgType.title',                    value: '$orgType.name'            });                    #end            var allowedCountries = [];                    #foreach($cc in $formatter.countryCodes.list)            allowedCountries.push({            value: '$cc.alpha2Code',                    title: "$cc.englishShortName"            });                    #end        </script>        <script type="text/javascript">            $(function () {                var win = $(window);                $('#org-map').orgFinder({                    searchUrl: '/organisations/map/',                    googleAPIKey: 'AIzaSyDS53FPtVGJPvZvrzh2sLcfPUQYS3gsh0c',                    initLatLng: [-33.867, 151.195],                    initZoomLevel: 15,                    orgTypes: orgTypes,                    allowedCountries: allowedCountries,                    onReady: function (formSearch, itemsWrapper, mapDiv) {                        win.on('resize', function () {                            var mapWrapper = mapDiv.parent();                            var winWidth = win.width();                            itemsWrapper.css('height', '');                            itemsWrapper.css('max-height', '');                            mapWrapper.css('padding-bottom', '');                            if (winWidth < 768) {                                mapWrapper.css('padding-bottom', '120%');                                itemsWrapper.css('max-height', 200);                            } else if (winWidth < 992) {                                itemsWrapper.css('max-height', 300);                            } else {                                itemsWrapper.css('height', mapWrapper.innerHeight() - 2);                            }                        }).trigger('resize');                    }                });                $("#btnProcessLocation").click(function () {                    console.log("btnProcessLocation");                    $.ajax({                        url: window.location.pathname,                        type: 'POST',                        data: {                            process: true                        },                        success: function (resp) {                            var data = JSON.parse(resp);                            flog(data);                            flog(data.status);                            if (data.status) {                                Msg.info("Updated the organisations lat & long");                                $("#orgDataStats").reloadFragment();                            } else {                                Msg.error("Couldnt process the orgs");                            }                        },                        error: function (e) {                            Msg.error(e.status + ': ' + e.statusText);                        }                    })                });            });        </script>    </body></html>