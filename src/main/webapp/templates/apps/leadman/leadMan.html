<html xmlns="http://www.w3.org/1999/xhtml">
    #parse("/theme/masterTemplate.html")
    #parse("/theme/apps/leadman/leadManIncludes.html")
    <head>
        #@themeHeader( "Lead Management" )
        <script src="/static/reload-fragment/1.0.1/jquery.reload-fragment-1.0.1.js" type="text/javascript" >//</script>
        #end
        <style>
            .infoBox {
                height: 100px;
            }
            .infoBox h1 {
                margin-top: 0;
            }
            .leadContactMethods a {
                margin-right: 10px;
            }
            .leadActions {
                position: absolute;
                bottom: 0;
                right: 0;
            }
            .leadContactMethods {
                position: absolute;
                bottom: 0;
                left: 20px;
            }
            .lead {
                margin-bottom: 40px;
            }
            .leadInner {
                max-height: 200px;
            }
        </style>
    </head>
    <body class='add-container'>
        #@themeBody()

        <div class="container">
            <p class='lead'>Leads</p>
            <div class="row">
                <div class="col-md-8">
                    <div class="input-group" id="lead-query-container">
                        <input type="text" id="leadQuery" name="q" class="form-control" placeholder="Search for a lead" />
                    </div>
                </div>
            </div>
            <br/>
            <div class="row">
                <div id="leads_table" class="col-md-12">
                    #set($leads = $page.search($currentOrg, $request.params.query))

                    #if( $leads.size() > 0 )
                    <ul class="list-group leadsList" id="dashLeadsList">
                        #foreach($lead in $leads)
                        <li class="list-group-item">
                            #showLead($lead)
                        </li>
                        #end
                    </ul>
                    #else
                    <p class="lead">Couldnt find any leads</p>
                    #end
                </div>
            </div>
        </div>
        #createModals()
        <script type="text/javascript">
            $(function () {
                $('body').on('change', '#leadQuery', function (e) {
                    e.preventDefault();
                    
                    var inp = $(this);
                    
                    $('#leads_table').reloadFragment({
                        url: window.location.pathname + "?query=" + inp.val()
                    });
                });
            });
        </script>
        #end
    </body>
</html>