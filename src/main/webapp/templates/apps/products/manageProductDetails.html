<html xmlns="http://www.w3.org/1999/xhtml">    <head>        <title>Manage Products</title>        <style>            .delete-image {                position: absolute;                top: 10px;                right: 25px;            }        </style>    </head>    <body class="">        <div class="well">Please update the product details below</div>        #portlets("beforeManageProductDetails")        <div class="panel-body">            <form action="." method="POST" enctype="multipart/form-data" class="updateProduct form-horizontal" role="form">                <input type="hidden" name="action" value="update"/>                <div class="form-group">                    <div class="errorHandler alert alert-danger no-display pageMessage">.</div>                </div>                <div class="form-group">                    <label class="col-sm-2 control-label" for="name">Name/Code</label>                    <div class="col-sm-9">                        <input type="text" class="form-control required simpleChars" id="productName" name="name" value="$page.product.name" />                    </div>                </div>                <div class="form-group">                    <label class="col-sm-2 control-label" for="title">Title</label>                    <div class="col-sm-9">                        <input type="text" class="form-control required" name="title" value="$page.product.title"/>                    </div>                </div>                <div class="form-group">                    <label class="col-sm-2 control-label" for="baseCost">Base Cost</label>                    <div class="col-sm-9">                        <input type="text" class="form-control" name="baseCost" value="$!page.product.baseCost"/>                    </div>                </div>                <div class="form-group">                    <label class="col-sm-2 control-label" for="baseCost">Freight Cost</label>                    <div class="col-sm-9">                        <input type="text" class="form-control" name="freightCost" value="$!page.product.freightCost"/>                    </div>                </div>                <div class="form-group">                    <label class="col-sm-2 control-label" for="canOrderChk">Allow Ordering?</label>                    <div class="col-sm-9">                        <div class="checkbox">                            <label>                                $formatter.checkbox("canOrderChk", "canOrder", $page.product.canOrder)                                If ticked users will be given ordering options                            </label>                        </div>                    </div>                </div>                <div class="ordering">                    <h4 class="title">Order Form</h4>                    <hr />                    <div class="form-group">                        <label class="col-sm-2 control-label" for="orderForm">Order Form</label>                        <div class="col-sm-9">                            <textarea class="form-control" name="orderForm">$!{page.orderFormHtml}</textarea>                            <i>Enter the form html above</i>                        </div>                    </div>                    <div class="form-group">                        <label class="col-sm-2 control-label" for="orderColumns">CSV Columns</label>                        <div class="col-sm-9">                            <input type="text" name="orderColumns" id="orderColumns" class="form-control" value="$!page.product.orderColumns"/>                        </div>                    </div>                    <div class="form-group">                        <label class="col-sm-2 control-label" for="canOrderQuantityChk">Quantity?</label>                        <div class="col-sm-9">                            <div class="checkbox">                                <label>                                    $formatter.checkbox("canOrderQuantityChk", "canOrderQuantity", $page.product.canOrderQuantity)                                    If ticked users will be prompted for a quantity when ordering                                </label>                            </div>                        </div>                    </div>                </div>                <div class="form-group">                    <label class="col-sm-2 control-label" for="notes">Product Details</label>                    <div class="col-sm-9">                        <textarea id="notes" name="notes" class="htmleditor" cols="100" rows="5">$!page.product.notes</textarea>                        #portlets("insideManageProductDetails")                    </div>                </div>                <div class="form-group">                    <div class="col-sm-offset-2 col-sm-9">                        <button type="submit" class="btn btn-sm btn-primary">Save</button>                    </div>                </div>            </form>        </div>        <hr/>        <div class="panel panel-default">            <div class="panel-heading">                <i class="clip-pictures"></i>Product images            </div>            <div class="panel-body">                <div class="row">                    <div class="col-xs-4 col-md-2">                        <button id="btn-change-ava" class="btn btn-success">Add image</button>                    </div>                    <div id="product-images">                        #foreach($href in $page.imageHrefs)                        <div class="col-xs-6 col-md-3 product-image-thumb">                            <a href="$href" target="_blank" class="thumbnail"><img src="$href/alt-150-150.png"/></a>                            <a class="delete-image btn btn-xs btn-danger" href="$href">                                <span class="fa fa-times"></span>                            </a>                        </div>                        #end                    </div>                </div>              </div>                        </div>        <hr/>        #portlets("afterManageProductDetails")        <script type="text/javascript" src="/static/bootstrap-upcrop-image/1.0/bootstrap-upcrop-image.js">//</script>        <script type="text/javascript" src="/static/js/jquery.milton-upload.js"></script>        <script type="text/javascript">            $(function () {                jQuery("form.updateProduct").forms({                    callback: function () {                        Msg.success("Successfully updated product!");                    }                });                initHtmlEditors();                toggleOrderInfo();                $("#canOrderChk").change(function (event) {                    toggleOrderInfo();                });                $("#product-images").on("click", ".delete-image", function (e) {                    e.preventDefault();                    var target = $(e.target).closest("a");                    var href = target.attr("href");                    var name = getFileName(href);                    confirmDelete(href, name, function () {                        target.closest(".product-image-thumb").remove();                    });                });                $('#btn-change-ava').upcropImage({                    buttonContinueText: 'Save',                    url: window.location.pathname, // this is actually the default value anyway                    onCropComplete: function (resp) {                        flog("onCropComplete:", resp, resp.nextHref);                        $("#product-images").reloadFragment();                    },                    onContinue: function (resp) {                        flog("onContinue:", resp, resp.result.nextHref);                        $.ajax({                            url: window.location.pathname,                            type: 'POST',                            dataType: 'json',                            data: {                                uploadedHref: resp.result.nextHref,                                applyImage: true                            },                            success: function (resp) {                                flog("success");                                if (resp.status) {                                    Msg.info("Done");                                    $("#product-images").reloadFragment();                                } else {                                    Msg.error("An error occured processing the product image");                                }                            },                            error: function () {                                alert('Sorry, we couldn\'t save your profile image.');                            }                        });                    }                });            });            function toggleOrderInfo() {                var chk = $("#canOrderChk:checked");                if (chk.length > 0) {                    $(".ordering").show();                } else {                    $(".ordering").hide();                }            }        </script>            </body></html>