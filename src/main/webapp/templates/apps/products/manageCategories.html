<html xmlns="http://www.w3.org/1999/xhtml">    <head>        <title>Manage Categories</title>        <style>            .cat-image {                max-height: 50px;                max-width: 50px;            }        </style>    </head>    <body class="">        <p>            <button type="button" class="btn btn-sm btn-primary newCategory" data-toggle="modal" data-target="#addCategoryModal"><i class="fa fa-plus"></i> Add New Category</button>            <button type="button" class="btn btn-sm btn-danger deleteCat pull-right"><i class="glyphicon glyphicon-trash"></i> Delete</button>        </p>        <div class="panel panel-default">            <div id="productsTableContainer" class="panel-body">                <div class="table-responsive">                    <table class="table table-striped table-hover">                        <colgroup>                            <col width="20%" />                            <col width="50%" />                            <col width="30%" />                            <col width="180px" />                        </colgroup>                        <thead>                            <tr>                                <th></th>                                <th>Title</th>                                <th>No. products</th>                                <th><input type="checkbox" class="check-all"/></th>                            </tr>                        </thead>                        <tbody id="categories-list">                            #foreach($cat in $page.children)                            <tr>                                <td>                                    <a href="$cat.name">                                        #if( $cat.imageHref )                                        <img src="$cat.imageHref" class="cat-image" />                                        #else                                        $cat.name                                        #end                                    </a>                                </td>                                <td>$cat.title</td>                                <td>$cat.numProducts</td>                                <th><input type="checkbox" data-catid="$cat.category.id" class="cat-check"/></th>                            </tr>                            #end                        </tbody>                    </table>                </div>            </div>        </div>        <div id="addCategoryModal" class="modal fade" tabindex="-1" data-focus-on="input:first" role="dialog" aria-hidden="true">            <div class="modal-header">                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>                <h4 class="modal-title">Category Details</h4>            </div>            <div class="modal-body">                <form action="." method="POST" class="form-horizontal createCategory">                    <input type="hidden" name="action" value="create"/>                    <div class="form-group">                        <label class="col-md-3 control-label" for="name">Name/Code</label>                        <div class="col-md-8">                            <input class="form-control required" type="text" id="name" name="name" maxlength="30" placeholder="Category code, Eg MEK-123"  />                        </div>                    </div>                    <div class="form-group">                        <label class="col-md-3 control-label" for="newTitle">Title</label>                        <div class="col-md-8">                            <input class="form-control required" id="newTitle" type="text" name="newTitle" maxlength="250" placeholder="Category title" />                        </div>                    </div>                </form>            </div>            <div class="modal-footer">                <button type="button" class="btn btn-sm btn-default" data-dismiss="modal">Close</button>                <button type="button" class="btn btn-sm btn-primary" data-type="form-submit">Create category</button>            </div>        </div>                <script type="text/javascript">            $(function () {                $(".newCategory").click(function (event) {                    event.preventDefault();                    // Reset fields in the create product form                    $("#addCategoryModal").find("input[type=text], textarea,input[name=pageName]").val("");                });                $("form.createCategory").forms({                    callback: function () {                        $("#categories-list").reloadFragment();                        $("#addCategoryModal").modal('hide');                    }                });                $("body").on("click", ".deleteCat", function (e) {                    e.preventDefault();                    var listToDelete = [];                    $('body').find(':checkbox.cat-check:checked').each(function () {                        listToDelete.add($(this).data("catid"));                    });                    if (listToDelete.length > 0 && confirm("Are you sure you want to delete " + listToDelete.length + " categories?")) {                        flog(listToDelete.join(','));                        deleteCategories(listToDelete.join(','));                        $('body').find('.check-all').check(false).change();                    }                });                $('body').on('change', '.check-all', function (e) {                    var checkedStatus = this.checked;                    $('body').find(':checkbox.cat-check').prop('checked', checkedStatus);                });            });            function deleteCategories(listToDelete) {                $.ajax({                    url: window.location.pathname,                    type: 'POST',                    dataType: 'json',                    data: {                        deleteCat: listToDelete                    },                    success: function (resp) {                        flog("success", resp);                        if (resp.status) {                            Msg.info(resp.messages[0]);                            $("#categories-list").reloadFragment();                        } else {                            Msg.error("An error occured delete categories");                        }                    },                    error: function () {                        alert('An error occured delete categories');                    }                });            }        </script>            </body></html>